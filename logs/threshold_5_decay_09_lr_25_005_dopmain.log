prepare dataloader...
finished!
Initializing a new model from scratch
{'decoder_out_dim': 200}
Final encoder config NTConfig(block_size=200, patch_size=200, sample_size=40000, num_classes=0, in_chans=1, out_chans=16, use_mean_pooling=True, init_scale=0.001, n_layer=12, n_head=12, n_embd=768, dropout=0.0, bias=False)
Final decoder config NTConfig(block_size=200, patch_size=200, sample_size=40000, num_classes=0, in_chans=128, out_chans=16, use_mean_pooling=True, init_scale=0.001, n_layer=4, n_head=12, n_embd=768, dropout=0.0, bias=False)
num decayed parameter tensors: 100, with 144,821,744 parameters
num non-decayed parameter tensors: 66, with 40,766 parameters
using fused AdamW: True
Set warmup steps = 6690
Performing Kemans init for codebook

π”¬ Encoder Diversity (iter 0):
  Avg similarity: 0.6543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5905 (0.0=collapsed)
[Epoch 1/100] [Batch 10/669 (1.5%)] [Iter 10] Loss: 2.2679 (freq: 1.2009, raw: 1.0663, quant: 0.0007, domain: 0.0000) LR: 2.69e-08 
π“ Codebook: 1022/1024 (99.8%) Top5:[526,222,454,865,172,175,47,532,311,371,321,504,811,340,19]


π”¬ Encoder Diversity (iter 10):
  Avg similarity: 0.6401 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6060 (0.0=collapsed)
[Epoch 1/100] [Batch 20/669 (3.0%)] [Iter 20] Loss: 2.2110 (freq: 1.1431, raw: 1.0672, quant: 0.0006, domain: 0.0000) LR: 5.68e-08 
π“ Codebook: 668/1024 (65.2%) Top5:[297,526,696,437,169,608,12,193,948,913,366,414,391,712,303]


π”¬ Encoder Diversity (iter 20):
  Avg similarity: 0.6121 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6049 (0.0=collapsed)
[Epoch 1/100] [Batch 30/669 (4.5%)] [Iter 30] Loss: 2.2540 (freq: 1.1875, raw: 1.0659, quant: 0.0006, domain: 0.0000) LR: 8.67e-08 
π“ Codebook: 531/1024 (51.9%) Top5:[297,169,758,73,526,724,437,865,474,391,545,608,913,196,256]


π”¬ Encoder Diversity (iter 30):
  Avg similarity: 0.6397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6077 (0.0=collapsed)
[Epoch 1/100] [Batch 40/669 (6.0%)] [Iter 40] Loss: 2.2051 (freq: 1.1388, raw: 1.0657, quant: 0.0006, domain: 0.0000) LR: 1.17e-07 
π“ Codebook: 522/1024 (51.0%) Top5:[437,608,169,526,297,863,913,792,317,758,391,321,100,303,712]


π”¬ Encoder Diversity (iter 40):
  Avg similarity: 0.6372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6020 (0.0=collapsed)
[Epoch 1/100] [Batch 50/669 (7.5%)] [Iter 50] Loss: 2.2029 (freq: 1.1377, raw: 1.0646, quant: 0.0006, domain: 0.0000) LR: 1.47e-07 
π“ Codebook: 506/1024 (49.4%) Top5:[437,297,608,526,696,169,863,545,391,776,390,505,942,913,979]


π”¬ Encoder Diversity (iter 50):
  Avg similarity: 0.6357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5943 (0.0=collapsed)
[Epoch 1/100] [Batch 60/669 (9.0%)] [Iter 60] Loss: 2.2029 (freq: 1.1361, raw: 1.0662, quant: 0.0006, domain: 0.0000) LR: 1.76e-07 
π“ Codebook: 496/1024 (48.4%) Top5:[608,430,526,504,724,297,776,696,437,660,173,169,792,712,391]


π”¬ Encoder Diversity (iter 60):
  Avg similarity: 0.6452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6033 (0.0=collapsed)
[Epoch 1/100] [Batch 70/669 (10.5%)] [Iter 70] Loss: 2.2019 (freq: 1.1400, raw: 1.0613, quant: 0.0006, domain: 0.0000) LR: 2.06e-07 
π“ Codebook: 445/1024 (43.5%) Top5:[366,297,526,437,545,391,696,948,913,196,724,758,474,33,20]


π”¬ Encoder Diversity (iter 70):
  Avg similarity: 0.6353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6035 (0.0=collapsed)
[Epoch 1/100] [Batch 80/669 (12.0%)] [Iter 80] Loss: 2.1809 (freq: 1.1138, raw: 1.0665, quant: 0.0006, domain: 0.0000) LR: 2.36e-07 
π“ Codebook: 448/1024 (43.8%) Top5:[366,297,948,696,913,543,545,210,33,437,526,277,502,78,608]


π”¬ Encoder Diversity (iter 80):
  Avg similarity: 0.6379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6048 (0.0=collapsed)
[Epoch 1/100] [Batch 90/669 (13.5%)] [Iter 90] Loss: 2.1806 (freq: 1.1209, raw: 1.0592, quant: 0.0006, domain: 0.0000) LR: 2.66e-07 
π“ Codebook: 353/1024 (34.5%) Top5:[608,526,437,297,792,317,545,863,173,321,366,621,163,78,256]


π”¬ Encoder Diversity (iter 90):
  Avg similarity: 0.6407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5986 (0.0=collapsed)
[Epoch 1/100] [Batch 100/669 (14.9%)] [Iter 100] Loss: 2.1807 (freq: 1.1223, raw: 1.0578, quant: 0.0006, domain: 0.0000) LR: 2.96e-07 
π“ Codebook: 335/1024 (32.7%) Top5:[608,526,105,792,256,317,437,776,991,712,716,1005,758,942,864]


π”¬ Encoder Diversity (iter 100):
  Avg similarity: 0.6243 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6025 (0.0=collapsed)
[Epoch 1/100] [Batch 110/669 (16.4%)] [Iter 110] Loss: 2.1739 (freq: 1.1194, raw: 1.0540, quant: 0.0006, domain: 0.0000) LR: 3.26e-07 
π“ Codebook: 283/1024 (27.6%) Top5:[297,913,366,608,545,256,526,696,948,437,391,169,162,621,397]


π”¬ Encoder Diversity (iter 110):
  Avg similarity: 0.6389 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5975 (0.0=collapsed)
[Epoch 1/100] [Batch 120/669 (17.9%)] [Iter 120] Loss: 2.1449 (freq: 1.0911, raw: 1.0532, quant: 0.0006, domain: 0.0000) LR: 3.56e-07 
π“ Codebook: 258/1024 (25.2%) Top5:[608,297,317,210,526,105,696,758,792,437,169,913,366,948,545]


π”¬ Encoder Diversity (iter 120):
  Avg similarity: 0.6536 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5844 (0.0=collapsed)
[Epoch 1/100] [Batch 130/669 (19.4%)] [Iter 130] Loss: 2.1141 (freq: 1.0614, raw: 1.0522, quant: 0.0006, domain: 0.0000) LR: 3.86e-07 
π“ Codebook: 228/1024 (22.3%) Top5:[608,297,526,317,696,545,437,792,366,776,948,210,913,105,169]


π”¬ Encoder Diversity (iter 130):
  Avg similarity: 0.6213 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6056 (0.0=collapsed)
[Epoch 1/100] [Batch 140/669 (20.9%)] [Iter 140] Loss: 2.0724 (freq: 1.0222, raw: 1.0496, quant: 0.0005, domain: 0.0000) LR: 4.16e-07 
π“ Codebook: 220/1024 (21.5%) Top5:[608,526,19,391,724,317,913,792,545,696,321,437,210,148,366]


π”¬ Encoder Diversity (iter 140):
  Avg similarity: 0.6311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5973 (0.0=collapsed)
[Epoch 1/100] [Batch 150/669 (22.4%)] [Iter 150] Loss: 2.1744 (freq: 1.1237, raw: 1.0501, quant: 0.0006, domain: 0.0000) LR: 4.46e-07 
π“ Codebook: 195/1024 (19.0%) Top5:[162,724,608,776,474,317,105,19,792,437,17,100,173,526,78]


π”¬ Encoder Diversity (iter 150):
  Avg similarity: 0.6404 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6002 (0.0=collapsed)
[Epoch 1/100] [Batch 160/669 (23.9%)] [Iter 160] Loss: 2.1361 (freq: 1.0873, raw: 1.0482, quant: 0.0006, domain: 0.0000) LR: 4.75e-07 
π“ Codebook: 179/1024 (17.5%) Top5:[105,724,776,19,282,397,502,162,256,862,120,474,677,17,1015]


π”¬ Encoder Diversity (iter 160):
  Avg similarity: 0.6448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6056 (0.0=collapsed)
[Epoch 1/100] [Batch 170/669 (25.4%)] [Iter 170] Loss: 2.1232 (freq: 1.0785, raw: 1.0441, quant: 0.0006, domain: 0.0000) LR: 5.05e-07 
π“ Codebook: 137/1024 (13.4%) Top5:[724,792,317,526,173,608,371,100,621,162,321,649,502,474,862]


π”¬ Encoder Diversity (iter 170):
  Avg similarity: 0.6213 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6034 (0.0=collapsed)
[Epoch 1/100] [Batch 180/669 (26.9%)] [Iter 180] Loss: 2.0514 (freq: 1.0070, raw: 1.0439, quant: 0.0006, domain: 0.0000) LR: 5.35e-07 
π“ Codebook: 201/1024 (19.6%) Top5:[105,502,19,148,724,608,526,792,297,474,317,282,437,677,173]


π”¬ Encoder Diversity (iter 180):
  Avg similarity: 0.6554 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5972 (0.0=collapsed)
[Epoch 1/100] [Batch 190/669 (28.4%)] [Iter 190] Loss: 2.0276 (freq: 0.9842, raw: 1.0428, quant: 0.0006, domain: 0.0000) LR: 5.65e-07 
π“ Codebook: 183/1024 (17.9%) Top5:[105,621,173,317,724,526,792,474,608,282,100,19,321,437,371]


π”¬ Encoder Diversity (iter 190):
  Avg similarity: 0.6327 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5964 (0.0=collapsed)
[Epoch 1/100] [Batch 200/669 (29.9%)] [Iter 200] Loss: 2.0572 (freq: 1.0172, raw: 1.0393, quant: 0.0006, domain: 0.0000) LR: 5.95e-07 
π“ Codebook: 173/1024 (16.9%) Top5:[677,19,776,724,17,105,862,474,414,1015,282,20,502,391,621]


π”¬ Encoder Diversity (iter 200):
  Avg similarity: 0.6472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5918 (0.0=collapsed)
[Epoch 1/100] [Batch 210/669 (31.4%)] [Iter 210] Loss: 2.0017 (freq: 0.9634, raw: 1.0377, quant: 0.0006, domain: 0.0000) LR: 6.25e-07 
π“ Codebook: 153/1024 (14.9%) Top5:[913,677,366,148,297,545,724,608,162,948,776,696,210,1015,317]


π”¬ Encoder Diversity (iter 210):
  Avg similarity: 0.6352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6010 (0.0=collapsed)
[Epoch 1/100] [Batch 220/669 (32.9%)] [Iter 220] Loss: 2.0719 (freq: 1.0337, raw: 1.0376, quant: 0.0006, domain: 0.0000) LR: 6.55e-07 
π“ Codebook: 141/1024 (13.8%) Top5:[105,724,1015,776,502,19,430,282,474,862,17,414,20,256,162]


π”¬ Encoder Diversity (iter 220):
  Avg similarity: 0.6511 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5844 (0.0=collapsed)
[Epoch 1/100] [Batch 230/669 (34.4%)] [Iter 230] Loss: 2.0293 (freq: 0.9953, raw: 1.0335, quant: 0.0006, domain: 0.0000) LR: 6.85e-07 
π“ Codebook: 139/1024 (13.6%) Top5:[414,502,19,173,677,724,317,526,235,100,256,862,608,474,321]


π”¬ Encoder Diversity (iter 230):
  Avg similarity: 0.6341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6008 (0.0=collapsed)
[Epoch 1/100] [Batch 240/669 (35.9%)] [Iter 240] Loss: 1.9790 (freq: 0.9443, raw: 1.0342, quant: 0.0005, domain: 0.0000) LR: 7.15e-07 
π“ Codebook: 168/1024 (16.4%) Top5:[105,677,776,148,19,608,20,414,173,297,317,210,437,321,724]


π”¬ Encoder Diversity (iter 240):
  Avg similarity: 0.6476 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5962 (0.0=collapsed)
[Epoch 1/100] [Batch 250/669 (37.4%)] [Iter 250] Loss: 2.0021 (freq: 0.9707, raw: 1.0309, quant: 0.0005, domain: 0.0000) LR: 7.45e-07 
π“ Codebook: 194/1024 (18.9%) Top5:[105,1015,724,19,608,526,17,317,321,256,371,173,414,437,100]


π”¬ Encoder Diversity (iter 250):
  Avg similarity: 0.6571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5917 (0.0=collapsed)
[Epoch 1/100] [Batch 260/669 (38.9%)] [Iter 260] Loss: 2.0116 (freq: 0.9804, raw: 1.0307, quant: 0.0005, domain: 0.0000) LR: 7.74e-07 
π“ Codebook: 190/1024 (18.6%) Top5:[297,105,148,19,1015,608,366,724,437,33,913,862,20,677,505]


π”¬ Encoder Diversity (iter 260):
  Avg similarity: 0.6638 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5832 (0.0=collapsed)
[Epoch 1/100] [Batch 270/669 (40.4%)] [Iter 270] Loss: 2.0035 (freq: 0.9722, raw: 1.0307, quant: 0.0005, domain: 0.0000) LR: 8.04e-07 
π“ Codebook: 183/1024 (17.9%) Top5:[677,256,414,724,1015,19,862,505,776,17,397,621,235,608,373]


π”¬ Encoder Diversity (iter 270):
  Avg similarity: 0.6649 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5759 (0.0=collapsed)
[Epoch 1/100] [Batch 280/669 (41.9%)] [Iter 280] Loss: 1.8765 (freq: 0.8464, raw: 1.0297, quant: 0.0004, domain: 0.0000) LR: 8.34e-07 
π“ Codebook: 175/1024 (17.1%) Top5:[297,371,437,526,366,256,148,724,317,608,913,948,677,173,696]


π”¬ Encoder Diversity (iter 280):
  Avg similarity: 0.6697 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5768 (0.0=collapsed)
[Epoch 1/100] [Batch 290/669 (43.3%)] [Iter 290] Loss: 1.9194 (freq: 0.8926, raw: 1.0264, quant: 0.0004, domain: 0.0000) LR: 8.64e-07 
π“ Codebook: 169/1024 (16.5%) Top5:[148,297,608,366,317,437,371,321,100,545,526,696,173,792,913]


π”¬ Encoder Diversity (iter 290):
  Avg similarity: 0.6615 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5780 (0.0=collapsed)
[Epoch 1/100] [Batch 300/669 (44.8%)] [Iter 300] Loss: 1.8829 (freq: 0.8564, raw: 1.0261, quant: 0.0004, domain: 0.0000) LR: 8.94e-07 
π“ Codebook: 174/1024 (17.0%) Top5:[317,437,148,366,297,608,391,100,526,696,321,371,373,19,913]


π”¬ Encoder Diversity (iter 300):
  Avg similarity: 0.6805 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5648 (0.0=collapsed)
[Epoch 1/100] [Batch 310/669 (46.3%)] [Iter 310] Loss: 1.8689 (freq: 0.8435, raw: 1.0251, quant: 0.0004, domain: 0.0000) LR: 9.24e-07 
π“ Codebook: 166/1024 (16.2%) Top5:[724,621,297,677,1015,148,256,391,608,948,696,317,913,526,366]


π”¬ Encoder Diversity (iter 310):
  Avg similarity: 0.6720 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5666 (0.0=collapsed)
[Epoch 1/100] [Batch 320/669 (47.8%)] [Iter 320] Loss: 1.9388 (freq: 0.9149, raw: 1.0235, quant: 0.0004, domain: 0.0000) LR: 9.54e-07 
π“ Codebook: 137/1024 (13.4%) Top5:[608,317,1015,724,526,414,297,792,437,173,502,677,256,100,371]


π”¬ Encoder Diversity (iter 320):
  Avg similarity: 0.6977 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5610 (0.0=collapsed)
[Epoch 1/100] [Batch 330/669 (49.3%)] [Iter 330] Loss: 1.9428 (freq: 0.9241, raw: 1.0183, quant: 0.0004, domain: 0.0000) LR: 9.84e-07 
π“ Codebook: 135/1024 (13.2%) Top5:[1015,677,20,862,105,414,297,256,724,391,148,196,696,948,366]


π”¬ Encoder Diversity (iter 330):
  Avg similarity: 0.6829 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5685 (0.0=collapsed)
[Epoch 1/100] [Batch 340/669 (50.8%)] [Iter 340] Loss: 2.0044 (freq: 0.9845, raw: 1.0195, quant: 0.0004, domain: 0.0000) LR: 1.01e-06 
π“ Codebook: 130/1024 (12.7%) Top5:[1015,297,677,148,366,256,20,621,391,724,545,196,696,502,105]


π”¬ Encoder Diversity (iter 340):
  Avg similarity: 0.7095 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5522 (0.0=collapsed)
[Epoch 1/100] [Batch 350/669 (52.3%)] [Iter 350] Loss: 1.9154 (freq: 0.8961, raw: 1.0190, quant: 0.0004, domain: 0.0000) LR: 1.04e-06 
π“ Codebook: 119/1024 (11.6%) Top5:[724,317,20,677,1015,256,391,173,105,621,502,608,148,437,297]


π”¬ Encoder Diversity (iter 350):
  Avg similarity: 0.6786 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5654 (0.0=collapsed)
[Epoch 1/100] [Batch 360/669 (53.8%)] [Iter 360] Loss: 1.9121 (freq: 0.8949, raw: 1.0169, quant: 0.0004, domain: 0.0000) LR: 1.07e-06 
π“ Codebook: 125/1024 (12.2%) Top5:[20,105,1015,724,391,256,196,862,621,173,608,148,677,792,414]


π”¬ Encoder Diversity (iter 360):
  Avg similarity: 0.6980 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5528 (0.0=collapsed)
[Epoch 1/100] [Batch 370/669 (55.3%)] [Iter 370] Loss: 1.8475 (freq: 0.8313, raw: 1.0159, quant: 0.0003, domain: 0.0000) LR: 1.10e-06 
π“ Codebook: 113/1024 (11.0%) Top5:[724,502,1015,391,196,621,677,256,317,20,148,792,430,545,100]


π”¬ Encoder Diversity (iter 370):
  Avg similarity: 0.7186 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5328 (0.0=collapsed)
[Epoch 1/100] [Batch 380/669 (56.8%)] [Iter 380] Loss: 1.9664 (freq: 0.9497, raw: 1.0164, quant: 0.0004, domain: 0.0000) LR: 1.13e-06 
π“ Codebook: 93/1024 (9.1%) Top5:[724,502,1015,256,297,33,196,366,437,545,913,621,148,105,948]


π”¬ Encoder Diversity (iter 380):
  Avg similarity: 0.7094 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5508 (0.0=collapsed)
[Epoch 1/100] [Batch 390/669 (58.3%)] [Iter 390] Loss: 1.9601 (freq: 0.9464, raw: 1.0133, quant: 0.0003, domain: 0.0000) LR: 1.16e-06 
π“ Codebook: 104/1024 (10.2%) Top5:[502,1015,391,414,724,196,105,173,256,677,702,100,19,437,20]


π”¬ Encoder Diversity (iter 390):
  Avg similarity: 0.7031 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5361 (0.0=collapsed)
[Epoch 1/100] [Batch 400/669 (59.8%)] [Iter 400] Loss: 1.8734 (freq: 0.8606, raw: 1.0125, quant: 0.0003, domain: 0.0000) LR: 1.19e-06 
π“ Codebook: 108/1024 (10.5%) Top5:[724,256,1015,196,502,391,297,621,148,677,373,20,105,1005,47]


π”¬ Encoder Diversity (iter 400):
  Avg similarity: 0.7081 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5407 (0.0=collapsed)
[Epoch 1/100] [Batch 410/669 (61.3%)] [Iter 410] Loss: 1.9900 (freq: 0.9774, raw: 1.0123, quant: 0.0003, domain: 0.0000) LR: 1.22e-06 
π“ Codebook: 80/1024 (7.8%) Top5:[502,724,702,256,196,105,20,391,677,297,660,1015,47,148,621]


π”¬ Encoder Diversity (iter 410):
  Avg similarity: 0.7061 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5419 (0.0=collapsed)
[Epoch 1/100] [Batch 420/669 (62.8%)] [Iter 420] Loss: 1.8740 (freq: 0.8622, raw: 1.0115, quant: 0.0003, domain: 0.0000) LR: 1.25e-06 
π“ Codebook: 92/1024 (9.0%) Top5:[724,105,256,502,1015,621,414,677,864,196,47,702,391,1005,660]


π”¬ Encoder Diversity (iter 420):
  Avg similarity: 0.7123 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5353 (0.0=collapsed)
[Epoch 1/100] [Batch 430/669 (64.3%)] [Iter 430] Loss: 1.9132 (freq: 0.9020, raw: 1.0109, quant: 0.0003, domain: 0.0000) LR: 1.28e-06 
π“ Codebook: 89/1024 (8.7%) Top5:[724,702,256,105,1015,621,391,862,1005,660,20,100,235,173,373]


π”¬ Encoder Diversity (iter 430):
  Avg similarity: 0.7070 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5429 (0.0=collapsed)
[Epoch 1/100] [Batch 440/669 (65.8%)] [Iter 440] Loss: 1.9358 (freq: 0.9254, raw: 1.0102, quant: 0.0003, domain: 0.0000) LR: 1.31e-06 
π“ Codebook: 92/1024 (9.0%) Top5:[724,1015,677,502,862,105,660,256,702,414,864,235,621,47,942]


π”¬ Encoder Diversity (iter 440):
  Avg similarity: 0.7348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5196 (0.0=collapsed)
[Epoch 1/100] [Batch 450/669 (67.3%)] [Iter 450] Loss: 1.8890 (freq: 0.8788, raw: 1.0099, quant: 0.0003, domain: 0.0000) LR: 1.34e-06 
π“ Codebook: 87/1024 (8.5%) Top5:[724,660,105,702,862,256,1015,677,502,297,173,696,545,235,414]


π”¬ Encoder Diversity (iter 450):
  Avg similarity: 0.7138 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5326 (0.0=collapsed)
[Epoch 1/100] [Batch 460/669 (68.8%)] [Iter 460] Loss: 1.9394 (freq: 0.9307, raw: 1.0084, quant: 0.0003, domain: 0.0000) LR: 1.37e-06 
π“ Codebook: 90/1024 (8.8%) Top5:[724,677,702,502,660,942,1005,1015,20,148,100,173,696,235,297]


π”¬ Encoder Diversity (iter 460):
  Avg similarity: 0.7411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5121 (0.0=collapsed)
[Epoch 1/100] [Batch 470/669 (70.3%)] [Iter 470] Loss: 1.9643 (freq: 0.9547, raw: 1.0093, quant: 0.0003, domain: 0.0000) LR: 1.40e-06 
π“ Codebook: 72/1024 (7.0%) Top5:[724,660,297,148,696,1015,502,366,33,437,608,862,256,545,948]


π”¬ Encoder Diversity (iter 470):
  Avg similarity: 0.7212 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5295 (0.0=collapsed)
[Epoch 1/100] [Batch 480/669 (71.7%)] [Iter 480] Loss: 1.8911 (freq: 0.8814, raw: 1.0094, quant: 0.0003, domain: 0.0000) LR: 1.43e-06 
π“ Codebook: 71/1024 (6.9%) Top5:[724,1015,502,660,677,862,256,105,414,391,702,47,235,864,297]


π”¬ Encoder Diversity (iter 480):
  Avg similarity: 0.6972 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5321 (0.0=collapsed)
[Epoch 1/100] [Batch 490/669 (73.2%)] [Iter 490] Loss: 1.7807 (freq: 0.7725, raw: 1.0079, quant: 0.0003, domain: 0.0000) LR: 1.46e-06 
π“ Codebook: 70/1024 (6.8%) Top5:[724,862,105,702,502,1005,677,391,864,235,414,47,256,660,297]


π”¬ Encoder Diversity (iter 490):
  Avg similarity: 0.7095 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5349 (0.0=collapsed)
[Epoch 1/100] [Batch 500/669 (74.7%)] [Iter 500] Loss: 1.8154 (freq: 0.8071, raw: 1.0081, quant: 0.0003, domain: 0.0000) LR: 1.49e-06 
π“ Codebook: 78/1024 (7.6%) Top5:[724,502,660,862,414,677,702,173,864,105,100,942,1015,47,696]


π”¬ Encoder Diversity (iter 500):
  Avg similarity: 0.7268 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5310 (0.0=collapsed)
[Epoch 1/100] [Batch 510/669 (76.2%)] [Iter 510] Loss: 1.8984 (freq: 0.8912, raw: 1.0069, quant: 0.0003, domain: 0.0000) LR: 1.52e-06 
π“ Codebook: 77/1024 (7.5%) Top5:[724,502,677,660,1015,47,391,862,942,256,196,414,105,864,162]


π”¬ Encoder Diversity (iter 510):
  Avg similarity: 0.7214 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5307 (0.0=collapsed)
[Epoch 1/100] [Batch 520/669 (77.7%)] [Iter 520] Loss: 1.7980 (freq: 0.7911, raw: 1.0067, quant: 0.0003, domain: 0.0000) LR: 1.55e-06 
π“ Codebook: 77/1024 (7.5%) Top5:[724,502,677,660,1015,256,391,942,47,1005,196,162,862,702,235]


π”¬ Encoder Diversity (iter 520):
  Avg similarity: 0.7105 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5383 (0.0=collapsed)
[Epoch 1/100] [Batch 530/669 (79.2%)] [Iter 530] Loss: 1.6985 (freq: 0.6926, raw: 1.0056, quant: 0.0003, domain: 0.0000) LR: 1.58e-06 
π“ Codebook: 71/1024 (6.9%) Top5:[724,502,660,256,47,196,696,942,297,391,677,1015,414,702,105]


π”¬ Encoder Diversity (iter 530):
  Avg similarity: 0.6975 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5398 (0.0=collapsed)
[Epoch 1/100] [Batch 540/669 (80.7%)] [Iter 540] Loss: 1.9773 (freq: 0.9706, raw: 1.0064, quant: 0.0003, domain: 0.0000) LR: 1.61e-06 
π“ Codebook: 77/1024 (7.5%) Top5:[724,502,1015,660,256,677,1005,47,942,414,196,162,391,105,235]


π”¬ Encoder Diversity (iter 540):
  Avg similarity: 0.7082 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5373 (0.0=collapsed)
[Epoch 1/100] [Batch 550/669 (82.2%)] [Iter 550] Loss: 1.6329 (freq: 0.6276, raw: 1.0050, quant: 0.0003, domain: 0.0000) LR: 1.64e-06 
π“ Codebook: 67/1024 (6.5%) Top5:[724,297,33,148,1015,913,660,696,256,502,366,948,677,47,862]


π”¬ Encoder Diversity (iter 550):
  Avg similarity: 0.6957 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5429 (0.0=collapsed)
[Epoch 1/100] [Batch 560/669 (83.7%)] [Iter 560] Loss: 1.9127 (freq: 0.9065, raw: 1.0059, quant: 0.0003, domain: 0.0000) LR: 1.67e-06 
π“ Codebook: 90/1024 (8.8%) Top5:[724,502,660,1015,256,677,414,862,47,105,196,391,942,1005,235]


π”¬ Encoder Diversity (iter 560):
  Avg similarity: 0.6788 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5661 (0.0=collapsed)
[Epoch 1/100] [Batch 570/669 (85.2%)] [Iter 570] Loss: 1.8730 (freq: 0.8671, raw: 1.0056, quant: 0.0003, domain: 0.0000) LR: 1.70e-06 
π“ Codebook: 81/1024 (7.9%) Top5:[724,660,502,47,256,414,297,148,196,33,677,942,366,913,391]


π”¬ Encoder Diversity (iter 570):
  Avg similarity: 0.6752 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5683 (0.0=collapsed)
[Epoch 1/100] [Batch 580/669 (86.7%)] [Iter 580] Loss: 1.9404 (freq: 0.9344, raw: 1.0057, quant: 0.0004, domain: 0.0000) LR: 1.73e-06 
π“ Codebook: 109/1024 (10.6%) Top5:[724,502,660,414,256,942,677,47,862,196,1015,297,148,162,391]


π”¬ Encoder Diversity (iter 580):
  Avg similarity: 0.6805 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5582 (0.0=collapsed)
[Epoch 1/100] [Batch 590/669 (88.2%)] [Iter 590] Loss: 1.7431 (freq: 0.7373, raw: 1.0055, quant: 0.0003, domain: 0.0000) LR: 1.76e-06 
π“ Codebook: 94/1024 (9.2%) Top5:[724,297,148,33,366,696,502,660,913,948,414,47,256,942,677]


π”¬ Encoder Diversity (iter 590):
  Avg similarity: 0.6411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5824 (0.0=collapsed)
[Epoch 1/100] [Batch 600/669 (89.7%)] [Iter 600] Loss: 1.7168 (freq: 0.7109, raw: 1.0056, quant: 0.0003, domain: 0.0000) LR: 1.79e-06 
π“ Codebook: 129/1024 (12.6%) Top5:[724,502,660,256,47,942,677,414,196,297,391,862,621,162,105]


π”¬ Encoder Diversity (iter 600):
  Avg similarity: 0.6283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5900 (0.0=collapsed)
[Epoch 1/100] [Batch 610/669 (91.2%)] [Iter 610] Loss: 1.8283 (freq: 0.8222, raw: 1.0058, quant: 0.0003, domain: 0.0000) LR: 1.82e-06 
π“ Codebook: 122/1024 (11.9%) Top5:[724,502,660,256,942,196,677,47,414,391,373,621,297,1015,148]


π”¬ Encoder Diversity (iter 610):
  Avg similarity: 0.6374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5889 (0.0=collapsed)
[Epoch 1/100] [Batch 620/669 (92.7%)] [Iter 620] Loss: 1.7677 (freq: 0.7622, raw: 1.0052, quant: 0.0003, domain: 0.0000) LR: 1.85e-06 
π“ Codebook: 110/1024 (10.7%) Top5:[724,148,256,297,33,502,660,913,696,366,948,677,942,1015,196]


π”¬ Encoder Diversity (iter 620):
  Avg similarity: 0.6550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5904 (0.0=collapsed)
[Epoch 1/100] [Batch 630/669 (94.2%)] [Iter 630] Loss: 1.8646 (freq: 0.8597, raw: 1.0045, quant: 0.0004, domain: 0.0000) LR: 1.88e-06 
π“ Codebook: 131/1024 (12.8%) Top5:[724,256,148,502,660,297,1015,47,677,33,942,696,913,373,210]


π”¬ Encoder Diversity (iter 630):
  Avg similarity: 0.6235 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6105 (0.0=collapsed)
[Epoch 1/100] [Batch 640/669 (95.7%)] [Iter 640] Loss: 1.8957 (freq: 0.8903, raw: 1.0050, quant: 0.0004, domain: 0.0000) LR: 1.91e-06 
π“ Codebook: 135/1024 (13.2%) Top5:[724,256,660,148,677,502,47,297,1015,373,414,942,24,196,1005]


π”¬ Encoder Diversity (iter 640):
  Avg similarity: 0.6183 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6027 (0.0=collapsed)
[Epoch 1/100] [Batch 650/669 (97.2%)] [Iter 650] Loss: 1.8928 (freq: 0.8875, raw: 1.0049, quant: 0.0004, domain: 0.0000) LR: 1.94e-06 
π“ Codebook: 123/1024 (12.0%) Top5:[724,256,660,502,942,373,47,677,24,414,105,1015,297,1005,148]


π”¬ Encoder Diversity (iter 650):
  Avg similarity: 0.6348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6050 (0.0=collapsed)
[Epoch 1/100] [Batch 660/669 (98.7%)] [Iter 660] Loss: 1.8488 (freq: 0.8446, raw: 1.0039, quant: 0.0003, domain: 0.0000) LR: 1.97e-06 
π“ Codebook: 104/1024 (10.2%) Top5:[724,502,660,148,1015,297,948,47,256,677,33,696,366,373,162]


π”¬ Encoder Diversity (iter 660):
  Avg similarity: 0.6490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5937 (0.0=collapsed)

================================================================================
[Epoch 1] Validation Results:
  Total Loss: 1.4690
  Freq Loss:  0.4666
  Raw Loss:   1.0022
  Quant Loss: 0.0003
  π“ Codebook Usage: 60/1024 (5.9%)
  π“ Codebook Entropy: 3.2708 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 73093 (56.1%)
  Top 10 most used codes:
    1. Code 148: 10127 times (7.78%)
    2. Code 297: 9887 times (7.59%)
    3. Code 948: 9464 times (7.27%)
    4. Code 696: 7979 times (6.13%)
    5. Code 366: 7158 times (5.50%)
    6. Code 33: 6576 times (5.05%)
    7. Code 193: 5700 times (4.38%)
    8. Code 437: 5603 times (4.30%)
    9. Code 526: 5326 times (4.09%)
    10. Code 100: 5273 times (4.05%)
  Bottom 5 least used codes (among used):
    1. Code 758: 7 times (0.01%)
    2. Code 864: 14 times (0.01%)
    3. Code 19: 14 times (0.01%)
    4. Code 390: 21 times (0.02%)
    5. Code 20: 35 times (0.03%)
================================================================================

[EarlyStopping] Best model saved at epoch 1
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 2/100] [Batch 1/669 (0.1%)] [Iter 670] Loss: 1.8386 (freq: 0.8344, raw: 1.0039, quant: 0.0003, domain: 0.0000) LR: 2.00e-06 
π“ Codebook: 106/1024 (10.4%) Top5:[724,502,660,677,47,256,942,1015,162,414,148,297,373,948,24]


π”¬ Encoder Diversity (iter 670):
  Avg similarity: 0.6211 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6061 (0.0=collapsed)
[Epoch 2/100] [Batch 11/669 (1.6%)] [Iter 680] Loss: 1.8456 (freq: 0.8406, raw: 1.0047, quant: 0.0003, domain: 0.0000) LR: 2.03e-06 
π“ Codebook: 789/1024 (77.1%) Top5:[724,502,47,660,1015,677,256,162,942,24,414,148,297,948,33]


π”¬ Encoder Diversity (iter 680):
  Avg similarity: 0.6131 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6136 (0.0=collapsed)
[Epoch 2/100] [Batch 21/669 (3.1%)] [Iter 690] Loss: 1.9208 (freq: 0.9161, raw: 1.0043, quant: 0.0004, domain: 0.0000) LR: 2.06e-06 
π“ Codebook: 650/1024 (63.5%) Top5:[724,502,1015,660,47,677,256,162,414,942,24,148,297,193,696]


π”¬ Encoder Diversity (iter 690):
  Avg similarity: 0.6458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6055 (0.0=collapsed)
[Epoch 2/100] [Batch 31/669 (4.6%)] [Iter 700] Loss: 1.7059 (freq: 0.7038, raw: 1.0018, quant: 0.0003, domain: 0.0000) LR: 2.09e-06 
π“ Codebook: 490/1024 (47.9%) Top5:[724,502,660,47,1015,677,256,162,942,414,193,24,526,148,649]


π”¬ Encoder Diversity (iter 700):
  Avg similarity: 0.6447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5901 (0.0=collapsed)
[Epoch 2/100] [Batch 41/669 (6.1%)] [Iter 710] Loss: 2.0186 (freq: 1.0144, raw: 1.0039, quant: 0.0004, domain: 0.0000) LR: 2.12e-06 
π“ Codebook: 480/1024 (46.9%) Top5:[1015,724,660,256,502,677,148,47,414,162,942,297,33,366,696]


π”¬ Encoder Diversity (iter 710):
  Avg similarity: 0.6403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5982 (0.0=collapsed)
[Epoch 2/100] [Batch 51/669 (7.6%)] [Iter 720] Loss: 1.6162 (freq: 0.6143, raw: 1.0016, quant: 0.0003, domain: 0.0000) LR: 2.15e-06 
π“ Codebook: 356/1024 (34.8%) Top5:[724,1015,660,148,502,47,256,297,33,696,366,677,948,193,437]


π”¬ Encoder Diversity (iter 720):
  Avg similarity: 0.6249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6132 (0.0=collapsed)
[Epoch 2/100] [Batch 61/669 (9.1%)] [Iter 730] Loss: 1.6887 (freq: 0.6864, raw: 1.0020, quant: 0.0003, domain: 0.0000) LR: 2.18e-06 
π“ Codebook: 439/1024 (42.9%) Top5:[724,660,256,1015,47,502,677,148,297,414,366,162,942,33,24]


π”¬ Encoder Diversity (iter 730):
  Avg similarity: 0.6253 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6074 (0.0=collapsed)
[Epoch 2/100] [Batch 71/669 (10.6%)] [Iter 740] Loss: 1.7626 (freq: 0.7596, raw: 1.0026, quant: 0.0004, domain: 0.0000) LR: 2.21e-06 
π“ Codebook: 429/1024 (41.9%) Top5:[724,660,502,47,256,1015,677,148,414,162,942,24,297,33,696]


π”¬ Encoder Diversity (iter 740):
  Avg similarity: 0.5862 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6298 (0.0=collapsed)
[Epoch 2/100] [Batch 81/669 (12.1%)] [Iter 750] Loss: 1.8576 (freq: 0.8540, raw: 1.0032, quant: 0.0004, domain: 0.0000) LR: 2.24e-06 
π“ Codebook: 385/1024 (37.6%) Top5:[724,660,47,502,256,677,1015,414,24,942,162,608,148,210,526]


π”¬ Encoder Diversity (iter 750):
  Avg similarity: 0.6087 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6235 (0.0=collapsed)
[Epoch 2/100] [Batch 91/669 (13.6%)] [Iter 760] Loss: 1.7442 (freq: 0.7418, raw: 1.0021, quant: 0.0004, domain: 0.0000) LR: 2.27e-06 
π“ Codebook: 424/1024 (41.4%) Top5:[724,660,502,1015,47,256,677,414,942,24,162,193,33,297,148]


π”¬ Encoder Diversity (iter 760):
  Avg similarity: 0.6019 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6284 (0.0=collapsed)
[Epoch 2/100] [Batch 101/669 (15.1%)] [Iter 770] Loss: 1.7048 (freq: 0.7029, raw: 1.0015, quant: 0.0004, domain: 0.0000) LR: 2.30e-06 
π“ Codebook: 362/1024 (35.4%) Top5:[724,660,1015,502,47,256,677,414,162,942,24,148,366,33,696]


π”¬ Encoder Diversity (iter 770):
  Avg similarity: 0.6084 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6106 (0.0=collapsed)
[Epoch 2/100] [Batch 111/669 (16.6%)] [Iter 780] Loss: 1.6869 (freq: 0.6848, raw: 1.0018, quant: 0.0004, domain: 0.0000) LR: 2.33e-06 
π“ Codebook: 400/1024 (39.1%) Top5:[724,660,1015,502,256,47,677,162,414,942,24,148,948,366,297]


π”¬ Encoder Diversity (iter 780):
  Avg similarity: 0.6277 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6083 (0.0=collapsed)
[Epoch 2/100] [Batch 121/669 (18.1%)] [Iter 790] Loss: 1.6544 (freq: 0.6527, raw: 1.0013, quant: 0.0004, domain: 0.0000) LR: 2.36e-06 
π“ Codebook: 327/1024 (31.9%) Top5:[724,660,1015,502,47,256,677,148,162,414,297,948,366,942,696]


π”¬ Encoder Diversity (iter 790):
  Avg similarity: 0.5990 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6315 (0.0=collapsed)
[Epoch 2/100] [Batch 131/669 (19.6%)] [Iter 800] Loss: 1.7396 (freq: 0.7385, raw: 1.0007, quant: 0.0004, domain: 0.0000) LR: 2.39e-06 
π“ Codebook: 304/1024 (29.7%) Top5:[724,660,502,256,1015,677,47,162,148,414,297,948,24,366,942]


π”¬ Encoder Diversity (iter 800):
  Avg similarity: 0.5710 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6424 (0.0=collapsed)
[Epoch 2/100] [Batch 141/669 (21.1%)] [Iter 810] Loss: 1.7474 (freq: 0.7458, raw: 1.0012, quant: 0.0004, domain: 0.0000) LR: 2.42e-06 
π“ Codebook: 316/1024 (30.9%) Top5:[724,660,256,502,677,1015,47,148,297,33,366,948,414,696,24]


π”¬ Encoder Diversity (iter 810):
  Avg similarity: 0.5950 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6304 (0.0=collapsed)
[Epoch 2/100] [Batch 151/669 (22.6%)] [Iter 820] Loss: 1.6038 (freq: 0.6038, raw: 0.9997, quant: 0.0004, domain: 0.0000) LR: 2.45e-06 
π“ Codebook: 320/1024 (31.2%) Top5:[724,660,677,256,148,502,297,366,47,948,33,1015,696,24,414]


π”¬ Encoder Diversity (iter 820):
  Avg similarity: 0.5594 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6534 (0.0=collapsed)
[Epoch 2/100] [Batch 161/669 (24.1%)] [Iter 830] Loss: 1.8654 (freq: 0.8624, raw: 1.0025, quant: 0.0004, domain: 0.0000) LR: 2.48e-06 
π“ Codebook: 309/1024 (30.2%) Top5:[724,660,256,677,1015,502,47,321,942,148,24,297,33,414,162]


π”¬ Encoder Diversity (iter 830):
  Avg similarity: 0.6251 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6275 (0.0=collapsed)
[Epoch 2/100] [Batch 171/669 (25.6%)] [Iter 840] Loss: 1.8165 (freq: 0.8146, raw: 1.0015, quant: 0.0004, domain: 0.0000) LR: 2.51e-06 
π“ Codebook: 322/1024 (31.4%) Top5:[724,660,256,1015,502,677,321,47,148,942,24,297,33,162,173]


π”¬ Encoder Diversity (iter 840):
  Avg similarity: 0.5633 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6591 (0.0=collapsed)
[Epoch 2/100] [Batch 181/669 (27.1%)] [Iter 850] Loss: 1.8509 (freq: 0.8482, raw: 1.0023, quant: 0.0004, domain: 0.0000) LR: 2.54e-06 
π“ Codebook: 323/1024 (31.5%) Top5:[724,660,256,1015,677,502,47,33,148,366,948,297,24,321,942]


π”¬ Encoder Diversity (iter 850):
  Avg similarity: 0.5649 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6472 (0.0=collapsed)
[Epoch 2/100] [Batch 191/669 (28.6%)] [Iter 860] Loss: 1.7938 (freq: 0.7906, raw: 1.0027, quant: 0.0004, domain: 0.0000) LR: 2.57e-06 
π“ Codebook: 293/1024 (28.6%) Top5:[724,660,1015,256,502,677,33,948,366,297,148,321,47,913,942]


π”¬ Encoder Diversity (iter 860):
  Avg similarity: 0.5686 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6533 (0.0=collapsed)
[Epoch 2/100] [Batch 201/669 (30.0%)] [Iter 870] Loss: 1.8003 (freq: 0.7985, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 2.60e-06 
π“ Codebook: 301/1024 (29.4%) Top5:[724,660,256,1015,677,502,47,948,366,321,942,24,33,297,162]


π”¬ Encoder Diversity (iter 870):
  Avg similarity: 0.5502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6760 (0.0=collapsed)
[Epoch 2/100] [Batch 211/669 (31.5%)] [Iter 880] Loss: 1.7023 (freq: 0.7034, raw: 0.9984, quant: 0.0005, domain: 0.0000) LR: 2.63e-06 
π“ Codebook: 296/1024 (28.9%) Top5:[724,660,677,256,502,1015,47,942,948,24,33,321,162,366,414]


π”¬ Encoder Diversity (iter 880):
  Avg similarity: 0.5352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6746 (0.0=collapsed)
[Epoch 2/100] [Batch 221/669 (33.0%)] [Iter 890] Loss: 1.5743 (freq: 0.5770, raw: 0.9968, quant: 0.0004, domain: 0.0000) LR: 2.66e-06 
π“ Codebook: 272/1024 (26.6%) Top5:[724,660,677,256,948,502,47,1015,33,366,913,193,148,942,371]


π”¬ Encoder Diversity (iter 890):
  Avg similarity: 0.5568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6499 (0.0=collapsed)
[Epoch 2/100] [Batch 231/669 (34.5%)] [Iter 900] Loss: 1.8099 (freq: 0.8069, raw: 1.0026, quant: 0.0004, domain: 0.0000) LR: 2.69e-06 
π“ Codebook: 317/1024 (31.0%) Top5:[724,677,660,256,47,1015,502,948,33,24,942,321,148,366,913]


π”¬ Encoder Diversity (iter 900):
  Avg similarity: 0.5375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6691 (0.0=collapsed)
[Epoch 2/100] [Batch 241/669 (36.0%)] [Iter 910] Loss: 1.7479 (freq: 0.7470, raw: 1.0005, quant: 0.0004, domain: 0.0000) LR: 2.72e-06 
π“ Codebook: 291/1024 (28.4%) Top5:[724,660,256,677,1015,33,366,948,148,913,297,321,502,437,47]


π”¬ Encoder Diversity (iter 910):
  Avg similarity: 0.5947 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6443 (0.0=collapsed)
[Epoch 2/100] [Batch 251/669 (37.5%)] [Iter 920] Loss: 1.7962 (freq: 0.7955, raw: 1.0002, quant: 0.0005, domain: 0.0000) LR: 2.75e-06 
π“ Codebook: 314/1024 (30.7%) Top5:[724,256,660,1015,677,321,502,942,33,47,24,148,414,366,913]


π”¬ Encoder Diversity (iter 920):
  Avg similarity: 0.5623 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6617 (0.0=collapsed)
[Epoch 2/100] [Batch 261/669 (39.0%)] [Iter 930] Loss: 1.7174 (freq: 0.7177, raw: 0.9992, quant: 0.0005, domain: 0.0000) LR: 2.78e-06 
π“ Codebook: 350/1024 (34.2%) Top5:[724,660,677,1015,256,502,321,948,33,47,414,366,942,649,148]


π”¬ Encoder Diversity (iter 930):
  Avg similarity: 0.5339 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6730 (0.0=collapsed)
[Epoch 2/100] [Batch 271/669 (40.5%)] [Iter 940] Loss: 1.6578 (freq: 0.6592, raw: 0.9981, quant: 0.0005, domain: 0.0000) LR: 2.81e-06 
π“ Codebook: 340/1024 (33.2%) Top5:[724,660,677,1015,256,502,321,33,47,948,366,414,942,24,162]


π”¬ Encoder Diversity (iter 940):
  Avg similarity: 0.4933 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6929 (0.0=collapsed)
[Epoch 2/100] [Batch 281/669 (42.0%)] [Iter 950] Loss: 1.7852 (freq: 0.7834, raw: 1.0012, quant: 0.0006, domain: 0.0000) LR: 2.84e-06 
π“ Codebook: 288/1024 (28.1%) Top5:[724,660,256,1015,677,502,948,321,366,33,47,297,148,913,414]


π”¬ Encoder Diversity (iter 950):
  Avg similarity: 0.5014 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6921 (0.0=collapsed)
[Epoch 2/100] [Batch 291/669 (43.5%)] [Iter 960] Loss: 1.7396 (freq: 0.7406, raw: 0.9985, quant: 0.0005, domain: 0.0000) LR: 2.87e-06 
π“ Codebook: 248/1024 (24.2%) Top5:[724,660,677,256,47,1015,502,414,948,33,321,24,366,371,942]


π”¬ Encoder Diversity (iter 960):
  Avg similarity: 0.5053 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6999 (0.0=collapsed)
[Epoch 2/100] [Batch 301/669 (45.0%)] [Iter 970] Loss: 1.7986 (freq: 0.7994, raw: 0.9987, quant: 0.0005, domain: 0.0000) LR: 2.90e-06 
π“ Codebook: 259/1024 (25.3%) Top5:[724,660,677,256,502,33,47,1015,148,948,366,297,913,414,321]


π”¬ Encoder Diversity (iter 970):
  Avg similarity: 0.5177 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6921 (0.0=collapsed)
[Epoch 2/100] [Batch 311/669 (46.5%)] [Iter 980] Loss: 1.8566 (freq: 0.8533, raw: 1.0029, quant: 0.0005, domain: 0.0000) LR: 2.93e-06 
π“ Codebook: 246/1024 (24.0%) Top5:[724,660,256,677,1015,502,47,942,24,414,321,33,948,366,913]


π”¬ Encoder Diversity (iter 980):
  Avg similarity: 0.5228 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6825 (0.0=collapsed)
[Epoch 2/100] [Batch 321/669 (48.0%)] [Iter 990] Loss: 1.4908 (freq: 0.4975, raw: 0.9929, quant: 0.0004, domain: 0.0000) LR: 2.96e-06 
π“ Codebook: 294/1024 (28.7%) Top5:[724,660,677,256,1015,502,47,321,33,948,366,148,913,297,942]


π”¬ Encoder Diversity (iter 990):
  Avg similarity: 0.4790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7213 (0.0=collapsed)
[Epoch 2/100] [Batch 331/669 (49.5%)] [Iter 1000] Loss: 1.8401 (freq: 0.8390, raw: 1.0006, quant: 0.0005, domain: 0.0000) LR: 2.99e-06 
π“ Codebook: 256/1024 (25.0%) Top5:[724,660,1015,256,677,502,321,47,173,24,942,371,169,33,414]


π”¬ Encoder Diversity (iter 1000):
  Avg similarity: 0.4823 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7037 (0.0=collapsed)
[Epoch 2/100] [Batch 341/669 (51.0%)] [Iter 1010] Loss: 1.9206 (freq: 0.9186, raw: 1.0016, quant: 0.0005, domain: 0.0000) LR: 3.02e-06 
π“ Codebook: 298/1024 (29.1%) Top5:[724,660,1015,502,677,256,321,47,24,414,942,33,162,173,913]


π”¬ Encoder Diversity (iter 1010):
  Avg similarity: 0.4855 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7064 (0.0=collapsed)
[Epoch 2/100] [Batch 351/669 (52.5%)] [Iter 1020] Loss: 1.8908 (freq: 0.8891, raw: 1.0013, quant: 0.0005, domain: 0.0000) LR: 3.05e-06 
π“ Codebook: 288/1024 (28.1%) Top5:[724,1015,660,502,677,321,256,47,33,913,948,366,414,162,173]


π”¬ Encoder Diversity (iter 1020):
  Avg similarity: 0.5208 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7101 (0.0=collapsed)
[Epoch 2/100] [Batch 361/669 (54.0%)] [Iter 1030] Loss: 1.7799 (freq: 0.7800, raw: 0.9994, quant: 0.0005, domain: 0.0000) LR: 3.08e-06 
π“ Codebook: 370/1024 (36.1%) Top5:[724,660,1015,502,677,321,256,47,33,414,366,913,948,942,297]


π”¬ Encoder Diversity (iter 1030):
  Avg similarity: 0.4638 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7251 (0.0=collapsed)
[Epoch 2/100] [Batch 371/669 (55.5%)] [Iter 1040] Loss: 1.6931 (freq: 0.6957, raw: 0.9969, quant: 0.0005, domain: 0.0000) LR: 3.11e-06 
π“ Codebook: 425/1024 (41.5%) Top5:[724,660,677,502,1015,256,321,47,414,942,162,24,948,33,371]


π”¬ Encoder Diversity (iter 1040):
  Avg similarity: 0.4606 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7230 (0.0=collapsed)
[Epoch 2/100] [Batch 381/669 (57.0%)] [Iter 1050] Loss: 1.4919 (freq: 0.5018, raw: 0.9895, quant: 0.0005, domain: 0.0000) LR: 3.14e-06 
π“ Codebook: 408/1024 (39.8%) Top5:[724,660,677,502,1015,47,256,321,414,162,24,942,173,371,948]


π”¬ Encoder Diversity (iter 1050):
  Avg similarity: 0.4629 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7229 (0.0=collapsed)
[Epoch 2/100] [Batch 391/669 (58.4%)] [Iter 1060] Loss: 1.6618 (freq: 0.6673, raw: 0.9939, quant: 0.0005, domain: 0.0000) LR: 3.17e-06 
π“ Codebook: 358/1024 (35.0%) Top5:[724,660,677,502,47,256,1015,414,33,942,366,321,24,162,948]


π”¬ Encoder Diversity (iter 1060):
  Avg similarity: 0.4845 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7096 (0.0=collapsed)
[Epoch 2/100] [Batch 401/669 (59.9%)] [Iter 1070] Loss: 1.7665 (freq: 0.7664, raw: 0.9996, quant: 0.0005, domain: 0.0000) LR: 3.20e-06 
π“ Codebook: 395/1024 (38.6%) Top5:[724,660,677,256,47,502,942,1015,414,321,948,33,24,366,148]


π”¬ Encoder Diversity (iter 1070):
  Avg similarity: 0.4828 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7230 (0.0=collapsed)
[Epoch 2/100] [Batch 411/669 (61.4%)] [Iter 1080] Loss: 1.7869 (freq: 0.7872, raw: 0.9992, quant: 0.0005, domain: 0.0000) LR: 3.23e-06 
π“ Codebook: 341/1024 (33.3%) Top5:[724,660,677,256,47,321,942,502,1015,414,24,33,366,948,148]


π”¬ Encoder Diversity (iter 1080):
  Avg similarity: 0.4593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7282 (0.0=collapsed)
[Epoch 2/100] [Batch 421/669 (62.9%)] [Iter 1090] Loss: 1.6103 (freq: 0.6171, raw: 0.9928, quant: 0.0005, domain: 0.0000) LR: 3.26e-06 
π“ Codebook: 314/1024 (30.7%) Top5:[724,660,256,677,1015,502,321,942,33,24,366,47,414,913,148]


π”¬ Encoder Diversity (iter 1090):
  Avg similarity: 0.4601 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7451 (0.0=collapsed)
[Epoch 2/100] [Batch 431/669 (64.4%)] [Iter 1100] Loss: 1.7640 (freq: 0.7639, raw: 0.9996, quant: 0.0005, domain: 0.0000) LR: 3.29e-06 
π“ Codebook: 287/1024 (28.0%) Top5:[724,660,256,677,502,1015,321,366,33,942,913,148,24,173,47]


π”¬ Encoder Diversity (iter 1100):
  Avg similarity: 0.4585 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7353 (0.0=collapsed)
[Epoch 2/100] [Batch 441/669 (65.9%)] [Iter 1110] Loss: 1.6846 (freq: 0.6905, raw: 0.9935, quant: 0.0005, domain: 0.0000) LR: 3.32e-06 
π“ Codebook: 299/1024 (29.2%) Top5:[724,660,502,1015,256,321,942,677,33,24,414,366,913,47,162]


π”¬ Encoder Diversity (iter 1110):
  Avg similarity: 0.3987 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7610 (0.0=collapsed)
[Epoch 2/100] [Batch 451/669 (67.4%)] [Iter 1120] Loss: 1.7070 (freq: 0.7120, raw: 0.9946, quant: 0.0005, domain: 0.0000) LR: 3.35e-06 
π“ Codebook: 259/1024 (25.3%) Top5:[724,660,502,1015,677,942,321,256,33,414,173,366,47,913,162]


π”¬ Encoder Diversity (iter 1120):
  Avg similarity: 0.4200 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7494 (0.0=collapsed)
[Epoch 2/100] [Batch 461/669 (68.9%)] [Iter 1130] Loss: 1.7818 (freq: 0.7847, raw: 0.9965, quant: 0.0005, domain: 0.0000) LR: 3.38e-06 
π“ Codebook: 395/1024 (38.6%) Top5:[724,660,502,942,1015,677,321,414,47,162,256,24,173,366,371]


π”¬ Encoder Diversity (iter 1130):
  Avg similarity: 0.4434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7376 (0.0=collapsed)
[Epoch 2/100] [Batch 471/669 (70.4%)] [Iter 1140] Loss: 1.6213 (freq: 0.6278, raw: 0.9931, quant: 0.0005, domain: 0.0000) LR: 3.41e-06 
π“ Codebook: 297/1024 (29.0%) Top5:[724,660,502,677,942,1015,321,366,33,414,913,47,256,162,148]


π”¬ Encoder Diversity (iter 1140):
  Avg similarity: 0.4509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7363 (0.0=collapsed)
[Epoch 2/100] [Batch 481/669 (71.9%)] [Iter 1150] Loss: 1.7595 (freq: 0.7606, raw: 0.9984, quant: 0.0005, domain: 0.0000) LR: 3.44e-06 
π“ Codebook: 269/1024 (26.3%) Top5:[724,660,502,1015,942,321,677,414,256,366,33,913,47,948,162]


π”¬ Encoder Diversity (iter 1150):
  Avg similarity: 0.4183 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7525 (0.0=collapsed)
[Epoch 2/100] [Batch 491/669 (73.4%)] [Iter 1160] Loss: 1.6784 (freq: 0.6859, raw: 0.9920, quant: 0.0005, domain: 0.0000) LR: 3.47e-06 
π“ Codebook: 246/1024 (24.0%) Top5:[724,660,677,502,256,414,942,321,1015,47,24,162,913,366,173]


π”¬ Encoder Diversity (iter 1160):
  Avg similarity: 0.4099 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7612 (0.0=collapsed)
[Epoch 2/100] [Batch 501/669 (74.9%)] [Iter 1170] Loss: 1.6783 (freq: 0.6846, raw: 0.9932, quant: 0.0005, domain: 0.0000) LR: 3.50e-06 
π“ Codebook: 239/1024 (23.3%) Top5:[724,660,256,502,677,1015,942,321,414,24,913,47,173,948,162]


π”¬ Encoder Diversity (iter 1170):
  Avg similarity: 0.4458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7461 (0.0=collapsed)
[Epoch 2/100] [Batch 511/669 (76.4%)] [Iter 1180] Loss: 1.8389 (freq: 0.8385, raw: 0.9999, quant: 0.0005, domain: 0.0000) LR: 3.53e-06 
π“ Codebook: 275/1024 (26.9%) Top5:[724,660,677,256,502,414,1015,321,942,24,47,162,173,3,371]


π”¬ Encoder Diversity (iter 1180):
  Avg similarity: 0.3874 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7780 (0.0=collapsed)
[Epoch 2/100] [Batch 521/669 (77.9%)] [Iter 1190] Loss: 1.6931 (freq: 0.7015, raw: 0.9911, quant: 0.0005, domain: 0.0000) LR: 3.56e-06 
π“ Codebook: 244/1024 (23.8%) Top5:[724,660,677,256,1015,502,414,321,942,24,162,173,47,3,317]


π”¬ Encoder Diversity (iter 1190):
  Avg similarity: 0.3545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7935 (0.0=collapsed)
[Epoch 2/100] [Batch 531/669 (79.4%)] [Iter 1200] Loss: 1.3831 (freq: 0.4090, raw: 0.9736, quant: 0.0004, domain: 0.0000) LR: 3.58e-06 
π“ Codebook: 259/1024 (25.3%) Top5:[724,660,677,414,502,1015,942,321,366,913,256,33,148,948,47]


π”¬ Encoder Diversity (iter 1200):
  Avg similarity: 0.3640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7866 (0.0=collapsed)
[Epoch 2/100] [Batch 541/669 (80.9%)] [Iter 1210] Loss: 1.6822 (freq: 0.6903, raw: 0.9914, quant: 0.0005, domain: 0.0000) LR: 3.61e-06 
π“ Codebook: 270/1024 (26.4%) Top5:[724,660,414,942,1015,256,321,502,677,24,913,33,173,162,366]


π”¬ Encoder Diversity (iter 1210):
  Avg similarity: 0.4196 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7358 (0.0=collapsed)
[Epoch 2/100] [Batch 551/669 (82.4%)] [Iter 1220] Loss: 1.7991 (freq: 0.7984, raw: 1.0001, quant: 0.0006, domain: 0.0000) LR: 3.64e-06 
π“ Codebook: 275/1024 (26.9%) Top5:[724,660,414,677,321,942,502,1015,173,256,162,47,24,169,317]


π”¬ Encoder Diversity (iter 1220):
  Avg similarity: 0.3960 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7696 (0.0=collapsed)
[Epoch 2/100] [Batch 561/669 (83.9%)] [Iter 1230] Loss: 1.7953 (freq: 0.7989, raw: 0.9957, quant: 0.0007, domain: 0.0000) LR: 3.67e-06 
π“ Codebook: 281/1024 (27.4%) Top5:[724,660,414,942,502,1015,366,677,913,321,33,148,256,162,437]


π”¬ Encoder Diversity (iter 1230):
  Avg similarity: 0.3508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7887 (0.0=collapsed)
[Epoch 2/100] [Batch 571/669 (85.4%)] [Iter 1240] Loss: 1.6729 (freq: 0.6857, raw: 0.9867, quant: 0.0005, domain: 0.0000) LR: 3.70e-06 
π“ Codebook: 255/1024 (24.9%) Top5:[724,660,414,502,942,1015,677,321,173,371,3,317,169,162,256]


π”¬ Encoder Diversity (iter 1240):
  Avg similarity: 0.3631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7932 (0.0=collapsed)
[Epoch 2/100] [Batch 581/669 (86.8%)] [Iter 1250] Loss: 1.5795 (freq: 0.5980, raw: 0.9810, quant: 0.0005, domain: 0.0000) LR: 3.73e-06 
π“ Codebook: 266/1024 (26.0%) Top5:[724,660,414,502,942,677,1015,321,371,173,162,256,33,366,913]


π”¬ Encoder Diversity (iter 1250):
  Avg similarity: 0.3399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8018 (0.0=collapsed)
[Epoch 2/100] [Batch 591/669 (88.3%)] [Iter 1260] Loss: 1.7225 (freq: 0.7287, raw: 0.9933, quant: 0.0005, domain: 0.0000) LR: 3.76e-06 
π“ Codebook: 235/1024 (22.9%) Top5:[724,660,414,502,942,677,1015,321,913,33,256,366,162,24,173]


π”¬ Encoder Diversity (iter 1260):
  Avg similarity: 0.3494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7939 (0.0=collapsed)
[Epoch 2/100] [Batch 601/669 (89.8%)] [Iter 1270] Loss: 1.7481 (freq: 0.7565, raw: 0.9909, quant: 0.0006, domain: 0.0000) LR: 3.79e-06 
π“ Codebook: 235/1024 (22.9%) Top5:[724,660,414,502,942,1015,677,321,256,33,913,24,366,162,948]


π”¬ Encoder Diversity (iter 1270):
  Avg similarity: 0.3541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7942 (0.0=collapsed)
[Epoch 2/100] [Batch 611/669 (91.3%)] [Iter 1280] Loss: 1.8698 (freq: 0.8647, raw: 1.0046, quant: 0.0005, domain: 0.0000) LR: 3.82e-06 
π“ Codebook: 323/1024 (31.5%) Top5:[724,660,414,677,321,942,256,502,1015,24,366,33,162,148,913]


π”¬ Encoder Diversity (iter 1280):
  Avg similarity: 0.3282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8074 (0.0=collapsed)
[Epoch 2/100] [Batch 621/669 (92.8%)] [Iter 1290] Loss: 1.6588 (freq: 0.6734, raw: 0.9849, quant: 0.0005, domain: 0.0000) LR: 3.85e-06 
π“ Codebook: 280/1024 (27.3%) Top5:[724,660,414,256,677,321,942,502,1015,24,173,863,371,169,3]


π”¬ Encoder Diversity (iter 1290):
  Avg similarity: 0.3381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8033 (0.0=collapsed)
[Epoch 2/100] [Batch 631/669 (94.3%)] [Iter 1300] Loss: 1.6517 (freq: 0.6711, raw: 0.9801, quant: 0.0005, domain: 0.0000) LR: 3.88e-06 
π“ Codebook: 356/1024 (34.8%) Top5:[724,660,414,256,942,677,321,502,24,173,1015,863,169,913,371]


π”¬ Encoder Diversity (iter 1300):
  Avg similarity: 0.3157 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8124 (0.0=collapsed)
[Epoch 2/100] [Batch 641/669 (95.8%)] [Iter 1310] Loss: 1.5132 (freq: 0.5501, raw: 0.9627, quant: 0.0004, domain: 0.0000) LR: 3.91e-06 
π“ Codebook: 318/1024 (31.1%) Top5:[724,660,414,677,321,942,256,502,1015,24,173,913,33,148,366]


π”¬ Encoder Diversity (iter 1310):
  Avg similarity: 0.3301 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8065 (0.0=collapsed)
[Epoch 2/100] [Batch 651/669 (97.3%)] [Iter 1320] Loss: 1.5641 (freq: 0.5972, raw: 0.9665, quant: 0.0004, domain: 0.0000) LR: 3.94e-06 
π“ Codebook: 278/1024 (27.1%) Top5:[724,660,414,942,502,256,321,1015,677,24,913,33,173,169,371]


π”¬ Encoder Diversity (iter 1320):
  Avg similarity: 0.3291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8030 (0.0=collapsed)
[Epoch 2/100] [Batch 661/669 (98.8%)] [Iter 1330] Loss: 1.5291 (freq: 0.5634, raw: 0.9653, quant: 0.0004, domain: 0.0000) LR: 3.97e-06 
π“ Codebook: 287/1024 (28.0%) Top5:[724,414,660,677,942,321,913,502,366,1015,256,33,148,24,297]


π”¬ Encoder Diversity (iter 1330):
  Avg similarity: 0.3480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8164 (0.0=collapsed)

================================================================================
[Epoch 2] Validation Results:
  Total Loss: 1.2839
  Freq Loss:  0.3565
  Raw Loss:   0.9269
  Quant Loss: 0.0005
  π“ Codebook Usage: 76/1024 (7.4%)
  π“ Codebook Entropy: 3.4238 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 62950 (48.3%)
  Top 10 most used codes:
    1. Code 366: 7939 times (6.10%)
    2. Code 3: 7154 times (5.49%)
    3. Code 173: 6741 times (5.18%)
    4. Code 33: 6651 times (5.11%)
    5. Code 948: 6632 times (5.09%)
    6. Code 913: 6375 times (4.90%)
    7. Code 696: 5895 times (4.53%)
    8. Code 148: 5246 times (4.03%)
    9. Code 75: 5222 times (4.01%)
    10. Code 526: 5095 times (3.91%)
  Bottom 5 least used codes (among used):
    1. Code 473: 1 times (0.00%)
    2. Code 571: 1 times (0.00%)
    3. Code 517: 4 times (0.00%)
    4. Code 378: 6 times (0.00%)
    5. Code 28: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 2
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 3/100] [Batch 2/669 (0.3%)] [Iter 1340] Loss: 1.5206 (freq: 0.5567, raw: 0.9635, quant: 0.0004, domain: 0.0000) LR: 4.00e-06 
π“ Codebook: 573/1024 (56.0%) Top5:[724,414,660,677,942,502,321,913,256,1015,366,33,148,24,162]


π”¬ Encoder Diversity (iter 1340):
  Avg similarity: 0.2887 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8220 (0.0=collapsed)
[Epoch 3/100] [Batch 12/669 (1.8%)] [Iter 1350] Loss: 1.6109 (freq: 0.6411, raw: 0.9692, quant: 0.0005, domain: 0.0000) LR: 4.03e-06 
π“ Codebook: 993/1024 (97.0%) Top5:[724,414,660,677,321,942,502,256,1015,173,3,371,863,169,193]


π”¬ Encoder Diversity (iter 1350):
  Avg similarity: 0.2617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8373 (0.0=collapsed)
[Epoch 3/100] [Batch 22/669 (3.3%)] [Iter 1360] Loss: 1.5377 (freq: 0.5866, raw: 0.9506, quant: 0.0004, domain: 0.0000) LR: 4.06e-06 
π“ Codebook: 695/1024 (67.9%) Top5:[724,660,414,677,502,942,321,1015,3,256,371,846,173,193,913]


π”¬ Encoder Diversity (iter 1360):
  Avg similarity: 0.2885 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8259 (0.0=collapsed)
[Epoch 3/100] [Batch 32/669 (4.8%)] [Iter 1370] Loss: 1.5205 (freq: 0.5643, raw: 0.9557, quant: 0.0004, domain: 0.0000) LR: 4.09e-06 
π“ Codebook: 626/1024 (61.1%) Top5:[724,660,414,942,502,677,321,913,1015,33,366,256,148,297,948]


π”¬ Encoder Diversity (iter 1370):
  Avg similarity: 0.2879 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8271 (0.0=collapsed)
[Epoch 3/100] [Batch 42/669 (6.3%)] [Iter 1380] Loss: 1.8689 (freq: 0.8640, raw: 1.0044, quant: 0.0005, domain: 0.0000) LR: 4.12e-06 
π“ Codebook: 485/1024 (47.4%) Top5:[724,660,414,942,677,502,321,1015,256,689,846,913,33,694,366]


π”¬ Encoder Diversity (iter 1380):
  Avg similarity: 0.2882 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8272 (0.0=collapsed)
[Epoch 3/100] [Batch 52/669 (7.8%)] [Iter 1390] Loss: 1.5359 (freq: 0.5944, raw: 0.9410, quant: 0.0005, domain: 0.0000) LR: 4.15e-06 
π“ Codebook: 460/1024 (44.9%) Top5:[724,660,414,942,677,502,321,256,1015,689,913,846,148,33,366]


π”¬ Encoder Diversity (iter 1390):
  Avg similarity: 0.2834 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8261 (0.0=collapsed)
[Epoch 3/100] [Batch 62/669 (9.3%)] [Iter 1400] Loss: 1.7711 (freq: 0.7811, raw: 0.9895, quant: 0.0004, domain: 0.0000) LR: 4.18e-06 
π“ Codebook: 357/1024 (34.9%) Top5:[724,660,414,677,256,942,321,502,1015,689,173,371,863,913,169]


π”¬ Encoder Diversity (iter 1400):
  Avg similarity: 0.3305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8060 (0.0=collapsed)
[Epoch 3/100] [Batch 72/669 (10.8%)] [Iter 1410] Loss: 1.8771 (freq: 0.8889, raw: 0.9878, quant: 0.0004, domain: 0.0000) LR: 4.21e-06 
π“ Codebook: 408/1024 (39.8%) Top5:[724,660,414,942,256,677,1015,321,502,689,913,694,846,366,148]


π”¬ Encoder Diversity (iter 1410):
  Avg similarity: 0.2631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8333 (0.0=collapsed)
[Epoch 3/100] [Batch 82/669 (12.3%)] [Iter 1420] Loss: 1.4817 (freq: 0.5482, raw: 0.9331, quant: 0.0004, domain: 0.0000) LR: 4.24e-06 
π“ Codebook: 324/1024 (31.6%) Top5:[724,660,414,677,942,321,256,863,502,1015,193,169,689,371,163]


π”¬ Encoder Diversity (iter 1420):
  Avg similarity: 0.2597 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8392 (0.0=collapsed)
[Epoch 3/100] [Batch 92/669 (13.8%)] [Iter 1430] Loss: 1.6393 (freq: 0.6736, raw: 0.9653, quant: 0.0004, domain: 0.0000) LR: 4.27e-06 
π“ Codebook: 394/1024 (38.5%) Top5:[724,660,414,677,321,942,256,502,1015,689,694,913,846,33,148]


π”¬ Encoder Diversity (iter 1430):
  Avg similarity: 0.2705 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8436 (0.0=collapsed)
[Epoch 3/100] [Batch 102/669 (15.2%)] [Iter 1440] Loss: 1.6477 (freq: 0.6801, raw: 0.9672, quant: 0.0004, domain: 0.0000) LR: 4.30e-06 
π“ Codebook: 382/1024 (37.3%) Top5:[724,660,414,677,942,321,256,502,689,913,148,694,1015,33,366]


π”¬ Encoder Diversity (iter 1440):
  Avg similarity: 0.2708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8423 (0.0=collapsed)
[Epoch 3/100] [Batch 112/669 (16.7%)] [Iter 1450] Loss: 1.4478 (freq: 0.5315, raw: 0.9159, quant: 0.0004, domain: 0.0000) LR: 4.33e-06 
π“ Codebook: 319/1024 (31.2%) Top5:[724,660,414,677,942,321,256,502,689,863,173,913,1015,163,148]


π”¬ Encoder Diversity (iter 1450):
  Avg similarity: 0.2798 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8295 (0.0=collapsed)
[Epoch 3/100] [Batch 122/669 (18.2%)] [Iter 1460] Loss: 1.4671 (freq: 0.5472, raw: 0.9195, quant: 0.0004, domain: 0.0000) LR: 4.36e-06 
π“ Codebook: 270/1024 (26.4%) Top5:[724,660,414,256,677,942,502,321,1015,694,689,846,366,148,913]


π”¬ Encoder Diversity (iter 1460):
  Avg similarity: 0.3070 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8321 (0.0=collapsed)
[Epoch 3/100] [Batch 132/669 (19.7%)] [Iter 1470] Loss: 1.7201 (freq: 0.7600, raw: 0.9597, quant: 0.0004, domain: 0.0000) LR: 4.39e-06 
π“ Codebook: 259/1024 (25.3%) Top5:[724,660,414,502,942,677,256,321,1015,689,694,846,913,948,148]


π”¬ Encoder Diversity (iter 1470):
  Avg similarity: 0.2510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8495 (0.0=collapsed)
[Epoch 3/100] [Batch 142/669 (21.2%)] [Iter 1480] Loss: 1.7805 (freq: 0.7979, raw: 0.9821, quant: 0.0005, domain: 0.0000) LR: 4.42e-06 
π“ Codebook: 212/1024 (20.7%) Top5:[724,660,414,942,502,256,677,1015,321,689,846,694,366,148,913]


π”¬ Encoder Diversity (iter 1480):
  Avg similarity: 0.3147 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8229 (0.0=collapsed)
[Epoch 3/100] [Batch 152/669 (22.7%)] [Iter 1490] Loss: 1.4806 (freq: 0.5794, raw: 0.9008, quant: 0.0004, domain: 0.0000) LR: 4.45e-06 
π“ Codebook: 198/1024 (19.3%) Top5:[724,660,414,942,256,502,677,193,321,1015,371,163,689,863,694]


π”¬ Encoder Diversity (iter 1490):
  Avg similarity: 0.2763 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8401 (0.0=collapsed)
[Epoch 3/100] [Batch 162/669 (24.2%)] [Iter 1500] Loss: 1.4842 (freq: 0.5820, raw: 0.9018, quant: 0.0004, domain: 0.0000) LR: 4.48e-06 
π“ Codebook: 236/1024 (23.0%) Top5:[724,660,414,502,942,677,256,321,193,1015,846,689,163,371,863]


π”¬ Encoder Diversity (iter 1500):
  Avg similarity: 0.2776 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8444 (0.0=collapsed)
[Epoch 3/100] [Batch 172/669 (25.7%)] [Iter 1510] Loss: 1.6997 (freq: 0.7198, raw: 0.9794, quant: 0.0005, domain: 0.0000) LR: 4.51e-06 
π“ Codebook: 292/1024 (28.5%) Top5:[724,660,414,502,321,942,256,677,1015,689,846,694,193,948,913]


π”¬ Encoder Diversity (iter 1510):
  Avg similarity: 0.2764 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8436 (0.0=collapsed)
[Epoch 3/100] [Batch 182/669 (27.2%)] [Iter 1520] Loss: 1.8260 (freq: 0.8211, raw: 1.0045, quant: 0.0005, domain: 0.0000) LR: 4.54e-06 
π“ Codebook: 350/1024 (34.2%) Top5:[724,660,414,502,321,942,677,256,193,913,1015,689,371,366,948]


π”¬ Encoder Diversity (iter 1520):
  Avg similarity: 0.2725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8340 (0.0=collapsed)
[Epoch 3/100] [Batch 192/669 (28.7%)] [Iter 1530] Loss: 1.4538 (freq: 0.5639, raw: 0.8895, quant: 0.0004, domain: 0.0000) LR: 4.57e-06 
π“ Codebook: 346/1024 (33.8%) Top5:[724,660,414,677,321,256,502,942,913,366,33,193,948,297,148]


π”¬ Encoder Diversity (iter 1530):
  Avg similarity: 0.2290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8576 (0.0=collapsed)
[Epoch 3/100] [Batch 202/669 (30.2%)] [Iter 1540] Loss: 1.4460 (freq: 0.5628, raw: 0.8828, quant: 0.0004, domain: 0.0000) LR: 4.60e-06 
π“ Codebook: 310/1024 (30.3%) Top5:[724,660,414,677,390,502,942,256,321,913,33,366,948,297,694]


π”¬ Encoder Diversity (iter 1540):
  Avg similarity: 0.2941 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8339 (0.0=collapsed)
[Epoch 3/100] [Batch 212/669 (31.7%)] [Iter 1550] Loss: 1.4268 (freq: 0.5476, raw: 0.8788, quant: 0.0004, domain: 0.0000) LR: 4.63e-06 
π“ Codebook: 286/1024 (27.9%) Top5:[660,724,502,256,414,677,942,1015,321,193,792,390,846,689,913]


π”¬ Encoder Diversity (iter 1550):
  Avg similarity: 0.3026 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8267 (0.0=collapsed)
[Epoch 3/100] [Batch 222/669 (33.2%)] [Iter 1560] Loss: 1.3751 (freq: 0.5180, raw: 0.8568, quant: 0.0003, domain: 0.0000) LR: 4.66e-06 
π“ Codebook: 284/1024 (27.7%) Top5:[724,660,256,677,502,414,321,390,942,1015,694,689,846,750,273]


π”¬ Encoder Diversity (iter 1560):
  Avg similarity: 0.2794 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8326 (0.0=collapsed)
[Epoch 3/100] [Batch 232/669 (34.7%)] [Iter 1570] Loss: 1.6090 (freq: 0.6677, raw: 0.9410, quant: 0.0003, domain: 0.0000) LR: 4.69e-06 
π“ Codebook: 276/1024 (27.0%) Top5:[724,660,677,256,414,390,502,321,942,1015,913,694,366,689,33]


π”¬ Encoder Diversity (iter 1570):
  Avg similarity: 0.3198 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7997 (0.0=collapsed)
[Epoch 3/100] [Batch 242/669 (36.2%)] [Iter 1580] Loss: 1.3210 (freq: 0.4846, raw: 0.8361, quant: 0.0003, domain: 0.0000) LR: 4.72e-06 
π“ Codebook: 322/1024 (31.4%) Top5:[724,660,256,414,502,321,942,1015,846,694,750,689,677,273,792]


π”¬ Encoder Diversity (iter 1580):
  Avg similarity: 0.3450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8177 (0.0=collapsed)
[Epoch 3/100] [Batch 252/669 (37.7%)] [Iter 1590] Loss: 1.6100 (freq: 0.6818, raw: 0.9277, quant: 0.0005, domain: 0.0000) LR: 4.75e-06 
π“ Codebook: 361/1024 (35.3%) Top5:[724,660,414,256,677,321,942,689,390,502,694,750,1015,163,273]


π”¬ Encoder Diversity (iter 1590):
  Avg similarity: 0.2296 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8517 (0.0=collapsed)
[Epoch 3/100] [Batch 262/669 (39.2%)] [Iter 1600] Loss: 1.5199 (freq: 0.6277, raw: 0.8918, quant: 0.0004, domain: 0.0000) LR: 4.78e-06 
π“ Codebook: 315/1024 (30.8%) Top5:[724,660,414,256,321,390,942,677,163,502,792,750,545,1015,913]


π”¬ Encoder Diversity (iter 1600):
  Avg similarity: 0.2334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8639 (0.0=collapsed)
[Epoch 3/100] [Batch 272/669 (40.7%)] [Iter 1610] Loss: 1.2897 (freq: 0.4837, raw: 0.8055, quant: 0.0004, domain: 0.0000) LR: 4.81e-06 
π“ Codebook: 352/1024 (34.4%) Top5:[724,660,390,414,321,942,256,677,366,502,913,948,750,33,1015]


π”¬ Encoder Diversity (iter 1610):
  Avg similarity: 0.2234 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8741 (0.0=collapsed)
[Epoch 3/100] [Batch 282/669 (42.2%)] [Iter 1620] Loss: 1.6227 (freq: 0.6924, raw: 0.9297, quant: 0.0005, domain: 0.0000) LR: 4.84e-06 
π“ Codebook: 310/1024 (30.3%) Top5:[724,660,390,256,414,942,321,273,502,1015,677,750,163,846,689]


π”¬ Encoder Diversity (iter 1620):
  Avg similarity: 0.2619 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8404 (0.0=collapsed)
[Epoch 3/100] [Batch 292/669 (43.6%)] [Iter 1630] Loss: 1.4435 (freq: 0.5575, raw: 0.8857, quant: 0.0004, domain: 0.0000) LR: 4.87e-06 
π“ Codebook: 251/1024 (24.5%) Top5:[724,660,414,390,942,677,256,508,75,321,913,163,948,608,366]


π”¬ Encoder Diversity (iter 1630):
  Avg similarity: 0.3072 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8311 (0.0=collapsed)
[Epoch 3/100] [Batch 302/669 (45.1%)] [Iter 1640] Loss: 1.8257 (freq: 0.8204, raw: 1.0048, quant: 0.0004, domain: 0.0000) LR: 4.90e-06 
π“ Codebook: 270/1024 (26.4%) Top5:[724,660,256,390,942,414,1015,321,502,677,750,273,508,846,689]


π”¬ Encoder Diversity (iter 1640):
  Avg similarity: 0.2905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8169 (0.0=collapsed)
[Epoch 3/100] [Batch 312/669 (46.6%)] [Iter 1650] Loss: 1.6518 (freq: 0.7361, raw: 0.9153, quant: 0.0004, domain: 0.0000) LR: 4.93e-06 
π“ Codebook: 221/1024 (21.6%) Top5:[724,660,502,256,414,677,462,1015,390,942,321,169,163,750,193]


π”¬ Encoder Diversity (iter 1650):
  Avg similarity: 0.3480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8002 (0.0=collapsed)
[Epoch 3/100] [Batch 322/669 (48.1%)] [Iter 1660] Loss: 1.2674 (freq: 0.4680, raw: 0.7991, quant: 0.0004, domain: 0.0000) LR: 4.96e-06 
π“ Codebook: 224/1024 (21.9%) Top5:[724,660,502,462,677,1015,846,256,321,414,942,694,750,689,366]


π”¬ Encoder Diversity (iter 1660):
  Avg similarity: 0.2586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8478 (0.0=collapsed)
[Epoch 3/100] [Batch 332/669 (49.6%)] [Iter 1670] Loss: 1.5754 (freq: 0.6546, raw: 0.9205, quant: 0.0003, domain: 0.0000) LR: 4.99e-06 
π“ Codebook: 200/1024 (19.5%) Top5:[724,502,660,677,508,297,366,462,414,321,148,846,390,694,863]


π”¬ Encoder Diversity (iter 1670):
  Avg similarity: 0.2810 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8381 (0.0=collapsed)
[Epoch 3/100] [Batch 342/669 (51.1%)] [Iter 1680] Loss: 1.6328 (freq: 0.7109, raw: 0.9216, quant: 0.0003, domain: 0.0000) LR: 5.02e-06 
π“ Codebook: 205/1024 (20.0%) Top5:[724,660,502,677,390,462,508,256,414,846,750,321,694,689,942]


π”¬ Encoder Diversity (iter 1680):
  Avg similarity: 0.2305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8583 (0.0=collapsed)
[Epoch 3/100] [Batch 352/669 (52.6%)] [Iter 1690] Loss: 1.4342 (freq: 0.5859, raw: 0.8480, quant: 0.0004, domain: 0.0000) LR: 5.05e-06 
π“ Codebook: 229/1024 (22.4%) Top5:[724,660,677,390,502,508,414,321,462,750,256,942,689,694,163]


π”¬ Encoder Diversity (iter 1690):
  Avg similarity: 0.2550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8481 (0.0=collapsed)
[Epoch 3/100] [Batch 362/669 (54.1%)] [Iter 1700] Loss: 1.6087 (freq: 0.6899, raw: 0.9184, quant: 0.0004, domain: 0.0000) LR: 5.08e-06 
π“ Codebook: 233/1024 (22.8%) Top5:[724,660,390,414,502,462,256,677,942,321,508,750,694,846,1015]


π”¬ Encoder Diversity (iter 1700):
  Avg similarity: 0.2101 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8681 (0.0=collapsed)
[Epoch 3/100] [Batch 372/669 (55.6%)] [Iter 1710] Loss: 1.6056 (freq: 0.6958, raw: 0.9093, quant: 0.0004, domain: 0.0000) LR: 5.11e-06 
π“ Codebook: 230/1024 (22.5%) Top5:[724,660,390,414,462,502,942,677,256,321,1015,750,243,273,689]


π”¬ Encoder Diversity (iter 1710):
  Avg similarity: 0.2625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8397 (0.0=collapsed)
[Epoch 3/100] [Batch 382/669 (57.1%)] [Iter 1720] Loss: 1.3402 (freq: 0.5085, raw: 0.8314, quant: 0.0003, domain: 0.0000) LR: 5.14e-06 
π“ Codebook: 247/1024 (24.1%) Top5:[724,660,390,256,942,462,414,502,321,1015,243,677,689,846,694]


π”¬ Encoder Diversity (iter 1720):
  Avg similarity: 0.2357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8687 (0.0=collapsed)
[Epoch 3/100] [Batch 392/669 (58.6%)] [Iter 1730] Loss: 1.3714 (freq: 0.5513, raw: 0.8198, quant: 0.0003, domain: 0.0000) LR: 5.17e-06 
π“ Codebook: 214/1024 (20.9%) Top5:[724,660,942,390,256,462,414,502,1015,243,321,677,846,689,948]


π”¬ Encoder Diversity (iter 1730):
  Avg similarity: 0.2949 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8339 (0.0=collapsed)
[Epoch 3/100] [Batch 402/669 (60.1%)] [Iter 1740] Loss: 1.3811 (freq: 0.5705, raw: 0.8103, quant: 0.0003, domain: 0.0000) LR: 5.20e-06 
π“ Codebook: 195/1024 (19.0%) Top5:[724,660,462,256,390,502,942,414,913,75,297,366,321,948,1015]


π”¬ Encoder Diversity (iter 1740):
  Avg similarity: 0.2116 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8787 (0.0=collapsed)
[Epoch 3/100] [Batch 412/669 (61.6%)] [Iter 1750] Loss: 1.4590 (freq: 0.5955, raw: 0.8631, quant: 0.0004, domain: 0.0000) LR: 5.23e-06 
π“ Codebook: 186/1024 (18.2%) Top5:[724,660,502,390,677,846,256,414,462,321,942,273,750,243,508]


π”¬ Encoder Diversity (iter 1750):
  Avg similarity: 0.1827 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8900 (0.0=collapsed)
[Epoch 3/100] [Batch 422/669 (63.1%)] [Iter 1760] Loss: 1.4750 (freq: 0.6089, raw: 0.8657, quant: 0.0004, domain: 0.0000) LR: 5.26e-06 
π“ Codebook: 173/1024 (16.9%) Top5:[724,677,390,660,508,414,75,502,942,321,366,750,273,913,778]


π”¬ Encoder Diversity (iter 1760):
  Avg similarity: 0.2214 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8722 (0.0=collapsed)
[Epoch 3/100] [Batch 432/669 (64.6%)] [Iter 1770] Loss: 1.6999 (freq: 0.7453, raw: 0.9542, quant: 0.0004, domain: 0.0000) LR: 5.29e-06 
π“ Codebook: 191/1024 (18.7%) Top5:[724,660,502,677,508,390,273,321,256,846,414,462,942,750,243]


π”¬ Encoder Diversity (iter 1770):
  Avg similarity: 0.2072 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8683 (0.0=collapsed)
[Epoch 3/100] [Batch 442/669 (66.1%)] [Iter 1780] Loss: 1.7197 (freq: 0.7650, raw: 0.9542, quant: 0.0004, domain: 0.0000) LR: 5.32e-06 
π“ Codebook: 200/1024 (19.5%) Top5:[724,660,502,462,390,677,256,273,846,508,321,243,942,414,750]


π”¬ Encoder Diversity (iter 1780):
  Avg similarity: 0.2811 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8276 (0.0=collapsed)
[Epoch 3/100] [Batch 452/669 (67.6%)] [Iter 1790] Loss: 1.5716 (freq: 0.6681, raw: 0.9031, quant: 0.0004, domain: 0.0000) LR: 5.35e-06 
π“ Codebook: 170/1024 (16.6%) Top5:[724,660,462,390,677,502,321,508,297,694,256,913,846,366,863]


π”¬ Encoder Diversity (iter 1790):
  Avg similarity: 0.3584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7668 (0.0=collapsed)
[Epoch 3/100] [Batch 462/669 (69.1%)] [Iter 1800] Loss: 1.4645 (freq: 0.6002, raw: 0.8639, quant: 0.0004, domain: 0.0000) LR: 5.38e-06 
π“ Codebook: 202/1024 (19.7%) Top5:[724,660,390,462,677,321,502,508,256,846,942,414,297,75,273]


π”¬ Encoder Diversity (iter 1800):
  Avg similarity: 0.2351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8518 (0.0=collapsed)
[Epoch 3/100] [Batch 472/669 (70.6%)] [Iter 1810] Loss: 1.5326 (freq: 0.6700, raw: 0.8622, quant: 0.0004, domain: 0.0000) LR: 5.41e-06 
π“ Codebook: 174/1024 (17.0%) Top5:[724,660,677,390,462,502,321,694,792,256,163,508,414,608,942]


π”¬ Encoder Diversity (iter 1810):
  Avg similarity: 0.2748 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8485 (0.0=collapsed)
[Epoch 3/100] [Batch 482/669 (72.0%)] [Iter 1820] Loss: 1.2937 (freq: 0.4955, raw: 0.7977, quant: 0.0005, domain: 0.0000) LR: 5.44e-06 
π“ Codebook: 176/1024 (17.2%) Top5:[724,660,462,502,366,863,297,75,677,913,846,148,390,948,33]


π”¬ Encoder Diversity (iter 1820):
  Avg similarity: 0.2125 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8602 (0.0=collapsed)
[Epoch 3/100] [Batch 492/669 (73.5%)] [Iter 1830] Loss: 1.6919 (freq: 0.7447, raw: 0.9468, quant: 0.0004, domain: 0.0000) LR: 5.47e-06 
π“ Codebook: 173/1024 (16.9%) Top5:[724,660,462,502,321,677,846,390,273,414,256,942,750,694,689]


π”¬ Encoder Diversity (iter 1830):
  Avg similarity: 0.3598 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7858 (0.0=collapsed)
[Epoch 3/100] [Batch 502/669 (75.0%)] [Iter 1840] Loss: 1.3857 (freq: 0.5868, raw: 0.7986, quant: 0.0003, domain: 0.0000) LR: 5.50e-06 
π“ Codebook: 199/1024 (19.4%) Top5:[724,660,321,462,846,414,502,750,273,677,942,256,508,1015,390]


π”¬ Encoder Diversity (iter 1840):
  Avg similarity: 0.2358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8549 (0.0=collapsed)
[Epoch 3/100] [Batch 512/669 (76.5%)] [Iter 1850] Loss: 1.5993 (freq: 0.6906, raw: 0.9084, quant: 0.0004, domain: 0.0000) LR: 5.53e-06 
π“ Codebook: 191/1024 (18.7%) Top5:[724,414,321,390,508,677,750,660,942,846,502,273,1015,256,462]


π”¬ Encoder Diversity (iter 1850):
  Avg similarity: 0.3245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8113 (0.0=collapsed)
[Epoch 3/100] [Batch 522/669 (78.0%)] [Iter 1860] Loss: 1.4542 (freq: 0.5975, raw: 0.8563, quant: 0.0004, domain: 0.0000) LR: 5.56e-06 
π“ Codebook: 205/1024 (20.0%) Top5:[724,414,321,750,846,256,390,942,1015,462,660,508,689,677,273]


π”¬ Encoder Diversity (iter 1860):
  Avg similarity: 0.2155 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8671 (0.0=collapsed)
[Epoch 3/100] [Batch 532/669 (79.5%)] [Iter 1870] Loss: 1.5548 (freq: 0.6538, raw: 0.9005, quant: 0.0005, domain: 0.0000) LR: 5.59e-06 
π“ Codebook: 190/1024 (18.6%) Top5:[724,660,414,390,75,863,148,462,297,677,366,913,437,1015,750]


π”¬ Encoder Diversity (iter 1870):
  Avg similarity: 0.2071 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8756 (0.0=collapsed)
[Epoch 3/100] [Batch 542/669 (81.0%)] [Iter 1880] Loss: 1.5218 (freq: 0.6150, raw: 0.9065, quant: 0.0004, domain: 0.0000) LR: 5.62e-06 
π“ Codebook: 179/1024 (17.5%) Top5:[724,660,390,462,414,273,256,163,508,321,526,317,677,792,502]


π”¬ Encoder Diversity (iter 1880):
  Avg similarity: 0.2064 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8777 (0.0=collapsed)
[Epoch 3/100] [Batch 552/669 (82.5%)] [Iter 1890] Loss: 1.7115 (freq: 0.7621, raw: 0.9489, quant: 0.0004, domain: 0.0000) LR: 5.65e-06 
π“ Codebook: 191/1024 (18.7%) Top5:[724,660,462,390,273,677,502,414,508,256,321,846,750,694,1015]


π”¬ Encoder Diversity (iter 1890):
  Avg similarity: 0.2591 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8428 (0.0=collapsed)
[Epoch 3/100] [Batch 562/669 (84.0%)] [Iter 1900] Loss: 1.4590 (freq: 0.6189, raw: 0.8397, quant: 0.0004, domain: 0.0000) LR: 5.68e-06 
π“ Codebook: 192/1024 (18.8%) Top5:[724,660,390,462,508,273,677,502,321,414,792,317,193,163,173]


π”¬ Encoder Diversity (iter 1900):
  Avg similarity: 0.3512 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8002 (0.0=collapsed)
[Epoch 3/100] [Batch 572/669 (85.5%)] [Iter 1910] Loss: 1.1724 (freq: 0.4418, raw: 0.7302, quant: 0.0003, domain: 0.0000) LR: 5.71e-06 
π“ Codebook: 187/1024 (18.3%) Top5:[724,660,390,273,508,502,462,414,677,321,846,694,256,750,75]


π”¬ Encoder Diversity (iter 1910):
  Avg similarity: 0.2072 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8709 (0.0=collapsed)
[Epoch 3/100] [Batch 582/669 (87.0%)] [Iter 1920] Loss: 1.0327 (freq: 0.3539, raw: 0.6785, quant: 0.0003, domain: 0.0000) LR: 5.74e-06 
π“ Codebook: 197/1024 (19.2%) Top5:[724,163,660,390,173,169,508,100,193,371,677,462,792,526,3]


π”¬ Encoder Diversity (iter 1920):
  Avg similarity: 0.3608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7903 (0.0=collapsed)
[Epoch 3/100] [Batch 592/669 (88.5%)] [Iter 1930] Loss: 1.5377 (freq: 0.6417, raw: 0.8955, quant: 0.0005, domain: 0.0000) LR: 5.77e-06 
π“ Codebook: 184/1024 (18.0%) Top5:[724,660,462,390,502,508,273,846,694,677,256,414,321,1015,366]


π”¬ Encoder Diversity (iter 1930):
  Avg similarity: 0.2859 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8408 (0.0=collapsed)
[Epoch 3/100] [Batch 602/669 (90.0%)] [Iter 1940] Loss: 1.4676 (freq: 0.6292, raw: 0.8380, quant: 0.0004, domain: 0.0000) LR: 5.80e-06 
π“ Codebook: 172/1024 (16.8%) Top5:[724,660,462,508,390,502,273,414,297,677,366,863,846,913,948]


π”¬ Encoder Diversity (iter 1940):
  Avg similarity: 0.1918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8862 (0.0=collapsed)
[Epoch 3/100] [Batch 612/669 (91.5%)] [Iter 1950] Loss: 1.3950 (freq: 0.5544, raw: 0.8402, quant: 0.0004, domain: 0.0000) LR: 5.83e-06 
π“ Codebook: 189/1024 (18.5%) Top5:[724,390,660,508,273,502,462,414,677,321,256,750,846,366,163]


π”¬ Encoder Diversity (iter 1950):
  Avg similarity: 0.2048 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8749 (0.0=collapsed)
[Epoch 3/100] [Batch 622/669 (93.0%)] [Iter 1960] Loss: 1.5514 (freq: 0.6543, raw: 0.8966, quant: 0.0005, domain: 0.0000) LR: 5.86e-06 
π“ Codebook: 210/1024 (20.5%) Top5:[724,508,660,390,273,414,677,502,462,321,750,846,75,948,256]


π”¬ Encoder Diversity (iter 1960):
  Avg similarity: 0.1922 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8771 (0.0=collapsed)
[Epoch 3/100] [Batch 632/669 (94.5%)] [Iter 1970] Loss: 1.5093 (freq: 0.6148, raw: 0.8941, quant: 0.0004, domain: 0.0000) LR: 5.89e-06 
π“ Codebook: 194/1024 (18.9%) Top5:[724,508,273,390,502,846,660,462,256,677,414,750,1015,243,321]


π”¬ Encoder Diversity (iter 1970):
  Avg similarity: 0.1992 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8797 (0.0=collapsed)
[Epoch 3/100] [Batch 642/669 (96.0%)] [Iter 1980] Loss: 1.6564 (freq: 0.7109, raw: 0.9451, quant: 0.0005, domain: 0.0000) LR: 5.92e-06 
π“ Codebook: 222/1024 (21.7%) Top5:[724,414,660,508,462,846,390,321,273,1015,750,256,694,545,502]


π”¬ Encoder Diversity (iter 1980):
  Avg similarity: 0.1787 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8845 (0.0=collapsed)
[Epoch 3/100] [Batch 652/669 (97.5%)] [Iter 1990] Loss: 1.4045 (freq: 0.5754, raw: 0.8287, quant: 0.0004, domain: 0.0000) LR: 5.95e-06 
π“ Codebook: 249/1024 (24.3%) Top5:[724,390,846,677,321,414,462,545,502,508,694,660,1015,913,273]


π”¬ Encoder Diversity (iter 1990):
  Avg similarity: 0.1624 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8880 (0.0=collapsed)
[Epoch 3/100] [Batch 662/669 (99.0%)] [Iter 2000] Loss: 1.4205 (freq: 0.5924, raw: 0.8277, quant: 0.0004, domain: 0.0000) LR: 5.98e-06 
π“ Codebook: 323/1024 (31.5%) Top5:[724,390,677,462,660,414,321,694,508,689,1015,502,545,273,778]


π”¬ Encoder Diversity (iter 2000):
  Avg similarity: 0.2657 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8434 (0.0=collapsed)

================================================================================
[Epoch 3] Validation Results:
  Total Loss: 0.8807
  Freq Loss:  0.2868
  Raw Loss:   0.5936
  Quant Loss: 0.0003
  π“ Codebook Usage: 47/1024 (4.6%)
  π“ Codebook Entropy: 3.2142 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 66183 (50.8%)
  Top 10 most used codes:
    1. Code 366: 7578 times (5.82%)
    2. Code 863: 7237 times (5.56%)
    3. Code 75: 6931 times (5.32%)
    4. Code 297: 6895 times (5.30%)
    5. Code 163: 6689 times (5.14%)
    6. Code 100: 6618 times (5.08%)
    7. Code 608: 6321 times (4.85%)
    8. Code 913: 6160 times (4.73%)
    9. Code 173: 5919 times (4.55%)
    10. Code 317: 5835 times (4.48%)
  Bottom 5 least used codes (among used):
    1. Code 491: 1 times (0.00%)
    2. Code 279: 1 times (0.00%)
    3. Code 778: 7 times (0.01%)
    4. Code 851: 14 times (0.01%)
    5. Code 994: 63 times (0.05%)
================================================================================

[EarlyStopping] Best model saved at epoch 3
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 4/100] [Batch 3/669 (0.4%)] [Iter 2010] Loss: 1.4876 (freq: 0.6483, raw: 0.8388, quant: 0.0004, domain: 0.0000) LR: 6.01e-06 
π“ Codebook: 777/1024 (75.9%) Top5:[724,660,462,390,502,414,321,689,1015,677,694,273,545,508,846]


π”¬ Encoder Diversity (iter 2010):
  Avg similarity: 0.2298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8700 (0.0=collapsed)
[Epoch 4/100] [Batch 13/669 (1.9%)] [Iter 2020] Loss: 1.1582 (freq: 0.4413, raw: 0.7165, quant: 0.0003, domain: 0.0000) LR: 6.04e-06 
π“ Codebook: 841/1024 (82.1%) Top5:[724,660,390,462,321,366,163,792,913,502,863,414,173,169,297]


π”¬ Encoder Diversity (iter 2020):
  Avg similarity: 0.1945 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8786 (0.0=collapsed)
[Epoch 4/100] [Batch 23/669 (3.4%)] [Iter 2030] Loss: 1.2494 (freq: 0.4727, raw: 0.7764, quant: 0.0003, domain: 0.0000) LR: 6.07e-06 
π“ Codebook: 672/1024 (65.6%) Top5:[724,660,390,462,379,148,75,502,414,366,863,321,689,576,297]


π”¬ Encoder Diversity (iter 2030):
  Avg similarity: 0.1909 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8919 (0.0=collapsed)
[Epoch 4/100] [Batch 33/669 (4.9%)] [Iter 2040] Loss: 1.4955 (freq: 0.6066, raw: 0.8885, quant: 0.0004, domain: 0.0000) LR: 6.10e-06 
π“ Codebook: 513/1024 (50.1%) Top5:[724,390,660,893,379,462,707,414,75,148,297,366,863,948,33]


π”¬ Encoder Diversity (iter 2040):
  Avg similarity: 0.2089 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8756 (0.0=collapsed)
[Epoch 4/100] [Batch 43/669 (6.4%)] [Iter 2050] Loss: 1.6021 (freq: 0.7136, raw: 0.8881, quant: 0.0004, domain: 0.0000) LR: 6.13e-06 
π“ Codebook: 491/1024 (47.9%) Top5:[724,660,390,462,379,502,211,414,707,972,893,296,278,280,576]


π”¬ Encoder Diversity (iter 2050):
  Avg similarity: 0.2205 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8743 (0.0=collapsed)
[Epoch 4/100] [Batch 53/669 (7.9%)] [Iter 2060] Loss: 1.4170 (freq: 0.5829, raw: 0.8336, quant: 0.0005, domain: 0.0000) LR: 6.16e-06 
π“ Codebook: 391/1024 (38.2%) Top5:[724,390,660,707,462,379,502,893,321,414,689,278,644,920,972]


π”¬ Encoder Diversity (iter 2060):
  Avg similarity: 0.3165 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8232 (0.0=collapsed)
[Epoch 4/100] [Batch 63/669 (9.4%)] [Iter 2070] Loss: 1.4505 (freq: 0.5634, raw: 0.8867, quant: 0.0004, domain: 0.0000) LR: 6.19e-06 
π“ Codebook: 306/1024 (29.9%) Top5:[724,660,707,390,502,462,379,321,644,962,414,163,278,972,893]


π”¬ Encoder Diversity (iter 2070):
  Avg similarity: 0.2356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8641 (0.0=collapsed)
[Epoch 4/100] [Batch 73/669 (10.9%)] [Iter 2080] Loss: 1.3029 (freq: 0.5273, raw: 0.7752, quant: 0.0004, domain: 0.0000) LR: 6.22e-06 
π“ Codebook: 245/1024 (23.9%) Top5:[724,660,390,707,502,462,321,893,379,278,414,366,913,689,962]


π”¬ Encoder Diversity (iter 2080):
  Avg similarity: 0.1829 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8862 (0.0=collapsed)
[Epoch 4/100] [Batch 83/669 (12.4%)] [Iter 2090] Loss: 1.3959 (freq: 0.5850, raw: 0.8104, quant: 0.0004, domain: 0.0000) LR: 6.25e-06 
π“ Codebook: 289/1024 (28.2%) Top5:[724,660,390,462,502,707,379,321,278,366,962,414,972,296,893]


π”¬ Encoder Diversity (iter 2090):
  Avg similarity: 0.2202 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8745 (0.0=collapsed)
[Epoch 4/100] [Batch 93/669 (13.9%)] [Iter 2100] Loss: 1.4265 (freq: 0.5989, raw: 0.8272, quant: 0.0004, domain: 0.0000) LR: 6.28e-06 
π“ Codebook: 330/1024 (32.2%) Top5:[724,390,660,502,379,462,414,972,321,296,278,803,707,893,689]


π”¬ Encoder Diversity (iter 2100):
  Avg similarity: 0.2533 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8601 (0.0=collapsed)
[Epoch 4/100] [Batch 103/669 (15.4%)] [Iter 2110] Loss: 0.9887 (freq: 0.3568, raw: 0.6316, quant: 0.0003, domain: 0.0000) LR: 6.31e-06 
π“ Codebook: 281/1024 (27.4%) Top5:[724,390,414,893,379,321,803,707,660,296,628,211,193,689,792]


π”¬ Encoder Diversity (iter 2110):
  Avg similarity: 0.2067 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8797 (0.0=collapsed)
[Epoch 4/100] [Batch 113/669 (16.9%)] [Iter 2120] Loss: 1.4102 (freq: 0.5982, raw: 0.8115, quant: 0.0005, domain: 0.0000) LR: 6.34e-06 
π“ Codebook: 275/1024 (26.9%) Top5:[724,390,414,75,33,297,948,148,893,913,863,437,462,321,660]


π”¬ Encoder Diversity (iter 2120):
  Avg similarity: 0.1506 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8927 (0.0=collapsed)
[Epoch 4/100] [Batch 123/669 (18.4%)] [Iter 2130] Loss: 1.6663 (freq: 0.7256, raw: 0.9401, quant: 0.0006, domain: 0.0000) LR: 6.37e-06 
π“ Codebook: 290/1024 (28.3%) Top5:[724,390,414,707,660,893,321,462,211,379,689,644,502,576,972]


π”¬ Encoder Diversity (iter 2130):
  Avg similarity: 0.1970 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8885 (0.0=collapsed)
[Epoch 4/100] [Batch 133/669 (19.9%)] [Iter 2140] Loss: 1.4582 (freq: 0.6182, raw: 0.8395, quant: 0.0005, domain: 0.0000) LR: 6.40e-06 
π“ Codebook: 255/1024 (24.9%) Top5:[724,390,707,893,414,462,660,644,321,169,877,211,379,502,972]


π”¬ Encoder Diversity (iter 2140):
  Avg similarity: 0.1687 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9013 (0.0=collapsed)
[Epoch 4/100] [Batch 143/669 (21.4%)] [Iter 2150] Loss: 1.4616 (freq: 0.5928, raw: 0.8681, quant: 0.0007, domain: 0.0000) LR: 6.43e-06 
π“ Codebook: 247/1024 (24.1%) Top5:[724,390,462,660,707,379,366,75,297,502,863,148,948,972,437]


π”¬ Encoder Diversity (iter 2150):
  Avg similarity: 0.2108 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8789 (0.0=collapsed)
[Epoch 4/100] [Batch 153/669 (22.9%)] [Iter 2160] Loss: 1.2559 (freq: 0.4958, raw: 0.7598, quant: 0.0003, domain: 0.0000) LR: 6.46e-06 
π“ Codebook: 235/1024 (22.9%) Top5:[724,390,707,462,893,660,644,502,379,972,211,414,321,877,948]


π”¬ Encoder Diversity (iter 2160):
  Avg similarity: 0.1784 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8922 (0.0=collapsed)
[Epoch 4/100] [Batch 163/669 (24.4%)] [Iter 2170] Loss: 1.3735 (freq: 0.5545, raw: 0.8186, quant: 0.0004, domain: 0.0000) LR: 6.49e-06 
π“ Codebook: 273/1024 (26.7%) Top5:[724,390,893,462,379,660,707,502,972,296,211,644,169,278,173]


π”¬ Encoder Diversity (iter 2170):
  Avg similarity: 0.1757 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8906 (0.0=collapsed)
[Epoch 4/100] [Batch 173/669 (25.9%)] [Iter 2180] Loss: 1.3639 (freq: 0.5495, raw: 0.8141, quant: 0.0004, domain: 0.0000) LR: 6.52e-06 
π“ Codebook: 195/1024 (19.0%) Top5:[724,390,707,893,660,462,379,502,321,972,169,526,296,193,644]


π”¬ Encoder Diversity (iter 2180):
  Avg similarity: 0.1655 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8981 (0.0=collapsed)
[Epoch 4/100] [Batch 183/669 (27.4%)] [Iter 2190] Loss: 1.2515 (freq: 0.4772, raw: 0.7740, quant: 0.0004, domain: 0.0000) LR: 6.55e-06 
π“ Codebook: 230/1024 (22.5%) Top5:[724,660,390,462,379,707,893,366,502,972,863,211,321,913,75]


π”¬ Encoder Diversity (iter 2190):
  Avg similarity: 0.1454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9110 (0.0=collapsed)
[Epoch 4/100] [Batch 193/669 (28.8%)] [Iter 2200] Loss: 1.5512 (freq: 0.6788, raw: 0.8717, quant: 0.0007, domain: 0.0000) LR: 6.57e-06 
π“ Codebook: 254/1024 (24.8%) Top5:[724,390,893,321,707,660,414,644,948,379,877,689,297,366,296]


π”¬ Encoder Diversity (iter 2200):
  Avg similarity: 0.1587 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9079 (0.0=collapsed)
[Epoch 4/100] [Batch 203/669 (30.3%)] [Iter 2210] Loss: 1.4094 (freq: 0.5831, raw: 0.8257, quant: 0.0006, domain: 0.0000) LR: 6.60e-06 
π“ Codebook: 220/1024 (21.5%) Top5:[724,321,390,893,707,414,462,660,644,379,972,169,803,163,576]


π”¬ Encoder Diversity (iter 2210):
  Avg similarity: 0.1653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9076 (0.0=collapsed)
[Epoch 4/100] [Batch 213/669 (31.8%)] [Iter 2220] Loss: 0.9837 (freq: 0.3572, raw: 0.6261, quant: 0.0003, domain: 0.0000) LR: 6.63e-06 
π“ Codebook: 208/1024 (20.3%) Top5:[724,390,321,893,707,366,297,863,75,33,148,913,644,437,414]


π”¬ Encoder Diversity (iter 2220):
  Avg similarity: 0.1783 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8998 (0.0=collapsed)
[Epoch 4/100] [Batch 223/669 (33.3%)] [Iter 2230] Loss: 1.3777 (freq: 0.5715, raw: 0.8058, quant: 0.0005, domain: 0.0000) LR: 6.66e-06 
π“ Codebook: 220/1024 (21.5%) Top5:[724,390,893,321,462,211,972,379,660,502,414,707,576,644,296]


π”¬ Encoder Diversity (iter 2230):
  Avg similarity: 0.1966 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8822 (0.0=collapsed)
[Epoch 4/100] [Batch 233/669 (34.8%)] [Iter 2240] Loss: 1.6406 (freq: 0.7041, raw: 0.9360, quant: 0.0006, domain: 0.0000) LR: 6.69e-06 
π“ Codebook: 159/1024 (15.5%) Top5:[724,390,462,893,644,321,379,972,707,33,296,211,193,163,913]


π”¬ Encoder Diversity (iter 2240):
  Avg similarity: 0.1819 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8864 (0.0=collapsed)
[Epoch 4/100] [Batch 243/669 (36.3%)] [Iter 2250] Loss: 1.5953 (freq: 0.6745, raw: 0.9203, quant: 0.0005, domain: 0.0000) LR: 6.72e-06 
π“ Codebook: 211/1024 (20.6%) Top5:[724,390,462,893,660,502,707,173,321,526,163,972,379,169,317]


π”¬ Encoder Diversity (iter 2250):
  Avg similarity: 0.2410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8775 (0.0=collapsed)
[Epoch 4/100] [Batch 253/669 (37.8%)] [Iter 2260] Loss: 1.2303 (freq: 0.4893, raw: 0.7405, quant: 0.0004, domain: 0.0000) LR: 6.75e-06 
π“ Codebook: 258/1024 (25.2%) Top5:[724,390,707,462,321,660,644,893,502,962,296,278,920,211,379]


π”¬ Encoder Diversity (iter 2260):
  Avg similarity: 0.2673 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8479 (0.0=collapsed)
[Epoch 4/100] [Batch 263/669 (39.3%)] [Iter 2270] Loss: 1.5192 (freq: 0.6450, raw: 0.8737, quant: 0.0005, domain: 0.0000) LR: 6.78e-06 
π“ Codebook: 219/1024 (21.4%) Top5:[724,390,660,462,321,502,707,893,920,644,296,278,379,366,913]


π”¬ Encoder Diversity (iter 2270):
  Avg similarity: 0.1901 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8938 (0.0=collapsed)
[Epoch 4/100] [Batch 273/669 (40.8%)] [Iter 2280] Loss: 1.1905 (freq: 0.4466, raw: 0.7435, quant: 0.0004, domain: 0.0000) LR: 6.81e-06 
π“ Codebook: 232/1024 (22.7%) Top5:[724,390,462,321,893,660,502,920,211,972,379,962,296,707,576]


π”¬ Encoder Diversity (iter 2280):
  Avg similarity: 0.1457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9114 (0.0=collapsed)
[Epoch 4/100] [Batch 283/669 (42.3%)] [Iter 2290] Loss: 1.4189 (freq: 0.6030, raw: 0.8154, quant: 0.0005, domain: 0.0000) LR: 6.84e-06 
π“ Codebook: 215/1024 (21.0%) Top5:[724,660,462,390,379,211,972,893,146,920,321,502,296,913,628]


π”¬ Encoder Diversity (iter 2290):
  Avg similarity: 0.2384 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8600 (0.0=collapsed)
[Epoch 4/100] [Batch 293/669 (43.8%)] [Iter 2300] Loss: 1.3486 (freq: 0.5544, raw: 0.7937, quant: 0.0004, domain: 0.0000) LR: 6.87e-06 
π“ Codebook: 238/1024 (23.2%) Top5:[724,390,893,321,462,211,379,707,644,414,660,920,972,280,471]


π”¬ Encoder Diversity (iter 2300):
  Avg similarity: 0.2004 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8751 (0.0=collapsed)
[Epoch 4/100] [Batch 303/669 (45.3%)] [Iter 2310] Loss: 1.2497 (freq: 0.5055, raw: 0.7438, quant: 0.0004, domain: 0.0000) LR: 6.90e-06 
π“ Codebook: 223/1024 (21.8%) Top5:[724,893,462,390,379,211,321,169,792,660,317,526,33,193,75]


π”¬ Encoder Diversity (iter 2310):
  Avg similarity: 0.2049 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8807 (0.0=collapsed)
[Epoch 4/100] [Batch 313/669 (46.8%)] [Iter 2320] Loss: 1.5035 (freq: 0.6924, raw: 0.8106, quant: 0.0005, domain: 0.0000) LR: 6.93e-06 
π“ Codebook: 236/1024 (23.0%) Top5:[724,893,390,321,75,913,33,366,211,148,948,437,644,863,707]


π”¬ Encoder Diversity (iter 2320):
  Avg similarity: 0.1811 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8918 (0.0=collapsed)
[Epoch 4/100] [Batch 323/669 (48.3%)] [Iter 2330] Loss: 1.0881 (freq: 0.4139, raw: 0.6737, quant: 0.0004, domain: 0.0000) LR: 6.96e-06 
π“ Codebook: 223/1024 (21.8%) Top5:[724,321,644,893,390,972,211,462,379,707,628,660,502,296,280]


π”¬ Encoder Diversity (iter 2330):
  Avg similarity: 0.1957 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8871 (0.0=collapsed)
[Epoch 4/100] [Batch 333/669 (49.8%)] [Iter 2340] Loss: 1.0764 (freq: 0.3852, raw: 0.6909, quant: 0.0003, domain: 0.0000) LR: 6.99e-06 
π“ Codebook: 273/1024 (26.7%) Top5:[724,390,644,321,707,893,877,774,471,414,211,689,193,920,163]


π”¬ Encoder Diversity (iter 2340):
  Avg similarity: 0.1701 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8889 (0.0=collapsed)
[Epoch 4/100] [Batch 343/669 (51.3%)] [Iter 2350] Loss: 1.4012 (freq: 0.6082, raw: 0.7924, quant: 0.0005, domain: 0.0000) LR: 7.02e-06 
π“ Codebook: 339/1024 (33.1%) Top5:[724,321,660,146,972,462,502,390,893,644,296,379,576,920,820]


π”¬ Encoder Diversity (iter 2350):
  Avg similarity: 0.1403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9179 (0.0=collapsed)
[Epoch 4/100] [Batch 353/669 (52.8%)] [Iter 2360] Loss: 1.4885 (freq: 0.6153, raw: 0.8727, quant: 0.0005, domain: 0.0000) LR: 7.05e-06 
π“ Codebook: 262/1024 (25.6%) Top5:[724,390,893,321,707,644,913,462,920,211,146,366,660,163,972]


π”¬ Encoder Diversity (iter 2360):
  Avg similarity: 0.1562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9101 (0.0=collapsed)
[Epoch 4/100] [Batch 363/669 (54.3%)] [Iter 2370] Loss: 1.2110 (freq: 0.4677, raw: 0.7429, quant: 0.0005, domain: 0.0000) LR: 7.08e-06 
π“ Codebook: 261/1024 (25.5%) Top5:[724,462,390,366,972,660,948,913,893,75,33,297,437,321,148]


π”¬ Encoder Diversity (iter 2370):
  Avg similarity: 0.2610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8592 (0.0=collapsed)
[Epoch 4/100] [Batch 373/669 (55.8%)] [Iter 2380] Loss: 1.4504 (freq: 0.5958, raw: 0.8542, quant: 0.0004, domain: 0.0000) LR: 7.11e-06 
π“ Codebook: 240/1024 (23.4%) Top5:[724,390,893,462,321,211,972,644,920,707,660,146,379,502,576]


π”¬ Encoder Diversity (iter 2380):
  Avg similarity: 0.1832 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8815 (0.0=collapsed)
[Epoch 4/100] [Batch 383/669 (57.2%)] [Iter 2390] Loss: 0.9478 (freq: 0.3307, raw: 0.6168, quant: 0.0003, domain: 0.0000) LR: 7.14e-06 
π“ Codebook: 300/1024 (29.3%) Top5:[724,893,972,644,390,321,462,660,211,526,146,193,707,379,471]


π”¬ Encoder Diversity (iter 2390):
  Avg similarity: 0.2062 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8814 (0.0=collapsed)
[Epoch 4/100] [Batch 393/669 (58.7%)] [Iter 2400] Loss: 1.5833 (freq: 0.6615, raw: 0.9214, quant: 0.0005, domain: 0.0000) LR: 7.17e-06 
π“ Codebook: 276/1024 (27.0%) Top5:[724,893,644,972,321,390,707,660,296,211,462,502,366,379,628]


π”¬ Encoder Diversity (iter 2400):
  Avg similarity: 0.1349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9197 (0.0=collapsed)
[Epoch 4/100] [Batch 403/669 (60.2%)] [Iter 2410] Loss: 1.1140 (freq: 0.4211, raw: 0.6926, quant: 0.0004, domain: 0.0000) LR: 7.20e-06 
π“ Codebook: 262/1024 (25.6%) Top5:[724,644,893,913,948,321,33,317,366,390,707,3,863,169,148]


π”¬ Encoder Diversity (iter 2410):
  Avg similarity: 0.1370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9044 (0.0=collapsed)
[Epoch 4/100] [Batch 413/669 (61.7%)] [Iter 2420] Loss: 1.3363 (freq: 0.5355, raw: 0.8004, quant: 0.0004, domain: 0.0000) LR: 7.23e-06 
π“ Codebook: 234/1024 (22.9%) Top5:[724,893,644,321,707,416,366,33,660,913,863,502,75,390,437]


π”¬ Encoder Diversity (iter 2420):
  Avg similarity: 0.1323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9153 (0.0=collapsed)
[Epoch 4/100] [Batch 423/669 (63.2%)] [Iter 2430] Loss: 1.4650 (freq: 0.5967, raw: 0.8678, quant: 0.0005, domain: 0.0000) LR: 7.26e-06 
π“ Codebook: 205/1024 (20.0%) Top5:[724,893,644,321,390,707,913,948,33,660,366,416,437,3,863]


π”¬ Encoder Diversity (iter 2430):
  Avg similarity: 0.1658 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9128 (0.0=collapsed)
[Epoch 4/100] [Batch 433/669 (64.7%)] [Iter 2440] Loss: 1.4726 (freq: 0.6227, raw: 0.8493, quant: 0.0006, domain: 0.0000) LR: 7.29e-06 
π“ Codebook: 215/1024 (21.0%) Top5:[724,321,893,644,390,502,146,920,707,660,462,211,416,379,972]


π”¬ Encoder Diversity (iter 2440):
  Avg similarity: 0.2078 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8946 (0.0=collapsed)
[Epoch 4/100] [Batch 443/669 (66.2%)] [Iter 2450] Loss: 1.3893 (freq: 0.5914, raw: 0.7974, quant: 0.0005, domain: 0.0000) LR: 7.32e-06 
π“ Codebook: 232/1024 (22.7%) Top5:[724,321,893,644,390,948,707,33,366,913,297,863,148,437,75]


π”¬ Encoder Diversity (iter 2450):
  Avg similarity: 0.1481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9095 (0.0=collapsed)
[Epoch 4/100] [Batch 453/669 (67.7%)] [Iter 2460] Loss: 1.3622 (freq: 0.5781, raw: 0.7836, quant: 0.0005, domain: 0.0000) LR: 7.35e-06 
π“ Codebook: 184/1024 (18.0%) Top5:[724,390,33,948,148,366,437,893,913,75,321,297,707,863,462]


π”¬ Encoder Diversity (iter 2460):
  Avg similarity: 0.2250 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8604 (0.0=collapsed)
[Epoch 4/100] [Batch 463/669 (69.2%)] [Iter 2470] Loss: 1.4211 (freq: 0.6016, raw: 0.8191, quant: 0.0004, domain: 0.0000) LR: 7.38e-06 
π“ Codebook: 262/1024 (25.6%) Top5:[724,390,893,629,707,462,644,321,920,146,471,48,211,820,502]


π”¬ Encoder Diversity (iter 2470):
  Avg similarity: 0.2087 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8797 (0.0=collapsed)
[Epoch 4/100] [Batch 473/669 (70.7%)] [Iter 2480] Loss: 1.5808 (freq: 0.6526, raw: 0.9277, quant: 0.0005, domain: 0.0000) LR: 7.41e-06 
π“ Codebook: 214/1024 (20.9%) Top5:[724,390,893,629,644,707,321,416,920,48,211,146,169,660,526]


π”¬ Encoder Diversity (iter 2480):
  Avg similarity: 0.1173 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9216 (0.0=collapsed)
[Epoch 4/100] [Batch 483/669 (72.2%)] [Iter 2490] Loss: 1.0905 (freq: 0.4331, raw: 0.6571, quant: 0.0003, domain: 0.0000) LR: 7.44e-06 
π“ Codebook: 193/1024 (18.8%) Top5:[724,629,169,3,317,893,193,526,416,163,792,100,608,173,210]


π”¬ Encoder Diversity (iter 2490):
  Avg similarity: 0.1871 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8858 (0.0=collapsed)
[Epoch 4/100] [Batch 493/669 (73.7%)] [Iter 2500] Loss: 1.1725 (freq: 0.4408, raw: 0.7313, quant: 0.0004, domain: 0.0000) LR: 7.47e-06 
π“ Codebook: 217/1024 (21.2%) Top5:[724,893,644,390,629,321,707,416,48,660,471,920,146,317,3]


π”¬ Encoder Diversity (iter 2500):
  Avg similarity: 0.1249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9192 (0.0=collapsed)
[Epoch 4/100] [Batch 503/669 (75.2%)] [Iter 2510] Loss: 1.6045 (freq: 0.7523, raw: 0.8517, quant: 0.0005, domain: 0.0000) LR: 7.50e-06 
π“ Codebook: 233/1024 (22.8%) Top5:[724,893,390,629,321,644,416,660,48,211,193,462,920,502,146]


π”¬ Encoder Diversity (iter 2510):
  Avg similarity: 0.2405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8773 (0.0=collapsed)
[Epoch 4/100] [Batch 513/669 (76.7%)] [Iter 2520] Loss: 1.5023 (freq: 0.6348, raw: 0.8671, quant: 0.0005, domain: 0.0000) LR: 7.53e-06 
π“ Codebook: 231/1024 (22.6%) Top5:[724,893,644,321,390,471,707,211,660,628,414,462,420,48,379]


π”¬ Encoder Diversity (iter 2520):
  Avg similarity: 0.1534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9106 (0.0=collapsed)
[Epoch 4/100] [Batch 523/669 (78.2%)] [Iter 2530] Loss: 1.3320 (freq: 0.5462, raw: 0.7853, quant: 0.0004, domain: 0.0000) LR: 7.56e-06 
π“ Codebook: 221/1024 (21.6%) Top5:[724,321,893,390,628,211,644,471,972,462,48,660,526,649,296]


π”¬ Encoder Diversity (iter 2530):
  Avg similarity: 0.1858 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8854 (0.0=collapsed)
[Epoch 4/100] [Batch 533/669 (79.7%)] [Iter 2540] Loss: 1.6874 (freq: 0.7734, raw: 0.9135, quant: 0.0005, domain: 0.0000) LR: 7.59e-06 
π“ Codebook: 224/1024 (21.9%) Top5:[724,893,211,644,462,390,629,48,321,146,628,660,972,920,502]


π”¬ Encoder Diversity (iter 2540):
  Avg similarity: 0.1837 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8902 (0.0=collapsed)
[Epoch 4/100] [Batch 543/669 (81.2%)] [Iter 2550] Loss: 1.1567 (freq: 0.4295, raw: 0.7268, quant: 0.0004, domain: 0.0000) LR: 7.62e-06 
π“ Codebook: 275/1024 (26.9%) Top5:[724,893,644,390,321,707,471,75,948,420,366,913,163,1015,33]


π”¬ Encoder Diversity (iter 2550):
  Avg similarity: 0.1698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8987 (0.0=collapsed)
[Epoch 4/100] [Batch 553/669 (82.7%)] [Iter 2560] Loss: 1.7834 (freq: 0.7952, raw: 0.9875, quant: 0.0007, domain: 0.0000) LR: 7.65e-06 
π“ Codebook: 240/1024 (23.4%) Top5:[724,893,644,416,629,321,48,502,660,211,146,920,462,390,707]


π”¬ Encoder Diversity (iter 2560):
  Avg similarity: 0.1770 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8945 (0.0=collapsed)
[Epoch 4/100] [Batch 563/669 (84.2%)] [Iter 2570] Loss: 1.6274 (freq: 0.7039, raw: 0.9229, quant: 0.0006, domain: 0.0000) LR: 7.68e-06 
π“ Codebook: 302/1024 (29.5%) Top5:[724,644,893,321,416,792,169,629,193,390,173,3,707,526,146]


π”¬ Encoder Diversity (iter 2570):
  Avg similarity: 0.1462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9019 (0.0=collapsed)
[Epoch 4/100] [Batch 573/669 (85.7%)] [Iter 2580] Loss: 1.4548 (freq: 0.5949, raw: 0.8593, quant: 0.0006, domain: 0.0000) LR: 7.71e-06 
π“ Codebook: 262/1024 (25.6%) Top5:[724,644,416,893,321,390,502,707,629,660,420,296,48,462,146]


π”¬ Encoder Diversity (iter 2580):
  Avg similarity: 0.1126 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9274 (0.0=collapsed)
[Epoch 4/100] [Batch 583/669 (87.1%)] [Iter 2590] Loss: 1.5616 (freq: 0.7056, raw: 0.8555, quant: 0.0005, domain: 0.0000) LR: 7.74e-06 
π“ Codebook: 332/1024 (32.4%) Top5:[724,644,321,948,893,366,33,913,75,437,629,48,660,707,148]


π”¬ Encoder Diversity (iter 2590):
  Avg similarity: 0.1819 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8819 (0.0=collapsed)
[Epoch 4/100] [Batch 593/669 (88.6%)] [Iter 2600] Loss: 1.7648 (freq: 0.7791, raw: 0.9851, quant: 0.0005, domain: 0.0000) LR: 7.77e-06 
π“ Codebook: 263/1024 (25.7%) Top5:[724,644,893,707,390,420,321,471,774,1015,116,877,317,526,414]


π”¬ Encoder Diversity (iter 2600):
  Avg similarity: 0.1354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9049 (0.0=collapsed)
[Epoch 4/100] [Batch 603/669 (90.1%)] [Iter 2610] Loss: 1.3489 (freq: 0.5465, raw: 0.8020, quant: 0.0004, domain: 0.0000) LR: 7.80e-06 
π“ Codebook: 268/1024 (26.2%) Top5:[724,390,893,644,321,707,471,629,920,416,211,75,863,462,48]


π”¬ Encoder Diversity (iter 2610):
  Avg similarity: 0.2151 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8908 (0.0=collapsed)
[Epoch 4/100] [Batch 613/669 (91.6%)] [Iter 2620] Loss: 1.3266 (freq: 0.5149, raw: 0.8112, quant: 0.0006, domain: 0.0000) LR: 7.83e-06 
π“ Codebook: 254/1024 (24.8%) Top5:[724,893,416,644,629,48,390,211,321,920,707,146,218,628,502]


π”¬ Encoder Diversity (iter 2620):
  Avg similarity: 0.1357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9108 (0.0=collapsed)
[Epoch 4/100] [Batch 623/669 (93.1%)] [Iter 2630] Loss: 1.4630 (freq: 0.6050, raw: 0.8575, quant: 0.0005, domain: 0.0000) LR: 7.86e-06 
π“ Codebook: 250/1024 (24.4%) Top5:[724,893,33,629,416,913,948,321,644,297,366,863,211,437,390]


π”¬ Encoder Diversity (iter 2630):
  Avg similarity: 0.1284 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9168 (0.0=collapsed)
[Epoch 4/100] [Batch 633/669 (94.6%)] [Iter 2640] Loss: 1.2145 (freq: 0.4952, raw: 0.7189, quant: 0.0004, domain: 0.0000) LR: 7.89e-06 
π“ Codebook: 310/1024 (30.3%) Top5:[724,893,644,321,390,629,416,173,169,792,33,3,210,211,48]


π”¬ Encoder Diversity (iter 2640):
  Avg similarity: 0.1019 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9277 (0.0=collapsed)
[Epoch 4/100] [Batch 643/669 (96.1%)] [Iter 2650] Loss: 1.4770 (freq: 0.6122, raw: 0.8642, quant: 0.0005, domain: 0.0000) LR: 7.92e-06 
π“ Codebook: 251/1024 (24.5%) Top5:[893,724,390,321,644,366,33,913,948,75,437,297,148,211,414]


π”¬ Encoder Diversity (iter 2650):
  Avg similarity: 0.1203 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9273 (0.0=collapsed)
[Epoch 4/100] [Batch 653/669 (97.6%)] [Iter 2660] Loss: 1.2176 (freq: 0.4868, raw: 0.7304, quant: 0.0004, domain: 0.0000) LR: 7.95e-06 
π“ Codebook: 291/1024 (28.4%) Top5:[893,321,724,390,644,211,471,48,414,416,628,379,280,803,629]


π”¬ Encoder Diversity (iter 2660):
  Avg similarity: 0.1201 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9136 (0.0=collapsed)
[Epoch 4/100] [Batch 663/669 (99.1%)] [Iter 2670] Loss: 1.4800 (freq: 0.6309, raw: 0.8485, quant: 0.0005, domain: 0.0000) LR: 7.98e-06 
π“ Codebook: 309/1024 (30.2%) Top5:[893,390,724,471,644,526,211,321,193,48,169,774,414,280,628]


π”¬ Encoder Diversity (iter 2670):
  Avg similarity: 0.1347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9140 (0.0=collapsed)

================================================================================
[Epoch 4] Validation Results:
  Total Loss: 0.7580
  Freq Loss:  0.2598
  Raw Loss:   0.4979
  Quant Loss: 0.0003
  π“ Codebook Usage: 68/1024 (6.6%)
  π“ Codebook Entropy: 3.2790 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 63415 (48.7%)
  Top 10 most used codes:
    1. Code 366: 7641 times (5.87%)
    2. Code 297: 6785 times (5.21%)
    3. Code 526: 6634 times (5.10%)
    4. Code 75: 6466 times (4.97%)
    5. Code 437: 6252 times (4.80%)
    6. Code 169: 6165 times (4.74%)
    7. Code 608: 6026 times (4.63%)
    8. Code 913: 5933 times (4.56%)
    9. Code 148: 5797 times (4.45%)
    10. Code 948: 5716 times (4.39%)
  Bottom 5 least used codes (among used):
    1. Code 233: 1 times (0.00%)
    2. Code 690: 7 times (0.01%)
    3. Code 49: 7 times (0.01%)
    4. Code 880: 7 times (0.01%)
    5. Code 145: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 4
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 5/100] [Batch 4/669 (0.6%)] [Iter 2680] Loss: 1.4614 (freq: 0.5989, raw: 0.8617, quant: 0.0008, domain: 0.0000) LR: 8.01e-06 
π“ Codebook: 843/1024 (82.3%) Top5:[724,390,893,629,48,211,644,471,774,526,608,169,920,416,3]


π”¬ Encoder Diversity (iter 2680):
  Avg similarity: 0.1751 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8943 (0.0=collapsed)
[Epoch 5/100] [Batch 14/669 (2.1%)] [Iter 2690] Loss: 1.3421 (freq: 0.5373, raw: 0.8042, quant: 0.0005, domain: 0.0000) LR: 8.04e-06 
π“ Codebook: 680/1024 (66.4%) Top5:[724,893,390,644,629,471,48,211,437,774,297,913,75,366,148]


π”¬ Encoder Diversity (iter 2690):
  Avg similarity: 0.2413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8753 (0.0=collapsed)
[Epoch 5/100] [Batch 24/669 (3.6%)] [Iter 2700] Loss: 1.3619 (freq: 0.5761, raw: 0.7853, quant: 0.0005, domain: 0.0000) LR: 8.07e-06 
π“ Codebook: 454/1024 (44.3%) Top5:[724,629,644,893,390,576,211,169,48,3,526,608,163,389,317]


π”¬ Encoder Diversity (iter 2700):
  Avg similarity: 0.1300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9182 (0.0=collapsed)
[Epoch 5/100] [Batch 34/669 (5.1%)] [Iter 2710] Loss: 1.4075 (freq: 0.5603, raw: 0.8466, quant: 0.0006, domain: 0.0000) LR: 8.10e-06 
π“ Codebook: 366/1024 (35.7%) Top5:[724,644,893,390,163,526,792,169,3,629,608,317,193,173,649]


π”¬ Encoder Diversity (iter 2710):
  Avg similarity: 0.1328 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9193 (0.0=collapsed)
[Epoch 5/100] [Batch 44/669 (6.6%)] [Iter 2720] Loss: 1.1818 (freq: 0.4621, raw: 0.7192, quant: 0.0004, domain: 0.0000) LR: 8.13e-06 
π“ Codebook: 292/1024 (28.5%) Top5:[644,724,893,33,366,297,948,913,148,75,390,437,863,576,482]


π”¬ Encoder Diversity (iter 2720):
  Avg similarity: 0.1543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9139 (0.0=collapsed)
[Epoch 5/100] [Batch 54/669 (8.1%)] [Iter 2730] Loss: 0.9660 (freq: 0.3599, raw: 0.6058, quant: 0.0003, domain: 0.0000) LR: 8.16e-06 
π“ Codebook: 270/1024 (26.4%) Top5:[644,193,792,173,371,163,526,317,169,893,649,3,100,608,210]


π”¬ Encoder Diversity (iter 2730):
  Avg similarity: 0.1884 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8973 (0.0=collapsed)
[Epoch 5/100] [Batch 64/669 (9.6%)] [Iter 2740] Loss: 1.2401 (freq: 0.5119, raw: 0.7278, quant: 0.0005, domain: 0.0000) LR: 8.19e-06 
π“ Codebook: 242/1024 (23.6%) Top5:[893,644,724,471,390,576,48,629,704,193,265,317,482,3,261]


π”¬ Encoder Diversity (iter 2740):
  Avg similarity: 0.1674 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8977 (0.0=collapsed)
[Epoch 5/100] [Batch 74/669 (11.1%)] [Iter 2750] Loss: 1.3210 (freq: 0.5429, raw: 0.7776, quant: 0.0005, domain: 0.0000) LR: 8.22e-06 
π“ Codebook: 204/1024 (19.9%) Top5:[893,629,576,644,724,48,193,913,390,211,33,940,754,173,366]


π”¬ Encoder Diversity (iter 2750):
  Avg similarity: 0.1081 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9251 (0.0=collapsed)
[Epoch 5/100] [Batch 84/669 (12.6%)] [Iter 2760] Loss: 1.4452 (freq: 0.5918, raw: 0.8529, quant: 0.0005, domain: 0.0000) LR: 8.25e-06 
π“ Codebook: 191/1024 (18.7%) Top5:[724,893,644,390,471,33,629,437,913,366,297,75,148,48,552]


π”¬ Encoder Diversity (iter 2760):
  Avg similarity: 0.1927 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8903 (0.0=collapsed)
[Epoch 5/100] [Batch 94/669 (14.1%)] [Iter 2770] Loss: 1.3638 (freq: 0.5804, raw: 0.7830, quant: 0.0004, domain: 0.0000) LR: 8.28e-06 
π“ Codebook: 189/1024 (18.5%) Top5:[724,893,629,48,211,390,644,345,145,366,754,576,863,389,594]


π”¬ Encoder Diversity (iter 2770):
  Avg similarity: 0.1227 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9123 (0.0=collapsed)
[Epoch 5/100] [Batch 104/669 (15.5%)] [Iter 2780] Loss: 1.3828 (freq: 0.5827, raw: 0.7996, quant: 0.0004, domain: 0.0000) LR: 8.31e-06 
π“ Codebook: 196/1024 (19.1%) Top5:[724,893,390,644,437,33,863,297,913,366,148,471,552,774,75]


π”¬ Encoder Diversity (iter 2780):
  Avg similarity: 0.1236 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9223 (0.0=collapsed)
[Epoch 5/100] [Batch 114/669 (17.0%)] [Iter 2790] Loss: 1.0562 (freq: 0.4219, raw: 0.6339, quant: 0.0004, domain: 0.0000) LR: 8.34e-06 
π“ Codebook: 213/1024 (20.8%) Top5:[297,863,366,148,437,33,948,913,724,75,644,629,893,163,482]


π”¬ Encoder Diversity (iter 2790):
  Avg similarity: 0.1240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9241 (0.0=collapsed)
[Epoch 5/100] [Batch 124/669 (18.5%)] [Iter 2800] Loss: 1.5872 (freq: 0.6698, raw: 0.9168, quant: 0.0006, domain: 0.0000) LR: 8.37e-06 
π“ Codebook: 271/1024 (26.5%) Top5:[644,724,913,366,297,863,893,33,148,482,948,437,704,75,471]


π”¬ Encoder Diversity (iter 2800):
  Avg similarity: 0.1471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8998 (0.0=collapsed)
[Epoch 5/100] [Batch 134/669 (20.0%)] [Iter 2810] Loss: 1.2786 (freq: 0.4878, raw: 0.7903, quant: 0.0004, domain: 0.0000) LR: 8.40e-06 
π“ Codebook: 263/1024 (25.7%) Top5:[724,644,893,482,163,704,193,526,863,297,792,3,371,366,169]


π”¬ Encoder Diversity (iter 2810):
  Avg similarity: 0.0953 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9277 (0.0=collapsed)
[Epoch 5/100] [Batch 144/669 (21.5%)] [Iter 2820] Loss: 1.3012 (freq: 0.4993, raw: 0.8013, quant: 0.0005, domain: 0.0000) LR: 8.43e-06 
π“ Codebook: 229/1024 (22.4%) Top5:[724,644,893,33,863,297,437,148,390,366,482,913,948,792,75]


π”¬ Encoder Diversity (iter 2820):
  Avg similarity: 0.1217 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9189 (0.0=collapsed)
[Epoch 5/100] [Batch 154/669 (23.0%)] [Iter 2830] Loss: 1.1725 (freq: 0.4494, raw: 0.7227, quant: 0.0004, domain: 0.0000) LR: 8.46e-06 
π“ Codebook: 214/1024 (20.9%) Top5:[893,33,644,948,75,863,297,913,366,526,193,792,148,437,3]


π”¬ Encoder Diversity (iter 2830):
  Avg similarity: 0.1168 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9276 (0.0=collapsed)
[Epoch 5/100] [Batch 164/669 (24.5%)] [Iter 2840] Loss: 1.5774 (freq: 0.6616, raw: 0.9152, quant: 0.0006, domain: 0.0000) LR: 8.49e-06 
π“ Codebook: 251/1024 (24.5%) Top5:[893,390,644,724,48,471,576,629,447,211,514,754,774,758,462]


π”¬ Encoder Diversity (iter 2840):
  Avg similarity: 0.1791 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8963 (0.0=collapsed)
[Epoch 5/100] [Batch 174/669 (26.0%)] [Iter 2850] Loss: 1.0332 (freq: 0.3598, raw: 0.6730, quant: 0.0004, domain: 0.0000) LR: 8.52e-06 
π“ Codebook: 224/1024 (21.9%) Top5:[893,390,193,317,173,169,48,33,210,471,526,371,3,163,629]


π”¬ Encoder Diversity (iter 2850):
  Avg similarity: 0.0897 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9324 (0.0=collapsed)
[Epoch 5/100] [Batch 184/669 (27.5%)] [Iter 2860] Loss: 1.2069 (freq: 0.4838, raw: 0.7227, quant: 0.0004, domain: 0.0000) LR: 8.55e-06 
π“ Codebook: 185/1024 (18.1%) Top5:[893,33,471,948,390,75,644,366,863,297,913,148,193,437,724]


π”¬ Encoder Diversity (iter 2860):
  Avg similarity: 0.1604 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9080 (0.0=collapsed)
[Epoch 5/100] [Batch 194/669 (29.0%)] [Iter 2870] Loss: 1.4447 (freq: 0.5914, raw: 0.8528, quant: 0.0005, domain: 0.0000) LR: 8.58e-06 
π“ Codebook: 252/1024 (24.6%) Top5:[724,893,471,644,390,704,754,629,774,482,462,447,345,552,576]


π”¬ Encoder Diversity (iter 2870):
  Avg similarity: 0.1629 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9000 (0.0=collapsed)
[Epoch 5/100] [Batch 204/669 (30.5%)] [Iter 2880] Loss: 1.6048 (freq: 0.6830, raw: 0.9210, quant: 0.0007, domain: 0.0000) LR: 8.61e-06 
π“ Codebook: 199/1024 (19.4%) Top5:[724,462,366,576,644,629,901,297,389,913,893,447,390,940,863]


π”¬ Encoder Diversity (iter 2880):
  Avg similarity: 0.1426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9167 (0.0=collapsed)
[Epoch 5/100] [Batch 214/669 (32.0%)] [Iter 2890] Loss: 1.3896 (freq: 0.5384, raw: 0.8506, quant: 0.0005, domain: 0.0000) LR: 8.64e-06 
π“ Codebook: 211/1024 (20.6%) Top5:[724,644,462,163,297,169,366,482,389,792,901,913,345,100,552]


π”¬ Encoder Diversity (iter 2890):
  Avg similarity: 0.1242 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9007 (0.0=collapsed)
[Epoch 5/100] [Batch 224/669 (33.5%)] [Iter 2900] Loss: 1.4531 (freq: 0.5922, raw: 0.8604, quant: 0.0005, domain: 0.0000) LR: 8.67e-06 
π“ Codebook: 190/1024 (18.6%) Top5:[724,644,390,893,482,552,462,594,471,389,447,704,345,901,653]


π”¬ Encoder Diversity (iter 2900):
  Avg similarity: 0.1215 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9132 (0.0=collapsed)
[Epoch 5/100] [Batch 234/669 (35.0%)] [Iter 2910] Loss: 1.3564 (freq: 0.5658, raw: 0.7902, quant: 0.0004, domain: 0.0000) LR: 8.70e-06 
π“ Codebook: 205/1024 (20.0%) Top5:[724,893,462,169,100,644,3,629,792,33,163,608,173,317,594]


π”¬ Encoder Diversity (iter 2910):
  Avg similarity: 0.1680 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8940 (0.0=collapsed)
[Epoch 5/100] [Batch 244/669 (36.5%)] [Iter 2920] Loss: 1.5993 (freq: 0.6793, raw: 0.9195, quant: 0.0006, domain: 0.0000) LR: 8.73e-06 
π“ Codebook: 230/1024 (22.5%) Top5:[893,724,462,629,48,576,644,211,390,704,447,345,261,526,163]


π”¬ Encoder Diversity (iter 2920):
  Avg similarity: 0.1886 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8857 (0.0=collapsed)
[Epoch 5/100] [Batch 254/669 (38.0%)] [Iter 2930] Loss: 1.3474 (freq: 0.5557, raw: 0.7912, quant: 0.0005, domain: 0.0000) LR: 8.76e-06 
π“ Codebook: 232/1024 (22.7%) Top5:[893,724,644,390,48,33,704,193,629,169,462,576,526,792,447]


π”¬ Encoder Diversity (iter 2930):
  Avg similarity: 0.1611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9098 (0.0=collapsed)
[Epoch 5/100] [Batch 264/669 (39.5%)] [Iter 2940] Loss: 1.2952 (freq: 0.5195, raw: 0.7752, quant: 0.0005, domain: 0.0000) LR: 8.79e-06 
π“ Codebook: 254/1024 (24.8%) Top5:[893,724,33,644,48,576,948,437,390,462,447,704,758,629,75]


π”¬ Encoder Diversity (iter 2940):
  Avg similarity: 0.0918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9288 (0.0=collapsed)
[Epoch 5/100] [Batch 274/669 (41.0%)] [Iter 2950] Loss: 1.7295 (freq: 0.7459, raw: 0.9830, quant: 0.0006, domain: 0.0000) LR: 8.82e-06 
π“ Codebook: 238/1024 (23.2%) Top5:[893,724,644,754,471,758,390,447,265,145,704,940,48,552,437]


π”¬ Encoder Diversity (iter 2950):
  Avg similarity: 0.1921 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8978 (0.0=collapsed)
[Epoch 5/100] [Batch 284/669 (42.5%)] [Iter 2960] Loss: 1.4253 (freq: 0.5738, raw: 0.8506, quant: 0.0009, domain: 0.0000) LR: 8.85e-06 
π“ Codebook: 219/1024 (21.4%) Top5:[33,724,644,948,893,75,437,317,754,526,193,366,297,552,148]


π”¬ Encoder Diversity (iter 2960):
  Avg similarity: 0.2179 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8671 (0.0=collapsed)
[Epoch 5/100] [Batch 294/669 (43.9%)] [Iter 2970] Loss: 1.2077 (freq: 0.4902, raw: 0.7171, quant: 0.0004, domain: 0.0000) LR: 8.88e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[297,863,33,437,366,913,148,75,317,948,163,644,193,724,173]


π”¬ Encoder Diversity (iter 2970):
  Avg similarity: 0.0974 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9299 (0.0=collapsed)
[Epoch 5/100] [Batch 304/669 (45.4%)] [Iter 2980] Loss: 1.1495 (freq: 0.4516, raw: 0.6974, quant: 0.0005, domain: 0.0000) LR: 8.91e-06 
π“ Codebook: 269/1024 (26.3%) Top5:[724,644,893,482,471,552,390,75,462,447,629,33,576,297,863]


π”¬ Encoder Diversity (iter 2980):
  Avg similarity: 0.0887 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 5/100] [Batch 314/669 (46.9%)] [Iter 2990] Loss: 1.3513 (freq: 0.5006, raw: 0.8501, quant: 0.0007, domain: 0.0000) LR: 8.94e-06 
π“ Codebook: 272/1024 (26.6%) Top5:[724,893,462,629,644,576,390,345,193,792,389,594,901,3,317]


π”¬ Encoder Diversity (iter 2990):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 5/100] [Batch 324/669 (48.4%)] [Iter 3000] Loss: 1.3072 (freq: 0.5262, raw: 0.7805, quant: 0.0005, domain: 0.0000) LR: 8.97e-06 
π“ Codebook: 243/1024 (23.7%) Top5:[893,724,644,863,297,390,148,33,366,75,948,913,462,437,471]


π”¬ Encoder Diversity (iter 3000):
  Avg similarity: 0.1931 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8858 (0.0=collapsed)
[Epoch 5/100] [Batch 334/669 (49.9%)] [Iter 3010] Loss: 1.4461 (freq: 0.5878, raw: 0.8577, quant: 0.0005, domain: 0.0000) LR: 9.00e-06 
π“ Codebook: 252/1024 (24.6%) Top5:[893,724,644,390,471,447,704,552,774,482,297,63,863,417,576]


π”¬ Encoder Diversity (iter 3010):
  Avg similarity: 0.1526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9084 (0.0=collapsed)
[Epoch 5/100] [Batch 344/669 (51.4%)] [Iter 3020] Loss: 1.2674 (freq: 0.4873, raw: 0.7796, quant: 0.0004, domain: 0.0000) LR: 9.03e-06 
π“ Codebook: 262/1024 (25.6%) Top5:[893,471,644,482,774,417,390,704,863,552,48,45,754,211,173]


π”¬ Encoder Diversity (iter 3020):
  Avg similarity: 0.2255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8635 (0.0=collapsed)
[Epoch 5/100] [Batch 354/669 (52.9%)] [Iter 3030] Loss: 1.4221 (freq: 0.5769, raw: 0.8448, quant: 0.0004, domain: 0.0000) LR: 9.06e-06 
π“ Codebook: 250/1024 (24.4%) Top5:[471,893,644,390,482,417,724,774,704,552,489,45,754,63,265]


π”¬ Encoder Diversity (iter 3030):
  Avg similarity: 0.1248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9178 (0.0=collapsed)
[Epoch 5/100] [Batch 364/669 (54.4%)] [Iter 3040] Loss: 1.1275 (freq: 0.4797, raw: 0.6474, quant: 0.0004, domain: 0.0000) LR: 9.09e-06 
π“ Codebook: 279/1024 (27.2%) Top5:[193,526,317,173,100,3,792,163,649,371,893,169,608,913,724]


π”¬ Encoder Diversity (iter 3040):
  Avg similarity: 0.1486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9032 (0.0=collapsed)
[Epoch 5/100] [Batch 374/669 (55.9%)] [Iter 3050] Loss: 1.1759 (freq: 0.4675, raw: 0.7080, quant: 0.0004, domain: 0.0000) LR: 9.12e-06 
π“ Codebook: 253/1024 (24.7%) Top5:[724,893,173,169,526,644,100,649,193,163,317,608,371,792,390]


π”¬ Encoder Diversity (iter 3050):
  Avg similarity: 0.1175 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9340 (0.0=collapsed)
[Epoch 5/100] [Batch 384/669 (57.4%)] [Iter 3060] Loss: 1.1257 (freq: 0.4183, raw: 0.7071, quant: 0.0004, domain: 0.0000) LR: 9.15e-06 
π“ Codebook: 324/1024 (31.6%) Top5:[724,644,898,893,462,704,595,390,792,193,173,169,33,526,163]


π”¬ Encoder Diversity (iter 3060):
  Avg similarity: 0.1030 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9361 (0.0=collapsed)
[Epoch 5/100] [Batch 394/669 (58.9%)] [Iter 3070] Loss: 1.4544 (freq: 0.6190, raw: 0.8349, quant: 0.0005, domain: 0.0000) LR: 9.18e-06 
π“ Codebook: 294/1024 (28.7%) Top5:[724,644,893,75,148,898,863,595,33,390,317,163,792,704,100]


π”¬ Encoder Diversity (iter 3070):
  Avg similarity: 0.0872 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9361 (0.0=collapsed)
[Epoch 5/100] [Batch 404/669 (60.4%)] [Iter 3080] Loss: 1.2215 (freq: 0.5118, raw: 0.7092, quant: 0.0004, domain: 0.0000) LR: 9.21e-06 
π“ Codebook: 240/1024 (23.4%) Top5:[724,644,148,898,75,893,629,595,913,948,366,437,462,33,863]


π”¬ Encoder Diversity (iter 3080):
  Avg similarity: 0.2061 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8941 (0.0=collapsed)
[Epoch 5/100] [Batch 414/669 (61.9%)] [Iter 3090] Loss: 1.6410 (freq: 0.6550, raw: 0.9855, quant: 0.0005, domain: 0.0000) LR: 9.24e-06 
π“ Codebook: 243/1024 (23.7%) Top5:[893,724,644,390,552,471,48,482,629,774,704,653,754,898,594]


π”¬ Encoder Diversity (iter 3090):
  Avg similarity: 0.1649 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8976 (0.0=collapsed)
[Epoch 5/100] [Batch 424/669 (63.4%)] [Iter 3100] Loss: 1.3615 (freq: 0.5697, raw: 0.7913, quant: 0.0005, domain: 0.0000) LR: 9.27e-06 
π“ Codebook: 242/1024 (23.6%) Top5:[893,724,644,649,169,317,792,173,100,193,3,371,471,210,163]


π”¬ Encoder Diversity (iter 3100):
  Avg similarity: 0.1822 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8985 (0.0=collapsed)
[Epoch 5/100] [Batch 434/669 (64.9%)] [Iter 3110] Loss: 1.0222 (freq: 0.3954, raw: 0.6265, quant: 0.0003, domain: 0.0000) LR: 9.30e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[75,33,913,893,948,366,644,437,148,863,730,724,48,576,471]


π”¬ Encoder Diversity (iter 3110):
  Avg similarity: 0.1506 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9167 (0.0=collapsed)
[Epoch 5/100] [Batch 444/669 (66.4%)] [Iter 3120] Loss: 1.1543 (freq: 0.4506, raw: 0.7032, quant: 0.0006, domain: 0.0000) LR: 9.33e-06 
π“ Codebook: 233/1024 (22.8%) Top5:[893,644,724,33,913,75,948,437,471,148,366,482,417,552,704]


π”¬ Encoder Diversity (iter 3120):
  Avg similarity: 0.1417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9220 (0.0=collapsed)
[Epoch 5/100] [Batch 454/669 (67.9%)] [Iter 3130] Loss: 1.4262 (freq: 0.5793, raw: 0.8462, quant: 0.0007, domain: 0.0000) LR: 9.36e-06 
π“ Codebook: 266/1024 (26.0%) Top5:[893,644,724,704,75,526,482,471,366,649,193,148,437,629,211]


π”¬ Encoder Diversity (iter 3130):
  Avg similarity: 0.0880 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9372 (0.0=collapsed)
[Epoch 5/100] [Batch 464/669 (69.4%)] [Iter 3140] Loss: 1.1836 (freq: 0.4584, raw: 0.7248, quant: 0.0004, domain: 0.0000) LR: 9.39e-06 
π“ Codebook: 298/1024 (29.1%) Top5:[644,724,893,704,447,482,526,649,169,371,100,193,390,163,63]


π”¬ Encoder Diversity (iter 3140):
  Avg similarity: 0.1250 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9291 (0.0=collapsed)
[Epoch 5/100] [Batch 474/669 (70.9%)] [Iter 3150] Loss: 1.2783 (freq: 0.5073, raw: 0.7706, quant: 0.0005, domain: 0.0000) LR: 9.42e-06 
π“ Codebook: 236/1024 (23.0%) Top5:[644,913,724,526,163,148,948,145,437,893,371,649,75,730,169]


π”¬ Encoder Diversity (iter 3150):
  Avg similarity: 0.1242 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9264 (0.0=collapsed)
[Epoch 5/100] [Batch 484/669 (72.3%)] [Iter 3160] Loss: 1.2922 (freq: 0.5135, raw: 0.7783, quant: 0.0005, domain: 0.0000) LR: 9.45e-06 
π“ Codebook: 314/1024 (30.7%) Top5:[893,724,644,482,390,75,948,552,913,704,730,148,447,594,471]


π”¬ Encoder Diversity (iter 3160):
  Avg similarity: 0.1970 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8941 (0.0=collapsed)
[Epoch 5/100] [Batch 494/669 (73.8%)] [Iter 3170] Loss: 1.4674 (freq: 0.6147, raw: 0.8520, quant: 0.0007, domain: 0.0000) LR: 9.48e-06 
π“ Codebook: 297/1024 (29.0%) Top5:[893,629,644,462,724,595,390,211,898,594,576,754,940,48,526]


π”¬ Encoder Diversity (iter 3170):
  Avg similarity: 0.1483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9045 (0.0=collapsed)
[Epoch 5/100] [Batch 504/669 (75.3%)] [Iter 3180] Loss: 1.4047 (freq: 0.5556, raw: 0.8486, quant: 0.0005, domain: 0.0000) LR: 9.51e-06 
π“ Codebook: 292/1024 (28.5%) Top5:[893,724,390,644,629,462,898,960,576,211,595,704,754,48,594]


π”¬ Encoder Diversity (iter 3180):
  Avg similarity: 0.2051 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8762 (0.0=collapsed)
[Epoch 5/100] [Batch 514/669 (76.8%)] [Iter 3190] Loss: 1.4406 (freq: 0.5970, raw: 0.8430, quant: 0.0005, domain: 0.0000) LR: 9.54e-06 
π“ Codebook: 274/1024 (26.8%) Top5:[893,390,724,644,913,75,629,3,33,437,148,863,898,552,704]


π”¬ Encoder Diversity (iter 3190):
  Avg similarity: 0.1428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9062 (0.0=collapsed)
[Epoch 5/100] [Batch 524/669 (78.3%)] [Iter 3200] Loss: 1.4417 (freq: 0.6074, raw: 0.8338, quant: 0.0005, domain: 0.0000) LR: 9.56e-06 
π“ Codebook: 297/1024 (29.0%) Top5:[893,390,724,3,163,644,629,169,792,526,317,173,100,371,193]


π”¬ Encoder Diversity (iter 3200):
  Avg similarity: 0.1052 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9239 (0.0=collapsed)
[Epoch 5/100] [Batch 534/669 (79.8%)] [Iter 3210] Loss: 1.6805 (freq: 0.7080, raw: 0.9719, quant: 0.0005, domain: 0.0000) LR: 9.59e-06 
π“ Codebook: 279/1024 (27.2%) Top5:[893,390,629,48,724,754,576,526,163,758,173,704,649,462,100]


π”¬ Encoder Diversity (iter 3210):
  Avg similarity: 0.1077 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9288 (0.0=collapsed)
[Epoch 5/100] [Batch 544/669 (81.3%)] [Iter 3220] Loss: 1.4091 (freq: 0.5548, raw: 0.8539, quant: 0.0004, domain: 0.0000) LR: 9.62e-06 
π“ Codebook: 228/1024 (22.3%) Top5:[893,724,390,644,471,552,774,48,75,665,704,148,297,366,458]


π”¬ Encoder Diversity (iter 3220):
  Avg similarity: 0.1935 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8971 (0.0=collapsed)
[Epoch 5/100] [Batch 554/669 (82.8%)] [Iter 3230] Loss: 1.3626 (freq: 0.5977, raw: 0.7644, quant: 0.0005, domain: 0.0000) LR: 9.65e-06 
π“ Codebook: 230/1024 (22.5%) Top5:[893,644,724,163,100,471,649,390,371,193,173,526,482,317,704]


π”¬ Encoder Diversity (iter 3230):
  Avg similarity: 0.1175 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9232 (0.0=collapsed)
[Epoch 5/100] [Batch 564/669 (84.3%)] [Iter 3240] Loss: 1.5546 (freq: 0.6465, raw: 0.9074, quant: 0.0007, domain: 0.0000) LR: 9.68e-06 
π“ Codebook: 280/1024 (27.3%) Top5:[644,724,893,163,100,526,482,649,390,193,317,704,371,792,173]


π”¬ Encoder Diversity (iter 3240):
  Avg similarity: 0.0893 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9407 (0.0=collapsed)
[Epoch 5/100] [Batch 574/669 (85.8%)] [Iter 3250] Loss: 1.4428 (freq: 0.6210, raw: 0.8212, quant: 0.0006, domain: 0.0000) LR: 9.71e-06 
π“ Codebook: 357/1024 (34.9%) Top5:[644,724,482,704,893,390,977,863,163,665,898,366,437,653,148]


π”¬ Encoder Diversity (iter 3250):
  Avg similarity: 0.0976 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 5/100] [Batch 584/669 (87.3%)] [Iter 3260] Loss: 1.5400 (freq: 0.6310, raw: 0.9083, quant: 0.0007, domain: 0.0000) LR: 9.74e-06 
π“ Codebook: 320/1024 (31.2%) Top5:[644,724,482,893,148,366,704,863,665,977,595,390,913,297,169]


π”¬ Encoder Diversity (iter 3260):
  Avg similarity: 0.1247 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9251 (0.0=collapsed)
[Epoch 5/100] [Batch 594/669 (88.8%)] [Iter 3270] Loss: 1.4119 (freq: 0.5753, raw: 0.8360, quant: 0.0006, domain: 0.0000) LR: 9.77e-06 
π“ Codebook: 249/1024 (24.3%) Top5:[148,863,366,913,297,437,665,948,75,644,893,724,390,33,792]


π”¬ Encoder Diversity (iter 3270):
  Avg similarity: 0.1245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9277 (0.0=collapsed)
[Epoch 5/100] [Batch 604/669 (90.3%)] [Iter 3280] Loss: 1.2497 (freq: 0.4639, raw: 0.7853, quant: 0.0005, domain: 0.0000) LR: 9.80e-06 
π“ Codebook: 255/1024 (24.9%) Top5:[724,390,893,629,3,169,792,462,100,644,595,754,193,163,211]


π”¬ Encoder Diversity (iter 3280):
  Avg similarity: 0.0897 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9394 (0.0=collapsed)
[Epoch 5/100] [Batch 614/669 (91.8%)] [Iter 3290] Loss: 0.8782 (freq: 0.3215, raw: 0.5563, quant: 0.0004, domain: 0.0000) LR: 9.83e-06 
π“ Codebook: 245/1024 (23.9%) Top5:[893,3,792,724,390,169,163,33,366,649,100,75,526,173,317]


π”¬ Encoder Diversity (iter 3290):
  Avg similarity: 0.1483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9230 (0.0=collapsed)
[Epoch 5/100] [Batch 624/669 (93.3%)] [Iter 3300] Loss: 1.1336 (freq: 0.4258, raw: 0.7075, quant: 0.0004, domain: 0.0000) LR: 9.86e-06 
π“ Codebook: 346/1024 (33.8%) Top5:[893,390,724,644,948,576,75,665,629,366,792,33,3,437,148]


π”¬ Encoder Diversity (iter 3300):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9459 (0.0=collapsed)
[Epoch 5/100] [Batch 634/669 (94.8%)] [Iter 3310] Loss: 1.2808 (freq: 0.5153, raw: 0.7650, quant: 0.0005, domain: 0.0000) LR: 9.89e-06 
π“ Codebook: 271/1024 (26.5%) Top5:[366,948,665,893,437,75,33,629,390,863,913,148,297,754,48]


π”¬ Encoder Diversity (iter 3310):
  Avg similarity: 0.1138 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9336 (0.0=collapsed)
[Epoch 5/100] [Batch 644/669 (96.3%)] [Iter 3320] Loss: 1.2188 (freq: 0.4523, raw: 0.7661, quant: 0.0005, domain: 0.0000) LR: 9.92e-06 
π“ Codebook: 280/1024 (27.3%) Top5:[629,893,390,754,644,774,552,704,576,193,48,724,526,345,758]


π”¬ Encoder Diversity (iter 3320):
  Avg similarity: 0.1228 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9321 (0.0=collapsed)
[Epoch 5/100] [Batch 654/669 (97.8%)] [Iter 3330] Loss: 1.4434 (freq: 0.5940, raw: 0.8487, quant: 0.0007, domain: 0.0000) LR: 9.95e-06 
π“ Codebook: 253/1024 (24.7%) Top5:[390,552,893,774,724,704,644,399,526,595,629,45,48,754,437]


π”¬ Encoder Diversity (iter 3330):
  Avg similarity: 0.1569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9065 (0.0=collapsed)
[Epoch 5/100] [Batch 664/669 (99.3%)] [Iter 3340] Loss: 1.4562 (freq: 0.6178, raw: 0.8379, quant: 0.0005, domain: 0.0000) LR: 9.98e-06 
π“ Codebook: 273/1024 (26.7%) Top5:[893,526,644,390,169,724,704,552,193,3,317,792,163,608,649]


π”¬ Encoder Diversity (iter 3340):
  Avg similarity: 0.1034 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9259 (0.0=collapsed)

================================================================================
[Epoch 5] Validation Results:
  Total Loss: 0.7121
  Freq Loss:  0.2432
  Raw Loss:   0.4685
  Quant Loss: 0.0004
  π“ Codebook Usage: 96/1024 (9.4%)
  π“ Codebook Entropy: 3.3489 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 63614 (48.9%)
  Top 10 most used codes:
    1. Code 163: 7407 times (5.69%)
    2. Code 75: 7107 times (5.46%)
    3. Code 665: 6974 times (5.36%)
    4. Code 437: 6609 times (5.08%)
    5. Code 297: 6175 times (4.74%)
    6. Code 948: 6096 times (4.68%)
    7. Code 863: 5953 times (4.57%)
    8. Code 148: 5824 times (4.47%)
    9. Code 526: 5795 times (4.45%)
    10. Code 33: 5674 times (4.36%)
  Bottom 5 least used codes (among used):
    1. Code 36: 2 times (0.00%)
    2. Code 892: 6 times (0.00%)
    3. Code 135: 7 times (0.01%)
    4. Code 45: 7 times (0.01%)
    5. Code 9: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 5
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 6/100] [Batch 5/669 (0.7%)] [Iter 3350] Loss: 1.4199 (freq: 0.5772, raw: 0.8421, quant: 0.0006, domain: 0.0000) LR: 1.00e-05 
π“ Codebook: 945/1024 (92.3%) Top5:[724,893,644,48,665,366,863,148,948,297,75,33,437,704,913]


π”¬ Encoder Diversity (iter 3350):
  Avg similarity: 0.1068 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9238 (0.0=collapsed)
[Epoch 6/100] [Batch 15/669 (2.2%)] [Iter 3360] Loss: 1.5762 (freq: 0.6735, raw: 0.9021, quant: 0.0006, domain: 0.0000) LR: 1.00e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[644,893,724,526,948,148,297,169,366,649,665,3,863,913,704]


π”¬ Encoder Diversity (iter 3360):
  Avg similarity: 0.1743 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9040 (0.0=collapsed)
[Epoch 6/100] [Batch 25/669 (3.7%)] [Iter 3370] Loss: 1.4560 (freq: 0.6182, raw: 0.8373, quant: 0.0005, domain: 0.0000) LR: 1.01e-05 
π“ Codebook: 436/1024 (42.6%) Top5:[724,893,644,169,792,3,526,850,193,704,649,317,371,48,100]


π”¬ Encoder Diversity (iter 3370):
  Avg similarity: 0.1105 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9255 (0.0=collapsed)
[Epoch 6/100] [Batch 35/669 (5.2%)] [Iter 3380] Loss: 1.5334 (freq: 0.6318, raw: 0.9011, quant: 0.0005, domain: 0.0000) LR: 1.01e-05 
π“ Codebook: 352/1024 (34.4%) Top5:[644,893,724,704,850,581,859,974,519,970,48,169,930,913,3]


π”¬ Encoder Diversity (iter 3380):
  Avg similarity: 0.0925 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9373 (0.0=collapsed)
[Epoch 6/100] [Batch 45/669 (6.7%)] [Iter 3390] Loss: 1.1857 (freq: 0.4867, raw: 0.6986, quant: 0.0004, domain: 0.0000) LR: 1.01e-05 
π“ Codebook: 308/1024 (30.1%) Top5:[893,913,644,948,724,366,970,33,850,437,75,859,148,3,704]


π”¬ Encoder Diversity (iter 3390):
  Avg similarity: 0.1258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9098 (0.0=collapsed)
[Epoch 6/100] [Batch 55/669 (8.2%)] [Iter 3400] Loss: 1.4170 (freq: 0.5793, raw: 0.8372, quant: 0.0005, domain: 0.0000) LR: 1.02e-05 
π“ Codebook: 289/1024 (28.2%) Top5:[724,893,644,704,338,930,970,154,633,640,850,487,188,519,335]


π”¬ Encoder Diversity (iter 3400):
  Avg similarity: 0.1258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9310 (0.0=collapsed)
[Epoch 6/100] [Batch 65/669 (9.7%)] [Iter 3410] Loss: 1.2891 (freq: 0.5377, raw: 0.7510, quant: 0.0004, domain: 0.0000) LR: 1.02e-05 
π“ Codebook: 262/1024 (25.6%) Top5:[724,644,704,893,338,154,33,913,970,930,297,75,948,863,148]


π”¬ Encoder Diversity (iter 3410):
  Avg similarity: 0.0880 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9317 (0.0=collapsed)
[Epoch 6/100] [Batch 75/669 (11.2%)] [Iter 3420] Loss: 1.5708 (freq: 0.6692, raw: 0.9009, quant: 0.0006, domain: 0.0000) LR: 1.02e-05 
π“ Codebook: 272/1024 (26.6%) Top5:[724,704,644,169,3,526,970,193,893,850,930,317,154,335,371]


π”¬ Encoder Diversity (iter 3420):
  Avg similarity: 0.0870 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9400 (0.0=collapsed)
[Epoch 6/100] [Batch 85/669 (12.7%)] [Iter 3430] Loss: 1.0941 (freq: 0.3985, raw: 0.6951, quant: 0.0004, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 273/1024 (26.7%) Top5:[644,724,526,704,3,913,169,297,366,75,148,193,893,33,317]


π”¬ Encoder Diversity (iter 3430):
  Avg similarity: 0.0550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 6/100] [Batch 95/669 (14.2%)] [Iter 3440] Loss: 1.5265 (freq: 0.6962, raw: 0.8297, quant: 0.0005, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 298/1024 (29.1%) Top5:[644,704,850,893,865,724,859,297,335,169,863,792,911,148,173]


π”¬ Encoder Diversity (iter 3440):
  Avg similarity: 0.0949 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9459 (0.0=collapsed)
[Epoch 6/100] [Batch 105/669 (15.7%)] [Iter 3450] Loss: 0.7097 (freq: 0.2190, raw: 0.4904, quant: 0.0003, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 354/1024 (34.6%) Top5:[644,913,366,863,893,704,948,148,865,724,297,437,665,169,75]


π”¬ Encoder Diversity (iter 3450):
  Avg similarity: 0.1314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9174 (0.0=collapsed)
[Epoch 6/100] [Batch 115/669 (17.2%)] [Iter 3460] Loss: 1.1484 (freq: 0.4701, raw: 0.6778, quant: 0.0005, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 302/1024 (29.5%) Top5:[644,724,526,893,704,75,148,948,3,649,863,163,173,169,792]


π”¬ Encoder Diversity (iter 3460):
  Avg similarity: 0.0988 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9351 (0.0=collapsed)
[Epoch 6/100] [Batch 125/669 (18.7%)] [Iter 3470] Loss: 1.1443 (freq: 0.4295, raw: 0.7144, quant: 0.0004, domain: 0.0000) LR: 1.04e-05 
π“ Codebook: 347/1024 (33.9%) Top5:[526,173,437,704,792,665,724,163,169,3,913,148,863,75,317]


π”¬ Encoder Diversity (iter 3470):
  Avg similarity: 0.0666 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9517 (0.0=collapsed)
[Epoch 6/100] [Batch 135/669 (20.2%)] [Iter 3480] Loss: 1.1774 (freq: 0.4765, raw: 0.7005, quant: 0.0004, domain: 0.0000) LR: 1.04e-05 
π“ Codebook: 307/1024 (30.0%) Top5:[724,235,665,148,903,913,930,863,526,144,704,970,75,297,173]


π”¬ Encoder Diversity (iter 3480):
  Avg similarity: 0.1628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9043 (0.0=collapsed)
[Epoch 6/100] [Batch 145/669 (21.7%)] [Iter 3490] Loss: 1.3646 (freq: 0.5389, raw: 0.8252, quant: 0.0005, domain: 0.0000) LR: 1.04e-05 
π“ Codebook: 304/1024 (29.7%) Top5:[724,930,903,413,188,704,893,644,970,338,633,672,850,224,640]


π”¬ Encoder Diversity (iter 3490):
  Avg similarity: 0.1029 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9297 (0.0=collapsed)
[Epoch 6/100] [Batch 155/669 (23.2%)] [Iter 3500] Loss: 1.3750 (freq: 0.5497, raw: 0.8249, quant: 0.0005, domain: 0.0000) LR: 1.05e-05 
π“ Codebook: 291/1024 (28.4%) Top5:[724,148,665,893,930,644,437,75,366,948,863,913,859,297,970]


π”¬ Encoder Diversity (iter 3500):
  Avg similarity: 0.0887 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9448 (0.0=collapsed)
[Epoch 6/100] [Batch 165/669 (24.7%)] [Iter 3510] Loss: 1.5056 (freq: 0.6021, raw: 0.9028, quant: 0.0007, domain: 0.0000) LR: 1.05e-05 
π“ Codebook: 296/1024 (28.9%) Top5:[644,724,893,859,704,930,143,75,850,948,865,148,913,169,48]


π”¬ Encoder Diversity (iter 3510):
  Avg similarity: 0.1164 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9350 (0.0=collapsed)
[Epoch 6/100] [Batch 175/669 (26.2%)] [Iter 3520] Loss: 1.4126 (freq: 0.5870, raw: 0.8250, quant: 0.0005, domain: 0.0000) LR: 1.05e-05 
π“ Codebook: 292/1024 (28.5%) Top5:[169,193,526,3,173,163,792,100,644,608,317,649,371,863,859]


π”¬ Encoder Diversity (iter 3520):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 6/100] [Batch 185/669 (27.7%)] [Iter 3530] Loss: 1.5238 (freq: 0.6369, raw: 0.8862, quant: 0.0007, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 272/1024 (26.6%) Top5:[644,724,930,526,3,893,792,173,193,704,649,169,865,317,859]


π”¬ Encoder Diversity (iter 3530):
  Avg similarity: 0.1262 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9259 (0.0=collapsed)
[Epoch 6/100] [Batch 195/669 (29.1%)] [Iter 3540] Loss: 1.2626 (freq: 0.5043, raw: 0.7578, quant: 0.0004, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 269/1024 (26.3%) Top5:[724,930,893,644,704,338,903,364,640,188,911,193,865,633,850]


π”¬ Encoder Diversity (iter 3540):
  Avg similarity: 0.2091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8869 (0.0=collapsed)
[Epoch 6/100] [Batch 205/669 (30.6%)] [Iter 3550] Loss: 1.2228 (freq: 0.4531, raw: 0.7691, quant: 0.0006, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 290/1024 (28.3%) Top5:[724,930,704,893,366,75,948,437,665,903,364,913,863,338,111]


π”¬ Encoder Diversity (iter 3550):
  Avg similarity: 0.0948 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9415 (0.0=collapsed)
[Epoch 6/100] [Batch 215/669 (32.1%)] [Iter 3560] Loss: 1.2466 (freq: 0.4805, raw: 0.7655, quant: 0.0006, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 299/1024 (29.2%) Top5:[148,724,704,437,863,366,665,930,297,948,75,33,913,193,173]


π”¬ Encoder Diversity (iter 3560):
  Avg similarity: 0.1173 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9276 (0.0=collapsed)
[Epoch 6/100] [Batch 225/669 (33.6%)] [Iter 3570] Loss: 1.2340 (freq: 0.4691, raw: 0.7642, quant: 0.0007, domain: 0.0000) LR: 1.07e-05 
π“ Codebook: 319/1024 (31.2%) Top5:[148,863,724,526,704,366,297,437,193,75,317,33,649,169,665]


π”¬ Encoder Diversity (iter 3570):
  Avg similarity: 0.0914 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 6/100] [Batch 235/669 (35.1%)] [Iter 3580] Loss: 0.9119 (freq: 0.3450, raw: 0.5665, quant: 0.0004, domain: 0.0000) LR: 1.07e-05 
π“ Codebook: 362/1024 (35.4%) Top5:[704,526,724,850,865,111,24,297,437,948,863,903,550,364,75]


π”¬ Encoder Diversity (iter 3580):
  Avg similarity: 0.0886 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9370 (0.0=collapsed)
[Epoch 6/100] [Batch 245/669 (36.6%)] [Iter 3590] Loss: 1.3388 (freq: 0.5086, raw: 0.8296, quant: 0.0006, domain: 0.0000) LR: 1.07e-05 
π“ Codebook: 324/1024 (31.6%) Top5:[724,526,863,704,111,644,169,371,911,100,148,792,814,24,850]


π”¬ Encoder Diversity (iter 3590):
  Avg similarity: 0.0832 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 6/100] [Batch 255/669 (38.1%)] [Iter 3600] Loss: 1.6495 (freq: 0.6863, raw: 0.9626, quant: 0.0006, domain: 0.0000) LR: 1.08e-05 
π“ Codebook: 329/1024 (32.1%) Top5:[724,644,850,526,704,893,3,169,143,930,911,792,814,649,111]


π”¬ Encoder Diversity (iter 3600):
  Avg similarity: 0.0922 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9233 (0.0=collapsed)
[Epoch 6/100] [Batch 265/669 (39.6%)] [Iter 3610] Loss: 1.2872 (freq: 0.5236, raw: 0.7631, quant: 0.0005, domain: 0.0000) LR: 1.08e-05 
π“ Codebook: 288/1024 (28.1%) Top5:[526,850,3,482,724,148,173,792,169,913,193,317,75,111,863]


π”¬ Encoder Diversity (iter 3610):
  Avg similarity: 0.0879 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9463 (0.0=collapsed)
[Epoch 6/100] [Batch 275/669 (41.1%)] [Iter 3620] Loss: 1.4557 (freq: 0.5653, raw: 0.8899, quant: 0.0006, domain: 0.0000) LR: 1.08e-05 
π“ Codebook: 332/1024 (32.4%) Top5:[724,893,704,930,911,338,437,913,526,640,111,850,903,75,33]


π”¬ Encoder Diversity (iter 3620):
  Avg similarity: 0.0820 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9433 (0.0=collapsed)
[Epoch 6/100] [Batch 285/669 (42.6%)] [Iter 3630] Loss: 1.4191 (freq: 0.5863, raw: 0.8321, quant: 0.0007, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 340/1024 (33.2%) Top5:[893,724,526,704,169,338,148,193,437,75,335,873,863,317,33]


π”¬ Encoder Diversity (iter 3630):
  Avg similarity: 0.1014 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9316 (0.0=collapsed)
[Epoch 6/100] [Batch 295/669 (44.1%)] [Iter 3640] Loss: 1.2275 (freq: 0.4742, raw: 0.7528, quant: 0.0005, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 320/1024 (31.2%) Top5:[724,338,893,437,704,913,948,148,297,366,33,930,640,75,665]


π”¬ Encoder Diversity (iter 3640):
  Avg similarity: 0.1367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9177 (0.0=collapsed)
[Epoch 6/100] [Batch 305/669 (45.6%)] [Iter 3650] Loss: 1.3652 (freq: 0.5251, raw: 0.8397, quant: 0.0005, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 295/1024 (28.8%) Top5:[297,863,724,913,366,148,437,665,526,704,948,169,173,317,75]


π”¬ Encoder Diversity (iter 3650):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 6/100] [Batch 315/669 (47.1%)] [Iter 3660] Loss: 1.0419 (freq: 0.4200, raw: 0.6215, quant: 0.0005, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 346/1024 (33.8%) Top5:[724,297,704,366,930,317,863,913,608,850,526,665,644,193,792]


π”¬ Encoder Diversity (iter 3660):
  Avg similarity: 0.1413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9240 (0.0=collapsed)
[Epoch 6/100] [Batch 325/669 (48.6%)] [Iter 3670] Loss: 1.3203 (freq: 0.4978, raw: 0.8220, quant: 0.0005, domain: 0.0000) LR: 1.10e-05 
π“ Codebook: 341/1024 (33.3%) Top5:[850,143,111,814,297,859,335,366,863,148,930,704,144,136,724]


π”¬ Encoder Diversity (iter 3670):
  Avg similarity: 0.0830 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 6/100] [Batch 335/669 (50.1%)] [Iter 3680] Loss: 1.1124 (freq: 0.4235, raw: 0.6885, quant: 0.0005, domain: 0.0000) LR: 1.10e-05 
π“ Codebook: 342/1024 (33.4%) Top5:[724,608,526,863,193,173,317,148,704,371,169,930,644,859,111]


π”¬ Encoder Diversity (iter 3680):
  Avg similarity: 0.0810 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 6/100] [Batch 345/669 (51.6%)] [Iter 3690] Loss: 1.2692 (freq: 0.5052, raw: 0.7635, quant: 0.0005, domain: 0.0000) LR: 1.10e-05 
π“ Codebook: 305/1024 (29.8%) Top5:[863,148,366,437,297,913,724,930,948,704,33,893,644,640,608]


π”¬ Encoder Diversity (iter 3690):
  Avg similarity: 0.0843 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9504 (0.0=collapsed)
[Epoch 6/100] [Batch 355/669 (53.1%)] [Iter 3700] Loss: 1.5030 (freq: 0.6180, raw: 0.8845, quant: 0.0006, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 351/1024 (34.3%) Top5:[863,665,148,366,437,913,75,644,948,704,297,930,33,893,865]


π”¬ Encoder Diversity (iter 3700):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 6/100] [Batch 365/669 (54.6%)] [Iter 3710] Loss: 1.0477 (freq: 0.3565, raw: 0.6908, quant: 0.0004, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 386/1024 (37.7%) Top5:[863,148,366,437,665,948,526,913,173,644,371,297,704,193,75]


π”¬ Encoder Diversity (iter 3710):
  Avg similarity: 0.0844 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9381 (0.0=collapsed)
[Epoch 6/100] [Batch 375/669 (56.1%)] [Iter 3720] Loss: 1.3121 (freq: 0.4940, raw: 0.8173, quant: 0.0008, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 414/1024 (40.4%) Top5:[724,704,644,850,865,893,903,364,366,665,911,148,930,814,24]


π”¬ Encoder Diversity (iter 3720):
  Avg similarity: 0.1043 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9334 (0.0=collapsed)
[Epoch 6/100] [Batch 385/669 (57.5%)] [Iter 3730] Loss: 1.2986 (freq: 0.5366, raw: 0.7615, quant: 0.0005, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 363/1024 (35.4%) Top5:[724,111,704,850,173,335,814,526,907,136,942,859,893,338,487]


π”¬ Encoder Diversity (iter 3730):
  Avg similarity: 0.0806 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9424 (0.0=collapsed)
[Epoch 6/100] [Batch 395/669 (59.0%)] [Iter 3740] Loss: 1.5327 (freq: 0.6371, raw: 0.8951, quant: 0.0006, domain: 0.0000) LR: 1.12e-05 
π“ Codebook: 353/1024 (34.5%) Top5:[724,704,111,893,338,335,850,640,903,859,814,665,144,143,136]


π”¬ Encoder Diversity (iter 3740):
  Avg similarity: 0.0531 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9504 (0.0=collapsed)
[Epoch 6/100] [Batch 405/669 (60.5%)] [Iter 3750] Loss: 1.2538 (freq: 0.4904, raw: 0.7628, quant: 0.0006, domain: 0.0000) LR: 1.12e-05 
π“ Codebook: 332/1024 (32.4%) Top5:[526,893,665,704,850,608,173,366,371,169,148,437,193,317,297]


π”¬ Encoder Diversity (iter 3750):
  Avg similarity: 0.1015 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9358 (0.0=collapsed)
[Epoch 6/100] [Batch 415/669 (62.0%)] [Iter 3760] Loss: 1.5147 (freq: 0.6096, raw: 0.9046, quant: 0.0006, domain: 0.0000) LR: 1.12e-05 
π“ Codebook: 353/1024 (34.5%) Top5:[893,724,930,704,903,526,173,859,644,169,338,970,193,640,371]


π”¬ Encoder Diversity (iter 3760):
  Avg similarity: 0.1169 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9200 (0.0=collapsed)
[Epoch 6/100] [Batch 425/669 (63.5%)] [Iter 3770] Loss: 1.3486 (freq: 0.5134, raw: 0.8346, quant: 0.0005, domain: 0.0000) LR: 1.13e-05 
π“ Codebook: 323/1024 (31.5%) Top5:[893,859,724,148,644,193,704,317,173,608,930,437,335,371,111]


π”¬ Encoder Diversity (iter 3770):
  Avg similarity: 0.1940 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8889 (0.0=collapsed)
[Epoch 6/100] [Batch 435/669 (65.0%)] [Iter 3780] Loss: 1.0433 (freq: 0.3992, raw: 0.6437, quant: 0.0004, domain: 0.0000) LR: 1.13e-05 
π“ Codebook: 288/1024 (28.1%) Top5:[893,724,644,704,930,338,859,640,437,814,850,188,620,136,519]


π”¬ Encoder Diversity (iter 3780):
  Avg similarity: 0.1243 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9223 (0.0=collapsed)
[Epoch 6/100] [Batch 445/669 (66.5%)] [Iter 3790] Loss: 1.2160 (freq: 0.4374, raw: 0.7781, quant: 0.0005, domain: 0.0000) LR: 1.13e-05 
π“ Codebook: 345/1024 (33.7%) Top5:[724,863,859,148,136,850,437,143,704,297,335,665,193,952,33]


π”¬ Encoder Diversity (iter 3790):
  Avg similarity: 0.0766 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9459 (0.0=collapsed)
[Epoch 6/100] [Batch 455/669 (68.0%)] [Iter 3800] Loss: 1.0066 (freq: 0.3745, raw: 0.6317, quant: 0.0005, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 359/1024 (35.1%) Top5:[193,526,317,704,3,173,944,724,371,143,792,649,163,136,24]


π”¬ Encoder Diversity (iter 3800):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9494 (0.0=collapsed)
[Epoch 6/100] [Batch 465/669 (69.5%)] [Iter 3810] Loss: 1.2440 (freq: 0.4771, raw: 0.7665, quant: 0.0004, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 334/1024 (32.6%) Top5:[863,297,148,948,136,913,3,437,75,33,704,526,346,143,665]


π”¬ Encoder Diversity (iter 3810):
  Avg similarity: 0.1101 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9263 (0.0=collapsed)
[Epoch 6/100] [Batch 475/669 (71.0%)] [Iter 3820] Loss: 0.9607 (freq: 0.3449, raw: 0.6154, quant: 0.0004, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 317/1024 (31.0%) Top5:[437,297,913,863,75,948,148,136,33,640,620,704,952,665,346]


π”¬ Encoder Diversity (iter 3820):
  Avg similarity: 0.1813 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8821 (0.0=collapsed)
[Epoch 6/100] [Batch 485/669 (72.5%)] [Iter 3830] Loss: 1.2497 (freq: 0.4915, raw: 0.7577, quant: 0.0005, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 321/1024 (31.3%) Top5:[136,913,724,952,948,297,148,863,704,437,859,3,526,346,33]


π”¬ Encoder Diversity (iter 3830):
  Avg similarity: 0.0708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 6/100] [Batch 495/669 (74.0%)] [Iter 3840] Loss: 1.3052 (freq: 0.4802, raw: 0.8244, quant: 0.0007, domain: 0.0000) LR: 1.15e-05 
π“ Codebook: 376/1024 (36.7%) Top5:[724,893,704,644,903,338,930,865,850,364,640,24,188,942,136]


π”¬ Encoder Diversity (iter 3840):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9512 (0.0=collapsed)
[Epoch 6/100] [Batch 505/669 (75.5%)] [Iter 3850] Loss: 0.7117 (freq: 0.2320, raw: 0.4794, quant: 0.0003, domain: 0.0000) LR: 1.15e-05 
π“ Codebook: 320/1024 (31.2%) Top5:[850,608,913,437,526,148,143,649,704,724,75,948,65,863,859]


π”¬ Encoder Diversity (iter 3850):
  Avg similarity: 0.0582 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 6/100] [Batch 515/669 (77.0%)] [Iter 3860] Loss: 1.1988 (freq: 0.4375, raw: 0.7607, quant: 0.0006, domain: 0.0000) LR: 1.15e-05 
π“ Codebook: 315/1024 (30.8%) Top5:[724,608,850,526,3,903,173,371,893,143,704,111,942,335,169]


π”¬ Encoder Diversity (iter 3860):
  Avg similarity: 0.1584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8919 (0.0=collapsed)
[Epoch 6/100] [Batch 525/669 (78.5%)] [Iter 3870] Loss: 1.4828 (freq: 0.5866, raw: 0.8957, quant: 0.0006, domain: 0.0000) LR: 1.16e-05 
π“ Codebook: 282/1024 (27.5%) Top5:[437,724,148,863,75,913,893,143,335,297,33,111,948,483,65]


π”¬ Encoder Diversity (iter 3870):
  Avg similarity: 0.1551 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8911 (0.0=collapsed)
[Epoch 6/100] [Batch 535/669 (80.0%)] [Iter 3880] Loss: 1.5232 (freq: 0.6382, raw: 0.8845, quant: 0.0005, domain: 0.0000) LR: 1.16e-05 
π“ Codebook: 252/1024 (24.6%) Top5:[724,850,893,111,335,143,814,942,338,859,144,526,930,106,487]


π”¬ Encoder Diversity (iter 3880):
  Avg similarity: 0.1372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9169 (0.0=collapsed)
[Epoch 6/100] [Batch 545/669 (81.5%)] [Iter 3890] Loss: 1.5988 (freq: 0.6320, raw: 0.9662, quant: 0.0005, domain: 0.0000) LR: 1.16e-05 
π“ Codebook: 268/1024 (26.2%) Top5:[724,893,850,704,644,865,24,814,942,930,143,335,863,148,903]


π”¬ Encoder Diversity (iter 3890):
  Avg similarity: 0.0951 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9328 (0.0=collapsed)
[Epoch 6/100] [Batch 555/669 (83.0%)] [Iter 3900] Loss: 0.8373 (freq: 0.2916, raw: 0.5454, quant: 0.0003, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 282/1024 (27.5%) Top5:[893,644,526,724,704,437,863,850,3,297,948,148,33,913,865]


π”¬ Encoder Diversity (iter 3900):
  Avg similarity: 0.1483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9061 (0.0=collapsed)
[Epoch 6/100] [Batch 565/669 (84.5%)] [Iter 3910] Loss: 1.4066 (freq: 0.5948, raw: 0.8113, quant: 0.0004, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 285/1024 (27.8%) Top5:[893,724,148,437,644,930,75,948,704,33,859,640,913,728,850]


π”¬ Encoder Diversity (iter 3910):
  Avg similarity: 0.0691 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 6/100] [Batch 575/669 (85.9%)] [Iter 3920] Loss: 1.3472 (freq: 0.5171, raw: 0.8296, quant: 0.0004, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 314/1024 (30.7%) Top5:[526,893,3,169,317,173,801,952,930,859,371,608,704,640,148]


π”¬ Encoder Diversity (iter 3920):
  Avg similarity: 0.1150 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9287 (0.0=collapsed)
[Epoch 6/100] [Batch 585/669 (87.4%)] [Iter 3930] Loss: 1.2122 (freq: 0.4645, raw: 0.7472, quant: 0.0005, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 355/1024 (34.7%) Top5:[526,608,893,317,173,3,437,148,135,640,75,944,859,863,111]


π”¬ Encoder Diversity (iter 3930):
  Avg similarity: 0.0650 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 6/100] [Batch 595/669 (88.9%)] [Iter 3940] Loss: 1.2314 (freq: 0.4707, raw: 0.7602, quant: 0.0004, domain: 0.0000) LR: 1.18e-05 
π“ Codebook: 291/1024 (28.4%) Top5:[148,483,893,863,724,317,913,75,526,437,33,620,640,644,704]


π”¬ Encoder Diversity (iter 3940):
  Avg similarity: 0.0997 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9381 (0.0=collapsed)
[Epoch 6/100] [Batch 605/669 (90.4%)] [Iter 3950] Loss: 1.2339 (freq: 0.4723, raw: 0.7611, quant: 0.0004, domain: 0.0000) LR: 1.18e-05 
π“ Codebook: 319/1024 (31.2%) Top5:[724,850,814,526,893,704,863,913,317,136,148,942,143,75,644]


π”¬ Encoder Diversity (iter 3950):
  Avg similarity: 0.0797 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9438 (0.0=collapsed)
[Epoch 6/100] [Batch 615/669 (91.9%)] [Iter 3960] Loss: 1.4798 (freq: 0.5768, raw: 0.9024, quant: 0.0006, domain: 0.0000) LR: 1.18e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[724,893,704,930,338,644,850,814,173,65,913,942,863,865,620]


π”¬ Encoder Diversity (iter 3960):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 6/100] [Batch 625/669 (93.4%)] [Iter 3970] Loss: 1.5002 (freq: 0.6144, raw: 0.8853, quant: 0.0005, domain: 0.0000) LR: 1.19e-05 
π“ Codebook: 297/1024 (29.0%) Top5:[724,893,863,148,913,173,169,75,65,526,704,930,33,850,297]


π”¬ Encoder Diversity (iter 3970):
  Avg similarity: 0.0870 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 6/100] [Batch 635/669 (94.9%)] [Iter 3980] Loss: 1.3613 (freq: 0.5322, raw: 0.8284, quant: 0.0007, domain: 0.0000) LR: 1.19e-05 
π“ Codebook: 334/1024 (32.6%) Top5:[724,893,143,930,111,850,814,952,704,859,644,338,335,640,136]


π”¬ Encoder Diversity (iter 3980):
  Avg similarity: 0.1586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9005 (0.0=collapsed)
[Epoch 6/100] [Batch 645/669 (96.4%)] [Iter 3990] Loss: 1.1591 (freq: 0.4089, raw: 0.7498, quant: 0.0004, domain: 0.0000) LR: 1.19e-05 
π“ Codebook: 334/1024 (32.6%) Top5:[930,893,724,704,437,135,148,3,169,526,640,814,317,728,620]


π”¬ Encoder Diversity (iter 3990):
  Avg similarity: 0.1039 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9292 (0.0=collapsed)
[Epoch 6/100] [Batch 655/669 (97.9%)] [Iter 4000] Loss: 1.2019 (freq: 0.4614, raw: 0.7401, quant: 0.0004, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 322/1024 (31.4%) Top5:[148,913,65,863,948,483,437,75,608,317,704,893,135,315,724]


π”¬ Encoder Diversity (iter 4000):
  Avg similarity: 0.1259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9218 (0.0=collapsed)
[Epoch 6/100] [Batch 665/669 (99.4%)] [Iter 4010] Loss: 1.3167 (freq: 0.4909, raw: 0.8253, quant: 0.0005, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[704,893,724,930,814,437,148,644,483,948,850,1007,859,608,863]


π”¬ Encoder Diversity (iter 4010):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9403 (0.0=collapsed)

================================================================================
[Epoch 6] Validation Results:
  Total Loss: 0.6850
  Freq Loss:  0.2271
  Raw Loss:   0.4574
  Quant Loss: 0.0004
  π“ Codebook Usage: 207/1024 (20.2%)
  π“ Codebook Entropy: 3.7995 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 50948 (39.1%)
  Top 10 most used codes:
    1. Code 483: 6252 times (4.80%)
    2. Code 148: 5895 times (4.53%)
    3. Code 948: 5521 times (4.24%)
    4. Code 437: 5485 times (4.21%)
    5. Code 65: 5109 times (3.92%)
    6. Code 863: 4783 times (3.67%)
    7. Code 913: 4654 times (3.57%)
    8. Code 608: 4503 times (3.46%)
    9. Code 315: 4451 times (3.42%)
    10. Code 193: 4295 times (3.30%)
  Bottom 5 least used codes (among used):
    1. Code 1015: 1 times (0.00%)
    2. Code 886: 6 times (0.00%)
    3. Code 146: 6 times (0.00%)
    4. Code 313: 6 times (0.00%)
    5. Code 8: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 6
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 7/100] [Batch 6/669 (0.9%)] [Iter 4020] Loss: 1.2779 (freq: 0.5208, raw: 0.7565, quant: 0.0006, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[893,724,814,704,148,483,65,437,913,948,1007,863,33,315,75]


π”¬ Encoder Diversity (iter 4020):
  Avg similarity: 0.0984 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9335 (0.0=collapsed)
[Epoch 7/100] [Batch 16/669 (2.4%)] [Iter 4030] Loss: 1.0899 (freq: 0.4050, raw: 0.6844, quant: 0.0004, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 701/1024 (68.5%) Top5:[893,724,814,704,608,1007,399,467,148,317,73,944,437,913,680]


π”¬ Encoder Diversity (iter 4030):
  Avg similarity: 0.1223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9103 (0.0=collapsed)
[Epoch 7/100] [Batch 26/669 (3.9%)] [Iter 4040] Loss: 1.4029 (freq: 0.5065, raw: 0.8959, quant: 0.0006, domain: 0.0000) LR: 1.21e-05 
π“ Codebook: 491/1024 (47.9%) Top5:[893,724,399,608,814,680,317,913,704,60,73,371,169,944,173]


π”¬ Encoder Diversity (iter 4040):
  Avg similarity: 0.0976 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9414 (0.0=collapsed)
[Epoch 7/100] [Batch 36/669 (5.4%)] [Iter 4050] Loss: 1.3237 (freq: 0.5056, raw: 0.8176, quant: 0.0004, domain: 0.0000) LR: 1.21e-05 
π“ Codebook: 464/1024 (45.3%) Top5:[893,724,704,913,814,863,680,483,948,148,297,467,315,437,648]


π”¬ Encoder Diversity (iter 4050):
  Avg similarity: 0.0989 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9234 (0.0=collapsed)
[Epoch 7/100] [Batch 46/669 (6.9%)] [Iter 4060] Loss: 1.0420 (freq: 0.4078, raw: 0.6338, quant: 0.0004, domain: 0.0000) LR: 1.21e-05 
π“ Codebook: 383/1024 (37.4%) Top5:[893,814,526,169,724,3,317,704,680,163,890,801,371,608,193]


π”¬ Encoder Diversity (iter 4060):
  Avg similarity: 0.1576 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9221 (0.0=collapsed)
[Epoch 7/100] [Batch 56/669 (8.4%)] [Iter 4070] Loss: 1.3733 (freq: 0.5612, raw: 0.8116, quant: 0.0005, domain: 0.0000) LR: 1.22e-05 
π“ Codebook: 400/1024 (39.1%) Top5:[893,814,704,526,317,169,913,948,193,163,680,608,863,437,801]


π”¬ Encoder Diversity (iter 4070):
  Avg similarity: 0.1355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9237 (0.0=collapsed)
[Epoch 7/100] [Batch 66/669 (9.9%)] [Iter 4080] Loss: 1.4541 (freq: 0.5758, raw: 0.8777, quant: 0.0007, domain: 0.0000) LR: 1.22e-05 
π“ Codebook: 372/1024 (36.3%) Top5:[893,940,704,298,724,948,814,976,75,714,430,913,863,234,295]


π”¬ Encoder Diversity (iter 4080):
  Avg similarity: 0.0733 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 7/100] [Batch 76/669 (11.4%)] [Iter 4090] Loss: 1.3535 (freq: 0.5370, raw: 0.8161, quant: 0.0005, domain: 0.0000) LR: 1.22e-05 
π“ Codebook: 326/1024 (31.8%) Top5:[893,940,724,704,298,317,526,890,648,193,608,169,194,714,295]


π”¬ Encoder Diversity (iter 4090):
  Avg similarity: 0.1033 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9279 (0.0=collapsed)
[Epoch 7/100] [Batch 86/669 (12.9%)] [Iter 4100] Loss: 1.2577 (freq: 0.4881, raw: 0.7691, quant: 0.0004, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 394/1024 (38.5%) Top5:[148,483,437,315,948,33,297,913,65,863,724,75,893,60,814]


π”¬ Encoder Diversity (iter 4100):
  Avg similarity: 0.1457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9096 (0.0=collapsed)
[Epoch 7/100] [Batch 96/669 (14.3%)] [Iter 4110] Loss: 1.4135 (freq: 0.5149, raw: 0.8977, quant: 0.0008, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 372/1024 (36.3%) Top5:[724,893,704,298,814,194,648,940,293,399,680,913,483,315,33]


π”¬ Encoder Diversity (iter 4110):
  Avg similarity: 0.1300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9139 (0.0=collapsed)
[Epoch 7/100] [Batch 106/669 (15.8%)] [Iter 4120] Loss: 1.2322 (freq: 0.4825, raw: 0.7491, quant: 0.0005, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 375/1024 (36.6%) Top5:[893,724,680,704,298,863,148,399,940,297,317,526,483,890,194]


π”¬ Encoder Diversity (iter 4120):
  Avg similarity: 0.1439 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9106 (0.0=collapsed)
[Epoch 7/100] [Batch 116/669 (17.3%)] [Iter 4130] Loss: 1.3798 (freq: 0.5504, raw: 0.8287, quant: 0.0007, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 342/1024 (33.4%) Top5:[893,724,704,680,298,483,648,295,940,194,293,148,297,399,467]


π”¬ Encoder Diversity (iter 4130):
  Avg similarity: 0.0678 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 7/100] [Batch 126/669 (18.8%)] [Iter 4140] Loss: 1.2357 (freq: 0.4967, raw: 0.7385, quant: 0.0004, domain: 0.0000) LR: 1.24e-05 
π“ Codebook: 308/1024 (30.1%) Top5:[893,724,863,297,437,298,483,148,704,295,940,913,680,728,65]


π”¬ Encoder Diversity (iter 4140):
  Avg similarity: 0.0817 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9476 (0.0=collapsed)
[Epoch 7/100] [Batch 136/669 (20.3%)] [Iter 4150] Loss: 1.2985 (freq: 0.4899, raw: 0.8082, quant: 0.0004, domain: 0.0000) LR: 1.24e-05 
π“ Codebook: 353/1024 (34.5%) Top5:[863,148,728,893,297,483,437,33,75,704,913,724,97,65,940]


π”¬ Encoder Diversity (iter 4150):
  Avg similarity: 0.1120 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9266 (0.0=collapsed)
[Epoch 7/100] [Batch 146/669 (21.8%)] [Iter 4160] Loss: 0.9272 (freq: 0.3180, raw: 0.6088, quant: 0.0004, domain: 0.0000) LR: 1.24e-05 
π“ Codebook: 384/1024 (37.5%) Top5:[724,893,704,863,317,298,483,648,728,297,890,714,148,399,976]


π”¬ Encoder Diversity (iter 4160):
  Avg similarity: 0.1049 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9431 (0.0=collapsed)
[Epoch 7/100] [Batch 156/669 (23.3%)] [Iter 4170] Loss: 1.1796 (freq: 0.4187, raw: 0.7604, quant: 0.0004, domain: 0.0000) LR: 1.25e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[724,704,298,893,399,437,863,940,714,194,648,819,728,376,814]


π”¬ Encoder Diversity (iter 4170):
  Avg similarity: 0.0687 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9465 (0.0=collapsed)
[Epoch 7/100] [Batch 166/669 (24.8%)] [Iter 4180] Loss: 1.0615 (freq: 0.3928, raw: 0.6681, quant: 0.0006, domain: 0.0000) LR: 1.25e-05 
π“ Codebook: 340/1024 (33.2%) Top5:[724,298,704,893,293,940,814,194,819,804,648,193,680,526,60]


π”¬ Encoder Diversity (iter 4180):
  Avg similarity: 0.1536 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9204 (0.0=collapsed)
[Epoch 7/100] [Batch 176/669 (26.3%)] [Iter 4190] Loss: 1.2291 (freq: 0.4731, raw: 0.7555, quant: 0.0005, domain: 0.0000) LR: 1.25e-05 
π“ Codebook: 345/1024 (33.7%) Top5:[814,293,399,193,944,526,890,704,317,3,350,976,724,169,372]


π”¬ Encoder Diversity (iter 4190):
  Avg similarity: 0.1482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9264 (0.0=collapsed)
[Epoch 7/100] [Batch 186/669 (27.8%)] [Iter 4200] Loss: 1.3524 (freq: 0.5340, raw: 0.8179, quant: 0.0005, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 361/1024 (35.3%) Top5:[293,724,704,893,298,399,350,814,944,680,919,430,890,97,148]


π”¬ Encoder Diversity (iter 4200):
  Avg similarity: 0.0894 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9305 (0.0=collapsed)
[Epoch 7/100] [Batch 196/669 (29.3%)] [Iter 4210] Loss: 1.3807 (freq: 0.5657, raw: 0.8145, quant: 0.0005, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 366/1024 (35.7%) Top5:[893,399,298,944,97,317,193,704,3,430,724,60,890,526,376]


π”¬ Encoder Diversity (iter 4210):
  Avg similarity: 0.1120 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9318 (0.0=collapsed)
[Epoch 7/100] [Batch 206/669 (30.8%)] [Iter 4220] Loss: 1.3756 (freq: 0.5624, raw: 0.8127, quant: 0.0005, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 381/1024 (37.2%) Top5:[863,728,913,483,297,399,65,75,60,437,148,293,430,317,3]


π”¬ Encoder Diversity (iter 4220):
  Avg similarity: 0.0760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9428 (0.0=collapsed)
[Epoch 7/100] [Batch 216/669 (32.3%)] [Iter 4230] Loss: 1.1151 (freq: 0.4283, raw: 0.6863, quant: 0.0005, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 366/1024 (35.7%) Top5:[298,724,194,940,944,704,893,3,648,193,890,317,804,962,611]


π”¬ Encoder Diversity (iter 4230):
  Avg similarity: 0.1108 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9401 (0.0=collapsed)
[Epoch 7/100] [Batch 226/669 (33.8%)] [Iter 4240] Loss: 1.0862 (freq: 0.4023, raw: 0.6834, quant: 0.0005, domain: 0.0000) LR: 1.27e-05 
π“ Codebook: 397/1024 (38.8%) Top5:[890,298,3,193,194,317,944,169,893,526,801,608,648,724,940]


π”¬ Encoder Diversity (iter 4240):
  Avg similarity: 0.1272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9240 (0.0=collapsed)
[Epoch 7/100] [Batch 236/669 (35.3%)] [Iter 4250] Loss: 1.4762 (freq: 0.5978, raw: 0.8779, quant: 0.0005, domain: 0.0000) LR: 1.27e-05 
π“ Codebook: 346/1024 (33.8%) Top5:[298,893,724,194,648,940,704,714,814,164,921,39,913,1018,295]


π”¬ Encoder Diversity (iter 4250):
  Avg similarity: 0.0935 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9416 (0.0=collapsed)
[Epoch 7/100] [Batch 246/669 (36.8%)] [Iter 4260] Loss: 1.3154 (freq: 0.4953, raw: 0.8196, quant: 0.0005, domain: 0.0000) LR: 1.27e-05 
π“ Codebook: 351/1024 (34.3%) Top5:[293,193,913,3,890,728,944,298,317,893,483,297,863,526,962]


π”¬ Encoder Diversity (iter 4260):
  Avg similarity: 0.1031 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 7/100] [Batch 256/669 (38.3%)] [Iter 4270] Loss: 1.3390 (freq: 0.5328, raw: 0.8057, quant: 0.0005, domain: 0.0000) LR: 1.28e-05 
π“ Codebook: 321/1024 (31.3%) Top5:[298,893,610,97,399,724,704,39,976,940,813,962,913,3,248]


π”¬ Encoder Diversity (iter 4270):
  Avg similarity: 0.1334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9167 (0.0=collapsed)
[Epoch 7/100] [Batch 266/669 (39.8%)] [Iter 4280] Loss: 1.2092 (freq: 0.4521, raw: 0.7567, quant: 0.0005, domain: 0.0000) LR: 1.28e-05 
π“ Codebook: 321/1024 (31.3%) Top5:[399,97,913,863,728,430,962,297,248,148,60,75,315,33,814]


π”¬ Encoder Diversity (iter 4280):
  Avg similarity: 0.0839 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9421 (0.0=collapsed)
[Epoch 7/100] [Batch 276/669 (41.3%)] [Iter 4290] Loss: 1.2681 (freq: 0.4563, raw: 0.8111, quant: 0.0008, domain: 0.0000) LR: 1.28e-05 
π“ Codebook: 368/1024 (35.9%) Top5:[893,704,724,298,728,297,863,3,648,940,148,913,890,944,33]


π”¬ Encoder Diversity (iter 4290):
  Avg similarity: 0.1006 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9290 (0.0=collapsed)
[Epoch 7/100] [Batch 286/669 (42.8%)] [Iter 4300] Loss: 1.3500 (freq: 0.5427, raw: 0.8068, quant: 0.0005, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 333/1024 (32.5%) Top5:[893,724,704,3,193,298,940,399,194,944,890,376,962,714,350]


π”¬ Encoder Diversity (iter 4300):
  Avg similarity: 0.0925 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9323 (0.0=collapsed)
[Epoch 7/100] [Batch 296/669 (44.2%)] [Iter 4310] Loss: 1.3310 (freq: 0.5050, raw: 0.8255, quant: 0.0005, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 334/1024 (32.6%) Top5:[724,893,704,940,298,372,819,194,680,376,611,964,437,714,467]


π”¬ Encoder Diversity (iter 4310):
  Avg similarity: 0.1315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9175 (0.0=collapsed)
[Epoch 7/100] [Batch 306/669 (45.7%)] [Iter 4320] Loss: 1.2177 (freq: 0.4622, raw: 0.7548, quant: 0.0006, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 360/1024 (35.2%) Top5:[724,893,704,298,863,297,940,680,148,913,164,728,194,75,315]


π”¬ Encoder Diversity (iter 4320):
  Avg similarity: 0.1199 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9339 (0.0=collapsed)
[Epoch 7/100] [Batch 316/669 (47.2%)] [Iter 4330] Loss: 1.3395 (freq: 0.5146, raw: 0.8243, quant: 0.0005, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 374/1024 (36.5%) Top5:[3,298,293,893,704,814,944,819,724,164,317,193,913,890,437]


π”¬ Encoder Diversity (iter 4330):
  Avg similarity: 0.0911 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9344 (0.0=collapsed)
[Epoch 7/100] [Batch 326/669 (48.7%)] [Iter 4340] Loss: 1.0573 (freq: 0.3895, raw: 0.6673, quant: 0.0004, domain: 0.0000) LR: 1.30e-05 
π“ Codebook: 378/1024 (36.9%) Top5:[298,724,293,194,704,893,648,315,863,814,976,164,728,399,819]


π”¬ Encoder Diversity (iter 4340):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 7/100] [Batch 336/669 (50.2%)] [Iter 4350] Loss: 1.2018 (freq: 0.4554, raw: 0.7459, quant: 0.0005, domain: 0.0000) LR: 1.30e-05 
π“ Codebook: 381/1024 (37.2%) Top5:[3,298,944,193,890,526,194,648,893,317,704,962,724,163,371]


π”¬ Encoder Diversity (iter 4350):
  Avg similarity: 0.1017 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9261 (0.0=collapsed)
[Epoch 7/100] [Batch 346/669 (51.7%)] [Iter 4360] Loss: 1.0305 (freq: 0.3334, raw: 0.6965, quant: 0.0006, domain: 0.0000) LR: 1.30e-05 
π“ Codebook: 360/1024 (35.2%) Top5:[704,893,298,33,913,437,97,648,3,295,194,962,193,39,679]


π”¬ Encoder Diversity (iter 4360):
  Avg similarity: 0.0654 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9426 (0.0=collapsed)
[Epoch 7/100] [Batch 356/669 (53.2%)] [Iter 4370] Loss: 1.0660 (freq: 0.4022, raw: 0.6631, quant: 0.0007, domain: 0.0000) LR: 1.31e-05 
π“ Codebook: 412/1024 (40.2%) Top5:[193,890,3,704,944,893,608,317,163,298,526,728,913,649,135]


π”¬ Encoder Diversity (iter 4370):
  Avg similarity: 0.0684 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 7/100] [Batch 366/669 (54.7%)] [Iter 4380] Loss: 1.2410 (freq: 0.4920, raw: 0.7486, quant: 0.0005, domain: 0.0000) LR: 1.31e-05 
π“ Codebook: 394/1024 (38.5%) Top5:[724,298,483,3,704,148,893,65,193,75,890,608,913,194,317]


π”¬ Encoder Diversity (iter 4380):
  Avg similarity: 0.1185 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9272 (0.0=collapsed)
[Epoch 7/100] [Batch 376/669 (56.2%)] [Iter 4390] Loss: 1.0825 (freq: 0.4030, raw: 0.6791, quant: 0.0005, domain: 0.0000) LR: 1.31e-05 
π“ Codebook: 397/1024 (38.8%) Top5:[3,399,608,724,376,193,890,526,944,293,814,801,75,483,819]


π”¬ Encoder Diversity (iter 4390):
  Avg similarity: 0.0909 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9427 (0.0=collapsed)
[Epoch 7/100] [Batch 386/669 (57.7%)] [Iter 4400] Loss: 1.4225 (freq: 0.4895, raw: 0.9322, quant: 0.0007, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 405/1024 (39.6%) Top5:[724,298,472,893,704,680,194,944,193,940,648,3,467,1018,890]


π”¬ Encoder Diversity (iter 4400):
  Avg similarity: 0.1012 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 7/100] [Batch 396/669 (59.2%)] [Iter 4410] Loss: 1.2202 (freq: 0.4747, raw: 0.7449, quant: 0.0005, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 383/1024 (37.4%) Top5:[724,293,496,944,704,298,893,814,890,399,372,680,60,819,193]


π”¬ Encoder Diversity (iter 4410):
  Avg similarity: 0.1203 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9290 (0.0=collapsed)
[Epoch 7/100] [Batch 406/669 (60.7%)] [Iter 4420] Loss: 1.0585 (freq: 0.3914, raw: 0.6665, quant: 0.0005, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 393/1024 (38.4%) Top5:[724,298,893,173,704,944,163,680,939,608,371,472,890,940,534]


π”¬ Encoder Diversity (iter 4420):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 7/100] [Batch 416/669 (62.2%)] [Iter 4430] Loss: 1.2209 (freq: 0.4749, raw: 0.7454, quant: 0.0005, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 337/1024 (32.9%) Top5:[472,893,194,97,704,814,293,33,297,163,315,496,804,399,974]


π”¬ Encoder Diversity (iter 4430):
  Avg similarity: 0.0996 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9337 (0.0=collapsed)
[Epoch 7/100] [Batch 426/669 (63.7%)] [Iter 4440] Loss: 1.3781 (freq: 0.5648, raw: 0.8128, quant: 0.0005, domain: 0.0000) LR: 1.33e-05 
π“ Codebook: 324/1024 (31.6%) Top5:[194,893,163,724,399,940,890,648,3,704,872,298,804,97,60]


π”¬ Encoder Diversity (iter 4440):
  Avg similarity: 0.0735 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9494 (0.0=collapsed)
[Epoch 7/100] [Batch 436/669 (65.2%)] [Iter 4450] Loss: 1.4018 (freq: 0.5142, raw: 0.8871, quant: 0.0005, domain: 0.0000) LR: 1.33e-05 
π“ Codebook: 381/1024 (37.2%) Top5:[298,724,893,704,194,890,3,163,317,648,814,940,680,944,714]


π”¬ Encoder Diversity (iter 4450):
  Avg similarity: 0.0978 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 7/100] [Batch 446/669 (66.7%)] [Iter 4460] Loss: 0.9190 (freq: 0.3117, raw: 0.6068, quant: 0.0004, domain: 0.0000) LR: 1.33e-05 
π“ Codebook: 370/1024 (36.1%) Top5:[724,298,893,704,194,317,648,437,680,293,526,163,65,890,940]


π”¬ Encoder Diversity (iter 4460):
  Avg similarity: 0.0921 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 7/100] [Batch 456/669 (68.2%)] [Iter 4470] Loss: 1.2485 (freq: 0.4289, raw: 0.8189, quant: 0.0006, domain: 0.0000) LR: 1.34e-05 
π“ Codebook: 382/1024 (37.3%) Top5:[298,724,893,704,194,496,293,648,976,437,872,399,680,97,940]


π”¬ Encoder Diversity (iter 4470):
  Avg similarity: 0.1464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9134 (0.0=collapsed)
[Epoch 7/100] [Batch 466/669 (69.7%)] [Iter 4480] Loss: 1.0379 (freq: 0.3678, raw: 0.6695, quant: 0.0006, domain: 0.0000) LR: 1.34e-05 
π“ Codebook: 351/1024 (34.3%) Top5:[298,97,399,293,194,704,724,893,976,350,496,679,39,248,648]


π”¬ Encoder Diversity (iter 4480):
  Avg similarity: 0.1028 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9359 (0.0=collapsed)
[Epoch 7/100] [Batch 476/669 (71.2%)] [Iter 4490] Loss: 1.2218 (freq: 0.4653, raw: 0.7560, quant: 0.0005, domain: 0.0000) LR: 1.34e-05 
π“ Codebook: 362/1024 (35.4%) Top5:[893,317,298,194,534,526,704,679,724,163,648,939,39,944,913]


π”¬ Encoder Diversity (iter 4490):
  Avg similarity: 0.0793 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9367 (0.0=collapsed)
[Epoch 7/100] [Batch 486/669 (72.6%)] [Iter 4500] Loss: 1.3519 (freq: 0.5425, raw: 0.8089, quant: 0.0005, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 390/1024 (38.1%) Top5:[893,298,724,194,704,317,39,679,467,680,940,939,714,804,534]


π”¬ Encoder Diversity (iter 4500):
  Avg similarity: 0.1013 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 7/100] [Batch 496/669 (74.1%)] [Iter 4510] Loss: 1.2667 (freq: 0.4640, raw: 0.8021, quant: 0.0006, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 435/1024 (42.5%) Top5:[437,298,939,315,297,317,913,835,33,724,893,65,75,163,534]


π”¬ Encoder Diversity (iter 4510):
  Avg similarity: 0.0600 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 7/100] [Batch 506/669 (75.6%)] [Iter 4520] Loss: 1.3109 (freq: 0.4779, raw: 0.8325, quant: 0.0005, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 429/1024 (41.9%) Top5:[724,298,704,893,194,437,507,65,33,483,317,315,297,939,835]


π”¬ Encoder Diversity (iter 4520):
  Avg similarity: 0.0558 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 7/100] [Batch 516/669 (77.1%)] [Iter 4530] Loss: 1.2105 (freq: 0.4746, raw: 0.7355, quant: 0.0005, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 365/1024 (35.6%) Top5:[855,399,939,534,437,483,3,194,317,60,835,315,507,724,65]


π”¬ Encoder Diversity (iter 4530):
  Avg similarity: 0.1415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9131 (0.0=collapsed)
[Epoch 7/100] [Batch 526/669 (78.6%)] [Iter 4540] Loss: 0.8807 (freq: 0.2971, raw: 0.5832, quant: 0.0004, domain: 0.0000) LR: 1.36e-05 
π“ Codebook: 331/1024 (32.3%) Top5:[724,399,194,704,298,939,274,893,3,648,317,60,496,73,97]


π”¬ Encoder Diversity (iter 4540):
  Avg similarity: 0.1082 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9236 (0.0=collapsed)
[Epoch 7/100] [Batch 536/669 (80.1%)] [Iter 4550] Loss: 1.1525 (freq: 0.4096, raw: 0.7425, quant: 0.0005, domain: 0.0000) LR: 1.36e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[724,298,893,704,437,194,3,939,317,913,648,148,835,297,940]


π”¬ Encoder Diversity (iter 4550):
  Avg similarity: 0.0970 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9252 (0.0=collapsed)
[Epoch 7/100] [Batch 546/669 (81.6%)] [Iter 4560] Loss: 1.2980 (freq: 0.4788, raw: 0.8187, quant: 0.0005, domain: 0.0000) LR: 1.36e-05 
π“ Codebook: 383/1024 (37.4%) Top5:[298,893,704,317,3,939,724,679,437,194,534,680,944,293,173]


π”¬ Encoder Diversity (iter 4560):
  Avg similarity: 0.1077 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9351 (0.0=collapsed)
[Epoch 7/100] [Batch 556/669 (83.1%)] [Iter 4570] Loss: 0.7168 (freq: 0.2032, raw: 0.5132, quant: 0.0005, domain: 0.0000) LR: 1.37e-05 
π“ Codebook: 369/1024 (36.0%) Top5:[893,298,317,3,607,944,913,679,437,939,173,201,704,297,526]


π”¬ Encoder Diversity (iter 4570):
  Avg similarity: 0.1078 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9249 (0.0=collapsed)
[Epoch 7/100] [Batch 566/669 (84.6%)] [Iter 4580] Loss: 1.1882 (freq: 0.4321, raw: 0.7557, quant: 0.0005, domain: 0.0000) LR: 1.37e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[298,893,3,194,724,437,293,317,835,679,607,97,201,372,350]


π”¬ Encoder Diversity (iter 4580):
  Avg similarity: 0.0825 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 7/100] [Batch 576/669 (86.1%)] [Iter 4590] Loss: 1.0365 (freq: 0.3758, raw: 0.6602, quant: 0.0006, domain: 0.0000) LR: 1.37e-05 
π“ Codebook: 374/1024 (36.5%) Top5:[298,65,297,194,483,893,835,724,974,437,526,33,607,728,648]


π”¬ Encoder Diversity (iter 4590):
  Avg similarity: 0.1114 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9345 (0.0=collapsed)
[Epoch 7/100] [Batch 586/669 (87.6%)] [Iter 4600] Loss: 1.1574 (freq: 0.4183, raw: 0.7387, quant: 0.0005, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 410/1024 (40.0%) Top5:[724,298,194,3,648,704,893,526,939,274,317,877,944,607,163]


π”¬ Encoder Diversity (iter 4600):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 7/100] [Batch 596/669 (89.1%)] [Iter 4610] Loss: 1.2820 (freq: 0.4645, raw: 0.8170, quant: 0.0005, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 382/1024 (37.3%) Top5:[298,724,893,297,704,194,835,437,33,863,648,467,728,483,274]


π”¬ Encoder Diversity (iter 4610):
  Avg similarity: 0.0418 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 7/100] [Batch 606/669 (90.6%)] [Iter 4620] Loss: 1.0313 (freq: 0.3581, raw: 0.6728, quant: 0.0004, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 421/1024 (41.1%) Top5:[724,893,298,835,704,297,483,23,437,399,467,372,33,3,728]


π”¬ Encoder Diversity (iter 4620):
  Avg similarity: 0.0837 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9382 (0.0=collapsed)
[Epoch 7/100] [Batch 616/669 (92.1%)] [Iter 4630] Loss: 1.0152 (freq: 0.3486, raw: 0.6661, quant: 0.0005, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 404/1024 (39.5%) Top5:[724,893,298,704,194,97,437,372,349,3,399,317,679,962,73]


π”¬ Encoder Diversity (iter 4630):
  Avg similarity: 0.1065 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9240 (0.0=collapsed)
[Epoch 7/100] [Batch 626/669 (93.6%)] [Iter 4640] Loss: 1.3832 (freq: 0.4998, raw: 0.8828, quant: 0.0006, domain: 0.0000) LR: 1.39e-05 
π“ Codebook: 395/1024 (38.6%) Top5:[893,298,724,704,317,3,939,201,23,371,607,194,293,350,274]


π”¬ Encoder Diversity (iter 4640):
  Avg similarity: 0.0735 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 7/100] [Batch 636/669 (95.1%)] [Iter 4650] Loss: 1.1392 (freq: 0.4610, raw: 0.6777, quant: 0.0005, domain: 0.0000) LR: 1.39e-05 
π“ Codebook: 407/1024 (39.7%) Top5:[97,298,939,350,976,962,399,893,814,317,3,293,804,700,73]


π”¬ Encoder Diversity (iter 4650):
  Avg similarity: 0.0733 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9427 (0.0=collapsed)
[Epoch 7/100] [Batch 646/669 (96.6%)] [Iter 4660] Loss: 1.2090 (freq: 0.4695, raw: 0.7390, quant: 0.0005, domain: 0.0000) LR: 1.39e-05 
π“ Codebook: 388/1024 (37.9%) Top5:[835,297,526,939,33,607,913,148,317,3,483,728,437,507,944]


π”¬ Encoder Diversity (iter 4660):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 7/100] [Batch 656/669 (98.1%)] [Iter 4670] Loss: 0.9401 (freq: 0.3293, raw: 0.6104, quant: 0.0004, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 440/1024 (43.0%) Top5:[724,298,728,893,835,939,297,507,526,317,607,3,940,194,648]


π”¬ Encoder Diversity (iter 4670):
  Avg similarity: 0.0991 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9321 (0.0=collapsed)
[Epoch 7/100] [Batch 666/669 (99.6%)] [Iter 4680] Loss: 1.3410 (freq: 0.5361, raw: 0.8043, quant: 0.0006, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 462/1024 (45.1%) Top5:[724,728,893,65,507,835,33,704,679,298,940,437,372,814,297]


π”¬ Encoder Diversity (iter 4680):
  Avg similarity: 0.0575 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9525 (0.0=collapsed)

================================================================================
[Epoch 7] Validation Results:
  Total Loss: 0.6514
  Freq Loss:  0.2085
  Raw Loss:   0.4425
  Quant Loss: 0.0004
  π“ Codebook Usage: 193/1024 (18.8%)
  π“ Codebook Entropy: 3.9711 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 45616 (35.0%)
  Top 10 most used codes:
    1. Code 65: 5460 times (4.19%)
    2. Code 483: 5422 times (4.16%)
    3. Code 507: 5053 times (3.88%)
    4. Code 201: 4983 times (3.83%)
    5. Code 728: 4947 times (3.80%)
    6. Code 607: 4078 times (3.13%)
    7. Code 863: 4072 times (3.13%)
    8. Code 3: 3939 times (3.03%)
    9. Code 939: 3863 times (2.97%)
    10. Code 437: 3799 times (2.92%)
  Bottom 5 least used codes (among used):
    1. Code 517: 1 times (0.00%)
    2. Code 309: 1 times (0.00%)
    3. Code 649: 1 times (0.00%)
    4. Code 783: 1 times (0.00%)
    5. Code 663: 1 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 7
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 8/100] [Batch 7/669 (1.0%)] [Iter 4690] Loss: 1.2021 (freq: 0.4598, raw: 0.7417, quant: 0.0006, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[65,728,939,201,835,507,317,33,607,814,483,437,297,154,75]


π”¬ Encoder Diversity (iter 4690):
  Avg similarity: 0.1080 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9355 (0.0=collapsed)
[Epoch 8/100] [Batch 17/669 (2.5%)] [Iter 4700] Loss: 1.0731 (freq: 0.3970, raw: 0.6756, quant: 0.0005, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[814,939,201,607,317,507,421,290,794,457,169,905,1013,253,633]


π”¬ Encoder Diversity (iter 4700):
  Avg similarity: 0.1516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9048 (0.0=collapsed)
[Epoch 8/100] [Batch 27/669 (4.0%)] [Iter 4710] Loss: 0.8304 (freq: 0.2871, raw: 0.5429, quant: 0.0004, domain: 0.0000) LR: 1.41e-05 
π“ Codebook: 542/1024 (52.9%) Top5:[939,507,317,33,835,728,65,297,814,944,607,913,315,201,3]


π”¬ Encoder Diversity (iter 4710):
  Avg similarity: 0.0726 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 8/100] [Batch 37/669 (5.5%)] [Iter 4720] Loss: 1.1921 (freq: 0.4617, raw: 0.7299, quant: 0.0005, domain: 0.0000) LR: 1.41e-05 
π“ Codebook: 458/1024 (44.7%) Top5:[939,591,905,814,253,317,571,399,457,799,101,573,421,944,650]


π”¬ Encoder Diversity (iter 4720):
  Avg similarity: 0.0756 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9427 (0.0=collapsed)
[Epoch 8/100] [Batch 47/669 (7.0%)] [Iter 4730] Loss: 1.3421 (freq: 0.5197, raw: 0.8219, quant: 0.0005, domain: 0.0000) LR: 1.41e-05 
π“ Codebook: 426/1024 (41.6%) Top5:[591,253,399,317,571,939,799,944,814,835,290,154,728,849,173]


π”¬ Encoder Diversity (iter 4730):
  Avg similarity: 0.1009 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 8/100] [Batch 57/669 (8.5%)] [Iter 4740] Loss: 1.2670 (freq: 0.4520, raw: 0.8144, quant: 0.0006, domain: 0.0000) LR: 1.42e-05 
π“ Codebook: 393/1024 (38.4%) Top5:[591,355,399,728,799,507,253,594,814,849,437,943,75,33,752]


π”¬ Encoder Diversity (iter 4740):
  Avg similarity: 0.0725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9401 (0.0=collapsed)
[Epoch 8/100] [Batch 67/669 (10.0%)] [Iter 4750] Loss: 1.3434 (freq: 0.5421, raw: 0.8008, quant: 0.0005, domain: 0.0000) LR: 1.42e-05 
π“ Codebook: 366/1024 (35.7%) Top5:[939,33,728,507,571,835,594,317,591,943,437,201,173,526,355]


π”¬ Encoder Diversity (iter 4750):
  Avg similarity: 0.0767 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 8/100] [Batch 77/669 (11.5%)] [Iter 4760] Loss: 0.9333 (freq: 0.3298, raw: 0.6031, quant: 0.0005, domain: 0.0000) LR: 1.42e-05 
π“ Codebook: 417/1024 (40.7%) Top5:[591,355,684,253,943,939,607,588,799,752,507,317,201,814,111]


π”¬ Encoder Diversity (iter 4760):
  Avg similarity: 0.1140 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9275 (0.0=collapsed)
[Epoch 8/100] [Batch 87/669 (13.0%)] [Iter 4770] Loss: 1.0737 (freq: 0.3912, raw: 0.6820, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 409/1024 (39.9%) Top5:[355,591,814,253,939,317,746,588,607,943,684,832,421,260,752]


π”¬ Encoder Diversity (iter 4770):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 8/100] [Batch 97/669 (14.5%)] [Iter 4780] Loss: 1.1688 (freq: 0.4167, raw: 0.7516, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 421/1024 (41.1%) Top5:[355,591,507,684,814,594,253,70,315,437,835,573,483,33,881]


π”¬ Encoder Diversity (iter 4780):
  Avg similarity: 0.1297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9131 (0.0=collapsed)
[Epoch 8/100] [Batch 107/669 (16.0%)] [Iter 4790] Loss: 1.4304 (freq: 0.5635, raw: 0.8663, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 405/1024 (39.6%) Top5:[355,507,591,728,65,437,684,111,75,297,33,835,70,814,315]


π”¬ Encoder Diversity (iter 4790):
  Avg similarity: 0.0800 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9491 (0.0=collapsed)
[Epoch 8/100] [Batch 117/669 (17.5%)] [Iter 4800] Loss: 0.9751 (freq: 0.3251, raw: 0.6495, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 451/1024 (44.0%) Top5:[317,939,201,591,571,607,173,45,163,3,752,154,169,355,437]


π”¬ Encoder Diversity (iter 4800):
  Avg similarity: 0.1110 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 8/100] [Batch 127/669 (19.0%)] [Iter 4810] Loss: 1.2478 (freq: 0.4664, raw: 0.7806, quant: 0.0008, domain: 0.0000) LR: 1.44e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[317,939,355,591,201,571,101,253,164,154,943,425,814,371,260]


π”¬ Encoder Diversity (iter 4810):
  Avg similarity: 0.0693 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 8/100] [Batch 137/669 (20.5%)] [Iter 4820] Loss: 0.7633 (freq: 0.2529, raw: 0.5099, quant: 0.0004, domain: 0.0000) LR: 1.44e-05 
π“ Codebook: 450/1024 (43.9%) Top5:[939,45,297,507,154,317,571,355,315,591,201,835,913,944,253]


π”¬ Encoder Diversity (iter 4820):
  Avg similarity: 0.0978 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9320 (0.0=collapsed)
[Epoch 8/100] [Batch 147/669 (22.0%)] [Iter 4830] Loss: 1.3683 (freq: 0.5757, raw: 0.7922, quant: 0.0005, domain: 0.0000) LR: 1.44e-05 
π“ Codebook: 422/1024 (41.2%) Top5:[507,835,814,522,297,33,65,913,101,164,45,62,437,355,728]


π”¬ Encoder Diversity (iter 4830):
  Avg similarity: 0.1374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9284 (0.0=collapsed)
[Epoch 8/100] [Batch 157/669 (23.5%)] [Iter 4840] Loss: 1.3588 (freq: 0.4729, raw: 0.8853, quant: 0.0006, domain: 0.0000) LR: 1.45e-05 
π“ Codebook: 407/1024 (39.7%) Top5:[355,591,483,253,297,65,835,111,934,45,399,650,260,70,522]


π”¬ Encoder Diversity (iter 4840):
  Avg similarity: 0.1116 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9218 (0.0=collapsed)
[Epoch 8/100] [Batch 167/669 (25.0%)] [Iter 4850] Loss: 1.5735 (freq: 0.6274, raw: 0.9455, quant: 0.0005, domain: 0.0000) LR: 1.45e-05 
π“ Codebook: 389/1024 (38.0%) Top5:[355,943,650,591,399,297,904,58,814,315,483,526,769,1003,684]


π”¬ Encoder Diversity (iter 4850):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9490 (0.0=collapsed)
[Epoch 8/100] [Batch 177/669 (26.5%)] [Iter 4860] Loss: 0.8394 (freq: 0.2920, raw: 0.5470, quant: 0.0004, domain: 0.0000) LR: 1.45e-05 
π“ Codebook: 403/1024 (39.4%) Top5:[526,317,571,201,939,148,607,45,154,173,355,169,534,75,591]


π”¬ Encoder Diversity (iter 4860):
  Avg similarity: 0.0678 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9406 (0.0=collapsed)
[Epoch 8/100] [Batch 187/669 (28.0%)] [Iter 4870] Loss: 1.2339 (freq: 0.4867, raw: 0.7466, quant: 0.0006, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 406/1024 (39.6%) Top5:[355,399,904,591,201,571,421,317,650,684,253,75,297,752,849]


π”¬ Encoder Diversity (iter 4870):
  Avg similarity: 0.1388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9273 (0.0=collapsed)
[Epoch 8/100] [Batch 197/669 (29.4%)] [Iter 4880] Loss: 1.1039 (freq: 0.4230, raw: 0.6804, quant: 0.0005, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 466/1024 (45.5%) Top5:[201,317,814,684,939,591,522,164,101,111,799,260,571,45,70]


π”¬ Encoder Diversity (iter 4880):
  Avg similarity: 0.0932 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9423 (0.0=collapsed)
[Epoch 8/100] [Batch 207/669 (30.9%)] [Iter 4890] Loss: 1.0380 (freq: 0.3531, raw: 0.6844, quant: 0.0005, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 445/1024 (43.5%) Top5:[588,260,111,858,62,431,101,814,799,522,164,317,591,538,201]


π”¬ Encoder Diversity (iter 4890):
  Avg similarity: 0.0911 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9406 (0.0=collapsed)
[Epoch 8/100] [Batch 217/669 (32.4%)] [Iter 4900] Loss: 1.1571 (freq: 0.4229, raw: 0.7336, quant: 0.0005, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 391/1024 (38.2%) Top5:[355,111,591,684,317,588,939,201,571,431,799,814,70,752,253]


π”¬ Encoder Diversity (iter 4900):
  Avg similarity: 0.1306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9310 (0.0=collapsed)
[Epoch 8/100] [Batch 227/669 (33.9%)] [Iter 4910] Loss: 0.8724 (freq: 0.2932, raw: 0.5787, quant: 0.0004, domain: 0.0000) LR: 1.47e-05 
π“ Codebook: 410/1024 (40.0%) Top5:[355,591,752,111,746,943,769,280,814,227,49,315,399,507,522]


π”¬ Encoder Diversity (iter 4910):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9418 (0.0=collapsed)
[Epoch 8/100] [Batch 237/669 (35.4%)] [Iter 4920] Loss: 1.4253 (freq: 0.5467, raw: 0.8780, quant: 0.0006, domain: 0.0000) LR: 1.47e-05 
π“ Codebook: 422/1024 (41.2%) Top5:[591,355,943,835,752,297,111,790,280,746,769,594,65,399,253]


π”¬ Encoder Diversity (iter 4920):
  Avg similarity: 0.0905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9446 (0.0=collapsed)
[Epoch 8/100] [Batch 247/669 (36.9%)] [Iter 4930] Loss: 0.8999 (freq: 0.3067, raw: 0.5928, quant: 0.0004, domain: 0.0000) LR: 1.47e-05 
π“ Codebook: 413/1024 (40.3%) Top5:[591,355,45,280,594,297,437,111,65,33,835,317,507,483,315]


π”¬ Encoder Diversity (iter 4930):
  Avg similarity: 0.0994 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9325 (0.0=collapsed)
[Epoch 8/100] [Batch 257/669 (38.4%)] [Iter 4940] Loss: 1.0355 (freq: 0.3657, raw: 0.6693, quant: 0.0004, domain: 0.0000) LR: 1.48e-05 
π“ Codebook: 447/1024 (43.7%) Top5:[591,297,280,111,835,355,45,684,594,70,315,507,33,951,573]


π”¬ Encoder Diversity (iter 4940):
  Avg similarity: 0.1091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9216 (0.0=collapsed)
[Epoch 8/100] [Batch 267/669 (39.9%)] [Iter 4950] Loss: 1.5956 (freq: 0.6750, raw: 0.9201, quant: 0.0006, domain: 0.0000) LR: 1.48e-05 
π“ Codebook: 435/1024 (42.5%) Top5:[355,591,111,684,944,101,317,70,45,571,814,650,904,421,201]


π”¬ Encoder Diversity (iter 4950):
  Avg similarity: 0.0943 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9333 (0.0=collapsed)
[Epoch 8/100] [Batch 277/669 (41.4%)] [Iter 4960] Loss: 1.2969 (freq: 0.5004, raw: 0.7960, quant: 0.0005, domain: 0.0000) LR: 1.48e-05 
π“ Codebook: 445/1024 (43.5%) Top5:[591,201,355,814,111,315,684,217,835,944,571,280,939,317,164]


π”¬ Encoder Diversity (iter 4960):
  Avg similarity: 0.1299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9293 (0.0=collapsed)
[Epoch 8/100] [Batch 287/669 (42.9%)] [Iter 4970] Loss: 1.1812 (freq: 0.4285, raw: 0.7522, quant: 0.0005, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 446/1024 (43.6%) Top5:[280,591,315,355,944,297,317,507,904,849,752,45,33,75,111]


π”¬ Encoder Diversity (iter 4970):
  Avg similarity: 0.0816 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9381 (0.0=collapsed)
[Epoch 8/100] [Batch 297/669 (44.4%)] [Iter 4980] Loss: 1.3537 (freq: 0.4872, raw: 0.8657, quant: 0.0008, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 478/1024 (46.7%) Top5:[355,201,939,317,904,684,111,571,591,371,849,70,607,253,173]


π”¬ Encoder Diversity (iter 4980):
  Avg similarity: 0.0568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 8/100] [Batch 307/669 (45.9%)] [Iter 4990] Loss: 1.1934 (freq: 0.4354, raw: 0.7575, quant: 0.0005, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 457/1024 (44.6%) Top5:[355,280,944,684,317,752,904,253,315,297,571,111,835,70,650]


π”¬ Encoder Diversity (iter 4990):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9484 (0.0=collapsed)
[Epoch 8/100] [Batch 317/669 (47.4%)] [Iter 5000] Loss: 1.0080 (freq: 0.3434, raw: 0.6641, quant: 0.0005, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 449/1024 (43.8%) Top5:[483,315,280,317,33,65,835,297,944,594,939,437,154,45,201]


π”¬ Encoder Diversity (iter 5000):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9478 (0.0=collapsed)
[Epoch 8/100] [Batch 327/669 (48.9%)] [Iter 5010] Loss: 1.1867 (freq: 0.4613, raw: 0.7249, quant: 0.0005, domain: 0.0000) LR: 1.50e-05 
π“ Codebook: 477/1024 (46.6%) Top5:[317,253,315,939,154,814,62,858,944,371,280,297,682,594,943]


π”¬ Encoder Diversity (iter 5010):
  Avg similarity: 0.0869 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9267 (0.0=collapsed)
[Epoch 8/100] [Batch 337/669 (50.4%)] [Iter 5020] Loss: 1.4677 (freq: 0.5776, raw: 0.8895, quant: 0.0006, domain: 0.0000) LR: 1.50e-05 
π“ Codebook: 468/1024 (45.7%) Top5:[355,164,317,522,939,814,752,253,944,70,101,280,943,422,746]


π”¬ Encoder Diversity (iter 5020):
  Avg similarity: 0.1002 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9363 (0.0=collapsed)
[Epoch 8/100] [Batch 347/669 (51.9%)] [Iter 5030] Loss: 1.2923 (freq: 0.5004, raw: 0.7914, quant: 0.0006, domain: 0.0000) LR: 1.50e-05 
π“ Codebook: 444/1024 (43.4%) Top5:[591,253,355,684,650,944,70,814,522,260,594,421,212,62,399]


π”¬ Encoder Diversity (iter 5030):
  Avg similarity: 0.0826 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 8/100] [Batch 357/669 (53.4%)] [Iter 5040] Loss: 1.3043 (freq: 0.4828, raw: 0.8209, quant: 0.0005, domain: 0.0000) LR: 1.51e-05 
π“ Codebook: 438/1024 (42.8%) Top5:[355,591,253,684,45,70,111,939,944,835,315,881,507,154,280]


π”¬ Encoder Diversity (iter 5040):
  Avg similarity: 0.0974 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 8/100] [Batch 367/669 (54.9%)] [Iter 5050] Loss: 1.1751 (freq: 0.4483, raw: 0.7263, quant: 0.0005, domain: 0.0000) LR: 1.51e-05 
π“ Codebook: 467/1024 (45.6%) Top5:[355,591,45,253,317,315,752,594,297,849,904,33,943,371,650]


π”¬ Encoder Diversity (iter 5050):
  Avg similarity: 0.0623 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9485 (0.0=collapsed)
[Epoch 8/100] [Batch 377/669 (56.4%)] [Iter 5060] Loss: 1.1680 (freq: 0.4459, raw: 0.7215, quant: 0.0005, domain: 0.0000) LR: 1.51e-05 
π“ Codebook: 460/1024 (44.9%) Top5:[317,371,154,591,201,70,45,944,939,111,173,607,355,522,253]


π”¬ Encoder Diversity (iter 5060):
  Avg similarity: 0.0691 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 8/100] [Batch 387/669 (57.8%)] [Iter 5070] Loss: 1.0608 (freq: 0.3936, raw: 0.6667, quant: 0.0005, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 429/1024 (41.9%) Top5:[317,939,154,746,315,858,45,75,33,65,522,591,253,849,588]


π”¬ Encoder Diversity (iter 5070):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9551 (0.0=collapsed)
[Epoch 8/100] [Batch 397/669 (59.3%)] [Iter 5080] Loss: 1.2477 (freq: 0.4380, raw: 0.8092, quant: 0.0005, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 452/1024 (44.1%) Top5:[315,33,65,317,253,437,507,297,111,594,835,154,483,871,266]


π”¬ Encoder Diversity (iter 5080):
  Avg similarity: 0.0746 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9476 (0.0=collapsed)
[Epoch 8/100] [Batch 407/669 (60.8%)] [Iter 5090] Loss: 1.0188 (freq: 0.3377, raw: 0.6806, quant: 0.0004, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 464/1024 (45.3%) Top5:[253,317,431,939,154,70,858,371,650,260,591,355,943,684,149]


π”¬ Encoder Diversity (iter 5090):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 8/100] [Batch 417/669 (62.3%)] [Iter 5100] Loss: 1.3143 (freq: 0.4965, raw: 0.8172, quant: 0.0006, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 445/1024 (43.5%) Top5:[684,253,70,939,154,317,591,111,943,260,101,371,45,164,633]


π”¬ Encoder Diversity (iter 5100):
  Avg similarity: 0.1330 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9276 (0.0=collapsed)
[Epoch 8/100] [Batch 427/669 (63.8%)] [Iter 5110] Loss: 1.1177 (freq: 0.4621, raw: 0.6550, quant: 0.0005, domain: 0.0000) LR: 1.53e-05 
π“ Codebook: 435/1024 (42.5%) Top5:[317,939,253,591,944,212,371,746,399,558,943,149,355,522,101]


π”¬ Encoder Diversity (iter 5110):
  Avg similarity: 0.1000 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9349 (0.0=collapsed)
[Epoch 8/100] [Batch 437/669 (65.3%)] [Iter 5120] Loss: 1.1699 (freq: 0.4223, raw: 0.7471, quant: 0.0005, domain: 0.0000) LR: 1.53e-05 
π“ Codebook: 413/1024 (40.3%) Top5:[355,591,752,944,253,45,835,75,849,746,594,1004,317,280,154]


π”¬ Encoder Diversity (iter 5120):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 8/100] [Batch 447/669 (66.8%)] [Iter 5130] Loss: 1.1977 (freq: 0.4638, raw: 0.7334, quant: 0.0005, domain: 0.0000) LR: 1.53e-05 
π“ Codebook: 438/1024 (42.8%) Top5:[355,591,752,746,253,1004,835,65,226,594,944,45,849,522,399]


π”¬ Encoder Diversity (iter 5130):
  Avg similarity: 0.0658 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9507 (0.0=collapsed)
[Epoch 8/100] [Batch 457/669 (68.3%)] [Iter 5140] Loss: 1.2397 (freq: 0.4864, raw: 0.7528, quant: 0.0005, domain: 0.0000) LR: 1.54e-05 
π“ Codebook: 406/1024 (39.6%) Top5:[939,317,154,944,201,45,371,571,835,594,607,355,173,534,297]


π”¬ Encoder Diversity (iter 5140):
  Avg similarity: 0.1110 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9315 (0.0=collapsed)
[Epoch 8/100] [Batch 467/669 (69.8%)] [Iter 5150] Loss: 1.2534 (freq: 0.4600, raw: 0.7929, quant: 0.0005, domain: 0.0000) LR: 1.54e-05 
π“ Codebook: 472/1024 (46.1%) Top5:[70,317,371,939,355,684,944,591,75,173,421,45,154,431,297]


π”¬ Encoder Diversity (iter 5150):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 8/100] [Batch 477/669 (71.3%)] [Iter 5160] Loss: 1.3599 (freq: 0.5642, raw: 0.7951, quant: 0.0006, domain: 0.0000) LR: 1.54e-05 
π“ Codebook: 489/1024 (47.8%) Top5:[591,70,684,33,227,65,355,253,1003,746,650,849,633,297,101]


π”¬ Encoder Diversity (iter 5160):
  Avg similarity: 0.0745 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9407 (0.0=collapsed)
[Epoch 8/100] [Batch 487/669 (72.8%)] [Iter 5170] Loss: 1.3021 (freq: 0.4846, raw: 0.8169, quant: 0.0005, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 486/1024 (47.5%) Top5:[317,939,591,684,154,253,70,633,371,355,294,45,909,260,573]


π”¬ Encoder Diversity (iter 5170):
  Avg similarity: 0.0834 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9410 (0.0=collapsed)
[Epoch 8/100] [Batch 497/669 (74.3%)] [Iter 5180] Loss: 1.1821 (freq: 0.4383, raw: 0.7433, quant: 0.0005, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[294,939,944,317,154,45,101,650,355,75,164,399,201,212,173]


π”¬ Encoder Diversity (iter 5180):
  Avg similarity: 0.0930 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9316 (0.0=collapsed)
[Epoch 8/100] [Batch 507/669 (75.8%)] [Iter 5190] Loss: 0.8973 (freq: 0.2917, raw: 0.6051, quant: 0.0004, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 411/1024 (40.1%) Top5:[591,355,253,317,944,746,939,684,70,594,45,650,154,212,111]


π”¬ Encoder Diversity (iter 5190):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 8/100] [Batch 517/669 (77.3%)] [Iter 5200] Loss: 1.3679 (freq: 0.5382, raw: 0.8290, quant: 0.0007, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 444/1024 (43.4%) Top5:[591,746,835,594,33,944,1004,101,814,253,45,684,557,522,507]


π”¬ Encoder Diversity (iter 5200):
  Avg similarity: 0.0905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9376 (0.0=collapsed)
[Epoch 8/100] [Batch 527/669 (78.8%)] [Iter 5210] Loss: 1.0179 (freq: 0.3605, raw: 0.6570, quant: 0.0005, domain: 0.0000) LR: 1.56e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[591,355,111,684,70,752,253,226,835,45,317,33,522,746,421]


π”¬ Encoder Diversity (iter 5210):
  Avg similarity: 0.0760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9424 (0.0=collapsed)
[Epoch 8/100] [Batch 537/669 (80.3%)] [Iter 5220] Loss: 1.2365 (freq: 0.4379, raw: 0.7980, quant: 0.0005, domain: 0.0000) LR: 1.56e-05 
π“ Codebook: 476/1024 (46.5%) Top5:[591,746,835,111,70,317,33,507,45,944,65,684,154,226,939]


π”¬ Encoder Diversity (iter 5220):
  Avg similarity: 0.0809 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9426 (0.0=collapsed)
[Epoch 8/100] [Batch 547/669 (81.8%)] [Iter 5230] Loss: 0.7793 (freq: 0.2388, raw: 0.5401, quant: 0.0004, domain: 0.0000) LR: 1.56e-05 
π“ Codebook: 488/1024 (47.7%) Top5:[591,746,70,684,111,315,752,507,871,835,33,1004,65,355,297]


π”¬ Encoder Diversity (iter 5230):
  Avg similarity: 0.0874 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9376 (0.0=collapsed)
[Epoch 8/100] [Batch 557/669 (83.3%)] [Iter 5240] Loss: 1.3495 (freq: 0.5406, raw: 0.8084, quant: 0.0005, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 486/1024 (47.5%) Top5:[944,591,752,317,355,253,939,70,111,154,814,613,849,684,226]


π”¬ Encoder Diversity (iter 5240):
  Avg similarity: 0.1117 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9315 (0.0=collapsed)
[Epoch 8/100] [Batch 567/669 (84.8%)] [Iter 5250] Loss: 1.1312 (freq: 0.4008, raw: 0.7297, quant: 0.0006, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 506/1024 (49.4%) Top5:[746,591,814,111,253,752,70,164,355,858,101,769,226,62,507]


π”¬ Encoder Diversity (iter 5250):
  Avg similarity: 0.0543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 8/100] [Batch 577/669 (86.2%)] [Iter 5260] Loss: 0.7405 (freq: 0.2164, raw: 0.5237, quant: 0.0004, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 434/1024 (42.4%) Top5:[944,557,507,45,317,315,939,594,835,75,371,33,154,613,682]


π”¬ Encoder Diversity (iter 5260):
  Avg similarity: 0.0842 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9257 (0.0=collapsed)
[Epoch 8/100] [Batch 587/669 (87.7%)] [Iter 5270] Loss: 1.2413 (freq: 0.4346, raw: 0.8062, quant: 0.0005, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 434/1024 (42.4%) Top5:[591,944,939,835,746,557,943,355,507,594,253,45,871,752,164]


π”¬ Encoder Diversity (iter 5270):
  Avg similarity: 0.1038 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9345 (0.0=collapsed)
[Epoch 8/100] [Batch 597/669 (89.2%)] [Iter 5280] Loss: 1.0414 (freq: 0.3767, raw: 0.6643, quant: 0.0005, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 455/1024 (44.4%) Top5:[591,944,355,939,507,594,557,650,253,880,975,399,835,201,101]


π”¬ Encoder Diversity (iter 5280):
  Avg similarity: 0.0614 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9473 (0.0=collapsed)
[Epoch 8/100] [Batch 607/669 (90.7%)] [Iter 5290] Loss: 1.4286 (freq: 0.5827, raw: 0.8452, quant: 0.0006, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 426/1024 (41.6%) Top5:[591,814,849,355,507,835,594,425,944,253,752,746,399,557,86]


π”¬ Encoder Diversity (iter 5290):
  Avg similarity: 0.0915 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9343 (0.0=collapsed)
[Epoch 8/100] [Batch 617/669 (92.2%)] [Iter 5300] Loss: 1.2634 (freq: 0.4511, raw: 0.8116, quant: 0.0006, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 437/1024 (42.7%) Top5:[355,752,591,849,70,650,835,507,594,164,226,633,522,588,909]


π”¬ Encoder Diversity (iter 5300):
  Avg similarity: 0.0894 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 8/100] [Batch 627/669 (93.7%)] [Iter 5310] Loss: 1.3936 (freq: 0.5494, raw: 0.8436, quant: 0.0006, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 451/1024 (44.0%) Top5:[746,814,507,355,591,684,1003,594,522,164,557,101,70,943,317]


π”¬ Encoder Diversity (iter 5310):
  Avg similarity: 0.1145 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9294 (0.0=collapsed)
[Epoch 8/100] [Batch 637/669 (95.2%)] [Iter 5320] Loss: 1.5665 (freq: 0.6240, raw: 0.9420, quant: 0.0006, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 406/1024 (39.6%) Top5:[591,594,266,111,684,507,70,567,569,253,1003,355,943,746,557]


π”¬ Encoder Diversity (iter 5320):
  Avg similarity: 0.0841 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9194 (0.0=collapsed)
[Epoch 8/100] [Batch 647/669 (96.7%)] [Iter 5330] Loss: 1.2471 (freq: 0.4363, raw: 0.8102, quant: 0.0007, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 420/1024 (41.0%) Top5:[746,111,943,569,814,253,1003,382,49,591,594,1013,858,70,567]


π”¬ Encoder Diversity (iter 5330):
  Avg similarity: 0.1477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9160 (0.0=collapsed)
[Epoch 8/100] [Batch 657/669 (98.2%)] [Iter 5340] Loss: 1.4285 (freq: 0.5613, raw: 0.8667, quant: 0.0005, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 385/1024 (37.6%) Top5:[591,746,111,939,154,253,355,943,317,588,1003,650,1013,684,70]


π”¬ Encoder Diversity (iter 5340):
  Avg similarity: 0.0551 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 8/100] [Batch 667/669 (99.7%)] [Iter 5350] Loss: 1.0121 (freq: 0.3462, raw: 0.6654, quant: 0.0005, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 397/1024 (38.8%) Top5:[939,75,591,594,944,746,111,557,613,835,154,507,943,317,849]


π”¬ Encoder Diversity (iter 5350):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)

================================================================================
[Epoch 8] Validation Results:
  Total Loss: 0.6301
  Freq Loss:  0.1963
  Raw Loss:   0.4333
  Quant Loss: 0.0005
  π“ Codebook Usage: 147/1024 (14.4%)
  π“ Codebook Entropy: 3.9688 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 42793 (32.9%)
  Top 10 most used codes:
    1. Code 835: 5525 times (4.24%)
    2. Code 594: 5114 times (3.93%)
    3. Code 65: 4763 times (3.66%)
    4. Code 154: 4414 times (3.39%)
    5. Code 613: 4061 times (3.12%)
    6. Code 75: 3994 times (3.07%)
    7. Code 266: 3889 times (2.99%)
    8. Code 317: 3761 times (2.89%)
    9. Code 1004: 3657 times (2.81%)
    10. Code 557: 3615 times (2.78%)
  Bottom 5 least used codes (among used):
    1. Code 894: 5 times (0.00%)
    2. Code 117: 7 times (0.01%)
    3. Code 35: 7 times (0.01%)
    4. Code 162: 7 times (0.01%)
    5. Code 111: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 8
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 9/100] [Batch 8/669 (1.2%)] [Iter 5360] Loss: 1.5183 (freq: 0.5632, raw: 0.9544, quant: 0.0006, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 946/1024 (92.4%) Top5:[944,594,154,835,75,66,557,939,45,33,613,880,507,317,756]


π”¬ Encoder Diversity (iter 5360):
  Avg similarity: 0.0848 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)
[Epoch 9/100] [Batch 18/669 (2.7%)] [Iter 5370] Loss: 1.3015 (freq: 0.5189, raw: 0.7821, quant: 0.0005, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[111,846,594,944,75,835,756,476,880,444,557,507,33,728,45]


π”¬ Encoder Diversity (iter 5370):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9465 (0.0=collapsed)
[Epoch 9/100] [Batch 28/669 (4.2%)] [Iter 5380] Loss: 1.1805 (freq: 0.4370, raw: 0.7430, quant: 0.0005, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 550/1024 (53.7%) Top5:[880,835,939,944,154,613,45,111,75,66,594,975,710,507,476]


π”¬ Encoder Diversity (iter 5380):
  Avg similarity: 0.0787 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9402 (0.0=collapsed)
[Epoch 9/100] [Batch 38/669 (5.7%)] [Iter 5390] Loss: 1.1777 (freq: 0.4342, raw: 0.7430, quant: 0.0005, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 488/1024 (47.7%) Top5:[880,154,975,939,613,201,45,317,770,944,66,111,173,221,75]


π”¬ Encoder Diversity (iter 5390):
  Avg similarity: 0.0504 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 9/100] [Batch 48/669 (7.2%)] [Iter 5400] Loss: 1.2827 (freq: 0.4577, raw: 0.8244, quant: 0.0005, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 426/1024 (41.6%) Top5:[835,373,33,1004,440,375,880,399,594,756,111,567,708,846,45]


π”¬ Encoder Diversity (iter 5400):
  Avg similarity: 0.1089 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9397 (0.0=collapsed)
[Epoch 9/100] [Batch 58/669 (8.7%)] [Iter 5410] Loss: 1.2955 (freq: 0.5068, raw: 0.7882, quant: 0.0005, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 458/1024 (44.7%) Top5:[317,154,594,835,33,373,880,75,201,975,1004,45,549,939,770]


π”¬ Encoder Diversity (iter 5410):
  Avg similarity: 0.0706 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9439 (0.0=collapsed)
[Epoch 9/100] [Batch 68/669 (10.2%)] [Iter 5420] Loss: 1.2447 (freq: 0.4449, raw: 0.7992, quant: 0.0005, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 433/1024 (42.3%) Top5:[594,111,373,835,818,444,944,573,814,516,846,461,1004,557,33]


π”¬ Encoder Diversity (iter 5420):
  Avg similarity: 0.0912 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 9/100] [Batch 78/669 (11.7%)] [Iter 5430] Loss: 1.2765 (freq: 0.4695, raw: 0.8064, quant: 0.0005, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 406/1024 (39.6%) Top5:[154,549,317,111,476,880,975,201,846,835,800,45,66,516,944]


π”¬ Encoder Diversity (iter 5430):
  Avg similarity: 0.1338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9167 (0.0=collapsed)
[Epoch 9/100] [Batch 88/669 (13.2%)] [Iter 5440] Loss: 1.2052 (freq: 0.4809, raw: 0.7239, quant: 0.0005, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 452/1024 (44.1%) Top5:[573,818,557,440,399,476,944,594,835,65,375,452,492,111,846]


π”¬ Encoder Diversity (iter 5440):
  Avg similarity: 0.0809 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9408 (0.0=collapsed)
[Epoch 9/100] [Batch 98/669 (14.6%)] [Iter 5450] Loss: 1.2992 (freq: 0.4905, raw: 0.8082, quant: 0.0005, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 422/1024 (41.2%) Top5:[476,846,835,557,444,549,944,373,868,33,399,154,516,144,196]


π”¬ Encoder Diversity (iter 5450):
  Avg similarity: 0.1017 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9395 (0.0=collapsed)
[Epoch 9/100] [Batch 108/669 (16.1%)] [Iter 5460] Loss: 1.0447 (freq: 0.3646, raw: 0.6796, quant: 0.0005, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 426/1024 (41.6%) Top5:[944,154,939,846,880,557,835,594,173,221,476,317,516,75,201]


π”¬ Encoder Diversity (iter 5460):
  Avg similarity: 0.1070 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9393 (0.0=collapsed)
[Epoch 9/100] [Batch 118/669 (17.6%)] [Iter 5470] Loss: 1.1114 (freq: 0.3830, raw: 0.7279, quant: 0.0005, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 454/1024 (44.3%) Top5:[835,594,516,756,944,557,33,846,1004,266,549,644,507,476,728]


π”¬ Encoder Diversity (iter 5470):
  Avg similarity: 0.0973 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9317 (0.0=collapsed)
[Epoch 9/100] [Batch 128/669 (19.1%)] [Iter 5480] Loss: 1.1383 (freq: 0.3784, raw: 0.7594, quant: 0.0005, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 432/1024 (42.2%) Top5:[516,154,846,880,835,373,549,476,939,975,317,944,461,440,196]


π”¬ Encoder Diversity (iter 5480):
  Avg similarity: 0.0922 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9336 (0.0=collapsed)
[Epoch 9/100] [Batch 138/669 (20.6%)] [Iter 5490] Loss: 1.1438 (freq: 0.4287, raw: 0.7145, quant: 0.0006, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 443/1024 (43.3%) Top5:[835,594,33,944,154,939,880,75,45,507,297,1004,266,557,65]


π”¬ Encoder Diversity (iter 5490):
  Avg similarity: 0.0420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9468 (0.0=collapsed)
[Epoch 9/100] [Batch 148/669 (22.1%)] [Iter 5500] Loss: 1.1378 (freq: 0.4040, raw: 0.7333, quant: 0.0005, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 478/1024 (46.7%) Top5:[476,846,549,373,921,594,444,461,604,33,801,452,818,567,625]


π”¬ Encoder Diversity (iter 5500):
  Avg similarity: 0.0496 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 9/100] [Batch 158/669 (23.6%)] [Iter 5510] Loss: 1.2558 (freq: 0.4570, raw: 0.7982, quant: 0.0005, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 473/1024 (46.2%) Top5:[835,33,567,557,944,1004,846,45,625,75,607,756,644,507,594]


π”¬ Encoder Diversity (iter 5510):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9525 (0.0=collapsed)
[Epoch 9/100] [Batch 168/669 (25.1%)] [Iter 5520] Loss: 1.1537 (freq: 0.4285, raw: 0.7247, quant: 0.0005, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 448/1024 (43.8%) Top5:[835,594,557,604,65,476,1004,549,154,944,516,880,201,846,33]


π”¬ Encoder Diversity (iter 5520):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9479 (0.0=collapsed)
[Epoch 9/100] [Batch 178/669 (26.6%)] [Iter 5530] Loss: 1.1358 (freq: 0.4098, raw: 0.7255, quant: 0.0005, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 469/1024 (45.8%) Top5:[835,594,516,549,557,818,452,800,944,297,154,373,33,236,75]


π”¬ Encoder Diversity (iter 5530):
  Avg similarity: 0.0487 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9491 (0.0=collapsed)
[Epoch 9/100] [Batch 188/669 (28.1%)] [Iter 5540] Loss: 1.3128 (freq: 0.5182, raw: 0.7940, quant: 0.0005, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 482/1024 (47.1%) Top5:[835,939,594,944,154,557,75,201,975,880,66,317,516,492,297]


π”¬ Encoder Diversity (iter 5540):
  Avg similarity: 0.1058 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9244 (0.0=collapsed)
[Epoch 9/100] [Batch 198/669 (29.6%)] [Iter 5550] Loss: 1.0450 (freq: 0.3752, raw: 0.6693, quant: 0.0005, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 491/1024 (47.9%) Top5:[594,33,835,759,557,144,573,461,75,65,221,1004,549,801,507]


π”¬ Encoder Diversity (iter 5550):
  Avg similarity: 0.0650 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9495 (0.0=collapsed)
[Epoch 9/100] [Batch 208/669 (31.1%)] [Iter 5560] Loss: 1.4172 (freq: 0.5319, raw: 0.8848, quant: 0.0005, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 472/1024 (46.1%) Top5:[154,939,846,201,317,75,476,613,66,221,770,975,516,604,549]


π”¬ Encoder Diversity (iter 5560):
  Avg similarity: 0.0959 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9358 (0.0=collapsed)
[Epoch 9/100] [Batch 218/669 (32.6%)] [Iter 5570] Loss: 1.2890 (freq: 0.4674, raw: 0.8211, quant: 0.0005, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 398/1024 (38.9%) Top5:[846,549,476,373,516,604,444,800,801,868,668,160,201,770,461]


π”¬ Encoder Diversity (iter 5570):
  Avg similarity: 0.0853 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9347 (0.0=collapsed)
[Epoch 9/100] [Batch 228/669 (34.1%)] [Iter 5580] Loss: 1.2419 (freq: 0.4463, raw: 0.7950, quant: 0.0005, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 482/1024 (47.1%) Top5:[507,880,944,835,549,375,154,939,594,452,373,557,800,440,144]


π”¬ Encoder Diversity (iter 5580):
  Avg similarity: 0.1037 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9276 (0.0=collapsed)
[Epoch 9/100] [Batch 238/669 (35.6%)] [Iter 5590] Loss: 1.4500 (freq: 0.5769, raw: 0.8725, quant: 0.0005, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 482/1024 (47.1%) Top5:[516,800,835,549,1004,111,461,375,373,444,846,252,880,440,557]


π”¬ Encoder Diversity (iter 5590):
  Avg similarity: 0.1014 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9227 (0.0=collapsed)
[Epoch 9/100] [Batch 248/669 (37.1%)] [Iter 5600] Loss: 1.2788 (freq: 0.4712, raw: 0.8070, quant: 0.0005, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 447/1024 (43.7%) Top5:[880,835,944,557,516,594,549,452,373,846,461,111,45,975,66]


π”¬ Encoder Diversity (iter 5600):
  Avg similarity: 0.0666 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9411 (0.0=collapsed)
[Epoch 9/100] [Batch 258/669 (38.6%)] [Iter 5610] Loss: 1.0666 (freq: 0.3996, raw: 0.6665, quant: 0.0005, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 441/1024 (43.1%) Top5:[573,516,939,476,944,846,880,452,549,835,975,814,373,111,818]


π”¬ Encoder Diversity (iter 5610):
  Avg similarity: 0.0601 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 9/100] [Batch 268/669 (40.1%)] [Iter 5620] Loss: 1.5391 (freq: 0.6151, raw: 0.9235, quant: 0.0006, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 478/1024 (46.7%) Top5:[939,154,944,835,476,846,975,594,880,373,66,196,45,75,644]


π”¬ Encoder Diversity (iter 5620):
  Avg similarity: 0.0612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9421 (0.0=collapsed)
[Epoch 9/100] [Batch 278/669 (41.6%)] [Iter 5630] Loss: 1.2490 (freq: 0.4532, raw: 0.7952, quant: 0.0006, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[939,154,801,549,476,880,66,975,708,604,373,160,440,818,75]


π”¬ Encoder Diversity (iter 5630):
  Avg similarity: 0.1088 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9335 (0.0=collapsed)
[Epoch 9/100] [Batch 288/669 (43.0%)] [Iter 5640] Loss: 1.1777 (freq: 0.4537, raw: 0.7235, quant: 0.0005, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 450/1024 (43.9%) Top5:[549,154,444,461,373,476,801,604,160,944,75,800,879,939,818]


π”¬ Encoder Diversity (iter 5640):
  Avg similarity: 0.0865 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9415 (0.0=collapsed)
[Epoch 9/100] [Batch 298/669 (44.5%)] [Iter 5650] Loss: 0.9206 (freq: 0.3258, raw: 0.5944, quant: 0.0005, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[154,880,835,66,594,317,1004,944,756,75,371,975,939,557,45]


π”¬ Encoder Diversity (iter 5650):
  Avg similarity: 0.1285 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9209 (0.0=collapsed)
[Epoch 9/100] [Batch 308/669 (46.0%)] [Iter 5660] Loss: 1.4376 (freq: 0.5614, raw: 0.8757, quant: 0.0006, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 507/1024 (49.5%) Top5:[516,476,818,800,573,729,236,373,111,452,604,461,275,444,868]


π”¬ Encoder Diversity (iter 5660):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 9/100] [Batch 318/669 (47.5%)] [Iter 5670] Loss: 1.3020 (freq: 0.4752, raw: 0.8263, quant: 0.0005, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 473/1024 (46.2%) Top5:[516,880,846,476,835,944,557,800,461,604,444,154,594,975,297]


π”¬ Encoder Diversity (iter 5670):
  Avg similarity: 0.0554 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9412 (0.0=collapsed)
[Epoch 9/100] [Batch 328/669 (49.0%)] [Iter 5680] Loss: 1.3606 (freq: 0.4856, raw: 0.8744, quant: 0.0005, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 495/1024 (48.3%) Top5:[835,759,371,880,846,452,385,461,297,944,557,756,373,440,34]


π”¬ Encoder Diversity (iter 5680):
  Avg similarity: 0.0808 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9294 (0.0=collapsed)
[Epoch 9/100] [Batch 338/669 (50.5%)] [Iter 5690] Loss: 1.1795 (freq: 0.4553, raw: 0.7237, quant: 0.0005, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 490/1024 (47.9%) Top5:[880,944,939,835,154,66,975,75,557,594,846,373,613,45,280]


π”¬ Encoder Diversity (iter 5690):
  Avg similarity: 0.0993 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9304 (0.0=collapsed)
[Epoch 9/100] [Batch 348/669 (52.0%)] [Iter 5700] Loss: 0.9951 (freq: 0.3534, raw: 0.6412, quant: 0.0005, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[82,297,801,835,371,373,476,604,668,516,35,549,921,160,440]


π”¬ Encoder Diversity (iter 5700):
  Avg similarity: 0.0389 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9548 (0.0=collapsed)
[Epoch 9/100] [Batch 358/669 (53.5%)] [Iter 5710] Loss: 0.7353 (freq: 0.2285, raw: 0.5064, quant: 0.0004, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 478/1024 (46.7%) Top5:[154,880,789,668,297,373,944,75,835,818,845,82,594,613,939]


π”¬ Encoder Diversity (iter 5710):
  Avg similarity: 0.0650 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9431 (0.0=collapsed)
[Epoch 9/100] [Batch 368/669 (55.0%)] [Iter 5720] Loss: 1.0132 (freq: 0.3132, raw: 0.6996, quant: 0.0005, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 446/1024 (43.6%) Top5:[154,66,944,880,939,594,317,297,45,607,557,975,625,239,371]


π”¬ Encoder Diversity (iter 5720):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 9/100] [Batch 378/669 (56.5%)] [Iter 5730] Loss: 1.2960 (freq: 0.4914, raw: 0.8041, quant: 0.0005, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 444/1024 (43.4%) Top5:[154,476,607,66,82,573,939,111,921,317,604,373,800,516,818]


π”¬ Encoder Diversity (iter 5730):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 9/100] [Batch 388/669 (58.0%)] [Iter 5740] Loss: 1.0404 (freq: 0.3784, raw: 0.6615, quant: 0.0005, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 457/1024 (44.6%) Top5:[594,756,45,759,880,371,835,75,297,573,1004,868,476,33,644]


π”¬ Encoder Diversity (iter 5740):
  Avg similarity: 0.1251 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9241 (0.0=collapsed)
[Epoch 9/100] [Batch 398/669 (59.5%)] [Iter 5750] Loss: 1.3270 (freq: 0.4825, raw: 0.8439, quant: 0.0006, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 458/1024 (44.7%) Top5:[516,476,846,868,801,82,373,814,604,549,573,461,440,45,492]


π”¬ Encoder Diversity (iter 5750):
  Avg similarity: 0.1085 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9368 (0.0=collapsed)
[Epoch 9/100] [Batch 408/669 (61.0%)] [Iter 5760] Loss: 1.0048 (freq: 0.3367, raw: 0.6676, quant: 0.0005, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 471/1024 (46.0%) Top5:[516,476,373,801,846,444,549,604,111,868,880,835,461,573,297]


π”¬ Encoder Diversity (iter 5760):
  Avg similarity: 0.0707 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)
[Epoch 9/100] [Batch 418/669 (62.5%)] [Iter 5770] Loss: 1.2403 (freq: 0.4483, raw: 0.7914, quant: 0.0006, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[944,939,476,880,452,444,516,573,154,557,549,66,800,835,801]


π”¬ Encoder Diversity (iter 5770):
  Avg similarity: 0.0566 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 9/100] [Batch 428/669 (64.0%)] [Iter 5780] Loss: 1.1938 (freq: 0.4547, raw: 0.7386, quant: 0.0005, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[944,939,594,880,66,154,297,835,557,444,476,371,493,507,280]


π”¬ Encoder Diversity (iter 5780):
  Avg similarity: 0.0760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9406 (0.0=collapsed)
[Epoch 9/100] [Batch 438/669 (65.5%)] [Iter 5790] Loss: 1.1188 (freq: 0.3942, raw: 0.7241, quant: 0.0005, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 534/1024 (52.1%) Top5:[573,880,644,835,371,452,476,33,944,759,594,557,939,607,756]


π”¬ Encoder Diversity (iter 5790):
  Avg similarity: 0.0617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9492 (0.0=collapsed)
[Epoch 9/100] [Batch 448/669 (67.0%)] [Iter 5800] Loss: 1.0459 (freq: 0.3663, raw: 0.6791, quant: 0.0005, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 489/1024 (47.8%) Top5:[154,939,66,944,644,75,880,594,297,476,280,45,507,835,516]


π”¬ Encoder Diversity (iter 5800):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 9/100] [Batch 458/669 (68.5%)] [Iter 5810] Loss: 1.5341 (freq: 0.6106, raw: 0.9230, quant: 0.0006, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[800,516,476,373,549,604,135,444,461,607,846,845,275,818,729]


π”¬ Encoder Diversity (iter 5810):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 9/100] [Batch 468/669 (70.0%)] [Iter 5820] Loss: 0.9484 (freq: 0.3248, raw: 0.6232, quant: 0.0005, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 446/1024 (43.6%) Top5:[880,154,800,939,835,944,371,756,45,1004,66,759,801,594,297]


π”¬ Encoder Diversity (iter 5820):
  Avg similarity: 0.0964 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 9/100] [Batch 478/669 (71.4%)] [Iter 5830] Loss: 1.1379 (freq: 0.4231, raw: 0.7142, quant: 0.0005, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 497/1024 (48.5%) Top5:[154,939,944,880,476,45,317,613,557,66,549,594,371,668,373]


π”¬ Encoder Diversity (iter 5830):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9454 (0.0=collapsed)
[Epoch 9/100] [Batch 488/669 (72.9%)] [Iter 5840] Loss: 1.3641 (freq: 0.5062, raw: 0.8573, quant: 0.0006, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[476,461,154,939,371,801,75,944,880,607,440,668,66,1004,144]


π”¬ Encoder Diversity (iter 5840):
  Avg similarity: 0.0746 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9433 (0.0=collapsed)
[Epoch 9/100] [Batch 498/669 (74.4%)] [Iter 5850] Loss: 1.1507 (freq: 0.4297, raw: 0.7205, quant: 0.0005, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 475/1024 (46.4%) Top5:[644,594,880,75,33,939,371,1004,759,944,507,835,947,280,756]


π”¬ Encoder Diversity (iter 5850):
  Avg similarity: 0.0892 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9420 (0.0=collapsed)
[Epoch 9/100] [Batch 508/669 (75.9%)] [Iter 5860] Loss: 1.2728 (freq: 0.4650, raw: 0.8073, quant: 0.0006, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 509/1024 (49.7%) Top5:[549,66,939,154,801,846,493,613,60,75,476,239,800,880,644]


π”¬ Encoder Diversity (iter 5860):
  Avg similarity: 0.0721 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9446 (0.0=collapsed)
[Epoch 9/100] [Batch 518/669 (77.4%)] [Iter 5870] Loss: 1.4164 (freq: 0.5520, raw: 0.8638, quant: 0.0006, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 470/1024 (45.9%) Top5:[800,452,516,549,845,573,814,373,493,440,880,60,585,818,237]


π”¬ Encoder Diversity (iter 5870):
  Avg similarity: 0.0972 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9390 (0.0=collapsed)
[Epoch 9/100] [Batch 528/669 (78.9%)] [Iter 5880] Loss: 1.0787 (freq: 0.3682, raw: 0.7100, quant: 0.0005, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 463/1024 (45.2%) Top5:[880,1004,33,452,297,756,557,594,371,493,835,573,800,944,45]


π”¬ Encoder Diversity (iter 5880):
  Avg similarity: 0.0738 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9364 (0.0=collapsed)
[Epoch 9/100] [Batch 538/669 (80.4%)] [Iter 5890] Loss: 1.5255 (freq: 0.6097, raw: 0.9152, quant: 0.0006, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 438/1024 (42.8%) Top5:[800,476,452,373,846,845,516,880,573,567,729,549,607,585,305]


π”¬ Encoder Diversity (iter 5890):
  Avg similarity: 0.1012 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9300 (0.0=collapsed)
[Epoch 9/100] [Batch 548/669 (81.9%)] [Iter 5900] Loss: 1.3230 (freq: 0.5074, raw: 0.8151, quant: 0.0005, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 474/1024 (46.3%) Top5:[66,939,476,880,846,493,801,317,549,154,944,613,921,800,607]


π”¬ Encoder Diversity (iter 5900):
  Avg similarity: 0.0914 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9326 (0.0=collapsed)
[Epoch 9/100] [Batch 558/669 (83.4%)] [Iter 5910] Loss: 1.3286 (freq: 0.4830, raw: 0.8450, quant: 0.0006, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 444/1024 (43.4%) Top5:[801,476,846,800,549,921,573,1004,373,607,604,729,756,271,789]


π”¬ Encoder Diversity (iter 5910):
  Avg similarity: 0.0699 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9396 (0.0=collapsed)
[Epoch 9/100] [Batch 568/669 (84.9%)] [Iter 5920] Loss: 1.1385 (freq: 0.4126, raw: 0.7253, quant: 0.0006, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 432/1024 (42.2%) Top5:[66,944,549,493,154,880,801,800,573,1004,440,939,613,668,567]


π”¬ Encoder Diversity (iter 5920):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 9/100] [Batch 578/669 (86.4%)] [Iter 5930] Loss: 1.1014 (freq: 0.3897, raw: 0.7111, quant: 0.0006, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 470/1024 (45.9%) Top5:[66,880,944,594,154,476,800,644,297,835,274,557,334,371,1004]


π”¬ Encoder Diversity (iter 5930):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 9/100] [Batch 588/669 (87.9%)] [Iter 5940] Loss: 1.2731 (freq: 0.4649, raw: 0.8076, quant: 0.0006, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 499/1024 (48.7%) Top5:[476,800,516,444,880,461,371,801,275,373,604,845,594,944,549]


π”¬ Encoder Diversity (iter 5940):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 9/100] [Batch 598/669 (89.4%)] [Iter 5950] Loss: 1.2720 (freq: 0.4784, raw: 0.7930, quant: 0.0006, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[880,756,371,944,75,297,594,1004,835,476,493,573,668,266,939]


π”¬ Encoder Diversity (iter 5950):
  Avg similarity: 0.1413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9191 (0.0=collapsed)
[Epoch 9/100] [Batch 608/669 (90.9%)] [Iter 5960] Loss: 1.1192 (freq: 0.3831, raw: 0.7356, quant: 0.0005, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 489/1024 (47.8%) Top5:[549,476,846,800,573,801,789,516,880,111,160,444,604,196,835]


π”¬ Encoder Diversity (iter 5960):
  Avg similarity: 0.0715 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9459 (0.0=collapsed)
[Epoch 9/100] [Batch 618/669 (92.4%)] [Iter 5970] Loss: 0.9036 (freq: 0.3023, raw: 0.6008, quant: 0.0005, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 529/1024 (51.7%) Top5:[549,846,880,493,607,939,160,111,604,66,476,594,801,814,800]


π”¬ Encoder Diversity (iter 5970):
  Avg similarity: 0.1141 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9218 (0.0=collapsed)
[Epoch 9/100] [Batch 628/669 (93.9%)] [Iter 5980] Loss: 1.5127 (freq: 0.5722, raw: 0.9400, quant: 0.0005, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 463/1024 (45.2%) Top5:[607,549,846,800,373,476,111,921,801,604,567,440,516,668,271]


π”¬ Encoder Diversity (iter 5980):
  Avg similarity: 0.0963 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9365 (0.0=collapsed)
[Epoch 9/100] [Batch 638/669 (95.4%)] [Iter 5990] Loss: 1.0193 (freq: 0.3468, raw: 0.6721, quant: 0.0005, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 483/1024 (47.2%) Top5:[944,594,45,880,493,846,939,66,33,75,573,756,154,609,557]


π”¬ Encoder Diversity (iter 5990):
  Avg similarity: 0.0905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9382 (0.0=collapsed)
[Epoch 9/100] [Batch 648/669 (96.9%)] [Iter 6000] Loss: 1.2340 (freq: 0.4437, raw: 0.7899, quant: 0.0005, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 486/1024 (47.5%) Top5:[493,154,880,66,944,594,60,939,846,667,476,318,45,75,33]


π”¬ Encoder Diversity (iter 6000):
  Avg similarity: 0.1358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9137 (0.0=collapsed)
[Epoch 9/100] [Batch 658/669 (98.4%)] [Iter 6010] Loss: 0.9724 (freq: 0.3336, raw: 0.6384, quant: 0.0005, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 574/1024 (56.1%) Top5:[476,594,880,516,444,604,800,845,82,835,846,573,729,461,45]


π”¬ Encoder Diversity (iter 6010):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 9/100] [Batch 668/669 (99.9%)] [Iter 6020] Loss: 1.1846 (freq: 0.4714, raw: 0.7127, quant: 0.0005, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[880,594,835,845,297,476,944,371,75,1004,814,800,34,516,729]


π”¬ Encoder Diversity (iter 6020):
  Avg similarity: 0.0911 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9361 (0.0=collapsed)

================================================================================
[Epoch 9] Validation Results:
  Total Loss: 0.6253
  Freq Loss:  0.1923
  Raw Loss:   0.4325
  Quant Loss: 0.0005
  π“ Codebook Usage: 237/1024 (23.1%)
  π“ Codebook Entropy: 4.0924 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 41863 (32.2%)
  Top 10 most used codes:
    1. Code 594: 5169 times (3.97%)
    2. Code 880: 4933 times (3.79%)
    3. Code 371: 4648 times (3.57%)
    4. Code 835: 4467 times (3.43%)
    5. Code 939: 4234 times (3.25%)
    6. Code 493: 3842 times (2.95%)
    7. Code 154: 3692 times (2.84%)
    8. Code 266: 3684 times (2.83%)
    9. Code 297: 3620 times (2.78%)
    10. Code 66: 3574 times (2.75%)
  Bottom 5 least used codes (among used):
    1. Code 650: 1 times (0.00%)
    2. Code 935: 3 times (0.00%)
    3. Code 43: 3 times (0.00%)
    4. Code 761: 3 times (0.00%)
    5. Code 949: 5 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 9
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 10/100] [Batch 9/669 (1.3%)] [Iter 6030] Loss: 1.2985 (freq: 0.4930, raw: 0.8049, quant: 0.0006, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 990/1024 (96.7%) Top5:[594,880,45,944,371,835,75,557,34,104,507,493,33,144,169]


π”¬ Encoder Diversity (iter 6030):
  Avg similarity: 0.0802 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9462 (0.0=collapsed)
[Epoch 10/100] [Batch 19/669 (2.8%)] [Iter 6040] Loss: 1.0059 (freq: 0.3518, raw: 0.6536, quant: 0.0004, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 613/1024 (59.9%) Top5:[880,594,944,47,835,45,557,493,297,61,154,75,169,371,66]


π”¬ Encoder Diversity (iter 6040):
  Avg similarity: 0.1184 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9223 (0.0=collapsed)
[Epoch 10/100] [Batch 29/669 (4.3%)] [Iter 6050] Loss: 1.2000 (freq: 0.4836, raw: 0.7159, quant: 0.0005, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 543/1024 (53.0%) Top5:[47,594,880,61,944,45,169,756,75,493,557,706,371,274,104]


π”¬ Encoder Diversity (iter 6050):
  Avg similarity: 0.0761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 10/100] [Batch 39/669 (5.8%)] [Iter 6060] Loss: 0.9442 (freq: 0.3467, raw: 0.5971, quant: 0.0005, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[61,493,274,594,47,154,781,557,944,750,920,433,706,667,880]


π”¬ Encoder Diversity (iter 6060):
  Avg similarity: 0.0885 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9425 (0.0=collapsed)
[Epoch 10/100] [Batch 49/669 (7.3%)] [Iter 6070] Loss: 1.2398 (freq: 0.4434, raw: 0.7959, quant: 0.0005, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[493,274,47,667,557,939,880,944,706,781,60,968,507,527,154]


π”¬ Encoder Diversity (iter 6070):
  Avg similarity: 0.0978 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9436 (0.0=collapsed)
[Epoch 10/100] [Batch 59/669 (8.8%)] [Iter 6080] Loss: 1.1777 (freq: 0.4311, raw: 0.7461, quant: 0.0005, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 480/1024 (46.9%) Top5:[493,706,968,443,39,47,433,239,527,927,692,274,750,938,419]


π”¬ Encoder Diversity (iter 6080):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 10/100] [Batch 69/669 (10.3%)] [Iter 6090] Loss: 1.1178 (freq: 0.4160, raw: 0.7013, quant: 0.0005, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 440/1024 (43.0%) Top5:[880,594,443,756,45,706,39,75,169,527,920,47,347,469,266]


π”¬ Encoder Diversity (iter 6090):
  Avg similarity: 0.0728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 10/100] [Batch 79/669 (11.8%)] [Iter 6100] Loss: 1.4141 (freq: 0.5326, raw: 0.8810, quant: 0.0005, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 458/1024 (44.7%) Top5:[880,594,47,920,443,469,45,756,938,557,835,239,798,75,897]


π”¬ Encoder Diversity (iter 6100):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 10/100] [Batch 89/669 (13.3%)] [Iter 6110] Loss: 1.3296 (freq: 0.4922, raw: 0.8368, quant: 0.0006, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 470/1024 (45.9%) Top5:[594,880,55,45,557,835,274,493,613,944,433,66,75,169,756]


π”¬ Encoder Diversity (iter 6110):
  Avg similarity: 0.0972 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9325 (0.0=collapsed)
[Epoch 10/100] [Batch 99/669 (14.8%)] [Iter 6120] Loss: 1.2511 (freq: 0.4839, raw: 0.7666, quant: 0.0006, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 452/1024 (44.1%) Top5:[47,799,665,920,494,902,527,750,594,239,880,1017,620,968,706]


π”¬ Encoder Diversity (iter 6120):
  Avg similarity: 0.1087 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9234 (0.0=collapsed)
[Epoch 10/100] [Batch 109/669 (16.3%)] [Iter 6130] Loss: 1.1569 (freq: 0.4290, raw: 0.7275, quant: 0.0005, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[880,39,594,47,1013,944,371,620,169,835,557,405,750,774,33]


π”¬ Encoder Diversity (iter 6130):
  Avg similarity: 0.0979 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9392 (0.0=collapsed)
[Epoch 10/100] [Batch 119/669 (17.8%)] [Iter 6140] Loss: 1.2774 (freq: 0.4823, raw: 0.7946, quant: 0.0005, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 451/1024 (44.0%) Top5:[880,274,45,944,47,493,781,750,756,39,154,266,104,75,719]


π”¬ Encoder Diversity (iter 6140):
  Avg similarity: 0.1011 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9283 (0.0=collapsed)
[Epoch 10/100] [Batch 129/669 (19.3%)] [Iter 6150] Loss: 1.0980 (freq: 0.4298, raw: 0.6677, quant: 0.0005, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 531/1024 (51.9%) Top5:[45,347,493,880,594,274,411,719,1013,433,750,47,39,781,443]


π”¬ Encoder Diversity (iter 6150):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)
[Epoch 10/100] [Batch 139/669 (20.8%)] [Iter 6160] Loss: 1.1453 (freq: 0.3980, raw: 0.7468, quant: 0.0005, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 527/1024 (51.5%) Top5:[318,880,493,47,706,920,154,781,594,750,280,45,239,667,347]


π”¬ Encoder Diversity (iter 6160):
  Avg similarity: 0.0903 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9439 (0.0=collapsed)
[Epoch 10/100] [Batch 149/669 (22.3%)] [Iter 6170] Loss: 1.2816 (freq: 0.4851, raw: 0.7960, quant: 0.0005, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 493/1024 (48.1%) Top5:[594,706,880,169,45,266,835,756,1004,609,371,750,527,944,239]


π”¬ Encoder Diversity (iter 6170):
  Avg similarity: 0.0981 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9295 (0.0=collapsed)
[Epoch 10/100] [Batch 159/669 (23.8%)] [Iter 6180] Loss: 1.1284 (freq: 0.4051, raw: 0.7228, quant: 0.0005, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[706,239,527,665,594,47,45,880,557,1017,559,61,274,750,920]


π”¬ Encoder Diversity (iter 6180):
  Avg similarity: 0.0766 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9386 (0.0=collapsed)
[Epoch 10/100] [Batch 169/669 (25.3%)] [Iter 6190] Loss: 1.0435 (freq: 0.3904, raw: 0.6526, quant: 0.0005, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 463/1024 (45.2%) Top5:[594,45,880,169,557,944,266,274,609,33,835,371,239,507,297]


π”¬ Encoder Diversity (iter 6190):
  Avg similarity: 0.0701 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 10/100] [Batch 179/669 (26.8%)] [Iter 6200] Loss: 1.1023 (freq: 0.3534, raw: 0.7484, quant: 0.0005, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 520/1024 (50.8%) Top5:[493,154,274,939,433,781,880,66,667,239,45,55,280,318,47]


π”¬ Encoder Diversity (iter 6200):
  Avg similarity: 0.0904 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9355 (0.0=collapsed)
[Epoch 10/100] [Batch 189/669 (28.3%)] [Iter 6210] Loss: 1.2843 (freq: 0.5157, raw: 0.7681, quant: 0.0005, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 454/1024 (44.3%) Top5:[920,443,798,39,719,706,347,47,665,968,350,411,620,349,774]


π”¬ Encoder Diversity (iter 6210):
  Avg similarity: 0.1155 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9244 (0.0=collapsed)
[Epoch 10/100] [Batch 199/669 (29.7%)] [Iter 6220] Loss: 1.2245 (freq: 0.4222, raw: 0.8018, quant: 0.0005, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 467/1024 (45.6%) Top5:[920,706,47,665,750,798,443,880,756,954,527,75,968,349,239]


π”¬ Encoder Diversity (iter 6220):
  Avg similarity: 0.1136 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9171 (0.0=collapsed)
[Epoch 10/100] [Batch 209/669 (31.2%)] [Iter 6230] Loss: 1.1099 (freq: 0.3556, raw: 0.7539, quant: 0.0005, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 487/1024 (47.6%) Top5:[920,443,750,706,798,527,469,17,774,719,835,239,207,101,45]


π”¬ Encoder Diversity (iter 6230):
  Avg similarity: 0.0871 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9403 (0.0=collapsed)
[Epoch 10/100] [Batch 219/669 (32.7%)] [Iter 6240] Loss: 1.2274 (freq: 0.4697, raw: 0.7572, quant: 0.0006, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 445/1024 (43.5%) Top5:[774,706,527,443,756,239,17,880,45,559,750,594,799,692,798]


π”¬ Encoder Diversity (iter 6240):
  Avg similarity: 0.0633 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9442 (0.0=collapsed)
[Epoch 10/100] [Batch 229/669 (34.2%)] [Iter 6250] Loss: 1.1620 (freq: 0.4280, raw: 0.7335, quant: 0.0005, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[880,756,944,45,835,274,507,667,594,790,557,55,169,665,706]


π”¬ Encoder Diversity (iter 6250):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 10/100] [Batch 239/669 (35.7%)] [Iter 6260] Loss: 0.9508 (freq: 0.3163, raw: 0.6339, quant: 0.0006, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[665,47,239,706,527,61,880,750,17,39,968,620,885,1017,559]


π”¬ Encoder Diversity (iter 6260):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 10/100] [Batch 249/669 (37.2%)] [Iter 6270] Loss: 1.0134 (freq: 0.3647, raw: 0.6483, quant: 0.0005, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 421/1024 (41.1%) Top5:[880,790,39,665,835,45,944,55,47,620,1013,169,557,507,405]


π”¬ Encoder Diversity (iter 6270):
  Avg similarity: 0.0568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9444 (0.0=collapsed)
[Epoch 10/100] [Batch 259/669 (38.7%)] [Iter 6280] Loss: 1.1211 (freq: 0.4117, raw: 0.7089, quant: 0.0006, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 496/1024 (48.4%) Top5:[880,45,47,493,790,39,667,665,154,781,559,433,944,620,55]


π”¬ Encoder Diversity (iter 6280):
  Avg similarity: 0.0889 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9304 (0.0=collapsed)
[Epoch 10/100] [Batch 269/669 (40.2%)] [Iter 6290] Loss: 1.3685 (freq: 0.5145, raw: 0.8535, quant: 0.0005, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 475/1024 (46.4%) Top5:[706,239,665,527,47,781,880,513,493,55,411,667,750,433,274]


π”¬ Encoder Diversity (iter 6290):
  Avg similarity: 0.0550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 10/100] [Batch 279/669 (41.7%)] [Iter 6300] Loss: 1.2352 (freq: 0.4493, raw: 0.7853, quant: 0.0005, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 471/1024 (46.0%) Top5:[239,706,920,880,790,61,835,774,45,169,17,665,954,944,750]


π”¬ Encoder Diversity (iter 6300):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 10/100] [Batch 289/669 (43.2%)] [Iter 6310] Loss: 1.1716 (freq: 0.4355, raw: 0.7356, quant: 0.0005, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 462/1024 (45.1%) Top5:[920,443,774,239,419,17,515,510,706,750,692,527,45,493,101]


π”¬ Encoder Diversity (iter 6310):
  Avg similarity: 0.0734 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9383 (0.0=collapsed)
[Epoch 10/100] [Batch 299/669 (44.7%)] [Iter 6320] Loss: 1.4323 (freq: 0.5767, raw: 0.8550, quant: 0.0006, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 475/1024 (46.4%) Top5:[920,706,527,880,45,17,750,443,306,411,1017,944,799,557,494]


π”¬ Encoder Diversity (iter 6320):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9574 (0.0=collapsed)
[Epoch 10/100] [Batch 309/669 (46.2%)] [Iter 6330] Loss: 1.2953 (freq: 0.5001, raw: 0.7947, quant: 0.0005, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 494/1024 (48.2%) Top5:[880,781,154,835,594,493,45,55,557,507,274,790,944,756,667]


π”¬ Encoder Diversity (iter 6330):
  Avg similarity: 0.0799 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)
[Epoch 10/100] [Batch 319/669 (47.7%)] [Iter 6340] Loss: 1.1899 (freq: 0.4550, raw: 0.7343, quant: 0.0005, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 462/1024 (45.1%) Top5:[239,781,47,706,620,665,719,880,527,920,349,39,816,347,154]


π”¬ Encoder Diversity (iter 6340):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9376 (0.0=collapsed)
[Epoch 10/100] [Batch 329/669 (49.2%)] [Iter 6350] Loss: 1.0396 (freq: 0.3839, raw: 0.6552, quant: 0.0005, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 456/1024 (44.5%) Top5:[781,880,835,944,594,790,1004,154,557,45,667,665,493,507,274]


π”¬ Encoder Diversity (iter 6350):
  Avg similarity: 0.1011 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9302 (0.0=collapsed)
[Epoch 10/100] [Batch 339/669 (50.7%)] [Iter 6360] Loss: 1.0390 (freq: 0.3444, raw: 0.6939, quant: 0.0007, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 533/1024 (52.1%) Top5:[39,239,47,781,774,1013,411,527,665,96,968,944,667,719,212]


π”¬ Encoder Diversity (iter 6360):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 10/100] [Batch 349/669 (52.2%)] [Iter 6370] Loss: 1.4112 (freq: 0.5290, raw: 0.8817, quant: 0.0006, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 469/1024 (45.8%) Top5:[239,557,47,1013,920,774,944,507,55,411,39,706,872,781,609]


π”¬ Encoder Diversity (iter 6370):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 10/100] [Batch 359/669 (53.7%)] [Iter 6380] Loss: 1.2507 (freq: 0.4515, raw: 0.7986, quant: 0.0005, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 479/1024 (46.8%) Top5:[665,944,239,920,706,17,39,557,47,719,527,774,781,968,55]


π”¬ Encoder Diversity (iter 6380):
  Avg similarity: 0.0602 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 10/100] [Batch 369/669 (55.2%)] [Iter 6390] Loss: 1.2601 (freq: 0.4897, raw: 0.7698, quant: 0.0005, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 458/1024 (44.7%) Top5:[706,527,665,297,557,835,47,944,920,719,968,756,799,207,781]


π”¬ Encoder Diversity (iter 6390):
  Avg similarity: 0.0712 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 10/100] [Batch 379/669 (56.7%)] [Iter 6400] Loss: 1.1475 (freq: 0.4101, raw: 0.7369, quant: 0.0005, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[706,944,557,527,665,738,55,799,835,781,756,411,433,667,880]


π”¬ Encoder Diversity (iter 6400):
  Avg similarity: 0.1067 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9308 (0.0=collapsed)
[Epoch 10/100] [Batch 389/669 (58.1%)] [Iter 6410] Loss: 1.0709 (freq: 0.4150, raw: 0.6555, quant: 0.0005, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 538/1024 (52.5%) Top5:[774,493,433,944,154,816,781,55,613,667,557,527,45,665,494]


π”¬ Encoder Diversity (iter 6410):
  Avg similarity: 0.0670 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9439 (0.0=collapsed)
[Epoch 10/100] [Batch 399/669 (59.6%)] [Iter 6420] Loss: 0.9187 (freq: 0.3276, raw: 0.5906, quant: 0.0005, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 450/1024 (43.9%) Top5:[433,781,154,944,45,665,47,55,33,594,297,667,557,613,920]


π”¬ Encoder Diversity (iter 6420):
  Avg similarity: 0.0730 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9423 (0.0=collapsed)
[Epoch 10/100] [Batch 409/669 (61.1%)] [Iter 6430] Loss: 0.9384 (freq: 0.3045, raw: 0.6334, quant: 0.0005, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 486/1024 (47.5%) Top5:[297,835,594,756,557,55,33,609,411,75,45,47,665,17,104]


π”¬ Encoder Diversity (iter 6430):
  Avg similarity: 0.0823 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9370 (0.0=collapsed)
[Epoch 10/100] [Batch 419/669 (62.6%)] [Iter 6440] Loss: 0.9962 (freq: 0.3190, raw: 0.6767, quant: 0.0005, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 501/1024 (48.9%) Top5:[706,665,239,594,920,750,47,17,738,756,527,557,297,835,790]


π”¬ Encoder Diversity (iter 6440):
  Avg similarity: 0.0530 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9420 (0.0=collapsed)
[Epoch 10/100] [Batch 429/669 (64.1%)] [Iter 6450] Loss: 1.1009 (freq: 0.3782, raw: 0.7222, quant: 0.0005, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 462/1024 (45.1%) Top5:[835,665,45,706,297,756,594,557,790,55,781,667,944,609,33]


π”¬ Encoder Diversity (iter 6450):
  Avg similarity: 0.0599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9453 (0.0=collapsed)
[Epoch 10/100] [Batch 439/669 (65.6%)] [Iter 6460] Loss: 1.2915 (freq: 0.4941, raw: 0.7969, quant: 0.0005, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 467/1024 (45.6%) Top5:[665,239,39,527,47,861,774,750,706,738,557,297,620,609,55]


π”¬ Encoder Diversity (iter 6460):
  Avg similarity: 0.1467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9253 (0.0=collapsed)
[Epoch 10/100] [Batch 449/669 (67.1%)] [Iter 6470] Loss: 1.3071 (freq: 0.4501, raw: 0.8563, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 491/1024 (47.9%) Top5:[665,944,706,239,781,47,297,750,45,433,613,594,667,557,527]


π”¬ Encoder Diversity (iter 6470):
  Avg similarity: 0.0615 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 10/100] [Batch 459/669 (68.6%)] [Iter 6480] Loss: 1.3648 (freq: 0.4839, raw: 0.8803, quant: 0.0006, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 502/1024 (49.0%) Top5:[665,594,47,920,55,507,104,750,33,45,944,609,297,790,75]


π”¬ Encoder Diversity (iter 6480):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 10/100] [Batch 469/669 (70.1%)] [Iter 6490] Loss: 1.2358 (freq: 0.4387, raw: 0.7965, quant: 0.0005, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[665,920,706,750,594,835,527,944,493,781,55,154,719,297,33]


π”¬ Encoder Diversity (iter 6490):
  Avg similarity: 0.0662 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9445 (0.0=collapsed)
[Epoch 10/100] [Batch 479/669 (71.6%)] [Iter 6500] Loss: 1.1490 (freq: 0.4379, raw: 0.7106, quant: 0.0005, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[297,781,706,620,665,349,594,527,396,337,405,39,835,557,411]


π”¬ Encoder Diversity (iter 6500):
  Avg similarity: 0.0917 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9357 (0.0=collapsed)
[Epoch 10/100] [Batch 489/669 (73.1%)] [Iter 6510] Loss: 0.8942 (freq: 0.3256, raw: 0.5681, quant: 0.0005, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 493/1024 (48.1%) Top5:[781,667,944,154,433,706,239,493,613,55,939,557,790,816,527]


π”¬ Encoder Diversity (iter 6510):
  Avg similarity: 0.0856 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9400 (0.0=collapsed)
[Epoch 10/100] [Batch 499/669 (74.6%)] [Iter 6520] Loss: 0.8931 (freq: 0.3164, raw: 0.5763, quant: 0.0005, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 509/1024 (49.7%) Top5:[239,706,665,540,433,527,620,580,405,667,781,419,411,559,816]


π”¬ Encoder Diversity (iter 6520):
  Avg similarity: 0.1312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9234 (0.0=collapsed)
[Epoch 10/100] [Batch 509/669 (76.1%)] [Iter 6530] Loss: 1.3033 (freq: 0.4457, raw: 0.8569, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 503/1024 (49.1%) Top5:[756,45,594,433,297,944,781,337,39,17,613,493,706,239,411]


π”¬ Encoder Diversity (iter 6530):
  Avg similarity: 0.0718 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9427 (0.0=collapsed)
[Epoch 10/100] [Batch 519/669 (77.6%)] [Iter 6540] Loss: 1.2647 (freq: 0.4601, raw: 0.8041, quant: 0.0005, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 517/1024 (50.5%) Top5:[594,39,443,17,527,756,920,750,297,1013,337,944,719,774,45]


π”¬ Encoder Diversity (iter 6540):
  Avg similarity: 0.1036 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9388 (0.0=collapsed)
[Epoch 10/100] [Batch 529/669 (79.1%)] [Iter 6550] Loss: 1.3992 (freq: 0.5334, raw: 0.8652, quant: 0.0006, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 487/1024 (47.6%) Top5:[706,47,45,781,443,944,527,39,17,750,667,665,719,956,433]


π”¬ Encoder Diversity (iter 6550):
  Avg similarity: 0.1073 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9450 (0.0=collapsed)
[Epoch 10/100] [Batch 539/669 (80.6%)] [Iter 6560] Loss: 1.0967 (freq: 0.3753, raw: 0.7208, quant: 0.0006, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 481/1024 (47.0%) Top5:[594,45,944,706,297,790,507,750,665,835,781,55,47,667,557]


π”¬ Encoder Diversity (iter 6560):
  Avg similarity: 0.0870 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9344 (0.0=collapsed)
[Epoch 10/100] [Batch 549/669 (82.1%)] [Iter 6570] Loss: 1.4072 (freq: 0.5595, raw: 0.8471, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 454/1024 (44.3%) Top5:[706,39,47,665,920,750,239,45,774,527,944,17,620,443,927]


π”¬ Encoder Diversity (iter 6570):
  Avg similarity: 0.0917 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9307 (0.0=collapsed)
[Epoch 10/100] [Batch 559/669 (83.6%)] [Iter 6580] Loss: 1.2090 (freq: 0.4467, raw: 0.7617, quant: 0.0005, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 465/1024 (45.4%) Top5:[706,665,527,17,239,750,47,61,968,861,510,799,920,774,207]


π”¬ Encoder Diversity (iter 6580):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9542 (0.0=collapsed)
[Epoch 10/100] [Batch 569/669 (85.1%)] [Iter 6590] Loss: 1.3876 (freq: 0.5447, raw: 0.8422, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 490/1024 (47.9%) Top5:[527,706,594,774,33,419,55,939,39,557,609,350,920,450,944]


π”¬ Encoder Diversity (iter 6590):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9514 (0.0=collapsed)
[Epoch 10/100] [Batch 579/669 (86.5%)] [Iter 6600] Loss: 1.1589 (freq: 0.4107, raw: 0.7477, quant: 0.0005, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 516/1024 (50.4%) Top5:[781,920,667,443,212,944,39,613,527,154,665,45,706,750,53]


π”¬ Encoder Diversity (iter 6600):
  Avg similarity: 0.0727 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9420 (0.0=collapsed)
[Epoch 10/100] [Batch 589/669 (88.0%)] [Iter 6610] Loss: 1.2883 (freq: 0.4778, raw: 0.8099, quant: 0.0005, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 471/1024 (46.0%) Top5:[781,667,433,154,493,920,47,613,816,944,45,239,443,750,212]


π”¬ Encoder Diversity (iter 6610):
  Avg similarity: 0.0831 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9403 (0.0=collapsed)
[Epoch 10/100] [Batch 599/669 (89.5%)] [Iter 6620] Loss: 1.2374 (freq: 0.4550, raw: 0.7818, quant: 0.0005, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 504/1024 (49.2%) Top5:[667,47,944,39,493,45,131,594,557,835,540,902,469,613,559]


π”¬ Encoder Diversity (iter 6620):
  Avg similarity: 0.0680 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9448 (0.0=collapsed)
[Epoch 10/100] [Batch 609/669 (91.0%)] [Iter 6630] Loss: 1.3601 (freq: 0.5027, raw: 0.8567, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 497/1024 (48.5%) Top5:[39,239,47,667,540,594,557,665,45,297,944,774,559,131,61]


π”¬ Encoder Diversity (iter 6630):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9494 (0.0=collapsed)
[Epoch 10/100] [Batch 619/669 (92.5%)] [Iter 6640] Loss: 1.3590 (freq: 0.4781, raw: 0.8804, quant: 0.0005, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 516/1024 (50.4%) Top5:[665,706,239,527,920,594,47,835,750,36,908,540,944,17,616]


π”¬ Encoder Diversity (iter 6640):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)
[Epoch 10/100] [Batch 629/669 (94.0%)] [Iter 6650] Loss: 1.0563 (freq: 0.4082, raw: 0.6475, quant: 0.0005, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 473/1024 (46.2%) Top5:[939,297,944,557,594,36,706,33,756,665,790,835,493,920,17]


π”¬ Encoder Diversity (iter 6650):
  Avg similarity: 0.1041 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9288 (0.0=collapsed)
[Epoch 10/100] [Batch 639/669 (95.5%)] [Iter 6660] Loss: 1.2566 (freq: 0.4644, raw: 0.7917, quant: 0.0005, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 515/1024 (50.3%) Top5:[493,920,706,781,527,17,613,719,939,665,36,616,594,297,667]


π”¬ Encoder Diversity (iter 6660):
  Avg similarity: 0.0683 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9423 (0.0=collapsed)
[Epoch 10/100] [Batch 649/669 (97.0%)] [Iter 6670] Loss: 1.1524 (freq: 0.4116, raw: 0.7402, quant: 0.0005, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 513/1024 (50.1%) Top5:[920,706,665,594,939,799,616,239,47,750,17,527,613,902,493]


π”¬ Encoder Diversity (iter 6670):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 10/100] [Batch 659/669 (98.5%)] [Iter 6680] Loss: 0.9680 (freq: 0.3303, raw: 0.6372, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 478/1024 (46.7%) Top5:[493,594,939,667,45,944,297,47,790,557,835,781,433,613,706]


π”¬ Encoder Diversity (iter 6680):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 10/100] [Batch 669/669 (100.0%)] [Iter 6690] Loss: 1.3918 (freq: 0.5272, raw: 0.8641, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 484/1024 (47.3%) Top5:[47,706,920,239,665,594,902,540,750,297,557,469,738,835,570]


================================================================================
[Epoch 10] Validation Results:
  Total Loss: 0.6198
  Freq Loss:  0.1899
  Raw Loss:   0.4295
  Quant Loss: 0.0005
  π“ Codebook Usage: 191/1024 (18.7%)
  π“ Codebook Entropy: 3.9794 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 40546 (31.1%)
  Top 10 most used codes:
    1. Code 594: 4861 times (3.73%)
    2. Code 396: 4679 times (3.59%)
    3. Code 835: 4553 times (3.50%)
    4. Code 557: 4138 times (3.18%)
    5. Code 297: 4011 times (3.08%)
    6. Code 781: 3843 times (2.95%)
    7. Code 667: 3822 times (2.94%)
    8. Code 266: 3727 times (2.86%)
    9. Code 939: 3462 times (2.66%)
    10. Code 493: 3450 times (2.65%)
  Bottom 5 least used codes (among used):
    1. Code 374: 2 times (0.00%)
    2. Code 376: 2 times (0.00%)
    3. Code 888: 3 times (0.00%)
    4. Code 117: 5 times (0.00%)
    5. Code 29: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 10
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 9 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 6690):
  Avg similarity: 0.1040 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9363 (0.0=collapsed)
[Epoch 11/100] [Batch 10/669 (1.5%)] [Iter 6700] Loss: 1.0300 (freq: 0.3882, raw: 0.6413, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 968/1024 (94.5%) Top5:[667,781,493,399,45,433,944,557,297,411,280,507,607,816,70]


π”¬ Encoder Diversity (iter 6700):
  Avg similarity: 0.1089 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9324 (0.0=collapsed)
[Epoch 11/100] [Batch 20/669 (3.0%)] [Iter 6710] Loss: 1.1342 (freq: 0.4278, raw: 0.7059, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 660/1024 (64.5%) Top5:[944,594,45,557,297,939,33,729,507,280,36,396,790,70,667]


π”¬ Encoder Diversity (iter 6710):
  Avg similarity: 0.0742 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 11/100] [Batch 30/669 (4.5%)] [Iter 6720] Loss: 1.2184 (freq: 0.4334, raw: 0.7845, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 589/1024 (57.5%) Top5:[433,572,594,45,944,584,557,667,297,939,36,729,756,450,70]


π”¬ Encoder Diversity (iter 6720):
  Avg similarity: 0.0997 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9404 (0.0=collapsed)
[Epoch 11/100] [Batch 40/669 (6.0%)] [Iter 6730] Loss: 1.3143 (freq: 0.5181, raw: 0.7957, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 502/1024 (49.0%) Top5:[572,952,642,108,594,975,939,584,546,898,71,729,839,701,45]


π”¬ Encoder Diversity (iter 6730):
  Avg similarity: 0.0615 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9524 (0.0=collapsed)
[Epoch 11/100] [Batch 50/669 (7.5%)] [Iter 6740] Loss: 1.0399 (freq: 0.3750, raw: 0.6645, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 419/1024 (40.9%) Top5:[493,572,594,45,944,154,790,667,433,280,939,613,108,781,477]


π”¬ Encoder Diversity (iter 6740):
  Avg similarity: 0.0926 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 11/100] [Batch 60/669 (9.0%)] [Iter 6750] Loss: 1.1726 (freq: 0.4435, raw: 0.7286, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 484/1024 (47.3%) Top5:[546,493,411,584,985,192,572,946,975,781,613,363,888,71,15]


π”¬ Encoder Diversity (iter 6750):
  Avg similarity: 0.1059 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9320 (0.0=collapsed)
[Epoch 11/100] [Batch 70/669 (10.5%)] [Iter 6760] Loss: 1.2722 (freq: 0.4902, raw: 0.7815, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 488/1024 (47.7%) Top5:[546,572,985,363,493,108,192,778,514,548,934,701,944,746,898]


π”¬ Encoder Diversity (iter 6760):
  Avg similarity: 0.0734 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9418 (0.0=collapsed)
[Epoch 11/100] [Batch 80/669 (12.0%)] [Iter 6770] Loss: 1.3092 (freq: 0.4454, raw: 0.8632, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 500/1024 (48.8%) Top5:[594,297,835,45,944,546,557,790,548,55,337,572,33,985,411]


π”¬ Encoder Diversity (iter 6770):
  Avg similarity: 0.0803 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 11/100] [Batch 90/669 (13.5%)] [Iter 6780] Loss: 1.3094 (freq: 0.5059, raw: 0.8029, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 500/1024 (48.8%) Top5:[108,572,975,701,584,636,729,922,119,71,45,888,952,366,371]


π”¬ Encoder Diversity (iter 6780):
  Avg similarity: 0.0867 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9355 (0.0=collapsed)
[Epoch 11/100] [Batch 100/669 (14.9%)] [Iter 6790] Loss: 1.0228 (freq: 0.3703, raw: 0.6520, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 393/1024 (38.4%) Top5:[297,572,45,594,55,557,355,975,337,944,108,926,433,493,546]


π”¬ Encoder Diversity (iter 6790):
  Avg similarity: 0.1086 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9250 (0.0=collapsed)
[Epoch 11/100] [Batch 110/669 (16.4%)] [Iter 6800] Loss: 1.1500 (freq: 0.4258, raw: 0.7237, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 451/1024 (44.0%) Top5:[572,45,297,944,952,119,39,642,108,975,433,55,546,71,594]


π”¬ Encoder Diversity (iter 6800):
  Avg similarity: 0.0654 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9478 (0.0=collapsed)
[Epoch 11/100] [Batch 120/669 (17.9%)] [Iter 6810] Loss: 1.2941 (freq: 0.5046, raw: 0.7890, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 534/1024 (52.1%) Top5:[433,944,667,781,493,297,45,55,399,790,594,286,154,613,670]


π”¬ Encoder Diversity (iter 6810):
  Avg similarity: 0.0701 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9492 (0.0=collapsed)
[Epoch 11/100] [Batch 130/669 (19.4%)] [Iter 6820] Loss: 1.0029 (freq: 0.3279, raw: 0.6746, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 562/1024 (54.9%) Top5:[297,546,594,45,493,433,572,667,362,670,781,55,71,399,154]


π”¬ Encoder Diversity (iter 6820):
  Avg similarity: 0.0779 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 11/100] [Batch 140/669 (20.9%)] [Iter 6830] Loss: 1.1492 (freq: 0.3989, raw: 0.7498, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[572,701,546,594,297,55,708,985,975,782,584,922,411,371,898]


π”¬ Encoder Diversity (iter 6830):
  Avg similarity: 0.1082 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9254 (0.0=collapsed)
[Epoch 11/100] [Batch 150/669 (22.4%)] [Iter 6840] Loss: 1.3786 (freq: 0.5228, raw: 0.8552, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 471/1024 (46.0%) Top5:[594,781,297,701,493,399,667,433,613,975,45,606,740,546,71]


π”¬ Encoder Diversity (iter 6840):
  Avg similarity: 0.0918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9426 (0.0=collapsed)
[Epoch 11/100] [Batch 160/669 (23.9%)] [Iter 6850] Loss: 1.1310 (freq: 0.4130, raw: 0.7175, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 480/1024 (46.9%) Top5:[594,297,557,667,519,55,835,756,337,45,399,493,433,944,670]


π”¬ Encoder Diversity (iter 6850):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 11/100] [Batch 170/669 (25.4%)] [Iter 6860] Loss: 1.4366 (freq: 0.5205, raw: 0.9156, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 482/1024 (47.1%) Top5:[572,493,399,667,546,557,701,781,944,154,433,297,362,708,740]


π”¬ Encoder Diversity (iter 6860):
  Avg similarity: 0.0665 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9471 (0.0=collapsed)
[Epoch 11/100] [Batch 180/669 (26.9%)] [Iter 6870] Loss: 1.0379 (freq: 0.3486, raw: 0.6887, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[594,337,297,572,557,45,546,975,670,756,450,888,934,55,355]


π”¬ Encoder Diversity (iter 6870):
  Avg similarity: 0.0631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 11/100] [Batch 190/669 (28.4%)] [Iter 6880] Loss: 0.9994 (freq: 0.3705, raw: 0.6285, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 431/1024 (42.1%) Top5:[546,584,71,108,572,888,399,922,297,725,729,701,52,493,45]


π”¬ Encoder Diversity (iter 6880):
  Avg similarity: 0.1091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9219 (0.0=collapsed)
[Epoch 11/100] [Batch 200/669 (29.9%)] [Iter 6890] Loss: 1.2652 (freq: 0.4686, raw: 0.7960, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 422/1024 (41.2%) Top5:[594,337,546,45,297,108,701,572,557,729,519,39,782,584,71]


π”¬ Encoder Diversity (iter 6890):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 11/100] [Batch 210/669 (31.4%)] [Iter 6900] Loss: 1.1804 (freq: 0.4482, raw: 0.7318, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 550/1024 (53.7%) Top5:[297,399,667,437,557,594,781,978,944,45,154,433,493,790,782]


π”¬ Encoder Diversity (iter 6900):
  Avg similarity: 0.0593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 11/100] [Batch 220/669 (32.9%)] [Iter 6910] Loss: 1.5080 (freq: 0.5802, raw: 0.9272, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 528/1024 (51.6%) Top5:[594,297,39,45,399,557,371,975,667,433,701,926,108,782,708]


π”¬ Encoder Diversity (iter 6910):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 11/100] [Batch 230/669 (34.4%)] [Iter 6920] Loss: 1.2755 (freq: 0.4937, raw: 0.7812, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[594,297,572,399,667,437,71,557,433,782,108,362,975,701,584]


π”¬ Encoder Diversity (iter 6920):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 11/100] [Batch 240/669 (35.9%)] [Iter 6930] Loss: 1.1203 (freq: 0.3973, raw: 0.7224, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 494/1024 (48.2%) Top5:[594,297,362,557,45,433,572,399,667,790,437,71,727,33,670]


π”¬ Encoder Diversity (iter 6930):
  Avg similarity: 0.0833 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 11/100] [Batch 250/669 (37.4%)] [Iter 6940] Loss: 1.1331 (freq: 0.3983, raw: 0.7342, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 501/1024 (48.9%) Top5:[572,594,934,782,33,546,708,600,557,701,670,337,108,297,45]


π”¬ Encoder Diversity (iter 6940):
  Avg similarity: 0.0807 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9490 (0.0=collapsed)
[Epoch 11/100] [Batch 260/669 (38.9%)] [Iter 6950] Loss: 1.1413 (freq: 0.4046, raw: 0.7362, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 512/1024 (50.0%) Top5:[701,594,572,108,584,546,729,782,366,399,670,371,119,39,934]


π”¬ Encoder Diversity (iter 6950):
  Avg similarity: 0.1044 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9365 (0.0=collapsed)
[Epoch 11/100] [Batch 270/669 (40.4%)] [Iter 6960] Loss: 1.2406 (freq: 0.4516, raw: 0.7883, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 477/1024 (46.6%) Top5:[108,297,701,371,975,594,546,670,944,985,39,782,572,888,45]


π”¬ Encoder Diversity (iter 6960):
  Avg similarity: 0.0795 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9414 (0.0=collapsed)
[Epoch 11/100] [Batch 280/669 (41.9%)] [Iter 6970] Loss: 1.2019 (freq: 0.4302, raw: 0.7712, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 495/1024 (48.3%) Top5:[975,839,371,888,108,297,39,708,952,944,594,546,782,689,437]


π”¬ Encoder Diversity (iter 6970):
  Avg similarity: 0.0973 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9357 (0.0=collapsed)
[Epoch 11/100] [Batch 290/669 (43.3%)] [Iter 6980] Loss: 0.9716 (freq: 0.3110, raw: 0.6601, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 513/1024 (50.1%) Top5:[465,708,667,437,944,557,433,594,782,701,546,297,727,68,781]


π”¬ Encoder Diversity (iter 6980):
  Avg similarity: 0.1101 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9368 (0.0=collapsed)
[Epoch 11/100] [Batch 300/669 (44.8%)] [Iter 6990] Loss: 1.0859 (freq: 0.3609, raw: 0.7245, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 511/1024 (49.9%) Top5:[708,701,546,297,572,557,667,965,782,465,594,944,437,729,47]


π”¬ Encoder Diversity (iter 6990):
  Avg similarity: 0.0662 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9483 (0.0=collapsed)
[Epoch 11/100] [Batch 310/669 (46.3%)] [Iter 7000] Loss: 0.9277 (freq: 0.2962, raw: 0.6310, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 546/1024 (53.3%) Top5:[546,594,297,572,45,701,557,782,519,71,465,600,835,337,944]


π”¬ Encoder Diversity (iter 7000):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 11/100] [Batch 320/669 (47.8%)] [Iter 7010] Loss: 0.9818 (freq: 0.3452, raw: 0.6361, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 495/1024 (48.3%) Top5:[297,594,557,362,45,33,944,667,108,729,47,835,465,337,519]


π”¬ Encoder Diversity (iter 7010):
  Avg similarity: 0.1318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9309 (0.0=collapsed)
[Epoch 11/100] [Batch 330/669 (49.3%)] [Iter 7020] Loss: 1.1849 (freq: 0.3919, raw: 0.7924, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 529/1024 (51.7%) Top5:[667,944,108,729,594,45,519,670,965,584,399,362,557,98,727]


π”¬ Encoder Diversity (iter 7020):
  Avg similarity: 0.0973 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9404 (0.0=collapsed)
[Epoch 11/100] [Batch 340/669 (50.8%)] [Iter 7030] Loss: 1.2698 (freq: 0.4051, raw: 0.8641, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 504/1024 (49.2%) Top5:[297,594,45,790,701,557,39,729,667,944,437,98,600,399,337]


π”¬ Encoder Diversity (iter 7030):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9528 (0.0=collapsed)
[Epoch 11/100] [Batch 350/669 (52.3%)] [Iter 7040] Loss: 1.5191 (freq: 0.6001, raw: 0.9184, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 518/1024 (50.6%) Top5:[701,975,108,782,898,952,366,546,119,572,839,39,729,98,888]


π”¬ Encoder Diversity (iter 7040):
  Avg similarity: 0.0591 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9523 (0.0=collapsed)
[Epoch 11/100] [Batch 360/669 (53.8%)] [Iter 7050] Loss: 1.1006 (freq: 0.3745, raw: 0.7256, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[546,708,944,594,600,15,839,952,985,975,782,45,297,338,725]


π”¬ Encoder Diversity (iter 7050):
  Avg similarity: 0.0619 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9384 (0.0=collapsed)
[Epoch 11/100] [Batch 370/669 (55.3%)] [Iter 7060] Loss: 0.8756 (freq: 0.2999, raw: 0.5753, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 505/1024 (49.3%) Top5:[465,45,600,297,944,557,727,670,667,756,594,33,790,399,592]


π”¬ Encoder Diversity (iter 7060):
  Avg similarity: 0.0724 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9372 (0.0=collapsed)
[Epoch 11/100] [Batch 380/669 (56.8%)] [Iter 7070] Loss: 1.3168 (freq: 0.5066, raw: 0.8096, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 485/1024 (47.4%) Top5:[600,572,297,944,729,546,45,701,975,594,71,670,782,55,965]


π”¬ Encoder Diversity (iter 7070):
  Avg similarity: 0.0793 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9485 (0.0=collapsed)
[Epoch 11/100] [Batch 390/669 (58.3%)] [Iter 7080] Loss: 1.3796 (freq: 0.5168, raw: 0.8621, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 537/1024 (52.4%) Top5:[108,729,546,352,701,584,608,782,975,514,411,572,965,985,119]


π”¬ Encoder Diversity (iter 7080):
  Avg similarity: 0.1086 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9360 (0.0=collapsed)
[Epoch 11/100] [Batch 400/669 (59.8%)] [Iter 7090] Loss: 1.0918 (freq: 0.3586, raw: 0.7327, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 567/1024 (55.4%) Top5:[701,297,45,729,465,944,667,722,670,47,584,108,546,600,399]


π”¬ Encoder Diversity (iter 7090):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 11/100] [Batch 410/669 (61.3%)] [Iter 7100] Loss: 1.2180 (freq: 0.4249, raw: 0.7925, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 537/1024 (52.4%) Top5:[297,600,399,45,944,465,519,362,47,667,835,33,790,722,108]


π”¬ Encoder Diversity (iter 7100):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9518 (0.0=collapsed)
[Epoch 11/100] [Batch 420/669 (62.8%)] [Iter 7110] Loss: 0.9242 (freq: 0.2808, raw: 0.6428, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 538/1024 (52.5%) Top5:[600,108,297,701,337,519,594,952,399,45,898,944,790,729,465]


π”¬ Encoder Diversity (iter 7110):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 11/100] [Batch 430/669 (64.3%)] [Iter 7120] Loss: 1.1686 (freq: 0.4570, raw: 0.7111, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 512/1024 (50.0%) Top5:[465,297,944,45,667,975,519,835,47,584,237,722,670,71,399]


π”¬ Encoder Diversity (iter 7120):
  Avg similarity: 0.0676 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9456 (0.0=collapsed)
[Epoch 11/100] [Batch 440/669 (65.8%)] [Iter 7130] Loss: 1.1269 (freq: 0.4061, raw: 0.7203, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 532/1024 (52.0%) Top5:[108,701,546,952,944,782,975,934,572,811,84,465,71,45,592]


π”¬ Encoder Diversity (iter 7130):
  Avg similarity: 0.0674 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9522 (0.0=collapsed)
[Epoch 11/100] [Batch 450/669 (67.3%)] [Iter 7140] Loss: 1.3844 (freq: 0.5115, raw: 0.8723, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 491/1024 (47.9%) Top5:[399,572,546,297,594,944,701,45,47,790,689,672,811,670,975]


π”¬ Encoder Diversity (iter 7140):
  Avg similarity: 0.1281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9250 (0.0=collapsed)
[Epoch 11/100] [Batch 460/669 (68.8%)] [Iter 7150] Loss: 1.0227 (freq: 0.3389, raw: 0.6832, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 505/1024 (49.3%) Top5:[546,701,572,708,839,608,689,594,399,934,519,371,985,672,45]


π”¬ Encoder Diversity (iter 7150):
  Avg similarity: 0.1209 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9230 (0.0=collapsed)
[Epoch 11/100] [Batch 470/669 (70.3%)] [Iter 7160] Loss: 1.0113 (freq: 0.3677, raw: 0.6430, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[701,944,572,667,47,546,297,782,689,985,45,835,839,465,39]


π”¬ Encoder Diversity (iter 7160):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 11/100] [Batch 480/669 (71.7%)] [Iter 7170] Loss: 1.0933 (freq: 0.3766, raw: 0.7160, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 495/1024 (48.3%) Top5:[701,297,399,944,45,670,594,672,667,108,814,790,926,47,337]


π”¬ Encoder Diversity (iter 7170):
  Avg similarity: 0.0681 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 11/100] [Batch 490/669 (73.2%)] [Iter 7180] Loss: 1.2760 (freq: 0.4714, raw: 0.8041, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 504/1024 (49.2%) Top5:[546,108,667,701,47,888,944,584,729,572,689,725,839,33,727]


π”¬ Encoder Diversity (iter 7180):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9467 (0.0=collapsed)
[Epoch 11/100] [Batch 500/669 (74.7%)] [Iter 7190] Loss: 1.3292 (freq: 0.4583, raw: 0.8703, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 506/1024 (49.4%) Top5:[667,546,108,701,608,584,47,920,71,725,729,572,888,338,237]


π”¬ Encoder Diversity (iter 7190):
  Avg similarity: 0.0600 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 11/100] [Batch 510/669 (76.2%)] [Iter 7200] Loss: 1.5415 (freq: 0.6136, raw: 0.9273, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 486/1024 (47.5%) Top5:[667,47,297,546,701,399,944,108,790,519,670,689,756,691,584]


π”¬ Encoder Diversity (iter 7200):
  Avg similarity: 0.0791 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9468 (0.0=collapsed)
[Epoch 11/100] [Batch 520/669 (77.7%)] [Iter 7210] Loss: 0.9810 (freq: 0.3337, raw: 0.6468, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 543/1024 (53.0%) Top5:[297,45,399,667,944,814,594,47,672,856,433,691,975,790,39]


π”¬ Encoder Diversity (iter 7210):
  Avg similarity: 0.0875 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 11/100] [Batch 530/669 (79.2%)] [Iter 7220] Loss: 1.3407 (freq: 0.4662, raw: 0.8739, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 539/1024 (52.6%) Top5:[108,546,45,297,934,944,39,399,701,965,952,594,519,600,782]


π”¬ Encoder Diversity (iter 7220):
  Avg similarity: 0.0632 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 11/100] [Batch 540/669 (80.7%)] [Iter 7230] Loss: 1.2233 (freq: 0.4033, raw: 0.8195, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 490/1024 (47.9%) Top5:[108,546,45,944,934,47,399,691,952,965,584,729,572,352,701]


π”¬ Encoder Diversity (iter 7230):
  Avg similarity: 0.0894 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9401 (0.0=collapsed)
[Epoch 11/100] [Batch 550/669 (82.2%)] [Iter 7240] Loss: 1.3008 (freq: 0.5088, raw: 0.7914, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 536/1024 (52.3%) Top5:[608,572,546,701,108,84,782,944,952,297,934,45,399,729,584]


π”¬ Encoder Diversity (iter 7240):
  Avg similarity: 0.0608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9450 (0.0=collapsed)
[Epoch 11/100] [Batch 560/669 (83.7%)] [Iter 7250] Loss: 1.2812 (freq: 0.4991, raw: 0.7815, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 512/1024 (50.0%) Top5:[944,399,608,84,672,45,756,790,237,782,108,371,600,390,729]


π”¬ Encoder Diversity (iter 7250):
  Avg similarity: 0.0779 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 11/100] [Batch 570/669 (85.2%)] [Iter 7260] Loss: 1.2007 (freq: 0.4115, raw: 0.7887, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 519/1024 (50.7%) Top5:[944,47,716,465,237,399,297,727,667,978,158,790,782,546,45]


π”¬ Encoder Diversity (iter 7260):
  Avg similarity: 0.0587 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 11/100] [Batch 580/669 (86.7%)] [Iter 7270] Loss: 1.1579 (freq: 0.4272, raw: 0.7301, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 478/1024 (46.7%) Top5:[47,546,465,727,45,944,399,691,716,237,297,835,158,670,729]


π”¬ Encoder Diversity (iter 7270):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9509 (0.0=collapsed)
[Epoch 11/100] [Batch 590/669 (88.2%)] [Iter 7280] Loss: 1.1069 (freq: 0.3825, raw: 0.7240, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[45,756,297,600,782,546,594,701,399,672,670,856,944,934,708]


π”¬ Encoder Diversity (iter 7280):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 11/100] [Batch 600/669 (89.7%)] [Iter 7290] Loss: 1.4225 (freq: 0.5632, raw: 0.8587, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 580/1024 (56.6%) Top5:[45,297,47,856,814,399,465,944,985,672,237,835,532,727,999]


π”¬ Encoder Diversity (iter 7290):
  Avg similarity: 0.0511 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 11/100] [Batch 610/669 (91.2%)] [Iter 7300] Loss: 1.3733 (freq: 0.4999, raw: 0.8729, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 527/1024 (51.5%) Top5:[856,297,45,399,546,944,814,985,532,701,672,47,835,934,592]


π”¬ Encoder Diversity (iter 7300):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 11/100] [Batch 620/669 (92.7%)] [Iter 7310] Loss: 0.9770 (freq: 0.3287, raw: 0.6477, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[546,584,548,888,839,975,999,665,708,47,390,297,316,459,405]


π”¬ Encoder Diversity (iter 7310):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9485 (0.0=collapsed)
[Epoch 11/100] [Batch 630/669 (94.2%)] [Iter 7320] Loss: 1.3847 (freq: 0.4661, raw: 0.9178, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 512/1024 (50.0%) Top5:[546,45,297,47,592,856,670,691,667,584,665,33,944,729,600]


π”¬ Encoder Diversity (iter 7320):
  Avg similarity: 0.1024 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9229 (0.0=collapsed)
[Epoch 11/100] [Batch 640/669 (95.7%)] [Iter 7330] Loss: 1.0192 (freq: 0.3537, raw: 0.6650, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 556/1024 (54.3%) Top5:[546,665,729,108,691,920,71,965,856,297,45,352,47,725,600]


π”¬ Encoder Diversity (iter 7330):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 11/100] [Batch 650/669 (97.2%)] [Iter 7340] Loss: 1.2815 (freq: 0.4930, raw: 0.7879, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 600/1024 (58.6%) Top5:[108,691,47,546,39,952,934,413,944,729,352,782,45,433,399]


π”¬ Encoder Diversity (iter 7340):
  Avg similarity: 0.0698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 11/100] [Batch 660/669 (98.7%)] [Iter 7350] Loss: 0.9868 (freq: 0.3331, raw: 0.6531, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 544/1024 (53.1%) Top5:[856,45,670,594,672,297,835,399,532,701,944,337,108,608,355]


π”¬ Encoder Diversity (iter 7350):
  Avg similarity: 0.0857 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9421 (0.0=collapsed)

================================================================================
[Epoch 11] Validation Results:
  Total Loss: 0.6059
  Freq Loss:  0.1815
  Raw Loss:   0.4240
  Quant Loss: 0.0005
  π“ Codebook Usage: 307/1024 (30.0%)
  π“ Codebook Entropy: 4.3264 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 36043 (27.7%)
  Top 10 most used codes:
    1. Code 337: 4543 times (3.49%)
    2. Code 594: 3773 times (2.90%)
    3. Code 856: 3758 times (2.89%)
    4. Code 691: 3677 times (2.82%)
    5. Code 45: 3649 times (2.80%)
    6. Code 297: 3511 times (2.70%)
    7. Code 891: 3427 times (2.63%)
    8. Code 672: 3334 times (2.56%)
    9. Code 19: 3214 times (2.47%)
    10. Code 519: 3157 times (2.42%)
  Bottom 5 least used codes (among used):
    1. Code 92: 3 times (0.00%)
    2. Code 136: 5 times (0.00%)
    3. Code 368: 6 times (0.00%)
    4. Code 9: 7 times (0.01%)
    5. Code 2: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 11
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 12/100] [Batch 1/669 (0.1%)] [Iter 7360] Loss: 1.2468 (freq: 0.4557, raw: 0.7906, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 730/1024 (71.3%) Top5:[532,672,944,45,108,985,297,594,670,237,465,437,546,608,856]


π”¬ Encoder Diversity (iter 7360):
  Avg similarity: 0.0251 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 12/100] [Batch 11/669 (1.6%)] [Iter 7370] Loss: 0.9988 (freq: 0.3473, raw: 0.6510, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 950/1024 (92.8%) Top5:[532,856,672,297,944,45,399,594,580,814,47,670,835,362,337]


π”¬ Encoder Diversity (iter 7370):
  Avg similarity: 0.1102 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9307 (0.0=collapsed)
[Epoch 12/100] [Batch 21/669 (3.1%)] [Iter 7380] Loss: 0.9715 (freq: 0.3508, raw: 0.6201, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[580,532,944,91,465,297,856,380,698,237,526,672,978,47,350]


π”¬ Encoder Diversity (iter 7380):
  Avg similarity: 0.1443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9081 (0.0=collapsed)
[Epoch 12/100] [Batch 31/669 (4.6%)] [Iter 7390] Loss: 0.8789 (freq: 0.2854, raw: 0.5929, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 609/1024 (59.5%) Top5:[580,45,856,297,978,1002,672,944,465,91,756,322,47,909,380]


π”¬ Encoder Diversity (iter 7390):
  Avg similarity: 0.0986 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9341 (0.0=collapsed)
[Epoch 12/100] [Batch 41/669 (6.1%)] [Iter 7400] Loss: 1.1461 (freq: 0.4357, raw: 0.7098, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[856,606,580,45,174,691,415,944,297,577,91,47,686,672,438]


π”¬ Encoder Diversity (iter 7400):
  Avg similarity: 0.1216 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9297 (0.0=collapsed)
[Epoch 12/100] [Batch 51/669 (7.6%)] [Iter 7410] Loss: 1.1316 (freq: 0.3876, raw: 0.7434, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 602/1024 (58.8%) Top5:[580,511,415,606,391,816,174,71,91,686,874,532,438,316,975]


π”¬ Encoder Diversity (iter 7410):
  Avg similarity: 0.0764 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 12/100] [Batch 61/669 (9.1%)] [Iter 7420] Loss: 0.6448 (freq: 0.1888, raw: 0.4556, quant: 0.0004, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 550/1024 (53.7%) Top5:[856,45,594,835,297,944,350,814,667,19,846,399,691,158,47]


π”¬ Encoder Diversity (iter 7420):
  Avg similarity: 0.0848 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9367 (0.0=collapsed)
[Epoch 12/100] [Batch 71/669 (10.6%)] [Iter 7430] Loss: 1.0087 (freq: 0.3667, raw: 0.6415, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 529/1024 (51.7%) Top5:[856,532,580,174,350,526,816,399,944,594,465,47,297,835,686]


π”¬ Encoder Diversity (iter 7430):
  Avg similarity: 0.0582 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 12/100] [Batch 81/669 (12.1%)] [Iter 7440] Loss: 1.2838 (freq: 0.4925, raw: 0.7907, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 526/1024 (51.4%) Top5:[856,297,672,594,45,174,713,944,600,814,580,350,465,337,19]


π”¬ Encoder Diversity (iter 7440):
  Avg similarity: 0.0902 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9436 (0.0=collapsed)
[Epoch 12/100] [Batch 91/669 (13.6%)] [Iter 7450] Loss: 0.9510 (freq: 0.3039, raw: 0.6466, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 495/1024 (48.3%) Top5:[856,297,672,45,399,465,944,47,174,532,406,380,667,383,19]


π”¬ Encoder Diversity (iter 7450):
  Avg similarity: 0.0957 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9271 (0.0=collapsed)
[Epoch 12/100] [Batch 101/669 (15.1%)] [Iter 7460] Loss: 1.5081 (freq: 0.5850, raw: 0.9225, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 535/1024 (52.2%) Top5:[580,350,91,874,174,606,1002,415,672,713,511,686,532,71,850]


π”¬ Encoder Diversity (iter 7460):
  Avg similarity: 0.1020 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9348 (0.0=collapsed)
[Epoch 12/100] [Batch 111/669 (16.6%)] [Iter 7470] Loss: 0.8322 (freq: 0.2641, raw: 0.5676, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 611/1024 (59.7%) Top5:[874,350,713,91,1002,511,174,71,45,670,814,532,944,415,620]


π”¬ Encoder Diversity (iter 7470):
  Avg similarity: 0.1088 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9334 (0.0=collapsed)
[Epoch 12/100] [Batch 121/669 (18.1%)] [Iter 7480] Loss: 1.0820 (freq: 0.4107, raw: 0.6707, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 559/1024 (54.6%) Top5:[91,532,174,511,350,944,577,380,874,316,465,47,856,606,879]


π”¬ Encoder Diversity (iter 7480):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 12/100] [Batch 131/669 (19.6%)] [Iter 7490] Loss: 1.3548 (freq: 0.5025, raw: 0.8517, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 522/1024 (51.0%) Top5:[856,45,600,672,174,580,297,944,713,47,594,465,670,1002,413]


π”¬ Encoder Diversity (iter 7490):
  Avg similarity: 0.1628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9260 (0.0=collapsed)
[Epoch 12/100] [Batch 141/669 (21.1%)] [Iter 7500] Loss: 0.9985 (freq: 0.3443, raw: 0.6537, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 511/1024 (49.9%) Top5:[580,606,174,91,713,380,350,856,393,686,406,459,681,511,100]


π”¬ Encoder Diversity (iter 7500):
  Avg similarity: 0.1048 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9296 (0.0=collapsed)
[Epoch 12/100] [Batch 151/669 (22.6%)] [Iter 7510] Loss: 1.2574 (freq: 0.4576, raw: 0.7992, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 564/1024 (55.1%) Top5:[580,713,350,1002,856,174,71,686,415,874,850,526,459,606,816]


π”¬ Encoder Diversity (iter 7510):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 12/100] [Batch 161/669 (24.1%)] [Iter 7520] Loss: 1.1652 (freq: 0.4195, raw: 0.7451, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 586/1024 (57.2%) Top5:[413,856,667,47,237,350,297,465,846,606,399,594,19,713,45]


π”¬ Encoder Diversity (iter 7520):
  Avg similarity: 0.0655 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9523 (0.0=collapsed)
[Epoch 12/100] [Batch 171/669 (25.6%)] [Iter 7530] Loss: 1.1302 (freq: 0.4307, raw: 0.6989, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 525/1024 (51.3%) Top5:[856,350,297,594,891,606,825,156,672,670,580,667,600,45,532]


π”¬ Encoder Diversity (iter 7530):
  Avg similarity: 0.0724 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 12/100] [Batch 181/669 (27.1%)] [Iter 7540] Loss: 1.2942 (freq: 0.4966, raw: 0.7970, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 497/1024 (48.5%) Top5:[350,297,856,713,580,91,891,47,174,606,814,406,45,667,399]


π”¬ Encoder Diversity (iter 7540):
  Avg similarity: 0.1052 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9368 (0.0=collapsed)
[Epoch 12/100] [Batch 191/669 (28.6%)] [Iter 7550] Loss: 1.2954 (freq: 0.4948, raw: 0.8000, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 512/1024 (50.0%) Top5:[156,297,594,532,406,45,856,32,19,350,891,672,580,713,606]


π”¬ Encoder Diversity (iter 7550):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 12/100] [Batch 201/669 (30.0%)] [Iter 7560] Loss: 1.0486 (freq: 0.3528, raw: 0.6952, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 504/1024 (49.2%) Top5:[580,297,606,713,816,459,874,594,526,174,532,891,45,350,856]


π”¬ Encoder Diversity (iter 7560):
  Avg similarity: 0.0663 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9471 (0.0=collapsed)
[Epoch 12/100] [Batch 211/669 (31.5%)] [Iter 7570] Loss: 0.8411 (freq: 0.2587, raw: 0.5820, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[465,297,47,158,856,944,667,350,237,997,174,606,19,816,978]


π”¬ Encoder Diversity (iter 7570):
  Avg similarity: 0.0607 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 12/100] [Batch 221/669 (33.0%)] [Iter 7580] Loss: 1.1387 (freq: 0.4345, raw: 0.7036, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 483/1024 (47.2%) Top5:[47,297,856,350,19,846,667,174,465,944,45,594,670,91,158]


π”¬ Encoder Diversity (iter 7580):
  Avg similarity: 0.0540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9485 (0.0=collapsed)
[Epoch 12/100] [Batch 231/669 (34.5%)] [Iter 7590] Loss: 1.0043 (freq: 0.3388, raw: 0.6650, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 512/1024 (50.0%) Top5:[350,415,174,972,380,580,856,628,406,532,874,639,1002,19,297]


π”¬ Encoder Diversity (iter 7590):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 12/100] [Batch 241/669 (36.0%)] [Iter 7600] Loss: 1.0762 (freq: 0.3657, raw: 0.7099, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 507/1024 (49.5%) Top5:[45,47,667,465,297,594,856,846,237,600,944,922,691,19,891]


π”¬ Encoder Diversity (iter 7600):
  Avg similarity: 0.0953 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9352 (0.0=collapsed)
[Epoch 12/100] [Batch 251/669 (37.5%)] [Iter 7610] Loss: 1.3104 (freq: 0.4739, raw: 0.8358, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[532,406,526,874,639,465,606,350,816,237,713,380,36,174,511]


π”¬ Encoder Diversity (iter 7610):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 12/100] [Batch 261/669 (39.0%)] [Iter 7620] Loss: 1.2226 (freq: 0.4197, raw: 0.8024, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 515/1024 (50.3%) Top5:[45,297,47,580,19,944,670,174,594,816,698,406,856,259,350]


π”¬ Encoder Diversity (iter 7620):
  Avg similarity: 0.0620 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9522 (0.0=collapsed)
[Epoch 12/100] [Batch 271/669 (40.5%)] [Iter 7630] Loss: 1.1254 (freq: 0.4019, raw: 0.7229, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 532/1024 (52.0%) Top5:[594,580,45,297,874,856,19,670,174,406,1002,816,32,91,672]


π”¬ Encoder Diversity (iter 7630):
  Avg similarity: 0.0765 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9405 (0.0=collapsed)
[Epoch 12/100] [Batch 281/669 (42.0%)] [Iter 7640] Loss: 0.7671 (freq: 0.2604, raw: 0.5062, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 550/1024 (53.7%) Top5:[297,580,594,45,670,259,944,856,19,237,672,825,891,713,1002]


π”¬ Encoder Diversity (iter 7640):
  Avg similarity: 0.1041 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9260 (0.0=collapsed)
[Epoch 12/100] [Batch 291/669 (43.5%)] [Iter 7650] Loss: 1.3425 (freq: 0.4869, raw: 0.8551, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 543/1024 (53.0%) Top5:[713,580,816,350,1002,35,234,415,879,91,874,237,459,295,465]


π”¬ Encoder Diversity (iter 7650):
  Avg similarity: 0.0784 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9353 (0.0=collapsed)
[Epoch 12/100] [Batch 301/669 (45.0%)] [Iter 7660] Loss: 1.0679 (freq: 0.3664, raw: 0.7009, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 535/1024 (52.2%) Top5:[45,156,713,532,600,297,856,944,465,350,237,519,580,874,19]


π”¬ Encoder Diversity (iter 7660):
  Avg similarity: 0.0589 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9449 (0.0=collapsed)
[Epoch 12/100] [Batch 311/669 (46.5%)] [Iter 7670] Loss: 1.3368 (freq: 0.5073, raw: 0.8288, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 530/1024 (51.8%) Top5:[174,580,606,698,713,237,45,350,856,465,297,433,380,406,816]


π”¬ Encoder Diversity (iter 7670):
  Avg similarity: 0.0536 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9514 (0.0=collapsed)
[Epoch 12/100] [Batch 321/669 (48.0%)] [Iter 7680] Loss: 0.9745 (freq: 0.3479, raw: 0.6260, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 613/1024 (59.9%) Top5:[45,237,856,944,297,846,580,47,465,380,174,19,670,686,399]


π”¬ Encoder Diversity (iter 7680):
  Avg similarity: 0.0919 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9397 (0.0=collapsed)
[Epoch 12/100] [Batch 331/669 (49.5%)] [Iter 7690] Loss: 0.8667 (freq: 0.2975, raw: 0.5687, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 580/1024 (56.6%) Top5:[237,47,465,944,851,667,297,580,922,596,816,698,174,19,45]


π”¬ Encoder Diversity (iter 7690):
  Avg similarity: 0.0661 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 12/100] [Batch 341/669 (51.0%)] [Iter 7700] Loss: 1.1382 (freq: 0.4306, raw: 0.7070, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 574/1024 (56.1%) Top5:[350,667,237,1002,503,606,816,713,580,856,297,670,686,825,45]


π”¬ Encoder Diversity (iter 7700):
  Avg similarity: 0.0985 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9321 (0.0=collapsed)
[Epoch 12/100] [Batch 351/669 (52.5%)] [Iter 7710] Loss: 1.2097 (freq: 0.4213, raw: 0.7879, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 566/1024 (55.3%) Top5:[350,1002,580,874,606,297,713,295,667,856,816,922,972,600,672]


π”¬ Encoder Diversity (iter 7710):
  Avg similarity: 0.0822 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9387 (0.0=collapsed)
[Epoch 12/100] [Batch 361/669 (54.0%)] [Iter 7720] Loss: 1.0117 (freq: 0.3609, raw: 0.6502, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 520/1024 (50.8%) Top5:[170,606,350,944,580,297,406,698,856,1002,45,532,713,667,174]


π”¬ Encoder Diversity (iter 7720):
  Avg similarity: 0.1198 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9220 (0.0=collapsed)
[Epoch 12/100] [Batch 371/669 (55.5%)] [Iter 7730] Loss: 0.9649 (freq: 0.3276, raw: 0.6367, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 547/1024 (53.4%) Top5:[713,606,580,156,698,174,695,879,874,380,35,532,816,350,85]


π”¬ Encoder Diversity (iter 7730):
  Avg similarity: 0.1177 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9354 (0.0=collapsed)
[Epoch 12/100] [Batch 381/669 (57.0%)] [Iter 7740] Loss: 1.4080 (freq: 0.4780, raw: 0.9292, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 516/1024 (50.4%) Top5:[713,606,45,297,856,944,399,35,594,532,874,19,380,156,259]


π”¬ Encoder Diversity (iter 7740):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9512 (0.0=collapsed)
[Epoch 12/100] [Batch 391/669 (58.4%)] [Iter 7750] Loss: 1.2875 (freq: 0.4548, raw: 0.8321, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 526/1024 (51.4%) Top5:[944,856,45,594,297,606,532,19,526,617,851,237,348,33,639]


π”¬ Encoder Diversity (iter 7750):
  Avg similarity: 0.0654 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 12/100] [Batch 401/669 (59.9%)] [Iter 7760] Loss: 0.9900 (freq: 0.3247, raw: 0.6647, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 571/1024 (55.8%) Top5:[350,174,580,526,606,639,856,944,532,628,874,698,297,1002,415]


π”¬ Encoder Diversity (iter 7760):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 12/100] [Batch 411/669 (61.4%)] [Iter 7770] Loss: 1.2952 (freq: 0.5034, raw: 0.7911, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 550/1024 (53.7%) Top5:[600,519,580,594,596,350,380,856,174,816,45,406,1002,874,297]


π”¬ Encoder Diversity (iter 7770):
  Avg similarity: 0.1051 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9258 (0.0=collapsed)
[Epoch 12/100] [Batch 421/669 (62.9%)] [Iter 7780] Loss: 1.0469 (freq: 0.3620, raw: 0.6842, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 583/1024 (56.9%) Top5:[600,944,45,297,519,670,606,399,856,348,580,156,594,174,465]


π”¬ Encoder Diversity (iter 7780):
  Avg similarity: 0.0654 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 12/100] [Batch 431/669 (64.4%)] [Iter 7790] Loss: 0.9872 (freq: 0.3524, raw: 0.6343, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 557/1024 (54.4%) Top5:[45,944,297,594,580,600,399,204,465,856,670,519,156,348,592]


π”¬ Encoder Diversity (iter 7790):
  Avg similarity: 0.0819 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9421 (0.0=collapsed)
[Epoch 12/100] [Batch 441/669 (65.9%)] [Iter 7800] Loss: 1.4526 (freq: 0.4915, raw: 0.9605, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 532/1024 (52.0%) Top5:[350,713,35,874,709,156,580,532,174,465,606,526,944,816,297]


π”¬ Encoder Diversity (iter 7800):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9500 (0.0=collapsed)
[Epoch 12/100] [Batch 451/669 (67.4%)] [Iter 7810] Loss: 1.1985 (freq: 0.4389, raw: 0.7590, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 534/1024 (52.1%) Top5:[350,297,156,606,698,532,713,879,617,399,580,91,383,526,681]


π”¬ Encoder Diversity (iter 7810):
  Avg similarity: 0.0765 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9389 (0.0=collapsed)
[Epoch 12/100] [Batch 461/669 (68.9%)] [Iter 7820] Loss: 1.2170 (freq: 0.4352, raw: 0.7812, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 528/1024 (51.6%) Top5:[713,465,297,532,944,639,350,348,1002,816,606,856,409,399,874]


π”¬ Encoder Diversity (iter 7820):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 12/100] [Batch 471/669 (70.4%)] [Iter 7830] Loss: 1.0523 (freq: 0.3550, raw: 0.6968, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 568/1024 (55.5%) Top5:[297,594,856,399,600,944,713,606,596,259,840,465,519,672,32]


π”¬ Encoder Diversity (iter 7830):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 12/100] [Batch 481/669 (71.9%)] [Iter 7840] Loss: 1.2572 (freq: 0.4865, raw: 0.7700, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 542/1024 (52.9%) Top5:[606,856,713,639,399,406,816,156,672,35,600,594,909,297,695]


π”¬ Encoder Diversity (iter 7840):
  Avg similarity: 0.0785 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9411 (0.0=collapsed)
[Epoch 12/100] [Batch 491/669 (73.4%)] [Iter 7850] Loss: 1.4107 (freq: 0.5583, raw: 0.8518, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 601/1024 (58.7%) Top5:[156,606,237,433,465,406,816,851,35,580,698,695,944,380,639]


π”¬ Encoder Diversity (iter 7850):
  Avg similarity: 0.1164 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9329 (0.0=collapsed)
[Epoch 12/100] [Batch 501/669 (74.9%)] [Iter 7860] Loss: 1.2641 (freq: 0.4633, raw: 0.8002, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 611/1024 (59.7%) Top5:[606,874,45,297,35,580,698,856,91,103,526,639,909,532,879]


π”¬ Encoder Diversity (iter 7860):
  Avg similarity: 0.0679 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 12/100] [Batch 511/669 (76.4%)] [Iter 7870] Loss: 1.0621 (freq: 0.3627, raw: 0.6987, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 552/1024 (53.9%) Top5:[944,45,594,856,592,237,433,519,297,33,670,156,698,891,399]


π”¬ Encoder Diversity (iter 7870):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 12/100] [Batch 521/669 (77.9%)] [Iter 7880] Loss: 1.2211 (freq: 0.4564, raw: 0.7640, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 562/1024 (54.9%) Top5:[103,580,532,350,91,295,698,35,874,686,237,45,617,174,380]


π”¬ Encoder Diversity (iter 7880):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 12/100] [Batch 531/669 (79.4%)] [Iter 7890] Loss: 0.8866 (freq: 0.3021, raw: 0.5840, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 500/1024 (48.8%) Top5:[594,672,944,297,773,45,237,348,922,856,399,592,700,899,433]


π”¬ Encoder Diversity (iter 7890):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 12/100] [Batch 541/669 (80.9%)] [Iter 7900] Loss: 1.2462 (freq: 0.4734, raw: 0.7722, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 575/1024 (56.2%) Top5:[606,594,103,856,399,174,297,580,713,91,944,45,639,672,32]


π”¬ Encoder Diversity (iter 7900):
  Avg similarity: 0.0614 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 12/100] [Batch 551/669 (82.4%)] [Iter 7910] Loss: 0.8226 (freq: 0.2903, raw: 0.5318, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 527/1024 (51.5%) Top5:[399,899,297,700,594,45,465,409,922,348,433,851,825,26,580]


π”¬ Encoder Diversity (iter 7910):
  Avg similarity: 0.0690 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9382 (0.0=collapsed)
[Epoch 12/100] [Batch 561/669 (83.9%)] [Iter 7920] Loss: 1.2291 (freq: 0.4313, raw: 0.7973, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 545/1024 (53.2%) Top5:[580,103,156,594,399,45,713,297,606,639,532,944,19,425,205]


π”¬ Encoder Diversity (iter 7920):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9561 (0.0=collapsed)
[Epoch 12/100] [Batch 571/669 (85.4%)] [Iter 7930] Loss: 1.1684 (freq: 0.4084, raw: 0.7594, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 568/1024 (55.5%) Top5:[103,156,174,580,698,606,205,594,350,526,874,617,686,35,639]


π”¬ Encoder Diversity (iter 7930):
  Avg similarity: 0.0994 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9416 (0.0=collapsed)
[Epoch 12/100] [Batch 581/669 (86.8%)] [Iter 7940] Loss: 1.2268 (freq: 0.4568, raw: 0.7694, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 561/1024 (54.8%) Top5:[594,773,944,45,350,672,399,617,698,103,35,874,526,393,580]


π”¬ Encoder Diversity (iter 7940):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9491 (0.0=collapsed)
[Epoch 12/100] [Batch 591/669 (88.3%)] [Iter 7950] Loss: 0.9728 (freq: 0.3488, raw: 0.6234, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 559/1024 (54.6%) Top5:[769,606,639,573,874,350,440,35,103,580,45,174,794,700,465]


π”¬ Encoder Diversity (iter 7950):
  Avg similarity: 0.0629 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9455 (0.0=collapsed)
[Epoch 12/100] [Batch 601/669 (89.8%)] [Iter 7960] Loss: 1.1817 (freq: 0.4147, raw: 0.7664, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 515/1024 (50.3%) Top5:[45,594,592,606,91,773,580,532,103,297,944,174,617,874,350]


π”¬ Encoder Diversity (iter 7960):
  Avg similarity: 0.0930 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)
[Epoch 12/100] [Batch 611/669 (91.3%)] [Iter 7970] Loss: 0.9707 (freq: 0.3148, raw: 0.6554, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 577/1024 (56.3%) Top5:[944,45,103,606,773,700,617,594,899,399,641,174,874,237,297]


π”¬ Encoder Diversity (iter 7970):
  Avg similarity: 0.0759 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9490 (0.0=collapsed)
[Epoch 12/100] [Batch 621/669 (92.8%)] [Iter 7980] Loss: 1.2516 (freq: 0.4822, raw: 0.7688, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 558/1024 (54.5%) Top5:[773,594,399,944,45,592,19,297,347,825,982,395,617,700,33]


π”¬ Encoder Diversity (iter 7980):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 12/100] [Batch 631/669 (94.3%)] [Iter 7990] Loss: 1.3619 (freq: 0.5214, raw: 0.8399, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[103,580,45,982,347,594,85,174,297,773,32,606,639,259,874]


π”¬ Encoder Diversity (iter 7990):
  Avg similarity: 0.0953 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9426 (0.0=collapsed)
[Epoch 12/100] [Batch 641/669 (95.8%)] [Iter 8000] Loss: 1.1392 (freq: 0.4215, raw: 0.7171, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 575/1024 (56.2%) Top5:[103,580,982,639,297,174,259,156,35,347,594,399,713,568,573]


π”¬ Encoder Diversity (iter 8000):
  Avg similarity: 0.0759 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9442 (0.0=collapsed)
[Epoch 12/100] [Batch 651/669 (97.3%)] [Iter 8010] Loss: 0.9881 (freq: 0.3629, raw: 0.6247, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[982,103,769,639,594,297,45,580,156,237,465,399,617,35,433]


π”¬ Encoder Diversity (iter 8010):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 12/100] [Batch 661/669 (98.8%)] [Iter 8020] Loss: 1.1019 (freq: 0.3995, raw: 0.7018, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 509/1024 (49.7%) Top5:[237,103,573,465,944,982,297,98,899,700,45,348,606,594,35]


π”¬ Encoder Diversity (iter 8020):
  Avg similarity: 0.0725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)

================================================================================
[Epoch 12] Validation Results:
  Total Loss: 0.6023
  Freq Loss:  0.1823
  Raw Loss:   0.4195
  Quant Loss: 0.0005
  π“ Codebook Usage: 304/1024 (29.7%)
  π“ Codebook Entropy: 4.3910 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 31919 (24.5%)
  Top 10 most used codes:
    1. Code 98: 3511 times (2.70%)
    2. Code 519: 3427 times (2.63%)
    3. Code 596: 3375 times (2.59%)
    4. Code 931: 3304 times (2.54%)
    5. Code 600: 3290 times (2.53%)
    6. Code 773: 3278 times (2.52%)
    7. Code 672: 3049 times (2.34%)
    8. Code 399: 2923 times (2.25%)
    9. Code 594: 2917 times (2.24%)
    10. Code 297: 2845 times (2.19%)
  Bottom 5 least used codes (among used):
    1. Code 359: 1 times (0.00%)
    2. Code 458: 1 times (0.00%)
    3. Code 739: 2 times (0.00%)
    4. Code 83: 2 times (0.00%)
    5. Code 242: 5 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 12
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 13/100] [Batch 2/669 (0.3%)] [Iter 8030] Loss: 1.4769 (freq: 0.6566, raw: 0.8194, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[297,594,465,98,19,944,982,592,237,891,259,45,347,33,399]


π”¬ Encoder Diversity (iter 8030):
  Avg similarity: 0.0965 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9382 (0.0=collapsed)
[Epoch 13/100] [Batch 12/669 (1.8%)] [Iter 8040] Loss: 1.2381 (freq: 0.4476, raw: 0.7898, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 927/1024 (90.5%) Top5:[297,773,594,259,891,596,856,982,33,592,818,347,600,19,48]


π”¬ Encoder Diversity (iter 8040):
  Avg similarity: 0.0998 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9383 (0.0=collapsed)
[Epoch 13/100] [Batch 22/669 (3.3%)] [Iter 8050] Loss: 1.3925 (freq: 0.5402, raw: 0.8517, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 635/1024 (62.0%) Top5:[594,297,508,773,818,787,904,646,647,98,907,265,688,233,29]


π”¬ Encoder Diversity (iter 8050):
  Avg similarity: 0.0896 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9450 (0.0=collapsed)
[Epoch 13/100] [Batch 32/669 (4.8%)] [Iter 8060] Loss: 0.8366 (freq: 0.2684, raw: 0.5677, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 583/1024 (56.9%) Top5:[594,297,237,98,399,348,891,944,982,700,20,64,465,265,321]


π”¬ Encoder Diversity (iter 8060):
  Avg similarity: 0.0794 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9466 (0.0=collapsed)
[Epoch 13/100] [Batch 42/669 (6.3%)] [Iter 8070] Loss: 1.1092 (freq: 0.3854, raw: 0.7233, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 569/1024 (55.6%) Top5:[944,321,237,399,982,297,700,456,891,594,64,98,347,395,807]


π”¬ Encoder Diversity (iter 8070):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 13/100] [Batch 52/669 (7.8%)] [Iter 8080] Loss: 0.9821 (freq: 0.3195, raw: 0.6621, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 566/1024 (55.3%) Top5:[321,982,773,297,891,399,265,923,594,233,237,944,949,64,259]


π”¬ Encoder Diversity (iter 8080):
  Avg similarity: 0.0783 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9381 (0.0=collapsed)
[Epoch 13/100] [Batch 62/669 (9.3%)] [Iter 8090] Loss: 1.1611 (freq: 0.3636, raw: 0.7970, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 522/1024 (51.0%) Top5:[856,891,321,596,297,982,546,64,773,233,646,259,931,923,456]


π”¬ Encoder Diversity (iter 8090):
  Avg similarity: 0.0851 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9431 (0.0=collapsed)
[Epoch 13/100] [Batch 72/669 (10.8%)] [Iter 8100] Loss: 1.0866 (freq: 0.3610, raw: 0.7250, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[233,856,297,700,982,546,944,891,596,399,237,421,773,64,259]


π”¬ Encoder Diversity (iter 8100):
  Avg similarity: 0.0646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 13/100] [Batch 82/669 (12.3%)] [Iter 8110] Loss: 1.0419 (freq: 0.3530, raw: 0.6882, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 564/1024 (55.1%) Top5:[982,233,594,297,421,237,891,399,546,683,646,347,456,592,98]


π”¬ Encoder Diversity (iter 8110):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 13/100] [Batch 92/669 (13.8%)] [Iter 8120] Loss: 1.1954 (freq: 0.4139, raw: 0.7809, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 546/1024 (53.3%) Top5:[233,98,594,297,456,982,237,949,683,45,891,265,646,399,29]


π”¬ Encoder Diversity (iter 8120):
  Avg similarity: 0.0582 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 13/100] [Batch 102/669 (15.2%)] [Iter 8130] Loss: 1.2770 (freq: 0.4938, raw: 0.7826, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 599/1024 (58.5%) Top5:[594,891,592,982,773,64,233,45,265,672,646,949,944,456,19]


π”¬ Encoder Diversity (iter 8130):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 13/100] [Batch 112/669 (16.7%)] [Iter 8140] Loss: 0.9814 (freq: 0.3689, raw: 0.6119, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 520/1024 (50.8%) Top5:[982,594,297,773,944,672,347,891,465,433,348,259,592,98,33]


π”¬ Encoder Diversity (iter 8140):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 13/100] [Batch 122/669 (18.2%)] [Iter 8150] Loss: 1.0040 (freq: 0.3513, raw: 0.6520, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 553/1024 (54.0%) Top5:[546,891,982,297,233,465,456,646,348,64,433,683,944,536,399]


π”¬ Encoder Diversity (iter 8150):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 13/100] [Batch 132/669 (19.7%)] [Iter 8160] Loss: 1.0697 (freq: 0.3763, raw: 0.6928, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 538/1024 (52.5%) Top5:[982,297,456,944,891,233,923,321,433,465,237,594,596,45,773]


π”¬ Encoder Diversity (iter 8160):
  Avg similarity: 0.1032 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 13/100] [Batch 142/669 (21.2%)] [Iter 8170] Loss: 1.0072 (freq: 0.3744, raw: 0.6323, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 532/1024 (52.0%) Top5:[321,944,433,456,683,250,237,891,949,297,399,45,982,923,20]


π”¬ Encoder Diversity (iter 8170):
  Avg similarity: 0.0890 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 13/100] [Batch 152/669 (22.7%)] [Iter 8180] Loss: 1.0363 (freq: 0.3735, raw: 0.6623, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 571/1024 (55.8%) Top5:[944,237,45,399,297,465,891,949,20,456,735,33,594,700,433]


π”¬ Encoder Diversity (iter 8180):
  Avg similarity: 0.0785 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9448 (0.0=collapsed)
[Epoch 13/100] [Batch 162/669 (24.2%)] [Iter 8190] Loss: 0.8832 (freq: 0.3083, raw: 0.5744, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 539/1024 (52.6%) Top5:[546,465,399,433,297,982,45,237,168,33,646,592,347,891,233]


π”¬ Encoder Diversity (iter 8190):
  Avg similarity: 0.0685 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9442 (0.0=collapsed)
[Epoch 13/100] [Batch 172/669 (25.7%)] [Iter 8200] Loss: 1.4105 (freq: 0.5352, raw: 0.8747, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 563/1024 (55.0%) Top5:[672,465,456,594,237,45,891,399,297,33,348,19,944,700,170]


π”¬ Encoder Diversity (iter 8200):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 13/100] [Batch 182/669 (27.2%)] [Iter 8210] Loss: 1.2670 (freq: 0.4904, raw: 0.7759, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 531/1024 (51.9%) Top5:[409,672,465,982,944,891,456,683,754,949,399,45,508,454,343]


π”¬ Encoder Diversity (iter 8210):
  Avg similarity: 0.0905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9367 (0.0=collapsed)
[Epoch 13/100] [Batch 192/669 (28.7%)] [Iter 8220] Loss: 1.3934 (freq: 0.5371, raw: 0.8556, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 545/1024 (53.2%) Top5:[233,683,546,646,456,672,923,508,536,421,982,257,711,498,430]


π”¬ Encoder Diversity (iter 8220):
  Avg similarity: 0.0673 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 13/100] [Batch 202/669 (30.2%)] [Iter 8230] Loss: 1.2402 (freq: 0.4660, raw: 0.7736, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 540/1024 (52.7%) Top5:[944,982,297,895,923,891,672,856,399,465,546,421,409,646,931]


π”¬ Encoder Diversity (iter 8230):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 13/100] [Batch 212/669 (31.7%)] [Iter 8240] Loss: 1.4028 (freq: 0.5233, raw: 0.8788, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 563/1024 (55.0%) Top5:[944,321,923,456,433,421,297,647,408,265,895,592,233,348,237]


π”¬ Encoder Diversity (iter 8240):
  Avg similarity: 0.0650 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 13/100] [Batch 222/669 (33.2%)] [Iter 8250] Loss: 0.8389 (freq: 0.2687, raw: 0.5697, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 533/1024 (52.1%) Top5:[4,982,297,456,895,891,233,594,856,944,802,421,546,134,45]


π”¬ Encoder Diversity (iter 8250):
  Avg similarity: 0.0695 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 13/100] [Batch 232/669 (34.7%)] [Iter 8260] Loss: 1.2642 (freq: 0.4833, raw: 0.7803, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 560/1024 (54.7%) Top5:[949,233,944,700,45,498,408,237,827,982,891,423,168,353,409]


π”¬ Encoder Diversity (iter 8260):
  Avg similarity: 0.0665 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 13/100] [Batch 242/669 (36.2%)] [Iter 8270] Loss: 1.0239 (freq: 0.3195, raw: 0.7038, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[233,982,646,891,647,45,754,250,421,297,456,944,4,672,269]


π”¬ Encoder Diversity (iter 8270):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 13/100] [Batch 252/669 (37.7%)] [Iter 8280] Loss: 1.0244 (freq: 0.3802, raw: 0.6436, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 532/1024 (52.0%) Top5:[982,891,399,233,592,409,297,456,944,856,45,4,672,895,646]


π”¬ Encoder Diversity (iter 8280):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 13/100] [Batch 262/669 (39.2%)] [Iter 8290] Loss: 1.0741 (freq: 0.3785, raw: 0.6950, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 633/1024 (61.8%) Top5:[321,647,982,134,4,856,895,646,421,672,433,259,456,237,233]


π”¬ Encoder Diversity (iter 8290):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 13/100] [Batch 272/669 (40.7%)] [Iter 8300] Loss: 0.9603 (freq: 0.2949, raw: 0.6648, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 577/1024 (56.3%) Top5:[546,456,321,683,4,342,233,646,982,937,944,923,495,895,353]


π”¬ Encoder Diversity (iter 8300):
  Avg similarity: 0.0638 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9548 (0.0=collapsed)
[Epoch 13/100] [Batch 282/669 (42.2%)] [Iter 8310] Loss: 1.0021 (freq: 0.3622, raw: 0.6393, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 560/1024 (54.7%) Top5:[944,891,237,982,399,433,672,45,4,321,409,851,923,899,600]


π”¬ Encoder Diversity (iter 8310):
  Avg similarity: 0.0796 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9418 (0.0=collapsed)
[Epoch 13/100] [Batch 292/669 (43.6%)] [Iter 8320] Loss: 1.0884 (freq: 0.3608, raw: 0.7270, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 561/1024 (54.8%) Top5:[456,409,891,233,982,646,944,700,45,399,237,856,672,594,937]


π”¬ Encoder Diversity (iter 8320):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 13/100] [Batch 302/669 (45.1%)] [Iter 8330] Loss: 0.9630 (freq: 0.3330, raw: 0.6294, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 582/1024 (56.8%) Top5:[944,409,891,982,856,45,399,343,700,594,4,233,347,237,11]


π”¬ Encoder Diversity (iter 8330):
  Avg similarity: 0.0716 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9473 (0.0=collapsed)
[Epoch 13/100] [Batch 312/669 (46.6%)] [Iter 8340] Loss: 1.4671 (freq: 0.5353, raw: 0.9311, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 572/1024 (55.9%) Top5:[456,353,233,802,646,982,891,856,944,168,374,134,498,4,923]


π”¬ Encoder Diversity (iter 8340):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 13/100] [Batch 322/669 (48.1%)] [Iter 8350] Loss: 1.0832 (freq: 0.3894, raw: 0.6932, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 542/1024 (52.9%) Top5:[592,456,321,233,4,982,891,856,134,646,348,259,421,937,45]


π”¬ Encoder Diversity (iter 8350):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 13/100] [Batch 332/669 (49.6%)] [Iter 8360] Loss: 1.2142 (freq: 0.4274, raw: 0.7861, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 620/1024 (60.5%) Top5:[321,683,456,433,923,265,250,233,390,647,134,754,944,237,949]


π”¬ Encoder Diversity (iter 8360):
  Avg similarity: 0.0849 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9431 (0.0=collapsed)
[Epoch 13/100] [Batch 342/669 (51.1%)] [Iter 8370] Loss: 1.0407 (freq: 0.3833, raw: 0.6568, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 618/1024 (60.4%) Top5:[944,321,433,982,237,45,11,698,399,343,891,754,743,899,672]


π”¬ Encoder Diversity (iter 8370):
  Avg similarity: 0.0693 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9392 (0.0=collapsed)
[Epoch 13/100] [Batch 352/669 (52.6%)] [Iter 8380] Loss: 1.3628 (freq: 0.5223, raw: 0.8398, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 624/1024 (60.9%) Top5:[982,944,891,672,399,4,297,546,456,700,64,45,754,594,11]


π”¬ Encoder Diversity (iter 8380):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9533 (0.0=collapsed)
[Epoch 13/100] [Batch 362/669 (54.1%)] [Iter 8390] Loss: 0.9884 (freq: 0.3513, raw: 0.6366, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 595/1024 (58.1%) Top5:[982,891,672,856,321,4,594,399,233,1,456,297,944,895,683]


π”¬ Encoder Diversity (iter 8390):
  Avg similarity: 0.0535 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9515 (0.0=collapsed)
[Epoch 13/100] [Batch 372/669 (55.6%)] [Iter 8400] Loss: 1.1286 (freq: 0.4213, raw: 0.7067, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 592/1024 (57.8%) Top5:[233,646,265,937,353,209,45,683,982,456,787,321,421,342,508]


π”¬ Encoder Diversity (iter 8400):
  Avg similarity: 0.0666 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 13/100] [Batch 382/669 (57.1%)] [Iter 8410] Loss: 1.1994 (freq: 0.4025, raw: 0.7963, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 638/1024 (62.3%) Top5:[982,45,399,891,700,209,297,465,944,672,237,754,1,805,856]


π”¬ Encoder Diversity (iter 8410):
  Avg similarity: 0.0342 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 13/100] [Batch 392/669 (58.6%)] [Iter 8420] Loss: 1.4794 (freq: 0.5503, raw: 0.9285, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 585/1024 (57.1%) Top5:[891,353,1,233,982,937,546,342,646,4,399,456,6,259,257]


π”¬ Encoder Diversity (iter 8420):
  Avg similarity: 0.0957 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9383 (0.0=collapsed)
[Epoch 13/100] [Batch 402/669 (60.1%)] [Iter 8430] Loss: 1.3216 (freq: 0.4763, raw: 0.8446, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 614/1024 (60.0%) Top5:[891,683,646,456,342,546,233,433,257,237,421,353,399,937,6]


π”¬ Encoder Diversity (iter 8430):
  Avg similarity: 0.0606 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 13/100] [Batch 412/669 (61.6%)] [Iter 8440] Loss: 1.2416 (freq: 0.4597, raw: 0.7812, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 589/1024 (57.5%) Top5:[891,944,433,399,45,982,209,465,851,743,672,754,1,856,117]


π”¬ Encoder Diversity (iter 8440):
  Avg similarity: 0.0611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 13/100] [Batch 422/669 (63.1%)] [Iter 8450] Loss: 1.0434 (freq: 0.3292, raw: 0.7137, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 585/1024 (57.1%) Top5:[891,399,433,944,45,982,851,672,754,117,265,743,856,465,237]


π”¬ Encoder Diversity (iter 8450):
  Avg similarity: 0.0474 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 13/100] [Batch 432/669 (64.6%)] [Iter 8460] Loss: 1.2754 (freq: 0.4680, raw: 0.8067, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 568/1024 (55.5%) Top5:[399,891,672,982,583,45,433,259,1,265,856,456,600,700,646]


π”¬ Encoder Diversity (iter 8460):
  Avg similarity: 0.0828 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9359 (0.0=collapsed)
[Epoch 13/100] [Batch 442/669 (66.1%)] [Iter 8470] Loss: 1.0401 (freq: 0.3902, raw: 0.6493, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 628/1024 (61.3%) Top5:[456,399,45,944,546,893,321,949,353,594,408,700,342,937,150]


π”¬ Encoder Diversity (iter 8470):
  Avg similarity: 0.0684 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 13/100] [Batch 452/669 (67.6%)] [Iter 8480] Loss: 1.0909 (freq: 0.3565, raw: 0.7339, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 595/1024 (58.1%) Top5:[456,754,237,150,45,546,433,944,465,374,342,11,399,233,343]


π”¬ Encoder Diversity (iter 8480):
  Avg similarity: 0.0662 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 13/100] [Batch 462/669 (69.1%)] [Iter 8490] Loss: 0.9575 (freq: 0.3063, raw: 0.6506, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 560/1024 (54.7%) Top5:[546,456,233,982,891,45,944,421,839,342,646,1,399,265,949]


π”¬ Encoder Diversity (iter 8490):
  Avg similarity: 0.0668 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 13/100] [Batch 472/669 (70.6%)] [Iter 8500] Loss: 1.1025 (freq: 0.3858, raw: 0.7161, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 575/1024 (56.2%) Top5:[433,944,465,237,45,233,743,546,982,891,421,856,343,937,495]


π”¬ Encoder Diversity (iter 8500):
  Avg similarity: 0.0968 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9352 (0.0=collapsed)
[Epoch 13/100] [Batch 482/669 (72.0%)] [Iter 8510] Loss: 1.1318 (freq: 0.4467, raw: 0.6845, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 572/1024 (55.9%) Top5:[233,456,646,891,399,903,647,498,944,546,45,982,683,425,856]


π”¬ Encoder Diversity (iter 8510):
  Avg similarity: 0.0593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9431 (0.0=collapsed)
[Epoch 13/100] [Batch 492/669 (73.5%)] [Iter 8520] Loss: 1.1374 (freq: 0.4047, raw: 0.7321, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 603/1024 (58.9%) Top5:[456,944,891,399,433,45,498,743,672,134,982,353,546,342,949]


π”¬ Encoder Diversity (iter 8520):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 13/100] [Batch 502/669 (75.0%)] [Iter 8530] Loss: 1.3353 (freq: 0.4843, raw: 0.8503, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[275,456,982,399,944,672,546,4,891,64,851,45,214,353,461]


π”¬ Encoder Diversity (iter 8530):
  Avg similarity: 0.0935 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 13/100] [Batch 512/669 (76.5%)] [Iter 8540] Loss: 0.9944 (freq: 0.3388, raw: 0.6550, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 637/1024 (62.2%) Top5:[456,214,405,672,342,353,937,849,64,508,802,212,907,688,118]


π”¬ Encoder Diversity (iter 8540):
  Avg similarity: 0.0655 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 13/100] [Batch 522/669 (78.0%)] [Iter 8550] Loss: 0.8648 (freq: 0.2574, raw: 0.6069, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 580/1024 (56.6%) Top5:[672,982,237,456,399,895,342,433,11,944,1,343,856,583,546]


π”¬ Encoder Diversity (iter 8550):
  Avg similarity: 0.0810 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 13/100] [Batch 532/669 (79.5%)] [Iter 8560] Loss: 1.3205 (freq: 0.4843, raw: 0.8356, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 609/1024 (59.5%) Top5:[546,233,425,672,433,683,237,465,583,646,944,421,594,992,134]


π”¬ Encoder Diversity (iter 8560):
  Avg similarity: 0.0957 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9410 (0.0=collapsed)
[Epoch 13/100] [Batch 542/669 (81.0%)] [Iter 8570] Loss: 0.8829 (freq: 0.2990, raw: 0.5834, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 620/1024 (60.5%) Top5:[891,856,982,895,672,839,259,45,546,1,592,399,11,9,583]


π”¬ Encoder Diversity (iter 8570):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 13/100] [Batch 552/669 (82.5%)] [Iter 8580] Loss: 1.0617 (freq: 0.3764, raw: 0.6847, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[456,233,546,495,498,45,647,683,425,672,265,583,536,1,399]


π”¬ Encoder Diversity (iter 8580):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 13/100] [Batch 562/669 (84.0%)] [Iter 8590] Loss: 1.3415 (freq: 0.4785, raw: 0.8624, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 594/1024 (58.0%) Top5:[456,45,9,233,891,937,536,895,672,353,342,259,495,839,134]


π”¬ Encoder Diversity (iter 8590):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 13/100] [Batch 572/669 (85.5%)] [Iter 8600] Loss: 1.4483 (freq: 0.5042, raw: 0.9434, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 602/1024 (58.8%) Top5:[456,688,134,891,353,944,787,233,6,700,893,45,342,901,672]


π”¬ Encoder Diversity (iter 8600):
  Avg similarity: 0.0563 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 13/100] [Batch 582/669 (87.0%)] [Iter 8610] Loss: 1.1078 (freq: 0.3868, raw: 0.7204, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[891,944,353,982,456,45,839,134,672,399,856,233,583,700,259]


π”¬ Encoder Diversity (iter 8610):
  Avg similarity: 0.0696 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9446 (0.0=collapsed)
[Epoch 13/100] [Batch 592/669 (88.5%)] [Iter 8620] Loss: 1.2146 (freq: 0.4437, raw: 0.7702, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 596/1024 (58.2%) Top5:[672,45,546,399,297,982,150,700,583,456,891,9,944,233,11]


π”¬ Encoder Diversity (iter 8620):
  Avg similarity: 0.0720 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9403 (0.0=collapsed)
[Epoch 13/100] [Batch 602/669 (90.0%)] [Iter 8630] Loss: 0.9858 (freq: 0.3582, raw: 0.6271, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 631/1024 (61.6%) Top5:[45,456,856,1012,546,982,275,399,583,265,891,64,672,937,656]


π”¬ Encoder Diversity (iter 8630):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 13/100] [Batch 612/669 (91.5%)] [Iter 8640] Loss: 1.3182 (freq: 0.5182, raw: 0.7993, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 623/1024 (60.8%) Top5:[456,265,982,134,421,275,64,399,233,342,353,688,846,408,390]


π”¬ Encoder Diversity (iter 8640):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 13/100] [Batch 622/669 (93.0%)] [Iter 8650] Loss: 1.2008 (freq: 0.4128, raw: 0.7874, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 623/1024 (60.8%) Top5:[233,456,353,856,536,265,672,583,498,64,421,802,683,495,408]


π”¬ Encoder Diversity (iter 8650):
  Avg similarity: 0.0812 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9448 (0.0=collapsed)
[Epoch 13/100] [Batch 632/669 (94.5%)] [Iter 8660] Loss: 1.3040 (freq: 0.5119, raw: 0.7915, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 581/1024 (56.7%) Top5:[456,214,353,233,856,583,45,342,982,992,321,265,399,6,498]


π”¬ Encoder Diversity (iter 8660):
  Avg similarity: 0.0756 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 13/100] [Batch 642/669 (96.0%)] [Iter 8670] Loss: 1.2560 (freq: 0.4711, raw: 0.7843, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 594/1024 (58.0%) Top5:[456,214,353,583,342,937,257,802,546,399,498,150,903,891,672]


π”¬ Encoder Diversity (iter 8670):
  Avg similarity: 0.0358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 13/100] [Batch 652/669 (97.5%)] [Iter 8680] Loss: 0.9797 (freq: 0.3535, raw: 0.6256, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 575/1024 (56.2%) Top5:[583,45,297,399,856,58,546,456,839,433,891,672,710,347,11]


π”¬ Encoder Diversity (iter 8680):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 13/100] [Batch 662/669 (99.0%)] [Iter 8690] Loss: 0.9137 (freq: 0.2746, raw: 0.6385, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 574/1024 (56.1%) Top5:[45,856,583,672,891,399,297,347,944,11,710,839,982,456,433]


π”¬ Encoder Diversity (iter 8690):
  Avg similarity: 0.0844 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)

================================================================================
[Epoch 13] Validation Results:
  Total Loss: 0.5970
  Freq Loss:  0.1792
  Raw Loss:   0.4172
  Quant Loss: 0.0005
  π“ Codebook Usage: 483/1024 (47.2%)
  π“ Codebook Entropy: 4.5676 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 35457 (27.2%)
  Top 10 most used codes:
    1. Code 58: 4580 times (3.52%)
    2. Code 891: 4280 times (3.29%)
    3. Code 592: 4121 times (3.17%)
    4. Code 856: 3820 times (2.93%)
    5. Code 982: 3567 times (2.74%)
    6. Code 895: 3160 times (2.43%)
    7. Code 45: 3097 times (2.38%)
    8. Code 11: 3083 times (2.37%)
    9. Code 672: 2878 times (2.21%)
    10. Code 170: 2871 times (2.21%)
  Bottom 5 least used codes (among used):
    1. Code 136: 1 times (0.00%)
    2. Code 10: 1 times (0.00%)
    3. Code 195: 1 times (0.00%)
    4. Code 296: 1 times (0.00%)
    5. Code 218: 1 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 13
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 14/100] [Batch 3/669 (0.4%)] [Iter 8700] Loss: 1.0704 (freq: 0.3683, raw: 0.7013, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[891,265,944,583,45,743,546,212,851,672,415,856,214,592,698]


π”¬ Encoder Diversity (iter 8700):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9350 (0.0=collapsed)
[Epoch 14/100] [Batch 13/669 (1.9%)] [Iter 8710] Loss: 0.9269 (freq: 0.2847, raw: 0.6417, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[891,839,583,944,45,672,856,184,743,982,519,514,541,612,212]


π”¬ Encoder Diversity (iter 8710):
  Avg similarity: 0.0603 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 14/100] [Batch 23/669 (3.4%)] [Iter 8720] Loss: 1.2489 (freq: 0.4683, raw: 0.7800, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 712/1024 (69.5%) Top5:[583,45,944,982,743,856,594,698,672,399,347,851,891,700,1]


π”¬ Encoder Diversity (iter 8720):
  Avg similarity: 0.0588 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9419 (0.0=collapsed)
[Epoch 14/100] [Batch 33/669 (4.9%)] [Iter 8730] Loss: 1.2470 (freq: 0.5025, raw: 0.7439, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 697/1024 (68.1%) Top5:[856,583,265,45,891,328,514,839,748,692,672,445,743,902,9]


π”¬ Encoder Diversity (iter 8730):
  Avg similarity: 0.1203 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9331 (0.0=collapsed)
[Epoch 14/100] [Batch 43/669 (6.4%)] [Iter 8740] Loss: 1.2265 (freq: 0.4558, raw: 0.7701, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[583,982,856,347,11,748,944,743,891,150,672,932,839,594,519]


π”¬ Encoder Diversity (iter 8740):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 14/100] [Batch 53/669 (7.9%)] [Iter 8750] Loss: 0.9829 (freq: 0.3366, raw: 0.6457, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 592/1024 (57.8%) Top5:[583,856,891,519,743,45,433,851,698,594,945,445,415,497,669]


π”¬ Encoder Diversity (iter 8750):
  Avg similarity: 0.0483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 14/100] [Batch 63/669 (9.4%)] [Iter 8760] Loss: 1.3255 (freq: 0.4372, raw: 0.8877, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 598/1024 (58.4%) Top5:[583,851,45,856,698,497,891,519,594,944,710,672,150,415,11]


π”¬ Encoder Diversity (iter 8760):
  Avg similarity: 0.0771 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 14/100] [Batch 73/669 (10.9%)] [Iter 8770] Loss: 1.3627 (freq: 0.5050, raw: 0.8570, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 589/1024 (57.5%) Top5:[583,415,399,698,45,944,150,710,856,497,433,594,851,974,743]


π”¬ Encoder Diversity (iter 8770):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 14/100] [Batch 83/669 (12.4%)] [Iter 8780] Loss: 1.1412 (freq: 0.4091, raw: 0.7315, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[583,856,519,399,891,1,979,982,259,11,594,328,751,76,672]


π”¬ Encoder Diversity (iter 8780):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 14/100] [Batch 93/669 (13.9%)] [Iter 8790] Loss: 1.1009 (freq: 0.3840, raw: 0.7163, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 568/1024 (55.5%) Top5:[583,982,891,839,672,45,945,851,415,944,11,856,698,184,710]


π”¬ Encoder Diversity (iter 8790):
  Avg similarity: 0.0697 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9471 (0.0=collapsed)
[Epoch 14/100] [Batch 103/669 (15.4%)] [Iter 8800] Loss: 1.0746 (freq: 0.3766, raw: 0.6973, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 590/1024 (57.6%) Top5:[519,851,583,743,751,115,698,891,415,944,902,328,76,710,265]


π”¬ Encoder Diversity (iter 8800):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 14/100] [Batch 113/669 (16.9%)] [Iter 8810] Loss: 1.2086 (freq: 0.3992, raw: 0.8088, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[519,891,851,115,583,672,944,415,710,982,45,751,433,856,150]


π”¬ Encoder Diversity (iter 8810):
  Avg similarity: 0.1114 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 14/100] [Batch 123/669 (18.4%)] [Iter 8820] Loss: 1.1096 (freq: 0.4209, raw: 0.6881, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[115,932,259,751,519,265,891,361,982,330,895,62,328,541,1]


π”¬ Encoder Diversity (iter 8820):
  Avg similarity: 0.0680 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9419 (0.0=collapsed)
[Epoch 14/100] [Batch 133/669 (19.9%)] [Iter 8830] Loss: 0.8980 (freq: 0.3177, raw: 0.5797, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 552/1024 (53.9%) Top5:[851,583,45,672,982,11,115,594,751,541,891,1,710,856,184]


π”¬ Encoder Diversity (iter 8830):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 14/100] [Batch 143/669 (21.4%)] [Iter 8840] Loss: 0.9618 (freq: 0.3048, raw: 0.6564, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 640/1024 (62.5%) Top5:[851,669,497,695,710,583,433,150,743,519,816,415,661,672,45]


π”¬ Encoder Diversity (iter 8840):
  Avg similarity: 0.0813 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9462 (0.0=collapsed)
[Epoch 14/100] [Batch 153/669 (22.9%)] [Iter 8850] Loss: 1.0363 (freq: 0.3392, raw: 0.6964, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 635/1024 (62.0%) Top5:[851,583,982,902,669,891,748,328,265,955,361,150,115,946,347]


π”¬ Encoder Diversity (iter 8850):
  Avg similarity: 0.0805 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9497 (0.0=collapsed)
[Epoch 14/100] [Batch 163/669 (24.4%)] [Iter 8860] Loss: 1.2523 (freq: 0.4634, raw: 0.7883, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 652/1024 (63.7%) Top5:[982,856,519,851,751,849,891,297,902,399,184,265,716,328,839]


π”¬ Encoder Diversity (iter 8860):
  Avg similarity: 0.0751 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9517 (0.0=collapsed)
[Epoch 14/100] [Batch 173/669 (25.9%)] [Iter 8870] Loss: 1.0639 (freq: 0.3678, raw: 0.6955, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[851,751,519,672,669,403,433,32,265,453,583,695,982,63,979]


π”¬ Encoder Diversity (iter 8870):
  Avg similarity: 0.0906 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9425 (0.0=collapsed)
[Epoch 14/100] [Batch 183/669 (27.4%)] [Iter 8880] Loss: 1.1859 (freq: 0.4160, raw: 0.7693, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 582/1024 (56.8%) Top5:[1,259,932,839,891,115,453,982,856,716,596,297,979,751,20]


π”¬ Encoder Diversity (iter 8880):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 14/100] [Batch 193/669 (28.8%)] [Iter 8890] Loss: 1.1150 (freq: 0.3829, raw: 0.7314, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 531/1024 (51.9%) Top5:[851,669,45,982,115,583,891,373,672,698,594,433,695,856,751]


π”¬ Encoder Diversity (iter 8890):
  Avg similarity: 0.0626 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 14/100] [Batch 203/669 (30.3%)] [Iter 8900] Loss: 1.1214 (freq: 0.4033, raw: 0.7174, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 573/1024 (56.0%) Top5:[115,519,45,851,982,669,856,596,1,583,751,76,373,193,399]


π”¬ Encoder Diversity (iter 8900):
  Avg similarity: 0.0980 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9396 (0.0=collapsed)
[Epoch 14/100] [Batch 213/669 (31.8%)] [Iter 8910] Loss: 1.1042 (freq: 0.4120, raw: 0.6916, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 610/1024 (59.6%) Top5:[115,982,979,856,839,519,1,751,902,328,101,76,330,399,583]


π”¬ Encoder Diversity (iter 8910):
  Avg similarity: 0.0541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 14/100] [Batch 223/669 (33.3%)] [Iter 8920] Loss: 0.9695 (freq: 0.3227, raw: 0.6462, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 657/1024 (64.2%) Top5:[115,731,373,944,583,433,816,672,669,695,979,710,594,698,497]


π”¬ Encoder Diversity (iter 8920):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 14/100] [Batch 233/669 (34.8%)] [Iter 8930] Loss: 1.1367 (freq: 0.4160, raw: 0.7202, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 557/1024 (54.4%) Top5:[1,399,45,982,110,347,856,839,891,849,594,373,11,184,672]


π”¬ Encoder Diversity (iter 8930):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 14/100] [Batch 243/669 (36.3%)] [Iter 8940] Loss: 0.9390 (freq: 0.3130, raw: 0.6255, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 562/1024 (54.9%) Top5:[1,851,497,110,856,45,373,982,672,433,583,669,891,731,944]


π”¬ Encoder Diversity (iter 8940):
  Avg similarity: 0.0887 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9425 (0.0=collapsed)
[Epoch 14/100] [Batch 253/669 (37.8%)] [Iter 8950] Loss: 1.2164 (freq: 0.4331, raw: 0.7826, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 631/1024 (61.6%) Top5:[519,115,523,97,902,596,76,856,979,101,751,946,955,626,330]


π”¬ Encoder Diversity (iter 8950):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 14/100] [Batch 263/669 (39.3%)] [Iter 8960] Loss: 1.1036 (freq: 0.3777, raw: 0.7253, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 648/1024 (63.3%) Top5:[328,110,373,669,45,851,497,944,115,519,523,672,62,982,979]


π”¬ Encoder Diversity (iter 8960):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 14/100] [Batch 273/669 (40.8%)] [Iter 8970] Loss: 0.8745 (freq: 0.2966, raw: 0.5774, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 651/1024 (63.6%) Top5:[519,856,672,982,45,1,979,110,11,596,891,259,399,373,594]


π”¬ Encoder Diversity (iter 8970):
  Avg similarity: 0.0711 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9528 (0.0=collapsed)
[Epoch 14/100] [Batch 283/669 (42.3%)] [Iter 8980] Loss: 1.1004 (freq: 0.3650, raw: 0.7348, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 648/1024 (63.3%) Top5:[716,115,751,672,519,979,698,932,45,704,902,453,98,433,300]


π”¬ Encoder Diversity (iter 8980):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 14/100] [Batch 293/669 (43.8%)] [Iter 8990] Loss: 0.8004 (freq: 0.2561, raw: 0.5438, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 590/1024 (57.6%) Top5:[1,891,45,672,839,856,982,817,11,259,541,184,945,751,110]


π”¬ Encoder Diversity (iter 8990):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 14/100] [Batch 303/669 (45.3%)] [Iter 9000] Loss: 1.3621 (freq: 0.4599, raw: 0.9015, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 593/1024 (57.9%) Top5:[115,453,97,902,932,979,716,751,20,108,523,704,361,974,519]


π”¬ Encoder Diversity (iter 9000):
  Avg similarity: 0.0926 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9449 (0.0=collapsed)
[Epoch 14/100] [Batch 313/669 (46.8%)] [Iter 9010] Loss: 1.0770 (freq: 0.3939, raw: 0.6825, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 612/1024 (59.8%) Top5:[519,751,45,110,523,115,583,347,265,672,399,76,669,626,415]


π”¬ Encoder Diversity (iter 9010):
  Avg similarity: 0.0696 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9483 (0.0=collapsed)
[Epoch 14/100] [Batch 323/669 (48.3%)] [Iter 9020] Loss: 0.8679 (freq: 0.2935, raw: 0.5738, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 523/1024 (51.1%) Top5:[110,45,583,672,519,347,669,751,692,184,594,10,944,945,895]


π”¬ Encoder Diversity (iter 9020):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 14/100] [Batch 333/669 (49.8%)] [Iter 9030] Loss: 1.0909 (freq: 0.3660, raw: 0.7244, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 591/1024 (57.7%) Top5:[110,716,433,583,373,45,115,743,979,453,415,945,497,10,150]


π”¬ Encoder Diversity (iter 9030):
  Avg similarity: 0.0596 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 14/100] [Batch 343/669 (51.3%)] [Iter 9040] Loss: 0.9560 (freq: 0.3270, raw: 0.6283, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 559/1024 (54.6%) Top5:[110,672,716,596,497,45,891,669,115,1,895,11,399,982,433]


π”¬ Encoder Diversity (iter 9040):
  Avg similarity: 0.0611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 14/100] [Batch 353/669 (52.8%)] [Iter 9050] Loss: 1.2262 (freq: 0.4414, raw: 0.7841, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 594/1024 (58.0%) Top5:[110,716,704,669,672,11,115,45,523,979,902,373,1022,891,497]


π”¬ Encoder Diversity (iter 9050):
  Avg similarity: 0.0696 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 14/100] [Batch 363/669 (54.3%)] [Iter 9060] Loss: 1.3417 (freq: 0.5035, raw: 0.8374, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 629/1024 (61.4%) Top5:[110,403,704,891,1022,453,20,716,9,672,979,932,982,523,497]


π”¬ Encoder Diversity (iter 9060):
  Avg similarity: 0.0304 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 14/100] [Batch 373/669 (55.8%)] [Iter 9070] Loss: 1.0708 (freq: 0.3525, raw: 0.7177, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 594/1024 (58.0%) Top5:[110,669,1,672,891,839,851,184,45,596,415,259,944,895,399]


π”¬ Encoder Diversity (iter 9070):
  Avg similarity: 0.0707 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9484 (0.0=collapsed)
[Epoch 14/100] [Batch 383/669 (57.2%)] [Iter 9080] Loss: 1.1420 (freq: 0.3921, raw: 0.7492, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 647/1024 (63.2%) Top5:[751,523,716,979,115,932,748,9,32,403,62,519,20,974,669]


π”¬ Encoder Diversity (iter 9080):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 14/100] [Batch 393/669 (58.7%)] [Iter 9090] Loss: 1.0895 (freq: 0.3724, raw: 0.7165, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 622/1024 (60.7%) Top5:[851,110,583,751,399,45,594,433,523,184,945,669,672,1022,979]


π”¬ Encoder Diversity (iter 9090):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 14/100] [Batch 403/669 (60.2%)] [Iter 9100] Loss: 1.0214 (freq: 0.3755, raw: 0.6454, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 638/1024 (62.3%) Top5:[110,669,583,1,45,849,839,150,945,944,695,851,594,672,347]


π”¬ Encoder Diversity (iter 9100):
  Avg similarity: 0.0686 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9522 (0.0=collapsed)
[Epoch 14/100] [Batch 413/669 (61.7%)] [Iter 9110] Loss: 1.2217 (freq: 0.4667, raw: 0.7544, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 663/1024 (64.7%) Top5:[669,895,110,839,1,115,534,770,596,902,259,932,751,748,45]


π”¬ Encoder Diversity (iter 9110):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 14/100] [Batch 423/669 (63.2%)] [Iter 9120] Loss: 1.4224 (freq: 0.5530, raw: 0.8687, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 615/1024 (60.1%) Top5:[519,115,979,669,97,1023,110,75,371,716,433,453,361,932,20]


π”¬ Encoder Diversity (iter 9120):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 14/100] [Batch 433/669 (64.7%)] [Iter 9130] Loss: 1.1816 (freq: 0.3815, raw: 0.7995, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 678/1024 (66.2%) Top5:[519,110,76,751,748,523,483,9,115,975,669,891,716,265,267]


π”¬ Encoder Diversity (iter 9130):
  Avg similarity: 0.0922 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 14/100] [Batch 443/669 (66.2%)] [Iter 9140] Loss: 1.1881 (freq: 0.4262, raw: 0.7612, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[716,932,433,45,361,1023,979,267,20,497,453,97,748,9,631]


π”¬ Encoder Diversity (iter 9140):
  Avg similarity: 0.0717 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 14/100] [Batch 453/669 (67.7%)] [Iter 9150] Loss: 1.1032 (freq: 0.4165, raw: 0.6861, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 644/1024 (62.9%) Top5:[45,1,891,669,265,672,979,415,932,110,232,97,532,347,945]


π”¬ Encoder Diversity (iter 9150):
  Avg similarity: 0.0821 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9454 (0.0=collapsed)
[Epoch 14/100] [Batch 463/669 (69.2%)] [Iter 9160] Loss: 0.8730 (freq: 0.2982, raw: 0.5743, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 651/1024 (63.6%) Top5:[609,267,1023,743,716,932,232,433,45,497,698,110,944,305,751]


π”¬ Encoder Diversity (iter 9160):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 14/100] [Batch 473/669 (70.7%)] [Iter 9170] Loss: 0.9396 (freq: 0.3176, raw: 0.6214, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 612/1024 (59.8%) Top5:[1023,45,851,672,519,110,751,445,902,433,743,97,716,42,669]


π”¬ Encoder Diversity (iter 9170):
  Avg similarity: 0.0724 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9446 (0.0=collapsed)
[Epoch 14/100] [Batch 483/669 (72.2%)] [Iter 9180] Loss: 1.2294 (freq: 0.4303, raw: 0.7985, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 649/1024 (63.4%) Top5:[519,894,932,20,751,974,534,716,748,449,97,45,631,523,75]


π”¬ Encoder Diversity (iter 9180):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 14/100] [Batch 493/669 (73.7%)] [Iter 9190] Loss: 1.2146 (freq: 0.4331, raw: 0.7809, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 613/1024 (59.9%) Top5:[45,110,851,415,743,10,519,1023,150,609,945,75,619,944,583]


π”¬ Encoder Diversity (iter 9190):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 14/100] [Batch 503/669 (75.2%)] [Iter 9200] Loss: 1.0001 (freq: 0.3528, raw: 0.6467, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 592/1024 (57.8%) Top5:[716,894,20,9,110,751,891,856,519,433,523,974,150,669,45]


π”¬ Encoder Diversity (iter 9200):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 14/100] [Batch 513/669 (76.7%)] [Iter 9210] Loss: 1.0560 (freq: 0.3556, raw: 0.6997, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 580/1024 (56.6%) Top5:[716,483,894,932,45,669,982,267,110,9,328,519,979,704,974]


π”¬ Encoder Diversity (iter 9210):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 14/100] [Batch 523/669 (78.2%)] [Iter 9220] Loss: 0.8961 (freq: 0.2901, raw: 0.6055, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 556/1024 (54.3%) Top5:[716,979,328,894,669,9,267,974,704,748,110,483,534,985,851]


π”¬ Encoder Diversity (iter 9220):
  Avg similarity: 0.0730 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9435 (0.0=collapsed)
[Epoch 14/100] [Batch 533/669 (79.7%)] [Iter 9230] Loss: 1.1114 (freq: 0.3862, raw: 0.7247, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 605/1024 (59.1%) Top5:[497,267,110,979,125,609,716,944,433,974,669,483,851,945,743]


π”¬ Encoder Diversity (iter 9230):
  Avg similarity: 0.0559 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 14/100] [Batch 543/669 (81.2%)] [Iter 9240] Loss: 1.2461 (freq: 0.4649, raw: 0.7806, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 605/1024 (59.1%) Top5:[669,856,894,751,265,716,748,839,726,110,11,932,141,9,704]


π”¬ Encoder Diversity (iter 9240):
  Avg similarity: 0.0715 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9470 (0.0=collapsed)
[Epoch 14/100] [Batch 553/669 (82.7%)] [Iter 9250] Loss: 1.2915 (freq: 0.5280, raw: 0.7628, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 644/1024 (62.9%) Top5:[497,737,716,45,626,9,932,265,1023,125,110,669,267,1022,879]


π”¬ Encoder Diversity (iter 9250):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 14/100] [Batch 563/669 (84.2%)] [Iter 9260] Loss: 1.0711 (freq: 0.3626, raw: 0.7078, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 611/1024 (59.7%) Top5:[45,726,110,669,141,891,829,839,851,869,895,519,716,932,20]


π”¬ Encoder Diversity (iter 9260):
  Avg similarity: 0.0454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 14/100] [Batch 573/669 (85.7%)] [Iter 9270] Loss: 1.2417 (freq: 0.4634, raw: 0.7776, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 572/1024 (55.9%) Top5:[45,519,891,110,851,716,150,669,415,497,433,856,743,483,944]


π”¬ Encoder Diversity (iter 9270):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 14/100] [Batch 583/669 (87.1%)] [Iter 9280] Loss: 1.2767 (freq: 0.4866, raw: 0.7895, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 576/1024 (56.2%) Top5:[716,891,483,1002,726,45,932,110,895,974,944,669,497,20,704]


π”¬ Encoder Diversity (iter 9280):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 14/100] [Batch 593/669 (88.6%)] [Iter 9290] Loss: 1.1428 (freq: 0.3956, raw: 0.7466, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 595/1024 (58.1%) Top5:[45,891,150,415,851,669,110,433,726,302,716,497,895,267,944]


π”¬ Encoder Diversity (iter 9290):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9462 (0.0=collapsed)
[Epoch 14/100] [Batch 603/669 (90.1%)] [Iter 9300] Loss: 1.2786 (freq: 0.4870, raw: 0.7909, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 575/1024 (56.2%) Top5:[737,716,894,45,974,20,704,979,97,932,902,669,748,267,483]


π”¬ Encoder Diversity (iter 9300):
  Avg similarity: 0.0927 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9370 (0.0=collapsed)
[Epoch 14/100] [Batch 613/669 (91.6%)] [Iter 9310] Loss: 1.1071 (freq: 0.3941, raw: 0.7124, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 636/1024 (62.1%) Top5:[894,716,393,110,704,748,974,851,680,932,669,45,75,523,97]


π”¬ Encoder Diversity (iter 9310):
  Avg similarity: 0.1065 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 14/100] [Batch 623/669 (93.1%)] [Iter 9320] Loss: 0.8378 (freq: 0.2704, raw: 0.5668, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 622/1024 (60.7%) Top5:[110,45,894,669,851,891,141,856,751,11,519,393,267,415,32]


π”¬ Encoder Diversity (iter 9320):
  Avg similarity: 0.0606 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 14/100] [Batch 633/669 (94.6%)] [Iter 9330] Loss: 1.1290 (freq: 0.3645, raw: 0.7639, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[894,737,519,9,932,704,974,716,42,748,483,32,751,626,199]


π”¬ Encoder Diversity (iter 9330):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9554 (0.0=collapsed)
[Epoch 14/100] [Batch 643/669 (96.1%)] [Iter 9340] Loss: 0.6083 (freq: 0.1710, raw: 0.4367, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 635/1024 (62.0%) Top5:[110,45,891,497,1002,669,856,743,302,851,609,150,690,141,415]


π”¬ Encoder Diversity (iter 9340):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 14/100] [Batch 653/669 (97.6%)] [Iter 9350] Loss: 1.2856 (freq: 0.4623, raw: 0.8226, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 594/1024 (58.0%) Top5:[932,716,9,894,45,704,974,891,469,669,110,453,115,199,514]


π”¬ Encoder Diversity (iter 9350):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 14/100] [Batch 663/669 (99.1%)] [Iter 9360] Loss: 1.3418 (freq: 0.4950, raw: 0.8461, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 628/1024 (61.3%) Top5:[891,716,9,894,979,668,464,751,393,449,483,75,534,974,445]


π”¬ Encoder Diversity (iter 9360):
  Avg similarity: 0.0698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9470 (0.0=collapsed)

================================================================================
[Epoch 14] Validation Results:
  Total Loss: 0.5902
  Freq Loss:  0.1768
  Raw Loss:   0.4128
  Quant Loss: 0.0006
  π“ Codebook Usage: 407/1024 (39.7%)
  π“ Codebook Entropy: 4.6031 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 33720 (25.9%)
  Top 10 most used codes:
    1. Code 895: 4498 times (3.45%)
    2. Code 856: 3757 times (2.89%)
    3. Code 891: 3700 times (2.84%)
    4. Code 669: 3555 times (2.73%)
    5. Code 982: 3233 times (2.48%)
    6. Code 1002: 3220 times (2.47%)
    7. Code 829: 3173 times (2.44%)
    8. Code 45: 3170 times (2.43%)
    9. Code 726: 2825 times (2.17%)
    10. Code 11: 2589 times (1.99%)
  Bottom 5 least used codes (among used):
    1. Code 939: 1 times (0.00%)
    2. Code 246: 1 times (0.00%)
    3. Code 219: 1 times (0.00%)
    4. Code 579: 4 times (0.00%)
    5. Code 941: 5 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 14
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 15/100] [Batch 4/669 (0.6%)] [Iter 9370] Loss: 1.4494 (freq: 0.5255, raw: 0.9230, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 986/1024 (96.3%) Top5:[669,851,258,45,743,891,945,488,267,1002,944,11,895,125,497]


π”¬ Encoder Diversity (iter 9370):
  Avg similarity: 0.0761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9426 (0.0=collapsed)
[Epoch 15/100] [Batch 14/669 (2.1%)] [Iter 9380] Loss: 1.1372 (freq: 0.4207, raw: 0.7158, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 801/1024 (78.2%) Top5:[891,110,1002,726,45,856,851,669,945,839,895,829,743,415,347]


π”¬ Encoder Diversity (iter 9380):
  Avg similarity: 0.0818 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9527 (0.0=collapsed)
[Epoch 15/100] [Batch 24/669 (3.6%)] [Iter 9390] Loss: 1.2210 (freq: 0.4503, raw: 0.7701, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 691/1024 (67.5%) Top5:[110,45,669,891,851,945,743,433,125,856,184,497,150,609,1002]


π”¬ Encoder Diversity (iter 9390):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 15/100] [Batch 34/669 (5.1%)] [Iter 9400] Loss: 0.9853 (freq: 0.3610, raw: 0.6238, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 632/1024 (61.7%) Top5:[220,588,941,22,524,45,1007,476,454,846,48,275,785,609,380]


π”¬ Encoder Diversity (iter 9400):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9504 (0.0=collapsed)
[Epoch 15/100] [Batch 44/669 (6.6%)] [Iter 9410] Loss: 0.7658 (freq: 0.2398, raw: 0.5254, quant: 0.0005, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 623/1024 (60.8%) Top5:[726,110,829,45,945,766,259,891,1002,669,591,895,141,851,839]


π”¬ Encoder Diversity (iter 9410):
  Avg similarity: 0.0817 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 15/100] [Batch 54/669 (8.1%)] [Iter 9420] Loss: 1.3494 (freq: 0.4912, raw: 0.8574, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 600/1024 (58.6%) Top5:[726,110,945,851,45,829,669,980,141,347,1007,895,1002,433,839]


π”¬ Encoder Diversity (iter 9420):
  Avg similarity: 0.0555 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9574 (0.0=collapsed)
[Epoch 15/100] [Batch 64/669 (9.6%)] [Iter 9430] Loss: 1.1266 (freq: 0.3656, raw: 0.7604, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 583/1024 (56.9%) Top5:[1007,851,220,110,609,980,275,930,588,677,524,22,945,726,48]


π”¬ Encoder Diversity (iter 9430):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 15/100] [Batch 74/669 (11.1%)] [Iter 9440] Loss: 1.2169 (freq: 0.4622, raw: 0.7540, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 692/1024 (67.6%) Top5:[220,380,851,75,524,743,613,125,677,497,22,345,365,186,941]


π”¬ Encoder Diversity (iter 9440):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 15/100] [Batch 84/669 (12.6%)] [Iter 9450] Loss: 1.3272 (freq: 0.4757, raw: 0.8509, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[851,1012,1002,945,891,220,45,497,110,150,415,829,743,48,669]


π”¬ Encoder Diversity (iter 9450):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 15/100] [Batch 94/669 (14.1%)] [Iter 9460] Loss: 0.8832 (freq: 0.2964, raw: 0.5862, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 680/1024 (66.4%) Top5:[497,1012,891,743,851,110,945,45,433,669,829,269,241,220,232]


π”¬ Encoder Diversity (iter 9460):
  Avg similarity: 0.0679 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 15/100] [Batch 104/669 (15.5%)] [Iter 9470] Loss: 1.0513 (freq: 0.3549, raw: 0.6957, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[891,110,669,851,433,45,48,497,945,220,609,1012,941,743,269]


π”¬ Encoder Diversity (iter 9470):
  Avg similarity: 0.0844 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)
[Epoch 15/100] [Batch 114/669 (17.0%)] [Iter 9480] Loss: 1.0290 (freq: 0.3348, raw: 0.6936, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 621/1024 (60.6%) Top5:[669,891,220,829,735,75,893,45,390,982,540,613,258,785,415]


π”¬ Encoder Diversity (iter 9480):
  Avg similarity: 0.0736 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9396 (0.0=collapsed)
[Epoch 15/100] [Batch 124/669 (18.5%)] [Iter 9490] Loss: 0.9881 (freq: 0.3388, raw: 0.6487, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 657/1024 (64.2%) Top5:[220,851,390,609,743,269,497,930,669,785,945,25,554,820,45]


π”¬ Encoder Diversity (iter 9490):
  Avg similarity: 0.0566 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9527 (0.0=collapsed)
[Epoch 15/100] [Batch 134/669 (20.0%)] [Iter 9500] Loss: 1.2973 (freq: 0.5043, raw: 0.7923, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 716/1024 (69.9%) Top5:[220,345,75,54,677,941,390,211,820,907,622,476,918,320,313]


π”¬ Encoder Diversity (iter 9500):
  Avg similarity: 0.1007 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9470 (0.0=collapsed)
[Epoch 15/100] [Batch 144/669 (21.5%)] [Iter 9510] Loss: 1.0077 (freq: 0.3589, raw: 0.6482, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 673/1024 (65.7%) Top5:[497,829,220,891,25,609,1002,869,1012,75,851,345,110,672,613]


π”¬ Encoder Diversity (iter 9510):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 15/100] [Batch 154/669 (23.0%)] [Iter 9520] Loss: 0.9430 (freq: 0.2943, raw: 0.6481, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 610/1024 (59.6%) Top5:[497,944,560,25,110,891,609,220,851,150,648,267,11,184,433]


π”¬ Encoder Diversity (iter 9520):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 15/100] [Batch 164/669 (24.5%)] [Iter 9530] Loss: 1.2021 (freq: 0.4310, raw: 0.7704, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 642/1024 (62.7%) Top5:[497,110,220,941,609,540,25,343,944,433,851,150,560,937,891]


π”¬ Encoder Diversity (iter 9530):
  Avg similarity: 0.1048 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9395 (0.0=collapsed)
[Epoch 15/100] [Batch 174/669 (26.0%)] [Iter 9540] Loss: 0.9860 (freq: 0.3551, raw: 0.6302, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[220,540,343,851,930,110,835,735,549,1012,22,390,622,497,150]


π”¬ Encoder Diversity (iter 9540):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 15/100] [Batch 184/669 (27.5%)] [Iter 9550] Loss: 1.4488 (freq: 0.5200, raw: 0.9280, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 651/1024 (63.6%) Top5:[1007,835,220,343,756,591,497,918,511,22,48,540,941,524,930]


π”¬ Encoder Diversity (iter 9550):
  Avg similarity: 0.0867 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9451 (0.0=collapsed)
[Epoch 15/100] [Batch 194/669 (29.0%)] [Iter 9560] Loss: 0.9449 (freq: 0.3291, raw: 0.6152, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 613/1024 (59.9%) Top5:[869,735,898,415,851,141,872,110,1002,347,895,829,856,258,343]


π”¬ Encoder Diversity (iter 9560):
  Avg similarity: 0.1138 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9144 (0.0=collapsed)
[Epoch 15/100] [Batch 204/669 (30.5%)] [Iter 9570] Loss: 1.0180 (freq: 0.3118, raw: 0.7055, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 605/1024 (59.1%) Top5:[735,415,75,898,549,891,835,829,851,856,540,110,345,895,220]


π”¬ Encoder Diversity (iter 9570):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 15/100] [Batch 214/669 (32.0%)] [Iter 9580] Loss: 1.3174 (freq: 0.5052, raw: 0.8115, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 602/1024 (58.8%) Top5:[220,540,829,898,735,891,869,110,851,497,198,415,944,150,1002]


π”¬ Encoder Diversity (iter 9580):
  Avg similarity: 0.0439 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 15/100] [Batch 224/669 (33.5%)] [Iter 9590] Loss: 0.9895 (freq: 0.3601, raw: 0.6288, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 595/1024 (58.1%) Top5:[829,415,898,735,1012,726,856,872,999,869,982,930,283,259,220]


π”¬ Encoder Diversity (iter 9590):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 15/100] [Batch 234/669 (35.0%)] [Iter 9600] Loss: 1.1286 (freq: 0.4086, raw: 0.7193, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 641/1024 (62.6%) Top5:[1012,380,891,727,220,110,941,540,343,1002,666,609,415,560,198]


π”¬ Encoder Diversity (iter 9600):
  Avg similarity: 0.0577 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 15/100] [Batch 244/669 (36.5%)] [Iter 9610] Loss: 0.9939 (freq: 0.3165, raw: 0.6769, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 589/1024 (57.5%) Top5:[220,560,497,944,1012,110,150,22,390,735,609,830,267,1002,421]


π”¬ Encoder Diversity (iter 9610):
  Avg similarity: 0.1045 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9389 (0.0=collapsed)
[Epoch 15/100] [Batch 254/669 (38.0%)] [Iter 9620] Loss: 1.1513 (freq: 0.3729, raw: 0.7777, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 677/1024 (66.1%) Top5:[220,540,75,415,591,785,345,22,898,918,343,380,549,511,258]


π”¬ Encoder Diversity (iter 9620):
  Avg similarity: 0.0565 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 15/100] [Batch 264/669 (39.5%)] [Iter 9630] Loss: 1.0692 (freq: 0.3604, raw: 0.7082, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 653/1024 (63.8%) Top5:[220,380,22,851,75,937,48,735,497,891,540,856,613,830,524]


π”¬ Encoder Diversity (iter 9630):
  Avg similarity: 0.0460 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 15/100] [Batch 274/669 (41.0%)] [Iter 9640] Loss: 1.3811 (freq: 0.5368, raw: 0.8436, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[497,856,851,944,735,891,613,560,220,1002,421,415,150,1012,898]


π”¬ Encoder Diversity (iter 9640):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 15/100] [Batch 284/669 (42.5%)] [Iter 9650] Loss: 1.4554 (freq: 0.5165, raw: 0.9382, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 605/1024 (59.1%) Top5:[735,560,220,1002,497,898,415,944,851,891,110,390,421,150,856]


π”¬ Encoder Diversity (iter 9650):
  Avg similarity: 0.0462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 15/100] [Batch 294/669 (43.9%)] [Iter 9660] Loss: 1.2069 (freq: 0.4329, raw: 0.7734, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 659/1024 (64.4%) Top5:[220,1012,540,415,524,898,232,622,390,735,1002,941,669,930,222]


π”¬ Encoder Diversity (iter 9660):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 15/100] [Batch 304/669 (45.4%)] [Iter 9670] Loss: 1.1056 (freq: 0.4142, raw: 0.6908, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 638/1024 (62.3%) Top5:[735,891,415,851,898,258,560,347,829,1012,1002,669,655,766,872]


π”¬ Encoder Diversity (iter 9670):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 15/100] [Batch 314/669 (46.9%)] [Iter 9680] Loss: 1.2008 (freq: 0.4112, raw: 0.7890, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 627/1024 (61.2%) Top5:[560,110,1002,898,735,851,891,944,497,25,982,415,347,150,609]


π”¬ Encoder Diversity (iter 9680):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 15/100] [Batch 324/669 (48.4%)] [Iter 9690] Loss: 0.5777 (freq: 0.1536, raw: 0.4235, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 609/1024 (59.5%) Top5:[560,851,1002,25,415,898,891,110,735,982,497,1012,856,150,669]


π”¬ Encoder Diversity (iter 9690):
  Avg similarity: 0.0758 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 15/100] [Batch 334/669 (49.9%)] [Iter 9700] Loss: 1.1676 (freq: 0.4395, raw: 0.7275, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[735,891,1002,415,198,549,380,48,898,220,622,540,944,343,999]


π”¬ Encoder Diversity (iter 9700):
  Avg similarity: 0.0916 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9353 (0.0=collapsed)
[Epoch 15/100] [Batch 344/669 (51.4%)] [Iter 9710] Loss: 1.1401 (freq: 0.4199, raw: 0.7195, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 713/1024 (69.6%) Top5:[25,110,944,22,560,1002,648,343,697,830,497,267,150,422,421]


π”¬ Encoder Diversity (iter 9710):
  Avg similarity: 0.0743 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9465 (0.0=collapsed)
[Epoch 15/100] [Batch 354/669 (52.9%)] [Iter 9720] Loss: 0.8030 (freq: 0.2438, raw: 0.5586, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 681/1024 (66.5%) Top5:[110,735,1002,856,415,198,891,851,380,275,669,22,421,125,893]


π”¬ Encoder Diversity (iter 9720):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 15/100] [Batch 364/669 (54.4%)] [Iter 9730] Loss: 1.2053 (freq: 0.4407, raw: 0.7639, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 675/1024 (65.9%) Top5:[198,487,540,591,891,1002,110,941,390,380,415,951,937,117,499]


π”¬ Encoder Diversity (iter 9730):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 15/100] [Batch 374/669 (55.9%)] [Iter 9740] Loss: 1.2072 (freq: 0.4211, raw: 0.7854, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 663/1024 (64.7%) Top5:[944,220,110,891,851,421,1002,898,497,697,588,609,735,25,560]


π”¬ Encoder Diversity (iter 9740):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 15/100] [Batch 384/669 (57.4%)] [Iter 9750] Loss: 1.2544 (freq: 0.4790, raw: 0.7748, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 681/1024 (66.5%) Top5:[898,851,110,1002,944,891,672,421,497,735,560,186,141,25,856]


π”¬ Encoder Diversity (iter 9750):
  Avg similarity: 0.0438 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 15/100] [Batch 394/669 (58.9%)] [Iter 9760] Loss: 1.1697 (freq: 0.3946, raw: 0.7745, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 629/1024 (61.4%) Top5:[220,898,797,7,856,735,588,891,591,453,347,524,836,677,313]


π”¬ Encoder Diversity (iter 9760):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 15/100] [Batch 404/669 (60.4%)] [Iter 9770] Loss: 1.2189 (freq: 0.4340, raw: 0.7843, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 667/1024 (65.1%) Top5:[944,110,898,540,560,549,497,797,941,220,380,232,743,937,851]


π”¬ Encoder Diversity (iter 9770):
  Avg similarity: 0.0866 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 15/100] [Batch 414/669 (61.9%)] [Iter 9780] Loss: 0.8471 (freq: 0.2608, raw: 0.5857, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 645/1024 (63.0%) Top5:[380,898,343,198,22,390,454,25,421,735,856,1007,944,476,220]


π”¬ Encoder Diversity (iter 9780):
  Avg similarity: 0.0660 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 15/100] [Batch 424/669 (63.4%)] [Iter 9790] Loss: 1.1254 (freq: 0.3992, raw: 0.7256, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 617/1024 (60.3%) Top5:[898,851,735,856,1002,110,891,347,944,669,415,141,560,497,125]


π”¬ Encoder Diversity (iter 9790):
  Avg similarity: 0.0596 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 15/100] [Batch 434/669 (64.9%)] [Iter 9800] Loss: 0.9293 (freq: 0.3206, raw: 0.6081, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 593/1024 (57.9%) Top5:[898,856,347,851,220,685,251,22,141,735,7,390,258,1007,891]


π”¬ Encoder Diversity (iter 9800):
  Avg similarity: 0.1006 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9409 (0.0=collapsed)
[Epoch 15/100] [Batch 444/669 (66.4%)] [Iter 9810] Loss: 0.8451 (freq: 0.2663, raw: 0.5782, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 719/1024 (70.2%) Top5:[220,48,1007,380,540,588,58,591,524,293,343,835,958,22,797]


π”¬ Encoder Diversity (iter 9810):
  Avg similarity: 0.0492 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 15/100] [Batch 454/669 (67.9%)] [Iter 9820] Loss: 1.1158 (freq: 0.4062, raw: 0.7090, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 674/1024 (65.8%) Top5:[497,220,944,110,186,232,184,380,540,941,797,697,421,222,524]


π”¬ Encoder Diversity (iter 9820):
  Avg similarity: 0.0790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 15/100] [Batch 464/669 (69.4%)] [Iter 9830] Loss: 1.2092 (freq: 0.4126, raw: 0.7959, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 597/1024 (58.3%) Top5:[110,872,125,898,1007,347,1012,540,785,511,251,415,342,1002,927]


π”¬ Encoder Diversity (iter 9830):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9470 (0.0=collapsed)
[Epoch 15/100] [Batch 474/669 (70.9%)] [Iter 9840] Loss: 0.9273 (freq: 0.2785, raw: 0.6483, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 620/1024 (60.5%) Top5:[1007,110,898,591,347,944,872,851,141,554,32,1002,1012,220,415]


π”¬ Encoder Diversity (iter 9840):
  Avg similarity: 0.0645 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 15/100] [Batch 484/669 (72.3%)] [Iter 9850] Loss: 1.1033 (freq: 0.4084, raw: 0.6942, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 629/1024 (61.4%) Top5:[944,743,110,898,851,941,380,697,497,184,32,116,891,421,186]


π”¬ Encoder Diversity (iter 9850):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9500 (0.0=collapsed)
[Epoch 15/100] [Batch 494/669 (73.8%)] [Iter 9860] Loss: 1.0813 (freq: 0.3608, raw: 0.7199, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 599/1024 (58.5%) Top5:[797,891,898,32,944,186,415,110,347,829,856,453,540,220,743]


π”¬ Encoder Diversity (iter 9860):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 15/100] [Batch 504/669 (75.3%)] [Iter 9870] Loss: 1.0017 (freq: 0.3445, raw: 0.6566, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 636/1024 (62.1%) Top5:[898,856,141,891,110,415,1002,347,184,125,697,829,220,497,32]


π”¬ Encoder Diversity (iter 9870):
  Avg similarity: 0.0746 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9409 (0.0=collapsed)
[Epoch 15/100] [Batch 514/669 (76.8%)] [Iter 9880] Loss: 1.2848 (freq: 0.4426, raw: 0.8415, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 628/1024 (61.3%) Top5:[220,797,415,347,909,856,602,75,891,453,830,588,495,835,58]


π”¬ Encoder Diversity (iter 9880):
  Avg similarity: 0.0852 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9464 (0.0=collapsed)
[Epoch 15/100] [Batch 524/669 (78.3%)] [Iter 9890] Loss: 1.2724 (freq: 0.4023, raw: 0.8695, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[220,1007,830,22,797,343,549,666,654,453,554,320,588,380,58]


π”¬ Encoder Diversity (iter 9890):
  Avg similarity: 0.0313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 15/100] [Batch 534/669 (79.8%)] [Iter 9900] Loss: 1.2101 (freq: 0.4574, raw: 0.7521, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 590/1024 (57.6%) Top5:[1007,347,898,1002,851,220,891,685,116,415,32,110,125,591,390]


π”¬ Encoder Diversity (iter 9900):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 15/100] [Batch 544/669 (81.3%)] [Iter 9910] Loss: 1.1021 (freq: 0.3652, raw: 0.7363, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[1002,116,944,1007,220,267,45,497,110,22,343,560,697,891,941]


π”¬ Encoder Diversity (iter 9910):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 15/100] [Batch 554/669 (82.8%)] [Iter 9920] Loss: 1.1189 (freq: 0.3946, raw: 0.7236, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 676/1024 (66.0%) Top5:[1007,110,116,697,982,944,743,891,560,343,797,267,856,588,591]


π”¬ Encoder Diversity (iter 9920):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9629 (0.0=collapsed)
[Epoch 15/100] [Batch 564/669 (84.3%)] [Iter 9930] Loss: 1.0840 (freq: 0.3982, raw: 0.6852, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 704/1024 (68.8%) Top5:[588,220,675,797,1007,495,32,549,232,685,982,838,554,540,524]


π”¬ Encoder Diversity (iter 9930):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9440 (0.0=collapsed)
[Epoch 15/100] [Batch 574/669 (85.8%)] [Iter 9940] Loss: 0.9780 (freq: 0.3494, raw: 0.6279, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[588,1007,540,220,930,830,337,1012,476,941,495,342,549,824,524]


π”¬ Encoder Diversity (iter 9940):
  Avg similarity: 0.0693 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 15/100] [Batch 584/669 (87.3%)] [Iter 9950] Loss: 1.2086 (freq: 0.4449, raw: 0.7630, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 614/1024 (60.0%) Top5:[220,602,1002,816,141,116,697,25,675,856,891,110,32,609,560]


π”¬ Encoder Diversity (iter 9950):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 15/100] [Batch 594/669 (88.8%)] [Iter 9960] Loss: 1.0568 (freq: 0.3331, raw: 0.7231, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[220,588,320,591,257,797,75,666,1002,1012,1007,22,549,390,343]


π”¬ Encoder Diversity (iter 9960):
  Avg similarity: 0.0844 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9482 (0.0=collapsed)
[Epoch 15/100] [Batch 604/669 (90.3%)] [Iter 9970] Loss: 1.1905 (freq: 0.4056, raw: 0.7842, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[220,816,25,343,110,125,830,421,390,267,930,1007,797,549,966]


π”¬ Encoder Diversity (iter 9970):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 15/100] [Batch 614/669 (91.8%)] [Iter 9980] Loss: 1.1999 (freq: 0.4210, raw: 0.7782, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 672/1024 (65.6%) Top5:[797,1007,110,898,856,390,1002,830,588,347,342,220,602,540,909]


π”¬ Encoder Diversity (iter 9980):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 15/100] [Batch 624/669 (93.3%)] [Iter 9990] Loss: 0.8741 (freq: 0.2637, raw: 0.6098, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 660/1024 (64.5%) Top5:[32,898,110,856,1002,141,347,944,497,25,816,421,830,918,735]


π”¬ Encoder Diversity (iter 9990):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 15/100] [Batch 634/669 (94.8%)] [Iter 10000] Loss: 1.2318 (freq: 0.4291, raw: 0.8020, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 622/1024 (60.7%) Top5:[32,898,110,1007,76,856,1002,415,735,872,141,549,220,345,25]


π”¬ Encoder Diversity (iter 10000):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 15/100] [Batch 644/669 (96.3%)] [Iter 10010] Loss: 1.3375 (freq: 0.5010, raw: 0.8357, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 633/1024 (61.8%) Top5:[898,966,32,220,1002,982,697,421,110,638,1007,259,872,743,415]


π”¬ Encoder Diversity (iter 10010):
  Avg similarity: 0.0404 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9586 (0.0=collapsed)
[Epoch 15/100] [Batch 654/669 (97.8%)] [Iter 10020] Loss: 1.2049 (freq: 0.4197, raw: 0.7845, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 632/1024 (61.7%) Top5:[32,220,1002,110,872,421,141,898,540,347,638,343,982,524,345]


π”¬ Encoder Diversity (iter 10020):
  Avg similarity: 0.0449 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 15/100] [Batch 664/669 (99.3%)] [Iter 10030] Loss: 1.2558 (freq: 0.4828, raw: 0.7724, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[966,1002,421,898,666,675,110,638,540,982,549,116,72,32,347]


π”¬ Encoder Diversity (iter 10030):
  Avg similarity: 0.0388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)

================================================================================
[Epoch 15] Validation Results:
  Total Loss: 0.5873
  Freq Loss:  0.1758
  Raw Loss:   0.4109
  Quant Loss: 0.0006
  π“ Codebook Usage: 399/1024 (39.0%)
  π“ Codebook Entropy: 4.5869 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 33725 (25.9%)
  Top 10 most used codes:
    1. Code 675: 4457 times (3.42%)
    2. Code 982: 3578 times (2.75%)
    3. Code 141: 3347 times (2.57%)
    4. Code 891: 3323 times (2.55%)
    5. Code 32: 3292 times (2.53%)
    6. Code 672: 3224 times (2.48%)
    7. Code 735: 3185 times (2.45%)
    8. Code 898: 3135 times (2.41%)
    9. Code 415: 3119 times (2.40%)
    10. Code 669: 3065 times (2.35%)
  Bottom 5 least used codes (among used):
    1. Code 172: 1 times (0.00%)
    2. Code 766: 1 times (0.00%)
    3. Code 1012: 2 times (0.00%)
    4. Code 94: 3 times (0.00%)
    5. Code 111: 4 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 15
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 16/100] [Batch 5/669 (0.7%)] [Iter 10040] Loss: 0.6159 (freq: 0.1760, raw: 0.4394, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 984/1024 (96.1%) Top5:[646,267,116,944,110,1002,72,851,609,421,898,672,735,685,697]


π”¬ Encoder Diversity (iter 10040):
  Avg similarity: 0.0352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 16/100] [Batch 15/669 (2.2%)] [Iter 10050] Loss: 1.0802 (freq: 0.3611, raw: 0.7185, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[236,941,123,276,280,820,393,90,562,683,35,711,886,116,675]


π”¬ Encoder Diversity (iter 10050):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 16/100] [Batch 25/669 (3.7%)] [Iter 10060] Loss: 0.9723 (freq: 0.3314, raw: 0.6402, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 750/1024 (73.2%) Top5:[820,110,497,609,72,947,393,778,816,321,804,25,626,421,944]


π”¬ Encoder Diversity (iter 10060):
  Avg similarity: 0.0801 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 16/100] [Batch 35/669 (5.2%)] [Iter 10070] Loss: 0.9695 (freq: 0.3391, raw: 0.6297, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 637/1024 (62.2%) Top5:[735,804,124,225,35,856,215,1002,722,619,820,280,562,321,110]


π”¬ Encoder Diversity (iter 10070):
  Avg similarity: 0.0270 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 16/100] [Batch 45/669 (6.7%)] [Iter 10080] Loss: 1.1271 (freq: 0.4076, raw: 0.7189, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 640/1024 (62.5%) Top5:[1002,110,735,944,816,609,982,697,421,941,898,25,116,497,856]


π”¬ Encoder Diversity (iter 10080):
  Avg similarity: 0.0364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 16/100] [Batch 55/669 (8.2%)] [Iter 10090] Loss: 1.4683 (freq: 0.5523, raw: 0.9153, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 675/1024 (65.9%) Top5:[124,820,898,619,628,276,914,110,32,941,735,944,678,236,838]


π”¬ Encoder Diversity (iter 10090):
  Avg similarity: 0.0731 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 16/100] [Batch 65/669 (9.7%)] [Iter 10100] Loss: 1.3658 (freq: 0.5109, raw: 0.8543, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 741/1024 (72.4%) Top5:[124,820,393,276,628,260,722,216,941,244,804,683,835,280,619]


π”¬ Encoder Diversity (iter 10100):
  Avg similarity: 0.0774 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9433 (0.0=collapsed)
[Epoch 16/100] [Batch 75/669 (11.2%)] [Iter 10110] Loss: 0.9712 (freq: 0.3363, raw: 0.6342, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 731/1024 (71.4%) Top5:[124,722,215,276,820,280,400,32,801,804,393,683,678,260,35]


π”¬ Encoder Diversity (iter 10110):
  Avg similarity: 0.0601 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 16/100] [Batch 85/669 (12.7%)] [Iter 10120] Loss: 1.0700 (freq: 0.3489, raw: 0.7203, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 675/1024 (65.9%) Top5:[722,735,856,32,110,898,1002,225,347,116,415,124,497,891,141]


π”¬ Encoder Diversity (iter 10120):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 16/100] [Batch 95/669 (14.2%)] [Iter 10130] Loss: 0.9653 (freq: 0.3297, raw: 0.6350, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 654/1024 (63.9%) Top5:[116,735,110,982,32,25,856,711,421,562,215,464,722,147,944]


π”¬ Encoder Diversity (iter 10130):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 16/100] [Batch 105/669 (15.7%)] [Iter 10140] Loss: 0.8424 (freq: 0.2663, raw: 0.5754, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 657/1024 (64.2%) Top5:[116,856,978,563,32,1002,421,735,585,110,225,982,898,873,124]


π”¬ Encoder Diversity (iter 10140):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 16/100] [Batch 115/669 (17.2%)] [Iter 10150] Loss: 1.1665 (freq: 0.4010, raw: 0.7650, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[393,820,136,124,527,420,711,941,886,804,794,191,35,530,400]


π”¬ Encoder Diversity (iter 10150):
  Avg similarity: 0.0557 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 16/100] [Batch 125/669 (18.7%)] [Iter 10160] Loss: 0.9694 (freq: 0.3330, raw: 0.6358, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 675/1024 (65.9%) Top5:[124,804,820,110,276,72,619,421,25,944,708,236,1002,755,193]


π”¬ Encoder Diversity (iter 10160):
  Avg similarity: 0.0638 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 16/100] [Batch 135/669 (20.2%)] [Iter 10170] Loss: 0.9746 (freq: 0.3344, raw: 0.6396, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 680/1024 (66.4%) Top5:[804,820,215,72,276,1002,124,260,421,110,321,898,735,697,174]


π”¬ Encoder Diversity (iter 10170):
  Avg similarity: 0.0637 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 16/100] [Batch 145/669 (21.7%)] [Iter 10180] Loss: 1.2265 (freq: 0.4601, raw: 0.7657, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[873,174,804,215,110,898,978,735,1002,856,32,722,124,820,181]


π”¬ Encoder Diversity (iter 10180):
  Avg similarity: 0.1004 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9311 (0.0=collapsed)
[Epoch 16/100] [Batch 155/669 (23.2%)] [Iter 10190] Loss: 1.2997 (freq: 0.4629, raw: 0.8360, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 598/1024 (58.4%) Top5:[804,110,856,124,215,259,820,898,873,30,1002,400,562,886,174]


π”¬ Encoder Diversity (iter 10190):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 16/100] [Batch 165/669 (24.7%)] [Iter 10200] Loss: 0.8600 (freq: 0.2944, raw: 0.5650, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 599/1024 (58.5%) Top5:[856,110,820,628,735,898,873,978,273,174,215,259,804,268,393]


π”¬ Encoder Diversity (iter 10200):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 16/100] [Batch 175/669 (26.2%)] [Iter 10210] Loss: 1.1341 (freq: 0.4251, raw: 0.7084, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 652/1024 (63.7%) Top5:[856,873,110,1002,32,527,735,124,944,25,273,324,602,898,585]


π”¬ Encoder Diversity (iter 10210):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 16/100] [Batch 185/669 (27.7%)] [Iter 10220] Loss: 1.1115 (freq: 0.3909, raw: 0.7199, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 613/1024 (59.9%) Top5:[124,1002,735,944,25,110,898,820,873,562,236,72,983,711,527]


π”¬ Encoder Diversity (iter 10220):
  Avg similarity: 0.0596 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 16/100] [Batch 195/669 (29.1%)] [Iter 10230] Loss: 1.0684 (freq: 0.3527, raw: 0.7150, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[124,72,110,944,32,393,236,25,873,496,804,1002,628,562,136]


π”¬ Encoder Diversity (iter 10230):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 16/100] [Batch 205/669 (30.6%)] [Iter 10240] Loss: 0.8577 (freq: 0.2802, raw: 0.5769, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[72,944,25,873,496,124,560,591,198,982,110,32,891,421,59]


π”¬ Encoder Diversity (iter 10240):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 16/100] [Batch 215/669 (32.1%)] [Iter 10250] Loss: 1.1378 (freq: 0.3720, raw: 0.7651, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 642/1024 (62.7%) Top5:[898,174,722,978,804,289,820,628,4,393,873,32,181,941,110]


π”¬ Encoder Diversity (iter 10250):
  Avg similarity: 0.0978 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9479 (0.0=collapsed)
[Epoch 16/100] [Batch 225/669 (33.6%)] [Iter 10260] Loss: 1.0657 (freq: 0.3574, raw: 0.7077, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 624/1024 (60.9%) Top5:[562,124,873,838,110,236,835,978,804,898,945,30,527,4,628]


π”¬ Encoder Diversity (iter 10260):
  Avg similarity: 0.1158 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9440 (0.0=collapsed)
[Epoch 16/100] [Batch 235/669 (35.1%)] [Iter 10270] Loss: 1.0858 (freq: 0.4097, raw: 0.6754, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 692/1024 (67.6%) Top5:[236,898,735,110,273,873,421,941,711,856,804,174,944,820,591]


π”¬ Encoder Diversity (iter 10270):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 16/100] [Batch 245/669 (36.6%)] [Iter 10280] Loss: 1.0787 (freq: 0.3878, raw: 0.6902, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[856,675,273,174,978,735,820,873,898,4,711,289,982,685,124]


π”¬ Encoder Diversity (iter 10280):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 16/100] [Batch 255/669 (38.1%)] [Iter 10290] Loss: 1.0649 (freq: 0.3506, raw: 0.7136, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 606/1024 (59.2%) Top5:[289,174,820,804,393,133,400,711,321,124,628,835,905,530,136]


π”¬ Encoder Diversity (iter 10290):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 16/100] [Batch 265/669 (39.6%)] [Iter 10300] Loss: 1.3723 (freq: 0.5143, raw: 0.8572, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 638/1024 (62.3%) Top5:[804,124,393,321,174,820,216,794,421,613,289,609,397,276,587]


π”¬ Encoder Diversity (iter 10300):
  Avg similarity: 0.0631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9492 (0.0=collapsed)
[Epoch 16/100] [Batch 275/669 (41.1%)] [Iter 10310] Loss: 0.4736 (freq: 0.1205, raw: 0.3526, quant: 0.0005, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 699/1024 (68.3%) Top5:[259,464,32,110,978,421,347,898,225,675,585,856,4,735,273]


π”¬ Encoder Diversity (iter 10310):
  Avg similarity: 0.0892 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9358 (0.0=collapsed)
[Epoch 16/100] [Batch 285/669 (42.6%)] [Iter 10320] Loss: 1.3449 (freq: 0.5114, raw: 0.8328, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 718/1024 (70.1%) Top5:[838,236,393,945,804,110,942,820,321,835,397,30,619,216,711]


π”¬ Encoder Diversity (iter 10320):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 16/100] [Batch 295/669 (44.1%)] [Iter 10330] Loss: 1.3704 (freq: 0.5382, raw: 0.8315, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 703/1024 (68.7%) Top5:[110,820,898,835,116,289,35,174,321,236,873,32,711,124,136]


π”¬ Encoder Diversity (iter 10330):
  Avg similarity: 0.0698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9519 (0.0=collapsed)
[Epoch 16/100] [Batch 305/669 (45.6%)] [Iter 10340] Loss: 1.2274 (freq: 0.4468, raw: 0.7798, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 680/1024 (66.4%) Top5:[110,873,32,289,133,820,941,25,451,393,711,722,778,198,116]


π”¬ Encoder Diversity (iter 10340):
  Avg similarity: 0.0384 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 16/100] [Batch 315/669 (47.1%)] [Iter 10350] Loss: 1.0016 (freq: 0.3476, raw: 0.6533, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 668/1024 (65.2%) Top5:[856,978,735,273,873,259,32,585,324,225,537,898,141,181,347]


π”¬ Encoder Diversity (iter 10350):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 16/100] [Batch 325/669 (48.6%)] [Iter 10360] Loss: 1.1563 (freq: 0.4004, raw: 0.7552, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 738/1024 (72.1%) Top5:[421,945,599,801,393,35,708,941,198,324,944,722,873,585,321]


π”¬ Encoder Diversity (iter 10360):
  Avg similarity: 0.0716 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9500 (0.0=collapsed)
[Epoch 16/100] [Batch 335/669 (50.1%)] [Iter 10370] Loss: 1.0647 (freq: 0.3836, raw: 0.6804, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 689/1024 (67.3%) Top5:[141,421,273,856,32,873,735,110,944,585,1002,198,225,591,537]


π”¬ Encoder Diversity (iter 10370):
  Avg similarity: 0.0738 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 16/100] [Batch 345/669 (51.6%)] [Iter 10380] Loss: 0.9247 (freq: 0.3084, raw: 0.6158, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[856,273,675,479,735,1002,393,585,124,838,978,141,259,336,835]


π”¬ Encoder Diversity (iter 10380):
  Avg similarity: 0.0742 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9444 (0.0=collapsed)
[Epoch 16/100] [Batch 355/669 (53.1%)] [Iter 10390] Loss: 1.0104 (freq: 0.3892, raw: 0.6205, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 661/1024 (64.6%) Top5:[421,110,898,735,856,32,1002,25,116,944,48,697,273,198,587]


π”¬ Encoder Diversity (iter 10390):
  Avg similarity: 0.0820 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9450 (0.0=collapsed)
[Epoch 16/100] [Batch 365/669 (54.6%)] [Iter 10400] Loss: 1.2247 (freq: 0.4529, raw: 0.7710, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 731/1024 (71.4%) Top5:[32,174,110,133,25,711,393,124,321,421,944,562,915,735,873]


π”¬ Encoder Diversity (iter 10400):
  Avg similarity: 0.0978 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9403 (0.0=collapsed)
[Epoch 16/100] [Batch 375/669 (56.1%)] [Iter 10410] Loss: 0.9586 (freq: 0.3073, raw: 0.6506, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[110,820,133,174,268,124,711,708,393,804,873,619,1004,400,276]


π”¬ Encoder Diversity (iter 10410):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 16/100] [Batch 385/669 (57.5%)] [Iter 10420] Loss: 1.1805 (freq: 0.4351, raw: 0.7446, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 714/1024 (69.7%) Top5:[110,1002,873,393,421,225,804,820,324,32,735,941,778,708,273]


π”¬ Encoder Diversity (iter 10420):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 16/100] [Batch 395/669 (59.0%)] [Iter 10430] Loss: 1.2711 (freq: 0.4758, raw: 0.7946, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 675/1024 (65.9%) Top5:[110,804,873,32,898,301,735,941,708,141,1002,626,820,838,273]


π”¬ Encoder Diversity (iter 10430):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 16/100] [Batch 405/669 (60.5%)] [Iter 10440] Loss: 1.0805 (freq: 0.3832, raw: 0.6966, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[110,421,393,708,735,1002,124,873,48,804,116,324,915,715,321]


π”¬ Encoder Diversity (iter 10440):
  Avg similarity: 0.0405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 16/100] [Batch 415/669 (62.0%)] [Iter 10450] Loss: 1.2319 (freq: 0.4488, raw: 0.7824, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[110,735,116,915,708,32,421,873,856,496,898,393,835,321,124]


π”¬ Encoder Diversity (iter 10450):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 16/100] [Batch 425/669 (63.5%)] [Iter 10460] Loss: 0.9204 (freq: 0.2985, raw: 0.6212, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 739/1024 (72.2%) Top5:[735,856,479,133,273,898,941,711,393,464,708,123,873,1002,685]


π”¬ Encoder Diversity (iter 10460):
  Avg similarity: 0.0772 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9453 (0.0=collapsed)
[Epoch 16/100] [Batch 435/669 (65.0%)] [Iter 10470] Loss: 0.9427 (freq: 0.3017, raw: 0.6404, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 696/1024 (68.0%) Top5:[479,898,856,873,4,735,1002,273,260,421,289,527,324,174,464]


π”¬ Encoder Diversity (iter 10470):
  Avg similarity: 0.1007 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9473 (0.0=collapsed)
[Epoch 16/100] [Batch 445/669 (66.5%)] [Iter 10480] Loss: 0.8688 (freq: 0.3121, raw: 0.5561, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 698/1024 (68.2%) Top5:[735,941,273,804,820,174,289,715,225,421,711,301,1002,873,708]


π”¬ Encoder Diversity (iter 10480):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 16/100] [Batch 455/669 (68.0%)] [Iter 10490] Loss: 1.2669 (freq: 0.4874, raw: 0.7787, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 676/1024 (66.0%) Top5:[1002,110,421,735,873,642,898,273,324,225,697,32,451,48,941]


π”¬ Encoder Diversity (iter 10490):
  Avg similarity: 0.0599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 16/100] [Batch 465/669 (69.5%)] [Iter 10500] Loss: 1.1578 (freq: 0.4275, raw: 0.7295, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[289,273,393,301,236,400,711,324,804,562,124,628,873,820,225]


π”¬ Encoder Diversity (iter 10500):
  Avg similarity: 0.0623 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 16/100] [Batch 475/669 (71.0%)] [Iter 10510] Loss: 1.3074 (freq: 0.4515, raw: 0.8551, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[236,708,321,628,124,711,941,945,289,856,133,393,801,804,820]


π”¬ Encoder Diversity (iter 10510):
  Avg similarity: 0.0629 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9504 (0.0=collapsed)
[Epoch 16/100] [Batch 485/669 (72.5%)] [Iter 10520] Loss: 1.0606 (freq: 0.3756, raw: 0.6842, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 722/1024 (70.5%) Top5:[735,321,110,873,1002,856,324,273,225,915,421,141,170,711,133]


π”¬ Encoder Diversity (iter 10520):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 16/100] [Batch 495/669 (74.0%)] [Iter 10530] Loss: 1.2301 (freq: 0.4317, raw: 0.7977, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 716/1024 (69.9%) Top5:[110,420,628,941,804,321,32,30,863,530,711,174,697,856,735]


π”¬ Encoder Diversity (iter 10530):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 16/100] [Batch 505/669 (75.5%)] [Iter 10540] Loss: 1.1354 (freq: 0.4220, raw: 0.7127, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 674/1024 (65.8%) Top5:[898,735,856,873,479,110,32,1002,891,141,273,464,324,116,4]


π”¬ Encoder Diversity (iter 10540):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 16/100] [Batch 515/669 (77.0%)] [Iter 10550] Loss: 1.1198 (freq: 0.4226, raw: 0.6966, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 717/1024 (70.0%) Top5:[941,778,735,626,820,701,301,124,711,35,30,804,479,236,527]


π”¬ Encoder Diversity (iter 10550):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 16/100] [Batch 525/669 (78.5%)] [Iter 10560] Loss: 0.8264 (freq: 0.2842, raw: 0.5417, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[124,898,804,35,319,628,393,941,983,735,321,801,873,835,289]


π”¬ Encoder Diversity (iter 10560):
  Avg similarity: 0.0697 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 16/100] [Batch 535/669 (80.0%)] [Iter 10570] Loss: 1.2312 (freq: 0.4553, raw: 0.7752, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 654/1024 (63.9%) Top5:[873,891,110,421,591,1002,386,735,273,755,85,43,915,708,856]


π”¬ Encoder Diversity (iter 10570):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 16/100] [Batch 545/669 (81.5%)] [Iter 10580] Loss: 1.2350 (freq: 0.4657, raw: 0.7686, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 717/1024 (70.0%) Top5:[321,701,820,628,124,174,835,804,289,301,527,324,400,393,530]


π”¬ Encoder Diversity (iter 10580):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 16/100] [Batch 555/669 (83.0%)] [Iter 10590] Loss: 0.9736 (freq: 0.3181, raw: 0.6548, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 698/1024 (68.2%) Top5:[735,804,321,124,820,711,215,110,701,1002,856,898,715,873,628]


π”¬ Encoder Diversity (iter 10590):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9551 (0.0=collapsed)
[Epoch 16/100] [Batch 565/669 (84.5%)] [Iter 10600] Loss: 1.4899 (freq: 0.5807, raw: 0.9084, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 703/1024 (68.7%) Top5:[804,321,941,820,527,873,711,708,945,236,393,260,400,628,289]


π”¬ Encoder Diversity (iter 10600):
  Avg similarity: 0.0295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 16/100] [Batch 575/669 (85.9%)] [Iter 10610] Loss: 1.2417 (freq: 0.4338, raw: 0.8071, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 713/1024 (69.6%) Top5:[856,898,873,110,273,735,141,324,181,225,585,448,268,170,915]


π”¬ Encoder Diversity (iter 10610):
  Avg similarity: 0.0274 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 16/100] [Batch 585/669 (87.4%)] [Iter 10620] Loss: 1.0605 (freq: 0.3761, raw: 0.6837, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 661/1024 (64.6%) Top5:[386,915,856,873,898,448,181,110,170,1019,840,141,324,1002,198]


π”¬ Encoder Diversity (iter 10620):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 16/100] [Batch 595/669 (88.9%)] [Iter 10630] Loss: 0.9959 (freq: 0.3446, raw: 0.6507, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[393,170,820,321,1004,856,804,628,35,711,273,124,898,527,289]


π”¬ Encoder Diversity (iter 10630):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 16/100] [Batch 605/669 (90.4%)] [Iter 10640] Loss: 0.8159 (freq: 0.2520, raw: 0.5632, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 719/1024 (70.2%) Top5:[170,856,804,110,915,198,840,820,273,116,448,386,931,898,944]


π”¬ Encoder Diversity (iter 10640):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 16/100] [Batch 615/669 (91.9%)] [Iter 10650] Loss: 1.0759 (freq: 0.3858, raw: 0.6894, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 692/1024 (67.6%) Top5:[944,110,840,116,898,448,873,386,32,170,591,915,1019,273,421]


π”¬ Encoder Diversity (iter 10650):
  Avg similarity: 0.0716 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9471 (0.0=collapsed)
[Epoch 16/100] [Batch 625/669 (93.4%)] [Iter 10660] Loss: 1.3134 (freq: 0.4678, raw: 0.8447, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 729/1024 (71.2%) Top5:[321,110,273,891,941,856,1019,711,141,1004,820,170,804,945,236]


π”¬ Encoder Diversity (iter 10660):
  Avg similarity: 0.0594 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)
[Epoch 16/100] [Batch 635/669 (94.9%)] [Iter 10670] Loss: 0.7493 (freq: 0.2514, raw: 0.4973, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 724/1024 (70.7%) Top5:[110,944,891,198,898,273,1019,448,856,203,1002,735,347,701,421]


π”¬ Encoder Diversity (iter 10670):
  Avg similarity: 0.0679 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 16/100] [Batch 645/669 (96.4%)] [Iter 10680] Loss: 0.9528 (freq: 0.3350, raw: 0.6172, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[321,110,804,646,170,856,735,628,273,944,891,174,448,421,393]


π”¬ Encoder Diversity (iter 10680):
  Avg similarity: 0.0685 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 16/100] [Batch 655/669 (97.9%)] [Iter 10690] Loss: 1.2765 (freq: 0.4989, raw: 0.7769, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[820,941,898,891,735,393,124,804,110,646,701,4,860,778,321]


π”¬ Encoder Diversity (iter 10690):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9581 (0.0=collapsed)
[Epoch 16/100] [Batch 665/669 (99.4%)] [Iter 10700] Loss: 1.0803 (freq: 0.3581, raw: 0.7215, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 730/1024 (71.3%) Top5:[646,804,711,735,273,110,225,400,301,124,856,324,289,321,820]


π”¬ Encoder Diversity (iter 10700):
  Avg similarity: 0.0671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)

================================================================================
[Epoch 16] Validation Results:
  Total Loss: 0.5811
  Freq Loss:  0.1745
  Raw Loss:   0.4059
  Quant Loss: 0.0006
  π“ Codebook Usage: 466/1024 (45.5%)
  π“ Codebook Entropy: 4.6106 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 30630 (23.5%)
  Top 10 most used codes:
    1. Code 32: 3695 times (2.84%)
    2. Code 589: 3376 times (2.59%)
    3. Code 233: 3211 times (2.47%)
    4. Code 915: 3160 times (2.43%)
    5. Code 273: 2981 times (2.29%)
    6. Code 931: 2977 times (2.29%)
    7. Code 585: 2909 times (2.23%)
    8. Code 386: 2877 times (2.21%)
    9. Code 464: 2742 times (2.11%)
    10. Code 141: 2702 times (2.08%)
  Bottom 5 least used codes (among used):
    1. Code 783: 1 times (0.00%)
    2. Code 42: 1 times (0.00%)
    3. Code 425: 2 times (0.00%)
    4. Code 72: 2 times (0.00%)
    5. Code 10: 2 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 16
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 17/100] [Batch 6/669 (0.9%)] [Iter 10710] Loss: 0.9421 (freq: 0.3310, raw: 0.6104, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 991/1024 (96.8%) Top5:[891,856,347,324,1019,203,110,898,181,873,593,273,225,448,170]


π”¬ Encoder Diversity (iter 10710):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)
[Epoch 17/100] [Batch 16/669 (2.4%)] [Iter 10720] Loss: 0.8503 (freq: 0.3052, raw: 0.5445, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[453,448,344,873,567,499,133,427,1019,906,591,150,790,170,169]


π”¬ Encoder Diversity (iter 10720):
  Avg similarity: 0.0761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9439 (0.0=collapsed)
[Epoch 17/100] [Batch 26/669 (3.9%)] [Iter 10730] Loss: 1.2163 (freq: 0.4138, raw: 0.8018, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[918,463,150,411,530,133,906,567,790,706,344,453,518,645,482]


π”¬ Encoder Diversity (iter 10730):
  Avg similarity: 0.0734 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 17/100] [Batch 36/669 (5.4%)] [Iter 10740] Loss: 1.2804 (freq: 0.4639, raw: 0.8157, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[463,448,421,1002,840,918,856,898,873,116,915,347,22,110,141]


π”¬ Encoder Diversity (iter 10740):
  Avg similarity: 0.0242 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 17/100] [Batch 46/669 (6.9%)] [Iter 10750] Loss: 1.0121 (freq: 0.3695, raw: 0.6419, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[324,735,110,463,170,448,141,918,955,856,186,185,273,790,635]


π”¬ Encoder Diversity (iter 10750):
  Avg similarity: 0.0712 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 17/100] [Batch 56/669 (8.4%)] [Iter 10760] Loss: 1.0835 (freq: 0.3672, raw: 0.7155, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 736/1024 (71.9%) Top5:[898,856,735,273,635,1002,347,141,1019,170,110,873,324,885,4]


π”¬ Encoder Diversity (iter 10760):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 17/100] [Batch 66/669 (9.9%)] [Iter 10770] Loss: 0.9957 (freq: 0.3625, raw: 0.6324, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[961,448,885,873,110,427,756,554,22,1002,411,898,1017,522,585]


π”¬ Encoder Diversity (iter 10770):
  Avg similarity: 0.0369 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 17/100] [Batch 76/669 (11.4%)] [Iter 10780] Loss: 1.1676 (freq: 0.4629, raw: 0.7040, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 695/1024 (67.9%) Top5:[944,110,448,198,697,915,840,873,931,386,421,856,1002,116,755]


π”¬ Encoder Diversity (iter 10780):
  Avg similarity: 0.0414 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 17/100] [Batch 86/669 (12.9%)] [Iter 10790] Loss: 1.2320 (freq: 0.4612, raw: 0.7702, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 706/1024 (68.9%) Top5:[879,906,110,22,961,706,453,885,580,891,809,411,1002,463,1017]


π”¬ Encoder Diversity (iter 10790):
  Avg similarity: 0.0245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 17/100] [Batch 96/669 (14.3%)] [Iter 10800] Loss: 0.7841 (freq: 0.2250, raw: 0.5585, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 692/1024 (67.6%) Top5:[856,110,273,1002,873,898,347,891,225,4,585,1019,955,918,463]


π”¬ Encoder Diversity (iter 10800):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 17/100] [Batch 106/669 (15.8%)] [Iter 10810] Loss: 1.2191 (freq: 0.4668, raw: 0.7516, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 708/1024 (69.1%) Top5:[110,635,944,856,1002,898,873,4,554,891,273,324,616,49,918]


π”¬ Encoder Diversity (iter 10810):
  Avg similarity: 0.0782 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 17/100] [Batch 116/669 (17.3%)] [Iter 10820] Loss: 1.1986 (freq: 0.4292, raw: 0.7687, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 704/1024 (68.8%) Top5:[918,898,110,944,873,706,1019,856,1002,842,735,1022,809,587,181]


π”¬ Encoder Diversity (iter 10820):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 17/100] [Batch 126/669 (18.8%)] [Iter 10830] Loss: 1.1081 (freq: 0.4011, raw: 0.7063, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 706/1024 (68.9%) Top5:[898,110,856,891,1002,873,225,635,273,181,1019,49,735,203,198]


π”¬ Encoder Diversity (iter 10830):
  Avg similarity: 0.0453 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9524 (0.0=collapsed)
[Epoch 17/100] [Batch 136/669 (20.3%)] [Iter 10840] Loss: 1.0909 (freq: 0.3688, raw: 0.7214, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 708/1024 (69.1%) Top5:[386,198,915,918,421,697,448,110,32,1002,944,891,840,116,591]


π”¬ Encoder Diversity (iter 10840):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 17/100] [Batch 146/669 (21.8%)] [Iter 10850] Loss: 1.2561 (freq: 0.4823, raw: 0.7731, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 689/1024 (67.3%) Top5:[697,110,386,931,944,918,198,915,421,840,891,645,448,554,22]


π”¬ Encoder Diversity (iter 10850):
  Avg similarity: 0.0656 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 17/100] [Batch 156/669 (23.3%)] [Iter 10860] Loss: 1.2063 (freq: 0.4524, raw: 0.7531, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 707/1024 (69.0%) Top5:[110,856,1019,735,1002,944,873,225,421,324,591,203,898,386,463]


π”¬ Encoder Diversity (iter 10860):
  Avg similarity: 0.0401 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 17/100] [Batch 166/669 (24.8%)] [Iter 10870] Loss: 1.3690 (freq: 0.5099, raw: 0.8583, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 663/1024 (64.7%) Top5:[856,735,944,448,386,635,110,463,1019,898,421,873,225,879,273]


π”¬ Encoder Diversity (iter 10870):
  Avg similarity: 0.0695 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9482 (0.0=collapsed)
[Epoch 17/100] [Batch 176/669 (26.3%)] [Iter 10880] Loss: 1.1507 (freq: 0.4275, raw: 0.7225, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 712/1024 (69.5%) Top5:[1002,856,873,141,110,273,944,898,735,225,421,324,49,587,170]


π”¬ Encoder Diversity (iter 10880):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 17/100] [Batch 186/669 (27.8%)] [Iter 10890] Loss: 1.3159 (freq: 0.5161, raw: 0.7989, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[879,856,463,453,1022,285,45,918,580,735,898,110,127,873,22]


π”¬ Encoder Diversity (iter 10890):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 17/100] [Batch 196/669 (29.3%)] [Iter 10900] Loss: 0.9207 (freq: 0.3024, raw: 0.6177, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 709/1024 (69.2%) Top5:[163,856,49,587,635,1002,324,110,203,273,225,259,735,873,421]


π”¬ Encoder Diversity (iter 10900):
  Avg similarity: 0.0853 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9389 (0.0=collapsed)
[Epoch 17/100] [Batch 206/669 (30.8%)] [Iter 10910] Loss: 1.3469 (freq: 0.4973, raw: 0.8489, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[863,482,463,670,518,133,427,554,45,279,790,691,905,71,10]


π”¬ Encoder Diversity (iter 10910):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 17/100] [Batch 216/669 (32.3%)] [Iter 10920] Loss: 0.9466 (freq: 0.3076, raw: 0.6383, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 778/1024 (76.0%) Top5:[463,944,110,386,421,734,706,918,10,790,198,279,697,591,567]


π”¬ Encoder Diversity (iter 10920):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 17/100] [Batch 226/669 (33.8%)] [Iter 10930] Loss: 1.1982 (freq: 0.4346, raw: 0.7629, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 659/1024 (64.4%) Top5:[110,873,931,591,944,116,1019,421,856,225,32,386,1002,203,22]


π”¬ Encoder Diversity (iter 10930):
  Avg similarity: 0.0843 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 17/100] [Batch 236/669 (35.3%)] [Iter 10940] Loss: 1.1061 (freq: 0.3960, raw: 0.7093, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 698/1024 (68.2%) Top5:[463,411,842,279,26,453,545,706,918,110,127,22,45,790,554]


π”¬ Encoder Diversity (iter 10940):
  Avg similarity: 0.0309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 17/100] [Batch 246/669 (36.8%)] [Iter 10950] Loss: 1.2174 (freq: 0.4391, raw: 0.7775, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 652/1024 (63.7%) Top5:[110,1002,198,931,133,918,944,225,421,32,734,706,856,873,790]


π”¬ Encoder Diversity (iter 10950):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 17/100] [Batch 256/669 (38.3%)] [Iter 10960] Loss: 1.1823 (freq: 0.4010, raw: 0.7806, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[554,918,110,421,944,463,45,939,411,26,856,863,285,427,71]


π”¬ Encoder Diversity (iter 10960):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 17/100] [Batch 266/669 (39.8%)] [Iter 10970] Loss: 1.1061 (freq: 0.3805, raw: 0.7249, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[944,110,856,285,71,279,961,10,885,554,706,1002,697,386,198]


π”¬ Encoder Diversity (iter 10970):
  Avg similarity: 0.0690 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 17/100] [Batch 276/669 (41.3%)] [Iter 10980] Loss: 1.0616 (freq: 0.3636, raw: 0.6974, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 739/1024 (72.2%) Top5:[944,438,110,386,873,879,639,856,285,1002,463,421,453,840,591]


π”¬ Encoder Diversity (iter 10980):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 17/100] [Batch 286/669 (42.8%)] [Iter 10990] Loss: 1.0813 (freq: 0.3910, raw: 0.6896, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 659/1024 (64.4%) Top5:[856,110,1019,453,141,873,735,944,170,324,26,22,734,879,225]


π”¬ Encoder Diversity (iter 10990):
  Avg similarity: 0.0974 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 17/100] [Batch 296/669 (44.2%)] [Iter 11000] Loss: 0.6810 (freq: 0.1939, raw: 0.4865, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 711/1024 (69.4%) Top5:[856,110,273,873,225,593,1019,163,788,324,587,141,181,735,891]


π”¬ Encoder Diversity (iter 11000):
  Avg similarity: 0.0352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 17/100] [Batch 306/669 (45.7%)] [Iter 11010] Loss: 0.9560 (freq: 0.3215, raw: 0.6338, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[421,891,873,438,386,697,589,1002,1019,324,591,840,915,116,32]


π”¬ Encoder Diversity (iter 11010):
  Avg similarity: 0.0195 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 17/100] [Batch 316/669 (47.2%)] [Iter 11020] Loss: 0.9733 (freq: 0.2986, raw: 0.6740, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 733/1024 (71.6%) Top5:[918,386,873,110,26,879,45,225,141,915,589,125,864,448,324]


π”¬ Encoder Diversity (iter 11020):
  Avg similarity: 0.0706 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9453 (0.0=collapsed)
[Epoch 17/100] [Batch 326/669 (48.7%)] [Iter 11030] Loss: 1.3275 (freq: 0.5035, raw: 0.8232, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[918,1019,45,110,141,463,259,706,411,279,225,324,879,873,10]


π”¬ Encoder Diversity (iter 11030):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 17/100] [Batch 336/669 (50.2%)] [Iter 11040] Loss: 1.1173 (freq: 0.3780, raw: 0.7385, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 696/1024 (68.0%) Top5:[438,110,463,944,386,734,45,1019,411,856,421,873,918,639,518]


π”¬ Encoder Diversity (iter 11040):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 17/100] [Batch 346/669 (51.7%)] [Iter 11050] Loss: 0.9401 (freq: 0.3094, raw: 0.6301, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 717/1024 (70.0%) Top5:[386,873,856,944,110,198,411,421,697,463,438,863,554,273,734]


π”¬ Encoder Diversity (iter 11050):
  Avg similarity: 0.0667 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9523 (0.0=collapsed)
[Epoch 17/100] [Batch 356/669 (53.2%)] [Iter 11060] Loss: 1.3327 (freq: 0.5057, raw: 0.8263, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[463,411,788,324,918,554,885,110,26,706,856,1019,879,790,138]


π”¬ Encoder Diversity (iter 11060):
  Avg similarity: 0.0533 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 17/100] [Batch 366/669 (54.7%)] [Iter 11070] Loss: 0.8508 (freq: 0.3022, raw: 0.5480, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[110,856,1019,324,788,163,873,593,22,944,225,558,116,170,554]


π”¬ Encoder Diversity (iter 11070):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 17/100] [Batch 376/669 (56.2%)] [Iter 11080] Loss: 1.2177 (freq: 0.4483, raw: 0.7686, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 759/1024 (74.1%) Top5:[427,26,279,463,45,918,10,734,885,554,453,22,407,411,71]


π”¬ Encoder Diversity (iter 11080):
  Avg similarity: 0.0497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 17/100] [Batch 386/669 (57.7%)] [Iter 11090] Loss: 1.0595 (freq: 0.3823, raw: 0.6765, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 722/1024 (70.5%) Top5:[734,45,26,411,453,427,110,790,22,1019,1022,133,833,225,10]


π”¬ Encoder Diversity (iter 11090):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 17/100] [Batch 396/669 (59.2%)] [Iter 11100] Loss: 1.0922 (freq: 0.3871, raw: 0.7043, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[324,463,421,944,110,734,386,1002,45,891,1019,639,453,163,856]


π”¬ Encoder Diversity (iter 11100):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 17/100] [Batch 406/669 (60.7%)] [Iter 11110] Loss: 1.2626 (freq: 0.4367, raw: 0.8252, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[842,734,45,453,863,324,879,1002,225,110,309,421,788,939,706]


π”¬ Encoder Diversity (iter 11110):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 17/100] [Batch 416/669 (62.2%)] [Iter 11120] Loss: 1.4698 (freq: 0.5565, raw: 0.9125, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[386,856,421,324,453,842,944,939,45,155,110,639,873,279,734]


π”¬ Encoder Diversity (iter 11120):
  Avg similarity: 0.0517 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 17/100] [Batch 426/669 (63.7%)] [Iter 11130] Loss: 1.2595 (freq: 0.4191, raw: 0.8396, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 704/1024 (68.8%) Top5:[463,918,915,324,198,840,45,386,1019,944,26,1002,411,10,856]


π”¬ Encoder Diversity (iter 11130):
  Avg similarity: 0.0609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 17/100] [Batch 436/669 (65.2%)] [Iter 11140] Loss: 1.1506 (freq: 0.3865, raw: 0.7634, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 745/1024 (72.8%) Top5:[918,463,279,133,10,411,138,790,26,45,926,453,427,324,502]


π”¬ Encoder Diversity (iter 11140):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 17/100] [Batch 446/669 (66.7%)] [Iter 11150] Loss: 1.0561 (freq: 0.3650, raw: 0.6904, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[324,1002,198,873,735,110,639,856,386,225,944,421,840,995,306]


π”¬ Encoder Diversity (iter 11150):
  Avg similarity: 0.0684 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 17/100] [Batch 456/669 (68.2%)] [Iter 11160] Loss: 1.1028 (freq: 0.3819, raw: 0.7202, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 740/1024 (72.3%) Top5:[734,790,453,879,407,554,285,26,502,133,842,558,735,211,45]


π”¬ Encoder Diversity (iter 11160):
  Avg similarity: 0.0848 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 17/100] [Batch 466/669 (69.7%)] [Iter 11170] Loss: 1.2075 (freq: 0.4398, raw: 0.7669, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[482,133,619,734,26,879,554,706,463,1017,324,926,833,407,63]


π”¬ Encoder Diversity (iter 11170):
  Avg similarity: 0.0747 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 17/100] [Batch 476/669 (71.2%)] [Iter 11180] Loss: 1.2170 (freq: 0.4305, raw: 0.7858, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 782/1024 (76.4%) Top5:[558,1019,233,330,856,140,735,324,879,273,309,259,873,891,926]


π”¬ Encoder Diversity (iter 11180):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 17/100] [Batch 486/669 (72.6%)] [Iter 11190] Loss: 1.2297 (freq: 0.4579, raw: 0.7711, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 731/1024 (71.4%) Top5:[324,873,330,1019,694,203,225,856,790,891,121,918,1002,463,309]


π”¬ Encoder Diversity (iter 11190):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 17/100] [Batch 496/669 (74.1%)] [Iter 11200] Loss: 1.1718 (freq: 0.4442, raw: 0.7268, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 714/1024 (69.7%) Top5:[1019,1002,324,110,856,915,421,32,198,944,840,170,873,203,891]


π”¬ Encoder Diversity (iter 11200):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 17/100] [Batch 506/669 (75.6%)] [Iter 11210] Loss: 1.0146 (freq: 0.3894, raw: 0.6245, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[1019,856,324,734,926,873,225,1002,110,639,431,45,891,138,330]


π”¬ Encoder Diversity (iter 11210):
  Avg similarity: 0.0627 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 17/100] [Batch 516/669 (77.1%)] [Iter 11220] Loss: 1.0027 (freq: 0.3250, raw: 0.6770, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 716/1024 (69.9%) Top5:[324,995,873,856,944,1002,225,842,1019,110,734,170,697,198,121]


π”¬ Encoder Diversity (iter 11220):
  Avg similarity: 0.0776 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 17/100] [Batch 526/669 (78.6%)] [Iter 11230] Loss: 1.0800 (freq: 0.3847, raw: 0.6947, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[734,431,926,324,463,1002,285,670,1019,453,554,995,856,133,873]


π”¬ Encoder Diversity (iter 11230):
  Avg similarity: 0.0612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 17/100] [Batch 536/669 (80.1%)] [Iter 11240] Loss: 0.7096 (freq: 0.2186, raw: 0.4904, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 750/1024 (73.2%) Top5:[856,734,324,873,203,427,431,735,593,259,944,995,439,879,225]


π”¬ Encoder Diversity (iter 11240):
  Avg similarity: 0.0500 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 17/100] [Batch 546/669 (81.6%)] [Iter 11250] Loss: 0.8596 (freq: 0.2781, raw: 0.5808, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 700/1024 (68.4%) Top5:[734,995,873,842,735,26,306,944,386,856,309,697,448,558,324]


π”¬ Encoder Diversity (iter 11250):
  Avg similarity: 0.0504 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 17/100] [Batch 556/669 (83.1%)] [Iter 11260] Loss: 1.3156 (freq: 0.4782, raw: 0.8365, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 723/1024 (70.6%) Top5:[734,790,879,285,918,944,453,482,116,856,670,306,842,411,26]


π”¬ Encoder Diversity (iter 11260):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 17/100] [Batch 566/669 (84.6%)] [Iter 11270] Loss: 1.3389 (freq: 0.5351, raw: 0.8029, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 724/1024 (70.7%) Top5:[734,842,26,840,879,856,558,995,324,944,863,806,593,1019,421]


π”¬ Encoder Diversity (iter 11270):
  Avg similarity: 0.0691 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 17/100] [Batch 576/669 (86.1%)] [Iter 11280] Loss: 1.2154 (freq: 0.4611, raw: 0.7535, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 767/1024 (74.9%) Top5:[873,1019,734,842,133,856,330,203,558,433,735,324,140,879,10]


π”¬ Encoder Diversity (iter 11280):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 17/100] [Batch 586/669 (87.6%)] [Iter 11290] Loss: 1.1612 (freq: 0.4477, raw: 0.7128, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[915,324,448,639,944,229,198,10,181,32,431,1002,1019,306,386]


π”¬ Encoder Diversity (iter 11290):
  Avg similarity: 0.0717 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 17/100] [Batch 596/669 (89.1%)] [Iter 11300] Loss: 1.2534 (freq: 0.4241, raw: 0.8286, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 694/1024 (67.8%) Top5:[873,1019,879,995,734,285,463,453,45,286,309,22,1002,918,790]


π”¬ Encoder Diversity (iter 11300):
  Avg similarity: 0.1119 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 17/100] [Batch 606/669 (90.6%)] [Iter 11310] Loss: 1.2504 (freq: 0.4718, raw: 0.7779, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[1002,1019,995,873,121,856,330,324,259,891,734,309,972,124,735]


π”¬ Encoder Diversity (iter 11310):
  Avg similarity: 0.0848 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9442 (0.0=collapsed)
[Epoch 17/100] [Batch 616/669 (92.1%)] [Iter 11320] Loss: 0.9798 (freq: 0.3703, raw: 0.6088, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[995,554,285,1019,324,124,558,1002,944,105,891,915,121,433,330]


π”¬ Encoder Diversity (iter 11320):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 17/100] [Batch 626/669 (93.6%)] [Iter 11330] Loss: 1.2400 (freq: 0.4442, raw: 0.7951, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 710/1024 (69.3%) Top5:[879,558,995,593,734,330,324,433,453,1002,121,124,873,309,285]


π”¬ Encoder Diversity (iter 11330):
  Avg similarity: 0.0700 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 17/100] [Batch 636/669 (95.1%)] [Iter 11340] Loss: 1.3073 (freq: 0.4953, raw: 0.8112, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 787/1024 (76.9%) Top5:[22,734,939,26,285,554,482,463,915,45,790,427,879,448,926]


π”¬ Encoder Diversity (iter 11340):
  Avg similarity: 0.0380 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 17/100] [Batch 646/669 (96.6%)] [Iter 11350] Loss: 1.3964 (freq: 0.4972, raw: 0.8985, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 775/1024 (75.7%) Top5:[879,734,453,706,22,285,463,926,133,842,790,286,411,736,354]


π”¬ Encoder Diversity (iter 11350):
  Avg similarity: 0.0313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 17/100] [Batch 656/669 (98.1%)] [Iter 11360] Loss: 1.2247 (freq: 0.4414, raw: 0.7825, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 727/1024 (71.0%) Top5:[330,225,40,995,309,431,433,1002,203,1019,170,770,324,891,140]


π”¬ Encoder Diversity (iter 11360):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 17/100] [Batch 666/669 (99.6%)] [Iter 11370] Loss: 0.9935 (freq: 0.3401, raw: 0.6527, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 753/1024 (73.5%) Top5:[324,995,1019,124,639,915,856,944,198,110,225,770,873,1002,731]


π”¬ Encoder Diversity (iter 11370):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)

================================================================================
[Epoch 17] Validation Results:
  Total Loss: 0.5931
  Freq Loss:  0.1770
  Raw Loss:   0.4154
  Quant Loss: 0.0007
  π“ Codebook Usage: 274/1024 (26.8%)
  π“ Codebook Entropy: 4.1770 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 37548 (28.8%)
  Top 10 most used codes:
    1. Code 324: 5190 times (3.99%)
    2. Code 330: 4050 times (3.11%)
    3. Code 558: 3729 times (2.86%)
    4. Code 589: 3709 times (2.85%)
    5. Code 140: 3647 times (2.80%)
    6. Code 309: 3597 times (2.76%)
    7. Code 1019: 3578 times (2.75%)
    8. Code 873: 3392 times (2.61%)
    9. Code 433: 3335 times (2.56%)
    10. Code 110: 3321 times (2.55%)
  Bottom 5 least used codes (among used):
    1. Code 149: 1 times (0.00%)
    2. Code 112: 1 times (0.00%)
    3. Code 164: 1 times (0.00%)
    4. Code 286: 1 times (0.00%)
    5. Code 226: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 18/100] [Batch 7/669 (1.0%)] [Iter 11380] Loss: 1.1585 (freq: 0.4546, raw: 0.7032, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 1014/1024 (99.0%) Top5:[1019,554,330,873,324,995,944,124,891,421,433,229,259,546,225]


π”¬ Encoder Diversity (iter 11380):
  Avg similarity: 0.0330 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9625 (0.0=collapsed)
[Epoch 18/100] [Batch 17/669 (2.5%)] [Iter 11390] Loss: 1.1953 (freq: 0.4603, raw: 0.7341, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[1019,324,788,309,995,330,741,735,225,124,584,433,520,873,170]


π”¬ Encoder Diversity (iter 11390):
  Avg similarity: 0.0786 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9527 (0.0=collapsed)
[Epoch 18/100] [Batch 27/669 (4.0%)] [Iter 11400] Loss: 0.8613 (freq: 0.2934, raw: 0.5673, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[1019,324,873,735,124,1002,421,49,584,611,995,535,856,891,229]


π”¬ Encoder Diversity (iter 11400):
  Avg similarity: 0.0558 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9528 (0.0=collapsed)
[Epoch 18/100] [Batch 37/669 (5.5%)] [Iter 11410] Loss: 1.3887 (freq: 0.5391, raw: 0.8488, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[551,49,788,584,278,875,696,741,396,742,421,1019,600,757,412]


π”¬ Encoder Diversity (iter 11410):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 18/100] [Batch 47/669 (7.0%)] [Iter 11420] Loss: 1.3592 (freq: 0.5012, raw: 0.8571, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 801/1024 (78.2%) Top5:[757,49,421,551,364,181,507,684,266,788,611,584,625,278,742]


π”¬ Encoder Diversity (iter 11420):
  Avg similarity: 0.0405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 18/100] [Batch 57/669 (8.5%)] [Iter 11430] Loss: 0.9913 (freq: 0.3744, raw: 0.6162, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[124,309,995,1019,324,735,856,170,873,1002,891,225,558,140,330]


π”¬ Encoder Diversity (iter 11430):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 18/100] [Batch 67/669 (10.0%)] [Iter 11440] Loss: 1.0403 (freq: 0.3441, raw: 0.6955, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[684,374,584,730,106,995,856,625,757,309,237,692,742,589,984]


π”¬ Encoder Diversity (iter 11440):
  Avg similarity: 0.0581 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9542 (0.0=collapsed)
[Epoch 18/100] [Batch 77/669 (11.5%)] [Iter 11450] Loss: 1.1648 (freq: 0.4097, raw: 0.7543, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 752/1024 (73.4%) Top5:[995,124,944,421,237,116,324,198,181,915,448,584,1002,873,386]


π”¬ Encoder Diversity (iter 11450):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 18/100] [Batch 87/669 (13.0%)] [Iter 11460] Loss: 1.0950 (freq: 0.3920, raw: 0.7022, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 718/1024 (70.1%) Top5:[324,259,225,995,1002,330,49,757,856,558,891,433,309,788,140]


π”¬ Encoder Diversity (iter 11460):
  Avg similarity: 0.0726 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 18/100] [Batch 97/669 (14.5%)] [Iter 11470] Loss: 1.2497 (freq: 0.4677, raw: 0.7812, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[788,49,324,520,995,421,757,939,551,915,742,389,946,584,944]


π”¬ Encoder Diversity (iter 11470):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 18/100] [Batch 107/669 (16.0%)] [Iter 11480] Loss: 1.1888 (freq: 0.4066, raw: 0.7814, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[995,873,116,324,840,1019,124,915,229,448,421,788,735,386,856]


π”¬ Encoder Diversity (iter 11480):
  Avg similarity: 0.0514 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 18/100] [Batch 117/669 (17.5%)] [Iter 11490] Loss: 1.3622 (freq: 0.5241, raw: 0.8374, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[1019,944,421,788,229,995,873,116,448,181,569,324,840,124,49]


π”¬ Encoder Diversity (iter 11490):
  Avg similarity: 0.0965 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9312 (0.0=collapsed)
[Epoch 18/100] [Batch 127/669 (19.0%)] [Iter 11500] Loss: 0.9024 (freq: 0.3263, raw: 0.5754, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[1019,995,324,735,225,944,421,181,229,692,873,448,1002,569,124]


π”¬ Encoder Diversity (iter 11500):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 18/100] [Batch 137/669 (20.5%)] [Iter 11510] Loss: 1.0581 (freq: 0.3757, raw: 0.6817, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[788,364,757,49,611,1019,608,696,742,237,378,225,125,584,307]


π”¬ Encoder Diversity (iter 11510):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 18/100] [Batch 147/669 (22.0%)] [Iter 11520] Loss: 1.0587 (freq: 0.3741, raw: 0.6839, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 790/1024 (77.1%) Top5:[788,278,584,741,611,106,742,757,49,715,551,891,834,608,364]


π”¬ Encoder Diversity (iter 11520):
  Avg similarity: 0.0487 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 18/100] [Batch 157/669 (23.5%)] [Iter 11530] Loss: 1.1877 (freq: 0.4030, raw: 0.7840, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[611,106,788,278,448,324,625,939,166,692,946,535,237,364,49]


π”¬ Encoder Diversity (iter 11530):
  Avg similarity: 0.0571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 18/100] [Batch 167/669 (25.0%)] [Iter 11540] Loss: 1.1925 (freq: 0.4075, raw: 0.7842, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[551,448,611,692,106,181,944,657,625,49,840,386,411,229,943]


π”¬ Encoder Diversity (iter 11540):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9542 (0.0=collapsed)
[Epoch 18/100] [Batch 177/669 (26.5%)] [Iter 11550] Loss: 1.0985 (freq: 0.3867, raw: 0.7110, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 775/1024 (75.7%) Top5:[421,324,788,995,742,741,946,944,891,229,106,735,856,452,237]


π”¬ Encoder Diversity (iter 11550):
  Avg similarity: 0.0420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 18/100] [Batch 187/669 (28.0%)] [Iter 11560] Loss: 1.0929 (freq: 0.4021, raw: 0.6901, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 767/1024 (74.9%) Top5:[995,788,611,49,330,757,696,668,364,780,856,715,1019,569,237]


π”¬ Encoder Diversity (iter 11560):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 18/100] [Batch 197/669 (29.4%)] [Iter 11570] Loss: 1.1073 (freq: 0.3922, raw: 0.7144, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 712/1024 (69.5%) Top5:[1019,995,668,587,569,324,330,181,735,558,840,421,891,856,715]


π”¬ Encoder Diversity (iter 11570):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9466 (0.0=collapsed)
[Epoch 18/100] [Batch 207/669 (30.9%)] [Iter 11580] Loss: 1.2324 (freq: 0.4361, raw: 0.7955, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 749/1024 (73.1%) Top5:[49,757,788,742,307,939,96,551,322,564,584,947,995,412,237]


π”¬ Encoder Diversity (iter 11580):
  Avg similarity: 0.0304 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 18/100] [Batch 217/669 (32.4%)] [Iter 11590] Loss: 1.2063 (freq: 0.4455, raw: 0.7600, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[1019,558,757,780,307,569,324,788,668,735,225,891,731,364,551]


π”¬ Encoder Diversity (iter 11590):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 18/100] [Batch 227/669 (33.9%)] [Iter 11600] Loss: 0.8582 (freq: 0.2878, raw: 0.5698, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 753/1024 (73.5%) Top5:[1019,448,324,731,225,307,386,944,554,788,668,995,856,735,421]


π”¬ Encoder Diversity (iter 11600):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 18/100] [Batch 237/669 (35.4%)] [Iter 11610] Loss: 0.9080 (freq: 0.2896, raw: 0.6177, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 747/1024 (72.9%) Top5:[569,995,1019,587,330,856,668,589,715,386,891,324,448,944,229]


π”¬ Encoder Diversity (iter 11610):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 18/100] [Batch 247/669 (36.9%)] [Iter 11620] Loss: 1.2851 (freq: 0.4785, raw: 0.8058, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[939,788,165,324,374,278,742,611,237,947,378,386,411,330,1019]


π”¬ Encoder Diversity (iter 11620):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 18/100] [Batch 257/669 (38.4%)] [Iter 11630] Loss: 1.2148 (freq: 0.4452, raw: 0.7688, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 754/1024 (73.6%) Top5:[995,856,1019,569,587,780,668,324,225,330,558,788,888,891,715]


π”¬ Encoder Diversity (iter 11630):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 18/100] [Batch 267/669 (39.9%)] [Iter 11640] Loss: 0.9331 (freq: 0.2967, raw: 0.6357, quant: 0.0006, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[995,108,278,668,324,611,569,742,788,625,364,49,166,421,587]


π”¬ Encoder Diversity (iter 11640):
  Avg similarity: 0.0656 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 18/100] [Batch 277/669 (41.4%)] [Iter 11650] Loss: 1.1529 (freq: 0.4250, raw: 0.7271, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[535,106,181,995,278,421,1019,490,307,840,675,229,587,520,13]


π”¬ Encoder Diversity (iter 11650):
  Avg similarity: 0.0572 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 18/100] [Batch 287/669 (42.9%)] [Iter 11660] Loss: 1.3418 (freq: 0.5156, raw: 0.8253, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[1019,757,324,625,587,535,225,229,668,946,788,733,915,181,165]


π”¬ Encoder Diversity (iter 11660):
  Avg similarity: 0.0393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 18/100] [Batch 297/669 (44.4%)] [Iter 11670] Loss: 1.1133 (freq: 0.3941, raw: 0.7184, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[324,587,1019,668,569,995,421,330,780,589,891,225,757,715,203]


π”¬ Encoder Diversity (iter 11670):
  Avg similarity: 0.0646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 18/100] [Batch 307/669 (45.9%)] [Iter 11680] Loss: 0.9041 (freq: 0.2906, raw: 0.6128, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 718/1024 (70.1%) Top5:[668,995,324,1019,203,562,330,780,587,569,278,788,944,611,166]


π”¬ Encoder Diversity (iter 11680):
  Avg similarity: 0.0735 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 18/100] [Batch 317/669 (47.4%)] [Iter 11690] Loss: 0.5996 (freq: 0.1707, raw: 0.4283, quant: 0.0006, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 739/1024 (72.2%) Top5:[324,1019,587,995,915,229,448,421,386,944,692,668,873,639,551]


π”¬ Encoder Diversity (iter 11690):
  Avg similarity: 0.0626 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9542 (0.0=collapsed)
[Epoch 18/100] [Batch 327/669 (48.9%)] [Iter 11700] Loss: 1.2585 (freq: 0.4617, raw: 0.7960, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[742,788,939,166,611,551,535,307,995,757,324,278,427,378,49]


π”¬ Encoder Diversity (iter 11700):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 18/100] [Batch 337/669 (50.4%)] [Iter 11710] Loss: 1.1703 (freq: 0.3818, raw: 0.7878, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[49,788,947,411,742,324,106,939,741,364,378,535,893,166,225]


π”¬ Encoder Diversity (iter 11710):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 18/100] [Batch 347/669 (51.9%)] [Iter 11720] Loss: 1.4636 (freq: 0.5660, raw: 0.8968, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[757,166,946,49,939,448,625,307,237,96,507,116,452,551,322]


π”¬ Encoder Diversity (iter 11720):
  Avg similarity: 0.0681 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 18/100] [Batch 357/669 (53.4%)] [Iter 11730] Loss: 1.0671 (freq: 0.3714, raw: 0.6949, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[324,668,448,49,569,587,856,757,582,731,733,944,1019,888,229]


π”¬ Encoder Diversity (iter 11730):
  Avg similarity: 0.0221 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 18/100] [Batch 367/669 (54.9%)] [Iter 11740] Loss: 1.1977 (freq: 0.4229, raw: 0.7740, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[696,608,108,757,364,584,611,742,855,507,307,564,788,237,71]


π”¬ Encoder Diversity (iter 11740):
  Avg similarity: 0.0597 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 18/100] [Batch 377/669 (56.4%)] [Iter 11750] Loss: 1.1002 (freq: 0.3796, raw: 0.7199, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[856,995,324,668,587,1019,891,731,1002,734,225,741,692,507,840]


π”¬ Encoder Diversity (iter 11750):
  Avg similarity: 0.0601 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 18/100] [Batch 387/669 (57.8%)] [Iter 11760] Loss: 1.1777 (freq: 0.3912, raw: 0.7858, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 741/1024 (72.4%) Top5:[995,856,229,1019,742,888,386,587,324,582,448,535,731,1002,225]


π”¬ Encoder Diversity (iter 11760):
  Avg similarity: 0.0752 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 18/100] [Batch 397/669 (59.3%)] [Iter 11770] Loss: 1.1356 (freq: 0.3415, raw: 0.7932, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[201,49,757,742,569,278,939,995,625,587,856,307,893,611,411]


π”¬ Encoder Diversity (iter 11770):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 18/100] [Batch 407/669 (60.8%)] [Iter 11780] Loss: 1.0983 (freq: 0.4119, raw: 0.6857, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 697/1024 (68.1%) Top5:[587,322,946,995,225,625,569,535,788,229,939,278,675,201,552]


π”¬ Encoder Diversity (iter 11780):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 18/100] [Batch 417/669 (62.3%)] [Iter 11790] Loss: 0.9542 (freq: 0.3056, raw: 0.6479, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 655/1024 (64.0%) Top5:[587,668,1019,569,552,225,856,545,995,994,888,944,229,589,733]


π”¬ Encoder Diversity (iter 11790):
  Avg similarity: 0.0719 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 18/100] [Batch 427/669 (63.8%)] [Iter 11800] Loss: 0.9554 (freq: 0.3273, raw: 0.6273, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 756/1024 (73.8%) Top5:[939,757,587,946,696,13,611,535,427,742,668,106,764,125,608]


π”¬ Encoder Diversity (iter 11800):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 18/100] [Batch 437/669 (65.3%)] [Iter 11810] Loss: 1.1844 (freq: 0.3969, raw: 0.7867, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[994,587,545,552,856,995,1002,569,608,946,235,931,324,780,668]


π”¬ Encoder Diversity (iter 11810):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 18/100] [Batch 447/669 (66.8%)] [Iter 11820] Loss: 1.1512 (freq: 0.4058, raw: 0.7447, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[608,696,587,639,237,788,944,229,840,995,856,757,764,891,734]


π”¬ Encoder Diversity (iter 11820):
  Avg similarity: 0.0291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 18/100] [Batch 457/669 (68.3%)] [Iter 11830] Loss: 0.8886 (freq: 0.2756, raw: 0.6122, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[1002,552,545,995,780,587,734,1019,582,994,233,324,856,307,104]


π”¬ Encoder Diversity (iter 11830):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 18/100] [Batch 467/669 (69.8%)] [Iter 11840] Loss: 1.3071 (freq: 0.4552, raw: 0.8511, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 702/1024 (68.6%) Top5:[1019,734,587,995,545,668,856,731,324,448,386,233,696,757,569]


π”¬ Encoder Diversity (iter 11840):
  Avg similarity: 0.0568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 18/100] [Batch 477/669 (71.3%)] [Iter 11850] Loss: 1.1802 (freq: 0.4194, raw: 0.7601, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[757,535,108,106,545,433,995,396,742,953,1019,49,675,25,307]


π”¬ Encoder Diversity (iter 11850):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 18/100] [Batch 487/669 (72.8%)] [Iter 11860] Loss: 1.1025 (freq: 0.4125, raw: 0.6892, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 710/1024 (69.3%) Top5:[734,696,569,856,995,448,1019,873,324,545,891,386,863,946,108]


π”¬ Encoder Diversity (iter 11860):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9483 (0.0=collapsed)
[Epoch 18/100] [Batch 497/669 (74.3%)] [Iter 11870] Loss: 1.1923 (freq: 0.4486, raw: 0.7429, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[734,49,535,106,953,201,946,668,448,1019,757,138,966,692,278]


π”¬ Encoder Diversity (iter 11870):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 18/100] [Batch 507/669 (75.8%)] [Iter 11880] Loss: 0.9753 (freq: 0.3337, raw: 0.6409, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 744/1024 (72.7%) Top5:[734,49,421,953,201,587,995,840,545,946,139,582,427,448,229]


π”¬ Encoder Diversity (iter 11880):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 18/100] [Batch 517/669 (77.3%)] [Iter 11890] Loss: 1.0860 (freq: 0.3971, raw: 0.6881, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 804/1024 (78.5%) Top5:[734,535,201,995,608,947,873,587,733,520,448,421,742,856,545]


π”¬ Encoder Diversity (iter 11890):
  Avg similarity: 0.0559 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 18/100] [Batch 527/669 (78.8%)] [Iter 11900] Loss: 0.8580 (freq: 0.2524, raw: 0.6050, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[49,788,742,995,307,757,930,201,108,611,582,692,545,1019,564]


π”¬ Encoder Diversity (iter 11900):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 18/100] [Batch 537/669 (80.3%)] [Iter 11910] Loss: 1.4740 (freq: 0.5457, raw: 0.9275, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[49,363,108,947,611,448,421,742,307,139,840,322,995,25,788]


π”¬ Encoder Diversity (iter 11910):
  Avg similarity: 0.0705 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 18/100] [Batch 547/669 (81.8%)] [Iter 11920] Loss: 1.1403 (freq: 0.3993, raw: 0.7401, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[1019,995,582,201,448,233,742,757,139,25,307,625,108,944,930]


π”¬ Encoder Diversity (iter 11920):
  Avg similarity: 0.0414 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 18/100] [Batch 557/669 (83.3%)] [Iter 11930] Loss: 1.3966 (freq: 0.5570, raw: 0.8387, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[734,139,944,229,149,668,421,448,639,1019,995,386,863,873,9]


π”¬ Encoder Diversity (iter 11930):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 18/100] [Batch 567/669 (84.8%)] [Iter 11940] Loss: 1.4250 (freq: 0.5071, raw: 0.9171, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 724/1024 (70.7%) Top5:[108,757,702,106,953,1001,1019,931,322,611,49,386,894,552,225]


π”¬ Encoder Diversity (iter 11940):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 18/100] [Batch 577/669 (86.2%)] [Iter 11950] Loss: 0.9841 (freq: 0.3183, raw: 0.6651, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 747/1024 (72.9%) Top5:[995,587,9,324,668,386,225,734,894,948,25,1001,156,611,201]


π”¬ Encoder Diversity (iter 11950):
  Avg similarity: 0.0536 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 18/100] [Batch 587/669 (87.7%)] [Iter 11960] Loss: 1.1998 (freq: 0.4155, raw: 0.7836, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 723/1024 (70.6%) Top5:[49,448,1019,108,611,421,237,5,944,9,307,1001,587,883,411]


π”¬ Encoder Diversity (iter 11960):
  Avg similarity: 0.0835 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 18/100] [Batch 597/669 (89.2%)] [Iter 11970] Loss: 1.0267 (freq: 0.3105, raw: 0.7154, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[448,49,307,25,421,587,788,702,322,108,995,149,734,233,201]


π”¬ Encoder Diversity (iter 11970):
  Avg similarity: 0.0254 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 18/100] [Batch 607/669 (90.7%)] [Iter 11980] Loss: 1.1860 (freq: 0.4315, raw: 0.7537, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 764/1024 (74.6%) Top5:[995,552,994,1001,307,780,25,894,374,1019,757,742,49,582,233]


π”¬ Encoder Diversity (iter 11980):
  Avg similarity: 0.0663 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 18/100] [Batch 617/669 (92.2%)] [Iter 11990] Loss: 0.8071 (freq: 0.2423, raw: 0.5641, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[233,995,587,734,1001,1019,386,994,25,448,545,894,944,225,324]


π”¬ Encoder Diversity (iter 11990):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 18/100] [Batch 627/669 (93.7%)] [Iter 12000] Loss: 1.1844 (freq: 0.3988, raw: 0.7849, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[25,944,448,324,347,587,139,108,5,734,1019,229,894,840,1022]


π”¬ Encoder Diversity (iter 12000):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 18/100] [Batch 637/669 (95.2%)] [Iter 12010] Loss: 1.0676 (freq: 0.3785, raw: 0.6884, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[734,1019,25,995,324,582,347,856,229,953,386,552,1002,944,233]


π”¬ Encoder Diversity (iter 12010):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 18/100] [Batch 647/669 (96.7%)] [Iter 12020] Loss: 1.0936 (freq: 0.4071, raw: 0.6858, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 745/1024 (72.8%) Top5:[953,749,702,307,939,25,49,535,201,171,108,742,258,433,396]


π”¬ Encoder Diversity (iter 12020):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 18/100] [Batch 657/669 (98.2%)] [Iter 12030] Loss: 1.3854 (freq: 0.5047, raw: 0.8799, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 715/1024 (69.8%) Top5:[995,1019,233,1001,229,734,324,545,139,5,702,25,448,985,552]


π”¬ Encoder Diversity (iter 12030):
  Avg similarity: 0.0221 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 18/100] [Batch 667/669 (99.7%)] [Iter 12040] Loss: 1.0920 (freq: 0.3722, raw: 0.7190, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[1001,225,734,995,939,108,307,1019,587,757,545,396,946,953,920]


π”¬ Encoder Diversity (iter 12040):
  Avg similarity: 0.0378 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)

================================================================================
[Epoch 18] Validation Results:
  Total Loss: 0.5879
  Freq Loss:  0.1741
  Raw Loss:   0.4130
  Quant Loss: 0.0007
  π“ Codebook Usage: 414/1024 (40.4%)
  π“ Codebook Entropy: 4.4162 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 33551 (25.8%)
  Top 10 most used codes:
    1. Code 374: 3847 times (2.95%)
    2. Code 1019: 3710 times (2.85%)
    3. Code 668: 3607 times (2.77%)
    4. Code 582: 3427 times (2.63%)
    5. Code 79: 3321 times (2.55%)
    6. Code 948: 3298 times (2.53%)
    7. Code 1001: 3282 times (2.52%)
    8. Code 1002: 3101 times (2.38%)
    9. Code 569: 3007 times (2.31%)
    10. Code 734: 2951 times (2.27%)
  Bottom 5 least used codes (among used):
    1. Code 459: 1 times (0.00%)
    2. Code 121: 1 times (0.00%)
    3. Code 643: 1 times (0.00%)
    4. Code 744: 1 times (0.00%)
    5. Code 674: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 19/100] [Batch 8/669 (1.2%)] [Iter 12050] Loss: 1.4687 (freq: 0.5571, raw: 0.9107, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 1018/1024 (99.4%) Top5:[944,421,5,229,545,1019,292,233,995,448,386,225,1022,160,157]


π”¬ Encoder Diversity (iter 12050):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 19/100] [Batch 18/669 (2.7%)] [Iter 12060] Loss: 1.2449 (freq: 0.4412, raw: 0.8029, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[354,779,292,255,988,944,734,513,371,229,318,221,587,347,959]


π”¬ Encoder Diversity (iter 12060):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 19/100] [Batch 28/669 (4.2%)] [Iter 12070] Loss: 1.0580 (freq: 0.3647, raw: 0.6926, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 750/1024 (73.2%) Top5:[944,734,448,877,1022,149,386,225,5,995,347,25,324,1019,587]


π”¬ Encoder Diversity (iter 12070):
  Avg similarity: 0.0674 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 19/100] [Batch 38/669 (5.7%)] [Iter 12080] Loss: 1.0791 (freq: 0.3651, raw: 0.7133, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[910,661,354,944,680,734,1019,347,513,292,904,914,544,995,300]


π”¬ Encoder Diversity (iter 12080):
  Avg similarity: 0.0589 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 19/100] [Batch 48/669 (7.2%)] [Iter 12090] Loss: 0.9426 (freq: 0.3186, raw: 0.6233, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[25,354,513,233,374,995,780,49,5,242,815,268,828,318,944]


π”¬ Encoder Diversity (iter 12090):
  Avg similarity: 0.0532 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 19/100] [Batch 58/669 (8.7%)] [Iter 12100] Loss: 1.0622 (freq: 0.3775, raw: 0.6840, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[25,242,944,1019,386,374,229,324,734,421,1022,894,582,995,318]


π”¬ Encoder Diversity (iter 12100):
  Avg similarity: 0.0531 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 19/100] [Batch 68/669 (10.2%)] [Iter 12110] Loss: 1.0860 (freq: 0.3982, raw: 0.6871, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[734,233,25,894,1019,995,994,223,545,1001,324,780,931,569,421]


π”¬ Encoder Diversity (iter 12110):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 19/100] [Batch 78/669 (11.7%)] [Iter 12120] Loss: 1.2048 (freq: 0.4240, raw: 0.7800, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[324,1019,734,1022,160,1001,1002,242,245,229,680,847,300,347,223]


π”¬ Encoder Diversity (iter 12120):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 19/100] [Batch 88/669 (13.2%)] [Iter 12130] Loss: 1.1771 (freq: 0.4180, raw: 0.7584, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[734,284,300,680,318,815,659,371,324,1019,661,504,292,49,354]


π”¬ Encoder Diversity (iter 12130):
  Avg similarity: 0.0766 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 19/100] [Batch 98/669 (14.6%)] [Iter 12140] Loss: 1.2134 (freq: 0.4351, raw: 0.7775, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[910,324,1019,904,243,346,318,834,1001,49,354,284,856,544,72]


π”¬ Encoder Diversity (iter 12140):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 19/100] [Batch 108/669 (16.1%)] [Iter 12150] Loss: 1.1721 (freq: 0.4156, raw: 0.7557, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[894,734,1019,910,324,1001,300,904,255,292,318,221,661,129,493]


π”¬ Encoder Diversity (iter 12150):
  Avg similarity: 0.0420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 19/100] [Batch 118/669 (17.6%)] [Iter 12160] Loss: 1.1419 (freq: 0.3867, raw: 0.7545, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 767/1024 (74.9%) Top5:[1001,374,1019,324,734,229,292,318,828,300,513,255,840,994,25]


π”¬ Encoder Diversity (iter 12160):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 19/100] [Batch 128/669 (19.1%)] [Iter 12170] Loss: 1.2562 (freq: 0.4990, raw: 0.7563, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 743/1024 (72.6%) Top5:[324,318,944,1001,292,834,513,734,1019,374,582,268,904,223,347]


π”¬ Encoder Diversity (iter 12170):
  Avg similarity: 0.0474 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 19/100] [Batch 138/669 (20.6%)] [Iter 12180] Loss: 1.4533 (freq: 0.5542, raw: 0.8982, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 752/1024 (73.4%) Top5:[995,1019,1001,734,894,715,780,233,104,25,817,1002,661,318,220]


π”¬ Encoder Diversity (iter 12180):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 19/100] [Batch 148/669 (22.1%)] [Iter 12190] Loss: 1.4222 (freq: 0.4993, raw: 0.9221, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[661,944,242,910,318,347,1022,513,448,324,229,680,1019,587,292]


π”¬ Encoder Diversity (iter 12190):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 19/100] [Batch 158/669 (23.6%)] [Iter 12200] Loss: 1.2161 (freq: 0.4397, raw: 0.7756, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[910,300,242,944,544,661,1001,149,386,931,493,734,243,554,229]


π”¬ Encoder Diversity (iter 12200):
  Avg similarity: 0.0608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 19/100] [Batch 168/669 (25.1%)] [Iter 12210] Loss: 1.0624 (freq: 0.3764, raw: 0.6852, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[944,910,229,1022,840,931,385,490,995,233,25,386,1001,587,104]


π”¬ Encoder Diversity (iter 12210):
  Avg similarity: 0.0637 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9537 (0.0=collapsed)
[Epoch 19/100] [Batch 178/669 (26.6%)] [Iter 12220] Loss: 1.2028 (freq: 0.4381, raw: 0.7640, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 760/1024 (74.2%) Top5:[243,207,910,769,292,221,904,284,680,72,659,656,459,345,300]


π”¬ Encoder Diversity (iter 12220):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 19/100] [Batch 188/669 (28.1%)] [Iter 12230] Loss: 1.0341 (freq: 0.3461, raw: 0.6872, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[1001,545,856,894,931,734,25,324,995,284,948,55,386,157,220]


π”¬ Encoder Diversity (iter 12230):
  Avg similarity: 0.0737 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 19/100] [Batch 198/669 (29.6%)] [Iter 12240] Loss: 0.9997 (freq: 0.3185, raw: 0.6804, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[877,324,944,347,493,1001,904,910,864,1022,385,255,840,463,995]


π”¬ Encoder Diversity (iter 12240):
  Avg similarity: 0.0301 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 19/100] [Batch 208/669 (31.1%)] [Iter 12250] Loss: 1.2028 (freq: 0.4458, raw: 0.7562, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 764/1024 (74.6%) Top5:[5,877,32,1022,948,910,149,856,840,324,944,1001,734,769,292]


π”¬ Encoder Diversity (iter 12250):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 19/100] [Batch 218/669 (32.6%)] [Iter 12260] Loss: 1.3944 (freq: 0.4932, raw: 0.9004, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[336,904,959,910,661,412,504,769,292,544,207,72,463,864,388]


π”¬ Encoder Diversity (iter 12260):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 19/100] [Batch 228/669 (34.1%)] [Iter 12270] Loss: 1.0226 (freq: 0.3119, raw: 0.7100, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[995,894,25,734,50,1001,386,229,1022,448,877,347,944,994,223]


π”¬ Encoder Diversity (iter 12270):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 19/100] [Batch 238/669 (35.6%)] [Iter 12280] Loss: 1.2179 (freq: 0.4519, raw: 0.7651, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 779/1024 (76.1%) Top5:[995,493,233,834,25,1001,292,904,513,894,544,229,324,856,840]


π”¬ Encoder Diversity (iter 12280):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 19/100] [Batch 248/669 (37.1%)] [Iter 12290] Loss: 1.0772 (freq: 0.3537, raw: 0.7227, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[25,944,448,995,544,274,157,1019,904,233,840,856,985,386,347]


π”¬ Encoder Diversity (iter 12290):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 19/100] [Batch 258/669 (38.6%)] [Iter 12300] Loss: 1.1021 (freq: 0.3965, raw: 0.7049, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[223,995,1019,233,25,55,318,894,513,157,545,274,896,834,324]


π”¬ Encoder Diversity (iter 12300):
  Avg similarity: 0.0338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 19/100] [Batch 268/669 (40.1%)] [Iter 12310] Loss: 1.2091 (freq: 0.4295, raw: 0.7788, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[292,157,300,32,769,995,448,493,324,347,513,985,904,834,25]


π”¬ Encoder Diversity (iter 12310):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 19/100] [Batch 278/669 (41.6%)] [Iter 12320] Loss: 1.0872 (freq: 0.3789, raw: 0.7076, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 729/1024 (71.2%) Top5:[223,324,995,25,1019,300,734,448,931,284,1001,894,896,910,233]


π”¬ Encoder Diversity (iter 12320):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 19/100] [Batch 288/669 (43.0%)] [Iter 12330] Loss: 0.9384 (freq: 0.2876, raw: 0.6501, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[910,896,626,157,300,680,318,324,734,544,884,255,343,904,864]


π”¬ Encoder Diversity (iter 12330):
  Avg similarity: 0.0741 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9528 (0.0=collapsed)
[Epoch 19/100] [Batch 298/669 (44.5%)] [Iter 12340] Loss: 0.9438 (freq: 0.3189, raw: 0.6242, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[995,1001,324,734,1021,223,856,769,220,544,55,626,894,545,448]


π”¬ Encoder Diversity (iter 12340):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 19/100] [Batch 308/669 (46.0%)] [Iter 12350] Loss: 1.1121 (freq: 0.3598, raw: 0.7515, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[995,513,554,856,910,877,324,896,661,544,734,347,1001,627,32]


π”¬ Encoder Diversity (iter 12350):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 19/100] [Batch 318/669 (47.5%)] [Iter 12360] Loss: 1.1676 (freq: 0.3946, raw: 0.7723, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 728/1024 (71.1%) Top5:[324,944,1019,856,448,347,995,25,386,582,1022,281,544,545,233]


π”¬ Encoder Diversity (iter 12360):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 19/100] [Batch 328/669 (49.0%)] [Iter 12370] Loss: 1.1110 (freq: 0.4067, raw: 0.7035, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[944,300,324,229,877,910,1019,347,386,490,1001,818,513,734,242]


π”¬ Encoder Diversity (iter 12370):
  Avg similarity: 0.0465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 19/100] [Batch 338/669 (50.5%)] [Iter 12380] Loss: 1.0781 (freq: 0.3636, raw: 0.7138, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[324,347,944,985,386,25,55,856,233,1016,840,734,157,587,626]


π”¬ Encoder Diversity (iter 12380):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 19/100] [Batch 348/669 (52.0%)] [Iter 12390] Loss: 1.0636 (freq: 0.3679, raw: 0.6950, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 737/1024 (72.0%) Top5:[995,55,25,896,734,1019,233,544,856,347,944,241,477,1016,878]


π”¬ Encoder Diversity (iter 12390):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 19/100] [Batch 358/669 (53.5%)] [Iter 12400] Loss: 1.0489 (freq: 0.3528, raw: 0.6954, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[233,55,463,544,29,241,1016,904,769,318,815,959,661,459,900]


π”¬ Encoder Diversity (iter 12400):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 19/100] [Batch 368/669 (55.0%)] [Iter 12410] Loss: 1.2417 (freq: 0.5054, raw: 0.7356, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[661,255,544,242,818,995,347,884,463,493,910,513,243,204,50]


π”¬ Encoder Diversity (iter 12410):
  Avg similarity: 0.0497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9629 (0.0=collapsed)
[Epoch 19/100] [Batch 378/669 (56.5%)] [Iter 12420] Loss: 1.1990 (freq: 0.4071, raw: 0.7911, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[910,1016,904,1019,995,55,324,894,29,463,1021,545,25,582,948]


π”¬ Encoder Diversity (iter 12420):
  Avg similarity: 0.0690 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 19/100] [Batch 388/669 (58.0%)] [Iter 12430] Loss: 1.3125 (freq: 0.4616, raw: 0.8501, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[910,300,959,255,386,242,463,764,544,904,268,661,818,243,917]


π”¬ Encoder Diversity (iter 12430):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 19/100] [Batch 398/669 (59.5%)] [Iter 12440] Loss: 1.0399 (freq: 0.3392, raw: 0.7000, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[324,944,910,995,281,386,904,626,582,55,318,544,587,233,840]


π”¬ Encoder Diversity (iter 12440):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 19/100] [Batch 408/669 (61.0%)] [Iter 12450] Loss: 0.9833 (freq: 0.3111, raw: 0.6715, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 739/1024 (72.2%) Top5:[324,995,1019,25,1001,55,856,318,289,944,29,385,582,734,300]


π”¬ Encoder Diversity (iter 12450):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 19/100] [Batch 418/669 (62.5%)] [Iter 12460] Loss: 1.0799 (freq: 0.3596, raw: 0.7196, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[25,856,1021,1016,55,324,995,582,734,29,894,318,904,386,1019]


π”¬ Encoder Diversity (iter 12460):
  Avg similarity: 0.0538 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 19/100] [Batch 428/669 (64.0%)] [Iter 12470] Loss: 0.9420 (freq: 0.3399, raw: 0.6013, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 724/1024 (70.7%) Top5:[55,29,25,884,894,995,513,1016,900,459,944,910,661,626,1001]


π”¬ Encoder Diversity (iter 12470):
  Avg similarity: 0.0769 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 19/100] [Batch 438/669 (65.5%)] [Iter 12480] Loss: 0.9083 (freq: 0.3097, raw: 0.5979, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 724/1024 (70.7%) Top5:[734,29,856,995,1016,386,55,944,25,157,894,1019,1022,318,281]


π”¬ Encoder Diversity (iter 12480):
  Avg similarity: 0.0556 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 19/100] [Batch 448/669 (67.0%)] [Iter 12490] Loss: 0.9826 (freq: 0.3279, raw: 0.6540, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[995,1001,324,29,734,1019,944,894,233,25,545,948,587,1022,149]


π”¬ Encoder Diversity (iter 12490):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 19/100] [Batch 458/669 (68.5%)] [Iter 12500] Loss: 1.2211 (freq: 0.4529, raw: 0.7674, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 743/1024 (72.6%) Top5:[894,910,1019,1016,896,29,904,1001,734,995,725,477,544,223,624]


π”¬ Encoder Diversity (iter 12500):
  Avg similarity: 0.0326 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 19/100] [Batch 468/669 (70.0%)] [Iter 12510] Loss: 1.3015 (freq: 0.4646, raw: 0.8361, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 749/1024 (73.1%) Top5:[910,324,995,896,734,55,242,1019,318,347,29,160,894,386,25]


π”¬ Encoder Diversity (iter 12510):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 19/100] [Batch 478/669 (71.4%)] [Iter 12520] Loss: 1.1882 (freq: 0.4154, raw: 0.7719, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 762/1024 (74.4%) Top5:[734,318,281,1021,55,1019,995,25,544,1001,656,324,769,894,160]


π”¬ Encoder Diversity (iter 12520):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 19/100] [Batch 488/669 (72.9%)] [Iter 12530] Loss: 1.0338 (freq: 0.3455, raw: 0.6874, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[318,910,900,281,1022,5,734,157,544,300,624,243,626,386,944]


π”¬ Encoder Diversity (iter 12530):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 19/100] [Batch 498/669 (74.4%)] [Iter 12540] Loss: 1.0596 (freq: 0.3646, raw: 0.6942, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[1001,734,386,582,29,25,944,856,1019,347,985,324,995,5,1021]


π”¬ Encoder Diversity (iter 12540):
  Avg similarity: 0.0803 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9511 (0.0=collapsed)
[Epoch 19/100] [Batch 508/669 (75.9%)] [Iter 12550] Loss: 0.9967 (freq: 0.3240, raw: 0.6718, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[995,1001,1019,324,29,948,582,734,163,25,233,1021,904,1022,14]


π”¬ Encoder Diversity (iter 12550):
  Avg similarity: 0.0627 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 19/100] [Batch 518/669 (77.4%)] [Iter 12560] Loss: 1.0580 (freq: 0.3899, raw: 0.6674, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[910,864,318,544,300,878,917,956,743,995,818,626,242,32,71]


π”¬ Encoder Diversity (iter 12560):
  Avg similarity: 0.0818 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 19/100] [Batch 528/669 (78.9%)] [Iter 12570] Loss: 1.1283 (freq: 0.4018, raw: 0.7257, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[544,242,25,734,243,950,814,513,626,459,878,818,324,71,864]


π”¬ Encoder Diversity (iter 12570):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9561 (0.0=collapsed)
[Epoch 19/100] [Batch 538/669 (80.4%)] [Iter 12580] Loss: 1.1520 (freq: 0.3932, raw: 0.7580, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 754/1024 (73.6%) Top5:[29,1019,25,386,243,910,999,1022,734,463,5,1001,544,324,300]


π”¬ Encoder Diversity (iter 12580):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 19/100] [Batch 548/669 (81.9%)] [Iter 12590] Loss: 1.1992 (freq: 0.4396, raw: 0.7588, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[544,1019,995,655,29,477,900,324,910,14,336,281,25,904,463]


π”¬ Encoder Diversity (iter 12590):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 19/100] [Batch 558/669 (83.4%)] [Iter 12600] Loss: 1.2356 (freq: 0.4704, raw: 0.7644, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[1019,324,29,734,575,386,995,655,25,157,856,55,1022,14,900]


π”¬ Encoder Diversity (iter 12600):
  Avg similarity: 0.0682 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 19/100] [Batch 568/669 (84.9%)] [Iter 12610] Loss: 0.9221 (freq: 0.3109, raw: 0.6103, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 787/1024 (76.9%) Top5:[318,734,575,25,324,347,668,459,1001,29,626,157,1019,884,386]


π”¬ Encoder Diversity (iter 12610):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 19/100] [Batch 578/669 (86.4%)] [Iter 12620] Loss: 1.1984 (freq: 0.4418, raw: 0.7558, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[900,764,32,910,300,864,255,286,221,734,243,71,318,725,18]


π”¬ Encoder Diversity (iter 12620):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 19/100] [Batch 588/669 (87.9%)] [Iter 12630] Loss: 0.8973 (freq: 0.2965, raw: 0.6000, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[995,910,1001,582,878,72,286,513,14,324,575,91,814,734,163]


π”¬ Encoder Diversity (iter 12630):
  Avg similarity: 0.0804 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9574 (0.0=collapsed)
[Epoch 19/100] [Batch 598/669 (89.4%)] [Iter 12640] Loss: 0.9580 (freq: 0.3217, raw: 0.6356, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[5,727,575,157,840,1022,347,655,544,1012,985,448,1001,734,944]


π”¬ Encoder Diversity (iter 12640):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 19/100] [Batch 608/669 (90.9%)] [Iter 12650] Loss: 1.3413 (freq: 0.4938, raw: 0.8466, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[5,727,459,910,255,864,300,412,878,268,318,544,504,286,725]


π”¬ Encoder Diversity (iter 12650):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 19/100] [Batch 618/669 (92.4%)] [Iter 12660] Loss: 1.3408 (freq: 0.4897, raw: 0.8503, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[910,255,969,944,221,544,5,26,160,959,281,323,999,758,71]


π”¬ Encoder Diversity (iter 12660):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 19/100] [Batch 628/669 (93.9%)] [Iter 12670] Loss: 1.3011 (freq: 0.4486, raw: 0.8516, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[544,255,354,910,370,412,864,281,292,26,959,464,336,286,884]


π”¬ Encoder Diversity (iter 12670):
  Avg similarity: 0.0492 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 19/100] [Batch 638/669 (95.4%)] [Iter 12680] Loss: 0.8258 (freq: 0.2705, raw: 0.5546, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[655,55,626,386,582,5,950,1001,25,243,324,518,910,575,900]


π”¬ Encoder Diversity (iter 12680):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 19/100] [Batch 648/669 (96.9%)] [Iter 12690] Loss: 1.1876 (freq: 0.4052, raw: 0.7815, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 753/1024 (73.5%) Top5:[1001,910,655,950,544,995,25,14,55,575,900,324,818,386,268]


π”¬ Encoder Diversity (iter 12690):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 19/100] [Batch 658/669 (98.4%)] [Iter 12700] Loss: 0.9494 (freq: 0.3210, raw: 0.6277, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 773/1024 (75.5%) Top5:[25,655,575,910,1019,734,386,872,255,1001,518,243,29,5,14]


π”¬ Encoder Diversity (iter 12700):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 19/100] [Batch 668/669 (99.9%)] [Iter 12710] Loss: 1.3296 (freq: 0.5002, raw: 0.8286, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[785,575,1001,324,25,233,1019,318,734,655,347,5,79,386,856]


π”¬ Encoder Diversity (iter 12710):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)

================================================================================
[Epoch 19] Validation Results:
  Total Loss: 0.5717
  Freq Loss:  0.1717
  Raw Loss:   0.3993
  Quant Loss: 0.0007
  π“ Codebook Usage: 636/1024 (62.1%)
  π“ Codebook Entropy: 4.9947 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 27470 (21.1%)
  Top 10 most used codes:
    1. Code 896: 3629 times (2.79%)
    2. Code 233: 3159 times (2.43%)
    3. Code 1001: 2840 times (2.18%)
    4. Code 518: 2779 times (2.13%)
    5. Code 91: 2739 times (2.10%)
    6. Code 545: 2669 times (2.05%)
    7. Code 901: 2568 times (1.97%)
    8. Code 515: 2434 times (1.87%)
    9. Code 587: 2337 times (1.79%)
    10. Code 655: 2316 times (1.78%)
  Bottom 5 least used codes (among used):
    1. Code 43: 1 times (0.00%)
    2. Code 580: 1 times (0.00%)
    3. Code 881: 3 times (0.00%)
    4. Code 294: 4 times (0.00%)
    5. Code 326: 6 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 19
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 20/100] [Batch 9/669 (1.3%)] [Iter 12720] Loss: 1.1881 (freq: 0.4172, raw: 0.7700, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 1020/1024 (99.6%) Top5:[1001,477,518,25,995,219,29,1019,856,323,734,785,14,985,386]


π”¬ Encoder Diversity (iter 12720):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 20/100] [Batch 19/669 (2.8%)] [Iter 12730] Loss: 1.1400 (freq: 0.4158, raw: 0.7234, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[877,790,575,649,673,10,381,220,711,441,713,944,518,46,933]


π”¬ Encoder Diversity (iter 12730):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 20/100] [Batch 29/669 (4.3%)] [Iter 12740] Loss: 1.1238 (freq: 0.4330, raw: 0.6900, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[713,828,306,46,385,570,78,322,698,482,711,261,47,518,122]


π”¬ Encoder Diversity (iter 12740):
  Avg similarity: 0.0782 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 20/100] [Batch 39/669 (5.8%)] [Iter 12750] Loss: 0.8311 (freq: 0.2826, raw: 0.5478, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[518,575,673,734,713,14,105,86,711,29,75,536,582,1019,219]


π”¬ Encoder Diversity (iter 12750):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 20/100] [Batch 49/669 (7.3%)] [Iter 12760] Loss: 1.1778 (freq: 0.4090, raw: 0.7679, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[381,38,713,673,200,475,482,933,341,822,220,241,760,536,78]


π”¬ Encoder Diversity (iter 12760):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 20/100] [Batch 59/669 (8.8%)] [Iter 12770] Loss: 1.4467 (freq: 0.5429, raw: 0.9029, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[655,518,1019,149,734,25,995,55,713,944,5,219,1001,575,515]


π”¬ Encoder Diversity (iter 12770):
  Avg similarity: 0.0581 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 20/100] [Batch 69/669 (10.3%)] [Iter 12780] Loss: 1.0440 (freq: 0.3178, raw: 0.7256, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[713,673,655,734,518,55,575,933,47,306,25,995,831,441,29]


π”¬ Encoder Diversity (iter 12780):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 20/100] [Batch 79/669 (11.8%)] [Iter 12790] Loss: 1.0535 (freq: 0.3886, raw: 0.6641, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[1001,655,1019,995,477,518,160,149,515,896,29,387,575,68,14]


π”¬ Encoder Diversity (iter 12790):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 20/100] [Batch 89/669 (13.3%)] [Iter 12800] Loss: 0.9924 (freq: 0.3517, raw: 0.6400, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[387,734,5,1001,582,518,542,856,779,711,575,995,347,954,944]


π”¬ Encoder Diversity (iter 12800):
  Avg similarity: 0.0509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 20/100] [Batch 99/669 (14.8%)] [Iter 12810] Loss: 1.1591 (freq: 0.4051, raw: 0.7532, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[700,713,105,933,285,711,220,673,441,742,131,1017,482,241,856]


π”¬ Encoder Diversity (iter 12810):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 20/100] [Batch 109/669 (16.3%)] [Iter 12820] Loss: 0.9656 (freq: 0.3408, raw: 0.6239, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[482,933,713,570,241,535,518,742,91,38,582,904,649,441,231]


π”¬ Encoder Diversity (iter 12820):
  Avg similarity: 0.0411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 20/100] [Batch 119/669 (17.8%)] [Iter 12830] Loss: 1.1854 (freq: 0.4156, raw: 0.7691, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[933,306,904,713,828,160,698,1017,200,673,760,341,570,399,231]


π”¬ Encoder Diversity (iter 12830):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 20/100] [Batch 129/669 (19.3%)] [Iter 12840] Loss: 1.0461 (freq: 0.3820, raw: 0.6633, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[78,822,241,518,231,904,713,110,649,535,858,734,673,575,387]


π”¬ Encoder Diversity (iter 12840):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 20/100] [Batch 139/669 (20.8%)] [Iter 12850] Loss: 1.0926 (freq: 0.4055, raw: 0.6864, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[649,694,324,933,322,347,995,1019,385,518,192,575,700,78,14]


π”¬ Encoder Diversity (iter 12850):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 20/100] [Batch 149/669 (22.3%)] [Iter 12860] Loss: 1.4322 (freq: 0.5193, raw: 0.9121, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[933,518,1019,713,322,14,347,55,901,800,831,655,742,734,995]


π”¬ Encoder Diversity (iter 12860):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 20/100] [Batch 159/669 (23.8%)] [Iter 12870] Loss: 0.9024 (freq: 0.3002, raw: 0.6015, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[655,5,518,944,785,55,734,779,727,800,387,347,29,845,241]


π”¬ Encoder Diversity (iter 12870):
  Avg similarity: 0.0540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 20/100] [Batch 169/669 (25.3%)] [Iter 12880] Loss: 0.7731 (freq: 0.2380, raw: 0.5344, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 733/1024 (71.6%) Top5:[995,477,518,575,29,14,1019,901,734,91,323,944,785,160,219]


π”¬ Encoder Diversity (iter 12880):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 20/100] [Batch 179/669 (26.8%)] [Iter 12890] Loss: 1.1704 (freq: 0.3988, raw: 0.7708, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 801/1024 (78.2%) Top5:[944,518,306,734,655,933,475,711,68,250,122,261,901,785,387]


π”¬ Encoder Diversity (iter 12890):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 20/100] [Batch 189/669 (28.3%)] [Iter 12900] Loss: 0.9597 (freq: 0.3497, raw: 0.6093, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[518,933,734,241,536,475,68,700,698,711,570,1017,785,387,575]


π”¬ Encoder Diversity (iter 12900):
  Avg similarity: 0.0400 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 20/100] [Batch 199/669 (29.7%)] [Iter 12910] Loss: 1.1015 (freq: 0.4090, raw: 0.6917, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[518,673,14,696,655,734,1001,1019,995,944,901,831,477,219,105]


π”¬ Encoder Diversity (iter 12910):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 20/100] [Batch 209/669 (31.2%)] [Iter 12920] Loss: 1.0093 (freq: 0.3481, raw: 0.6605, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[385,698,155,341,914,231,482,933,713,904,475,700,711,441,822]


π”¬ Encoder Diversity (iter 12920):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 20/100] [Batch 219/669 (32.7%)] [Iter 12930] Loss: 1.1785 (freq: 0.4430, raw: 0.7348, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 769/1024 (75.1%) Top5:[1001,696,12,5,341,29,856,535,575,233,347,831,995,518,25]


π”¬ Encoder Diversity (iter 12930):
  Avg similarity: 0.0567 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 20/100] [Batch 229/669 (34.2%)] [Iter 12940] Loss: 1.0501 (freq: 0.3775, raw: 0.6718, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[575,68,698,914,25,385,475,536,233,194,29,387,734,713,518]


π”¬ Encoder Diversity (iter 12940):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 20/100] [Batch 239/669 (35.7%)] [Iter 12950] Loss: 1.0196 (freq: 0.3271, raw: 0.6917, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 767/1024 (74.9%) Top5:[933,68,713,698,5,385,542,822,734,914,828,482,920,700,518]


π”¬ Encoder Diversity (iter 12950):
  Avg similarity: 0.0645 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 20/100] [Batch 249/669 (37.2%)] [Iter 12960] Loss: 0.9567 (freq: 0.3531, raw: 0.6028, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[194,767,713,482,385,933,535,518,105,696,29,306,570,192,742]


π”¬ Encoder Diversity (iter 12960):
  Avg similarity: 0.0540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 20/100] [Batch 259/669 (38.7%)] [Iter 12970] Loss: 0.9493 (freq: 0.3323, raw: 0.6163, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[575,68,535,1019,884,385,105,711,673,698,4,713,734,192,402]


π”¬ Encoder Diversity (iter 12970):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 20/100] [Batch 269/669 (40.2%)] [Iter 12980] Loss: 0.8138 (freq: 0.2745, raw: 0.5386, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 775/1024 (75.7%) Top5:[14,831,575,655,884,1019,767,1017,323,1001,858,542,901,995,933]


π”¬ Encoder Diversity (iter 12980):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 20/100] [Batch 279/669 (41.7%)] [Iter 12990] Loss: 1.0710 (freq: 0.3796, raw: 0.6906, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[482,10,828,38,858,194,1019,933,713,698,518,220,230,441,155]


π”¬ Encoder Diversity (iter 12990):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 20/100] [Batch 289/669 (43.2%)] [Iter 13000] Loss: 1.0090 (freq: 0.3647, raw: 0.6435, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[155,649,194,914,241,575,713,920,10,655,822,1001,68,475,385]


π”¬ Encoder Diversity (iter 13000):
  Avg similarity: 0.0744 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9491 (0.0=collapsed)
[Epoch 20/100] [Batch 299/669 (44.7%)] [Iter 13010] Loss: 0.8291 (freq: 0.2813, raw: 0.5472, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[1019,575,655,1012,1001,944,29,518,91,582,700,891,160,708,12]


π”¬ Encoder Diversity (iter 13010):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 20/100] [Batch 309/669 (46.2%)] [Iter 13020] Loss: 0.8423 (freq: 0.2640, raw: 0.5776, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[575,12,655,944,1012,233,1001,1019,14,535,700,155,831,347,241]


π”¬ Encoder Diversity (iter 13020):
  Avg similarity: 0.0505 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 20/100] [Batch 319/669 (47.7%)] [Iter 13030] Loss: 1.0009 (freq: 0.3528, raw: 0.6474, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 756/1024 (73.8%) Top5:[933,884,575,347,518,535,241,944,570,870,536,155,711,341,828]


π”¬ Encoder Diversity (iter 13030):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 20/100] [Batch 329/669 (49.2%)] [Iter 13040] Loss: 1.3450 (freq: 0.4978, raw: 0.8463, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[1001,536,280,575,582,1017,828,944,347,884,713,78,12,933,14]


π”¬ Encoder Diversity (iter 13040):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 20/100] [Batch 339/669 (50.7%)] [Iter 13050] Loss: 1.2399 (freq: 0.4643, raw: 0.7748, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[575,785,884,392,5,347,944,1001,622,385,79,933,12,222,219]


π”¬ Encoder Diversity (iter 13050):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 20/100] [Batch 349/669 (52.2%)] [Iter 13060] Loss: 1.1290 (freq: 0.3666, raw: 0.7616, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[155,933,1001,323,78,856,914,920,570,713,1019,431,575,231,55]


π”¬ Encoder Diversity (iter 13060):
  Avg similarity: 0.0699 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 20/100] [Batch 359/669 (53.7%)] [Iter 13070] Loss: 1.0866 (freq: 0.3956, raw: 0.6902, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[933,1001,155,475,582,194,575,570,110,347,477,78,12,995,659]


π”¬ Encoder Diversity (iter 13070):
  Avg similarity: 0.0320 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 20/100] [Batch 369/669 (55.2%)] [Iter 13080] Loss: 1.2443 (freq: 0.4879, raw: 0.7555, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[944,1001,575,241,659,5,280,78,475,347,12,392,884,55,122]


π”¬ Encoder Diversity (iter 13080):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 20/100] [Batch 379/669 (56.7%)] [Iter 13090] Loss: 1.0630 (freq: 0.3611, raw: 0.7011, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[575,1019,241,1012,1001,995,896,944,933,655,12,205,323,475,831]


π”¬ Encoder Diversity (iter 13090):
  Avg similarity: 0.0591 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 20/100] [Batch 389/669 (58.1%)] [Iter 13100] Loss: 0.9941 (freq: 0.2977, raw: 0.6957, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[933,575,700,995,944,241,570,845,655,1019,155,518,1012,535,202]


π”¬ Encoder Diversity (iter 13100):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 20/100] [Batch 399/669 (59.6%)] [Iter 13110] Loss: 1.2192 (freq: 0.4501, raw: 0.7683, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[1019,575,655,944,12,582,1001,995,518,241,535,347,323,1012,542]


π”¬ Encoder Diversity (iter 13110):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 20/100] [Batch 409/669 (61.1%)] [Iter 13120] Loss: 0.9517 (freq: 0.3334, raw: 0.6174, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[155,933,163,1001,828,323,680,1019,995,655,742,535,91,14,711]


π”¬ Encoder Diversity (iter 13120):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 20/100] [Batch 419/669 (62.6%)] [Iter 13130] Loss: 1.0896 (freq: 0.4024, raw: 0.6864, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[518,680,995,582,323,575,655,1019,831,1001,628,933,266,14,12]


π”¬ Encoder Diversity (iter 13130):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9522 (0.0=collapsed)
[Epoch 20/100] [Batch 429/669 (64.1%)] [Iter 13140] Loss: 1.2182 (freq: 0.4583, raw: 0.7590, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[680,12,323,933,68,518,155,582,475,1001,570,194,831,231,5]


π”¬ Encoder Diversity (iter 13140):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 20/100] [Batch 439/669 (65.6%)] [Iter 13150] Loss: 1.2161 (freq: 0.4863, raw: 0.7289, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 708/1024 (69.1%) Top5:[14,323,1012,1001,680,582,91,972,163,564,12,1019,901,896,731]


π”¬ Encoder Diversity (iter 13150):
  Avg similarity: 0.0231 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 20/100] [Batch 449/669 (67.1%)] [Iter 13160] Loss: 1.0626 (freq: 0.3694, raw: 0.6923, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[535,575,933,1001,884,518,155,659,55,1017,680,385,920,570,406]


π”¬ Encoder Diversity (iter 13160):
  Avg similarity: 0.0622 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 20/100] [Batch 459/669 (68.6%)] [Iter 13170] Loss: 1.0877 (freq: 0.3696, raw: 0.7173, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[570,933,155,10,535,659,536,399,914,231,628,513,673,828,280]


π”¬ Encoder Diversity (iter 13170):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 20/100] [Batch 469/669 (70.1%)] [Iter 13180] Loss: 0.8944 (freq: 0.2895, raw: 0.6042, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[406,79,5,68,241,535,944,231,1019,912,12,575,655,518,933]


π”¬ Encoder Diversity (iter 13180):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 20/100] [Batch 479/669 (71.6%)] [Iter 13190] Loss: 0.9664 (freq: 0.3303, raw: 0.6353, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[655,1012,5,12,518,582,535,79,944,933,280,901,856,575,958]


π”¬ Encoder Diversity (iter 13190):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 20/100] [Batch 489/669 (73.1%)] [Iter 13200] Loss: 0.9675 (freq: 0.3484, raw: 0.6183, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[1019,231,155,655,582,944,535,680,518,122,441,280,241,628,12]


π”¬ Encoder Diversity (iter 13200):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 20/100] [Batch 499/669 (74.6%)] [Iter 13210] Loss: 1.0574 (freq: 0.3672, raw: 0.6894, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[241,5,958,535,306,155,944,68,347,822,542,575,518,1012,793]


π”¬ Encoder Diversity (iter 13210):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 20/100] [Batch 509/669 (76.1%)] [Iter 13220] Loss: 1.1930 (freq: 0.4488, raw: 0.7434, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 727/1024 (71.0%) Top5:[1019,570,933,155,91,870,12,431,520,29,659,14,518,698,564]


π”¬ Encoder Diversity (iter 13220):
  Avg similarity: 0.0420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 20/100] [Batch 519/669 (77.6%)] [Iter 13230] Loss: 1.0936 (freq: 0.3956, raw: 0.6973, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[12,535,570,1019,29,673,698,1017,155,518,633,280,163,91,10]


π”¬ Encoder Diversity (iter 13230):
  Avg similarity: 0.0460 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 20/100] [Batch 529/669 (79.1%)] [Iter 13240] Loss: 1.1238 (freq: 0.4438, raw: 0.6791, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[1019,655,575,1012,12,29,1001,732,14,995,564,266,958,570,233]


π”¬ Encoder Diversity (iter 13240):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 20/100] [Batch 539/669 (80.6%)] [Iter 13250] Loss: 0.8775 (freq: 0.3041, raw: 0.5727, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[266,12,14,575,91,163,1019,5,767,1012,1001,518,655,122,29]


π”¬ Encoder Diversity (iter 13250):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 20/100] [Batch 549/669 (82.1%)] [Iter 13260] Loss: 1.0634 (freq: 0.3659, raw: 0.6967, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[1019,12,655,575,29,1001,582,38,122,958,513,901,680,535,280]


π”¬ Encoder Diversity (iter 13260):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9550 (0.0=collapsed)
[Epoch 20/100] [Batch 559/669 (83.6%)] [Iter 13270] Loss: 1.0039 (freq: 0.3258, raw: 0.6773, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[194,933,570,479,38,431,399,513,673,482,659,10,658,231,241]


π”¬ Encoder Diversity (iter 13270):
  Avg similarity: 0.0670 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 20/100] [Batch 569/669 (85.1%)] [Iter 13280] Loss: 1.0251 (freq: 0.3240, raw: 0.7003, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[655,575,1019,233,944,1012,347,958,1001,845,5,122,12,564,518]


π”¬ Encoder Diversity (iter 13280):
  Avg similarity: 0.0424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 20/100] [Batch 579/669 (86.5%)] [Iter 13290] Loss: 0.8414 (freq: 0.2982, raw: 0.5424, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 801/1024 (78.2%) Top5:[12,535,958,542,995,655,155,582,280,5,122,391,575,406,137]


π”¬ Encoder Diversity (iter 13290):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 20/100] [Batch 589/669 (88.0%)] [Iter 13300] Loss: 0.9373 (freq: 0.3227, raw: 0.6138, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[445,12,570,575,14,398,933,635,564,535,194,347,995,399,29]


π”¬ Encoder Diversity (iter 13300):
  Avg similarity: 0.0788 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9471 (0.0=collapsed)
[Epoch 20/100] [Batch 599/669 (89.5%)] [Iter 13310] Loss: 1.3423 (freq: 0.5042, raw: 0.8372, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[933,431,347,570,241,155,194,673,398,12,535,231,520,306,574]


π”¬ Encoder Diversity (iter 13310):
  Avg similarity: 0.0294 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 20/100] [Batch 609/669 (91.0%)] [Iter 13320] Loss: 1.1130 (freq: 0.3667, raw: 0.7455, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[933,431,673,659,570,655,713,68,155,742,241,12,958,280,1001]


π”¬ Encoder Diversity (iter 13320):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 20/100] [Batch 619/669 (92.5%)] [Iter 13330] Loss: 1.1945 (freq: 0.4399, raw: 0.7537, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[535,464,655,659,570,306,673,574,68,564,920,122,633,958,79]


π”¬ Encoder Diversity (iter 13330):
  Avg similarity: 0.0533 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 20/100] [Batch 629/669 (94.0%)] [Iter 13340] Loss: 0.9215 (freq: 0.2986, raw: 0.6221, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[575,655,1001,767,55,518,592,1019,640,79,137,582,884,540,944]


π”¬ Encoder Diversity (iter 13340):
  Avg similarity: 0.0889 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 20/100] [Batch 639/669 (95.5%)] [Iter 13350] Loss: 1.0417 (freq: 0.3473, raw: 0.6936, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 767/1024 (74.9%) Top5:[1019,582,655,575,570,347,241,944,68,658,12,163,870,1001,518]


π”¬ Encoder Diversity (iter 13350):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 20/100] [Batch 649/669 (97.0%)] [Iter 13360] Loss: 1.1691 (freq: 0.4088, raw: 0.7595, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[1019,575,513,582,659,944,570,12,396,828,655,1017,658,635,385]


π”¬ Encoder Diversity (iter 13360):
  Avg similarity: 0.0630 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 20/100] [Batch 659/669 (98.5%)] [Iter 13370] Loss: 1.0593 (freq: 0.3619, raw: 0.6966, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 759/1024 (74.1%) Top5:[12,575,280,163,1019,944,680,655,582,933,91,14,579,482,963]


π”¬ Encoder Diversity (iter 13370):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 20/100] [Batch 669/669 (100.0%)] [Iter 13380] Loss: 1.0762 (freq: 0.3750, raw: 0.7004, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[347,958,166,944,12,574,518,575,194,659,680,122,793,231,482]


================================================================================
[Epoch 20] Validation Results:
  Total Loss: 0.5810
  Freq Loss:  0.1686
  Raw Loss:   0.4116
  Quant Loss: 0.0007
  π“ Codebook Usage: 492/1024 (48.0%)
  π“ Codebook Entropy: 4.8094 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 30550 (23.5%)
  Top 10 most used codes:
    1. Code 899: 4371 times (3.36%)
    2. Code 14: 3344 times (2.57%)
    3. Code 564: 3088 times (2.37%)
    4. Code 79: 3022 times (2.32%)
    5. Code 91: 2950 times (2.27%)
    6. Code 1001: 2872 times (2.21%)
    7. Code 1019: 2849 times (2.19%)
    8. Code 655: 2787 times (2.14%)
    9. Code 995: 2648 times (2.03%)
    10. Code 582: 2619 times (2.01%)
  Bottom 5 least used codes (among used):
    1. Code 219: 1 times (0.00%)
    2. Code 213: 1 times (0.00%)
    3. Code 460: 1 times (0.00%)
    4. Code 596: 1 times (0.00%)
    5. Code 21: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 19 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 13380):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9567 (0.0=collapsed)
[Epoch 21/100] [Batch 10/669 (1.5%)] [Iter 13390] Loss: 1.0833 (freq: 0.3897, raw: 0.6928, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 1024/1024 (100.0%) Top5:[12,944,46,884,117,347,614,793,542,79,166,579,1001,137,122]


π”¬ Encoder Diversity (iter 13390):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 21/100] [Batch 20/669 (3.0%)] [Iter 13400] Loss: 1.0390 (freq: 0.3366, raw: 0.7016, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[579,12,694,719,575,1019,899,1001,680,518,347,1018,1012,573,513]


π”¬ Encoder Diversity (iter 13400):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 21/100] [Batch 30/669 (4.5%)] [Iter 13410] Loss: 0.9402 (freq: 0.3027, raw: 0.6368, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[384,575,820,662,331,474,694,946,719,944,518,351,655,347,12]


π”¬ Encoder Diversity (iter 13410):
  Avg similarity: 0.0708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 21/100] [Batch 40/669 (6.0%)] [Iter 13420] Loss: 1.1172 (freq: 0.4325, raw: 0.6839, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[384,694,161,880,679,892,662,820,573,474,575,717,548,315,238]


π”¬ Encoder Diversity (iter 13420):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 21/100] [Batch 50/669 (7.5%)] [Iter 13430] Loss: 0.9480 (freq: 0.3213, raw: 0.6259, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[575,117,122,574,406,79,391,564,958,1001,944,831,347,542,582]


π”¬ Encoder Diversity (iter 13430):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 21/100] [Batch 60/669 (9.0%)] [Iter 13440] Loss: 0.9307 (freq: 0.3186, raw: 0.6113, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[575,1019,655,12,1001,944,29,694,856,518,689,542,513,582,347]


π”¬ Encoder Diversity (iter 13440):
  Avg similarity: 0.0293 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 21/100] [Batch 70/669 (10.5%)] [Iter 13450] Loss: 1.1435 (freq: 0.4375, raw: 0.7052, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[504,1001,63,575,513,122,12,944,679,529,384,117,238,717,540]


π”¬ Encoder Diversity (iter 13450):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 21/100] [Batch 80/669 (12.0%)] [Iter 13460] Loss: 1.4431 (freq: 0.5464, raw: 0.8959, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[504,694,513,384,733,238,371,965,529,837,440,196,679,141,474]


π”¬ Encoder Diversity (iter 13460):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 21/100] [Batch 90/669 (13.5%)] [Iter 13470] Loss: 0.9746 (freq: 0.3325, raw: 0.6412, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[679,1019,238,694,29,12,582,820,944,719,529,655,689,513,122]


π”¬ Encoder Diversity (iter 13470):
  Avg similarity: 0.0378 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 21/100] [Batch 100/669 (14.9%)] [Iter 13480] Loss: 1.3346 (freq: 0.4948, raw: 0.8389, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[122,884,79,12,1019,843,831,542,29,347,793,880,529,575,4]


π”¬ Encoder Diversity (iter 13480):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 21/100] [Batch 110/669 (16.4%)] [Iter 13490] Loss: 1.2969 (freq: 0.4592, raw: 0.8368, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[679,474,384,513,529,655,694,461,347,1012,12,79,1018,161,137]


π”¬ Encoder Diversity (iter 13490):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 21/100] [Batch 120/669 (17.9%)] [Iter 13500] Loss: 1.1511 (freq: 0.3920, raw: 0.7583, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[12,689,655,1019,513,11,575,820,944,1001,266,573,694,680,719]


π”¬ Encoder Diversity (iter 13500):
  Avg similarity: 0.0671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 21/100] [Batch 130/669 (19.4%)] [Iter 13510] Loss: 1.2338 (freq: 0.4705, raw: 0.7625, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[384,683,461,548,719,513,468,843,694,344,247,655,579,63,1018]


π”¬ Encoder Diversity (iter 13510):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 21/100] [Batch 140/669 (20.9%)] [Iter 13520] Loss: 0.9439 (freq: 0.3277, raw: 0.6154, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[12,11,843,29,725,117,680,944,391,919,1001,689,1019,655,574]


π”¬ Encoder Diversity (iter 13520):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 21/100] [Batch 150/669 (22.4%)] [Iter 13530] Loss: 1.2341 (freq: 0.4854, raw: 0.7479, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[59,820,679,11,214,1001,689,725,575,351,683,12,694,504,181]


π”¬ Encoder Diversity (iter 13530):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 21/100] [Batch 160/669 (23.9%)] [Iter 13540] Loss: 1.2213 (freq: 0.4580, raw: 0.7625, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[440,733,683,880,694,575,680,238,504,1018,315,857,518,12,689]


π”¬ Encoder Diversity (iter 13540):
  Avg similarity: 0.0468 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 21/100] [Batch 170/669 (25.4%)] [Iter 13550] Loss: 0.7757 (freq: 0.2422, raw: 0.5327, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[575,1001,12,725,655,468,11,1019,944,518,112,29,431,238,694]


π”¬ Encoder Diversity (iter 13550):
  Avg similarity: 0.0439 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 21/100] [Batch 180/669 (26.9%)] [Iter 13560] Loss: 1.0162 (freq: 0.3251, raw: 0.6903, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[843,575,12,117,518,919,122,694,238,1019,915,137,655,468,347]


π”¬ Encoder Diversity (iter 13560):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 21/100] [Batch 190/669 (28.4%)] [Iter 13570] Loss: 1.0473 (freq: 0.3434, raw: 0.7032, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[843,573,12,579,504,352,655,347,575,574,733,1019,857,683,122]


π”¬ Encoder Diversity (iter 13570):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 21/100] [Batch 200/669 (29.9%)] [Iter 13580] Loss: 1.1245 (freq: 0.3702, raw: 0.7536, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[11,579,12,725,575,655,117,442,266,391,233,843,760,513,79]


π”¬ Encoder Diversity (iter 13580):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 21/100] [Batch 210/669 (31.4%)] [Iter 13590] Loss: 0.9389 (freq: 0.2933, raw: 0.6449, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[468,117,884,857,233,12,843,442,944,577,784,694,391,564,79]


π”¬ Encoder Diversity (iter 13590):
  Avg similarity: 0.0548 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 21/100] [Batch 220/669 (32.9%)] [Iter 13600] Loss: 0.9271 (freq: 0.3091, raw: 0.6172, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[680,725,12,579,112,843,11,122,575,582,944,513,1012,881,694]


π”¬ Encoder Diversity (iter 13600):
  Avg similarity: 0.0586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 21/100] [Batch 230/669 (34.4%)] [Iter 13610] Loss: 0.8188 (freq: 0.2417, raw: 0.5764, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[784,238,468,725,679,579,513,655,112,12,662,694,1012,944,11]


π”¬ Encoder Diversity (iter 13610):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 21/100] [Batch 240/669 (35.9%)] [Iter 13620] Loss: 1.0988 (freq: 0.3780, raw: 0.7201, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[857,694,725,384,575,461,880,843,440,96,1001,318,944,391,63]


π”¬ Encoder Diversity (iter 13620):
  Avg similarity: 0.0270 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 21/100] [Batch 250/669 (37.4%)] [Iter 13630] Loss: 0.9336 (freq: 0.3139, raw: 0.6190, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[384,579,1018,266,11,12,575,719,1003,19,238,46,843,944,694]


π”¬ Encoder Diversity (iter 13630):
  Avg similarity: 0.0322 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 21/100] [Batch 260/669 (38.9%)] [Iter 13640] Loss: 0.9447 (freq: 0.2949, raw: 0.6491, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[915,117,12,843,733,233,295,513,391,575,944,838,79,744,725]


π”¬ Encoder Diversity (iter 13640):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 21/100] [Batch 270/669 (40.4%)] [Iter 13650] Loss: 1.2161 (freq: 0.4335, raw: 0.7817, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 779/1024 (76.1%) Top5:[784,725,575,944,655,1001,12,238,513,542,577,266,474,518,63]


π”¬ Encoder Diversity (iter 13650):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 21/100] [Batch 280/669 (41.9%)] [Iter 13660] Loss: 1.3462 (freq: 0.5282, raw: 0.8171, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 790/1024 (77.1%) Top5:[820,784,238,744,577,176,694,474,193,1017,352,96,575,440,63]


π”¬ Encoder Diversity (iter 13660):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 21/100] [Batch 290/669 (43.3%)] [Iter 13670] Loss: 1.2333 (freq: 0.4708, raw: 0.7616, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[247,728,79,385,694,683,679,725,548,468,176,96,857,744,285]


π”¬ Encoder Diversity (iter 13670):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 21/100] [Batch 300/669 (44.8%)] [Iter 13680] Loss: 1.2110 (freq: 0.4020, raw: 0.8082, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[575,117,542,671,122,347,843,725,513,4,137,564,518,919,884]


π”¬ Encoder Diversity (iter 13680):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 21/100] [Batch 310/669 (46.3%)] [Iter 13690] Loss: 1.2982 (freq: 0.4821, raw: 0.8152, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[694,857,548,96,193,577,200,744,440,63,644,384,1003,880,733]


π”¬ Encoder Diversity (iter 13690):
  Avg similarity: 0.0333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 21/100] [Batch 320/669 (47.8%)] [Iter 13700] Loss: 1.2526 (freq: 0.4875, raw: 0.7642, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[694,513,440,857,122,193,1012,644,843,744,238,96,542,478,117]


π”¬ Encoder Diversity (iter 13700):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 21/100] [Batch 330/669 (49.3%)] [Iter 13710] Loss: 1.1948 (freq: 0.4190, raw: 0.7750, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[513,857,1012,575,694,944,478,1018,4,881,81,238,680,79,784]


π”¬ Encoder Diversity (iter 13710):
  Avg similarity: 0.0235 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 21/100] [Batch 340/669 (50.8%)] [Iter 13720] Loss: 1.1496 (freq: 0.4306, raw: 0.7182, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[944,347,12,391,575,440,1001,122,478,4,322,79,513,117,96]


π”¬ Encoder Diversity (iter 13720):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 21/100] [Batch 350/669 (52.3%)] [Iter 13730] Loss: 1.0651 (freq: 0.3504, raw: 0.7140, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[1018,575,19,944,384,518,1001,644,1012,96,4,12,725,839,391]


π”¬ Encoder Diversity (iter 13730):
  Avg similarity: 0.0802 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9537 (0.0=collapsed)
[Epoch 21/100] [Batch 360/669 (53.8%)] [Iter 13740] Loss: 0.9842 (freq: 0.3773, raw: 0.6062, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[63,193,694,19,384,880,725,946,238,944,520,30,347,478,122]


π”¬ Encoder Diversity (iter 13740):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 21/100] [Batch 370/669 (55.3%)] [Iter 13750] Loss: 1.2229 (freq: 0.4524, raw: 0.7696, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[874,944,843,694,662,679,575,352,122,101,193,680,671,238,725]


π”¬ Encoder Diversity (iter 13750):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 21/100] [Batch 380/669 (56.8%)] [Iter 13760] Loss: 1.4010 (freq: 0.5087, raw: 0.8914, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[744,1018,101,857,608,694,352,442,247,238,845,474,19,96,46]


π”¬ Encoder Diversity (iter 13760):
  Avg similarity: 0.0295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 21/100] [Batch 390/669 (58.3%)] [Iter 13770] Loss: 1.1561 (freq: 0.3903, raw: 0.7651, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[478,857,193,1018,408,520,468,694,384,784,513,315,881,161,683]


π”¬ Encoder Diversity (iter 13770):
  Avg similarity: 0.0571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 21/100] [Batch 400/669 (59.8%)] [Iter 13780] Loss: 1.0672 (freq: 0.3620, raw: 0.7045, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[881,513,575,12,680,79,944,29,994,442,859,81,617,655,122]


π”¬ Encoder Diversity (iter 13780):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 21/100] [Batch 410/669 (61.3%)] [Iter 13790] Loss: 1.0229 (freq: 0.3476, raw: 0.6745, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[944,843,117,575,874,122,137,725,859,881,813,79,825,782,1001]


π”¬ Encoder Diversity (iter 13790):
  Avg similarity: 0.0554 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 21/100] [Batch 420/669 (62.8%)] [Iter 13800] Loss: 1.1558 (freq: 0.4087, raw: 0.7462, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[468,384,513,985,1012,12,478,880,784,96,820,662,1018,825,725]


π”¬ Encoder Diversity (iter 13800):
  Avg similarity: 0.0722 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 21/100] [Batch 430/669 (64.3%)] [Iter 13810] Loss: 1.1917 (freq: 0.4599, raw: 0.7309, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[575,725,117,518,577,122,655,582,944,859,12,4,315,513,96]


π”¬ Encoder Diversity (iter 13810):
  Avg similarity: 0.0453 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 21/100] [Batch 440/669 (65.8%)] [Iter 13820] Loss: 1.0764 (freq: 0.3588, raw: 0.7168, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[122,417,12,843,944,117,79,859,391,692,655,994,880,384,575]


π”¬ Encoder Diversity (iter 13820):
  Avg similarity: 0.0547 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 21/100] [Batch 450/669 (67.3%)] [Iter 13830] Loss: 0.9408 (freq: 0.3146, raw: 0.6255, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[839,617,1001,725,994,30,540,575,19,689,625,582,117,391,112]


π”¬ Encoder Diversity (iter 13830):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 21/100] [Batch 460/669 (68.8%)] [Iter 13840] Loss: 0.9485 (freq: 0.3147, raw: 0.6331, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[117,843,315,575,79,542,122,857,944,1001,238,859,347,858,513]


π”¬ Encoder Diversity (iter 13840):
  Avg similarity: 0.0627 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 21/100] [Batch 470/669 (70.3%)] [Iter 13850] Loss: 1.3964 (freq: 0.5271, raw: 0.8684, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[944,542,725,117,859,518,1001,857,575,384,315,782,273,843,513]


π”¬ Encoder Diversity (iter 13850):
  Avg similarity: 0.0483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 21/100] [Batch 480/669 (71.7%)] [Iter 13860] Loss: 1.1278 (freq: 0.3970, raw: 0.7300, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[725,944,442,575,1018,29,542,122,19,12,1001,112,579,540,30]


π”¬ Encoder Diversity (iter 13860):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 21/100] [Batch 490/669 (73.2%)] [Iter 13870] Loss: 1.3501 (freq: 0.4901, raw: 0.8591, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[384,513,440,825,784,238,1012,1017,408,662,1003,63,679,193,96]


π”¬ Encoder Diversity (iter 13870):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 21/100] [Batch 500/669 (74.7%)] [Iter 13880] Loss: 1.2336 (freq: 0.4711, raw: 0.7617, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[725,784,859,813,542,944,548,575,30,478,920,122,881,782,1018]


π”¬ Encoder Diversity (iter 13880):
  Avg similarity: 0.0567 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 21/100] [Batch 510/669 (76.2%)] [Iter 13890] Loss: 1.2247 (freq: 0.4717, raw: 0.7521, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 759/1024 (74.1%) Top5:[725,117,655,122,944,575,30,784,1018,859,12,4,518,582,548]


π”¬ Encoder Diversity (iter 13890):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 21/100] [Batch 520/669 (77.7%)] [Iter 13900] Loss: 1.0785 (freq: 0.3748, raw: 0.7029, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[655,575,784,625,725,617,724,12,1018,384,518,478,876,112,1012]


π”¬ Encoder Diversity (iter 13900):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9561 (0.0=collapsed)
[Epoch 21/100] [Batch 530/669 (79.2%)] [Iter 13910] Loss: 1.1195 (freq: 0.4280, raw: 0.6908, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 778/1024 (76.0%) Top5:[724,575,725,911,252,655,1001,876,122,391,579,112,654,29,19]


π”¬ Encoder Diversity (iter 13910):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 21/100] [Batch 540/669 (80.7%)] [Iter 13920] Loss: 1.3794 (freq: 0.5355, raw: 0.8430, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[478,122,575,1012,725,117,724,876,944,784,699,518,513,1001,12]


π”¬ Encoder Diversity (iter 13920):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 21/100] [Batch 550/669 (82.2%)] [Iter 13930] Loss: 1.0703 (freq: 0.3671, raw: 0.7024, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[12,117,122,1012,724,391,699,384,575,625,680,843,859,408,579]


π”¬ Encoder Diversity (iter 13930):
  Avg similarity: 0.0245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 21/100] [Batch 560/669 (83.7%)] [Iter 13940] Loss: 1.2852 (freq: 0.4453, raw: 0.8391, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[680,724,1012,876,12,384,679,518,122,699,881,478,926,784,29]


π”¬ Encoder Diversity (iter 13940):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 21/100] [Batch 570/669 (85.2%)] [Iter 13950] Loss: 0.9480 (freq: 0.3248, raw: 0.6224, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[724,384,876,699,725,764,1012,12,680,200,518,19,252,625,513]


π”¬ Encoder Diversity (iter 13950):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 21/100] [Batch 580/669 (86.7%)] [Iter 13960] Loss: 1.1938 (freq: 0.4373, raw: 0.7557, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[784,725,30,575,117,1012,417,513,238,12,660,19,859,384,122]


π”¬ Encoder Diversity (iter 13960):
  Avg similarity: 0.0557 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 21/100] [Batch 590/669 (88.2%)] [Iter 13970] Loss: 1.1638 (freq: 0.4207, raw: 0.7422, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[513,784,384,1012,478,362,200,440,1003,63,238,176,573,857,153]


π”¬ Encoder Diversity (iter 13970):
  Avg similarity: 0.0645 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 21/100] [Batch 600/669 (89.7%)] [Iter 13980] Loss: 1.1910 (freq: 0.4357, raw: 0.7546, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[440,784,1018,476,857,575,880,96,384,740,112,63,391,725,478]


π”¬ Encoder Diversity (iter 13980):
  Avg similarity: 0.0665 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 21/100] [Batch 610/669 (91.2%)] [Iter 13990] Loss: 1.3572 (freq: 0.5282, raw: 0.8281, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[985,122,384,873,859,4,1001,1012,835,725,577,12,440,944,858]


π”¬ Encoder Diversity (iter 13990):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 21/100] [Batch 620/669 (92.7%)] [Iter 14000] Loss: 1.1899 (freq: 0.4323, raw: 0.7568, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[575,876,117,316,122,873,1018,1001,391,19,881,944,699,725,680]


π”¬ Encoder Diversity (iter 14000):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 21/100] [Batch 630/669 (94.2%)] [Iter 14010] Loss: 0.9659 (freq: 0.3385, raw: 0.6267, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[881,513,944,575,122,117,384,297,56,725,859,660,835,782,344]


π”¬ Encoder Diversity (iter 14010):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 21/100] [Batch 640/669 (95.7%)] [Iter 14020] Loss: 0.9423 (freq: 0.3058, raw: 0.6357, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[724,12,881,625,680,521,362,1001,911,391,873,575,876,699,440]


π”¬ Encoder Diversity (iter 14020):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 21/100] [Batch 650/669 (97.2%)] [Iter 14030] Loss: 1.0881 (freq: 0.3930, raw: 0.6943, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[1018,117,96,548,440,238,478,181,1009,724,63,384,56,655,193]


π”¬ Encoder Diversity (iter 14030):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 21/100] [Batch 660/669 (98.7%)] [Iter 14040] Loss: 1.0975 (freq: 0.3782, raw: 0.7185, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[513,880,459,694,573,84,1018,548,362,468,784,23,871,540,200]


π”¬ Encoder Diversity (iter 14040):
  Avg similarity: 0.0581 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)

================================================================================
[Epoch 21] Validation Results:
  Total Loss: 0.5769
  Freq Loss:  0.1702
  Raw Loss:   0.4059
  Quant Loss: 0.0007
  π“ Codebook Usage: 548/1024 (53.5%)
  π“ Codebook Entropy: 4.8912 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28476 (21.9%)
  Top 10 most used codes:
    1. Code 724: 3573 times (2.74%)
    2. Code 518: 3210 times (2.47%)
    3. Code 625: 3198 times (2.46%)
    4. Code 780: 3083 times (2.37%)
    5. Code 521: 2754 times (2.12%)
    6. Code 699: 2651 times (2.04%)
    7. Code 502: 2578 times (1.98%)
    8. Code 391: 2510 times (1.93%)
    9. Code 873: 2466 times (1.89%)
    10. Code 769: 2453 times (1.88%)
  Bottom 5 least used codes (among used):
    1. Code 219: 1 times (0.00%)
    2. Code 106: 1 times (0.00%)
    3. Code 221: 1 times (0.00%)
    4. Code 349: 1 times (0.00%)
    5. Code 231: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 22/100] [Batch 1/669 (0.1%)] [Iter 14050] Loss: 1.2921 (freq: 0.4497, raw: 0.8416, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 913/1024 (89.2%) Top5:[513,1018,944,440,122,784,1012,384,84,655,56,117,548,459,391]


π”¬ Encoder Diversity (iter 14050):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 22/100] [Batch 11/669 (1.6%)] [Iter 14060] Loss: 1.1896 (freq: 0.4130, raw: 0.7758, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 1009/1024 (98.5%) Top5:[513,911,12,660,617,117,655,780,122,876,512,699,19,518,297]


π”¬ Encoder Diversity (iter 14060):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 22/100] [Batch 21/669 (3.1%)] [Iter 14070] Loss: 1.0750 (freq: 0.3990, raw: 0.6753, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[998,643,513,843,655,526,297,117,900,700,759,725,1020,859,133]


π”¬ Encoder Diversity (iter 14070):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 22/100] [Batch 31/669 (4.6%)] [Iter 14080] Loss: 1.1362 (freq: 0.4265, raw: 0.7088, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[12,297,900,911,876,391,625,643,117,440,660,38,29,944,724]


π”¬ Encoder Diversity (iter 14080):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 22/100] [Batch 41/669 (6.1%)] [Iter 14090] Loss: 1.2666 (freq: 0.4577, raw: 0.8081, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[944,440,122,575,207,881,835,297,117,700,843,643,512,253,680]


π”¬ Encoder Diversity (iter 14090):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 22/100] [Batch 51/669 (7.6%)] [Iter 14100] Loss: 1.3491 (freq: 0.5011, raw: 0.8472, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[207,197,700,9,1018,91,926,513,720,533,253,103,802,277,520]


π”¬ Encoder Diversity (iter 14100):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 22/100] [Batch 61/669 (9.1%)] [Iter 14110] Loss: 1.2922 (freq: 0.4990, raw: 0.7924, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[700,873,729,579,759,1018,588,321,520,720,533,780,575,724,440]


π”¬ Encoder Diversity (iter 14110):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 22/100] [Batch 71/669 (10.6%)] [Iter 14120] Loss: 0.9996 (freq: 0.3715, raw: 0.6273, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 790/1024 (77.1%) Top5:[700,575,122,513,720,809,12,944,588,729,835,862,197,1001,725]


π”¬ Encoder Diversity (iter 14120):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 22/100] [Batch 81/669 (12.1%)] [Iter 14130] Loss: 0.9536 (freq: 0.3320, raw: 0.6208, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[575,660,122,354,944,377,947,833,440,823,344,268,873,253,207]


π”¬ Encoder Diversity (iter 14130):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 22/100] [Batch 91/669 (13.6%)] [Iter 14140] Loss: 0.7343 (freq: 0.2372, raw: 0.4965, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[12,835,660,344,341,859,297,881,122,944,521,575,900,526,1001]


π”¬ Encoder Diversity (iter 14140):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 22/100] [Batch 101/669 (15.1%)] [Iter 14150] Loss: 1.3422 (freq: 0.5147, raw: 0.8266, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[277,207,377,720,724,320,122,802,852,12,513,133,341,637,440]


π”¬ Encoder Diversity (iter 14150):
  Avg similarity: 0.0482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 22/100] [Batch 111/669 (16.6%)] [Iter 14160] Loss: 1.2550 (freq: 0.4303, raw: 0.8238, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[881,944,876,873,29,12,1001,575,507,724,151,768,277,351,297]


π”¬ Encoder Diversity (iter 14160):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 22/100] [Batch 121/669 (18.1%)] [Iter 14170] Loss: 1.2373 (freq: 0.4598, raw: 0.7767, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[513,91,840,729,277,351,802,1001,207,197,619,680,117,852,575]


π”¬ Encoder Diversity (iter 14170):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 22/100] [Batch 131/669 (19.6%)] [Iter 14180] Loss: 1.0025 (freq: 0.3180, raw: 0.6837, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[513,881,579,944,207,197,117,759,118,91,985,833,840,575,809]


π”¬ Encoder Diversity (iter 14180):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 22/100] [Batch 141/669 (21.1%)] [Iter 14190] Loss: 1.1944 (freq: 0.4422, raw: 0.7513, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[579,117,873,881,911,12,833,944,655,703,876,724,680,575,297]


π”¬ Encoder Diversity (iter 14190):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 22/100] [Batch 151/669 (22.6%)] [Iter 14200] Loss: 1.1729 (freq: 0.4123, raw: 0.7597, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[913,513,133,729,833,802,947,809,117,440,28,91,944,377,533]


π”¬ Encoder Diversity (iter 14200):
  Avg similarity: 0.0801 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 22/100] [Batch 161/669 (24.1%)] [Iter 14210] Loss: 1.1409 (freq: 0.3699, raw: 0.7701, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[513,277,947,700,729,833,985,862,9,151,859,440,944,589,320]


π”¬ Encoder Diversity (iter 14210):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 22/100] [Batch 171/669 (25.6%)] [Iter 14220] Loss: 1.2493 (freq: 0.4577, raw: 0.7907, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[507,440,99,320,12,859,297,947,579,277,700,197,655,117,1001]


π”¬ Encoder Diversity (iter 14220):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 22/100] [Batch 181/669 (27.1%)] [Iter 14230] Loss: 0.8748 (freq: 0.3120, raw: 0.5620, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[1001,507,911,297,12,575,513,680,859,780,526,944,881,900,579]


π”¬ Encoder Diversity (iter 14230):
  Avg similarity: 0.0624 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 22/100] [Batch 191/669 (28.6%)] [Iter 14240] Loss: 1.3238 (freq: 0.5032, raw: 0.8197, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[513,207,575,809,21,268,197,91,440,944,700,118,670,759,578]


π”¬ Encoder Diversity (iter 14240):
  Avg similarity: 0.0219 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 22/100] [Batch 201/669 (30.0%)] [Iter 14250] Loss: 1.0516 (freq: 0.3727, raw: 0.6780, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[724,876,91,253,440,985,21,759,270,947,133,579,497,170,809]


π”¬ Encoder Diversity (iter 14250):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 22/100] [Batch 211/669 (31.5%)] [Iter 14260] Loss: 1.0619 (freq: 0.3833, raw: 0.6777, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[876,655,1001,575,21,341,835,513,985,881,579,699,724,947,91]


π”¬ Encoder Diversity (iter 14260):
  Avg similarity: 0.0453 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 22/100] [Batch 221/669 (33.0%)] [Iter 14270] Loss: 1.0693 (freq: 0.3868, raw: 0.6817, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[575,944,655,117,4,1001,680,900,572,440,833,133,911,521,947]


π”¬ Encoder Diversity (iter 14270):
  Avg similarity: 0.0224 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 22/100] [Batch 231/669 (34.5%)] [Iter 14280] Loss: 1.1596 (freq: 0.4021, raw: 0.7566, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[513,944,4,575,117,1001,444,21,911,91,680,913,572,521,700]


π”¬ Encoder Diversity (iter 14280):
  Avg similarity: 0.0230 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 22/100] [Batch 241/669 (36.0%)] [Iter 14290] Loss: 0.9546 (freq: 0.3391, raw: 0.6147, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[513,91,944,268,852,840,680,802,720,354,985,21,320,207,833]


π”¬ Encoder Diversity (iter 14290):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 22/100] [Batch 251/669 (37.5%)] [Iter 14300] Loss: 0.8288 (freq: 0.2695, raw: 0.5586, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[985,440,464,513,117,833,572,913,297,859,377,944,507,997,809]


π”¬ Encoder Diversity (iter 14300):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 22/100] [Batch 261/669 (39.0%)] [Iter 14310] Loss: 1.1080 (freq: 0.4061, raw: 0.7011, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[507,91,720,655,99,947,625,1001,575,985,578,440,911,556,945]


π”¬ Encoder Diversity (iter 14310):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 22/100] [Batch 271/669 (40.5%)] [Iter 14320] Loss: 1.2107 (freq: 0.4313, raw: 0.7786, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[91,947,720,268,533,513,951,913,985,207,945,320,655,277,833]


π”¬ Encoder Diversity (iter 14320):
  Avg similarity: 0.0571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 22/100] [Batch 281/669 (42.0%)] [Iter 14330] Loss: 0.9262 (freq: 0.3337, raw: 0.5917, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[951,947,833,729,91,655,170,945,297,1001,277,913,117,575,507]


π”¬ Encoder Diversity (iter 14330):
  Avg similarity: 0.0205 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 22/100] [Batch 291/669 (43.5%)] [Iter 14340] Loss: 1.2291 (freq: 0.4564, raw: 0.7719, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[1001,655,575,859,117,951,578,985,759,843,945,911,4,714,881]


π”¬ Encoder Diversity (iter 14340):
  Avg similarity: 0.0391 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 22/100] [Batch 301/669 (45.0%)] [Iter 14350] Loss: 1.4325 (freq: 0.5403, raw: 0.8912, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[700,655,809,881,1001,945,575,207,484,170,117,859,823,900,513]


π”¬ Encoder Diversity (iter 14350):
  Avg similarity: 0.0630 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 22/100] [Batch 311/669 (46.5%)] [Iter 14360] Loss: 1.3550 (freq: 0.5464, raw: 0.8078, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[1001,575,881,911,944,440,859,655,253,843,117,619,597,507,700]


π”¬ Encoder Diversity (iter 14360):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 22/100] [Batch 321/669 (48.0%)] [Iter 14370] Loss: 1.0704 (freq: 0.4209, raw: 0.6487, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[655,575,117,1001,170,507,233,859,556,724,4,384,911,625,99]


π”¬ Encoder Diversity (iter 14370):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 22/100] [Batch 331/669 (49.5%)] [Iter 14380] Loss: 1.1488 (freq: 0.3868, raw: 0.7612, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[513,197,99,575,207,945,809,1001,91,759,729,170,833,151,28]


π”¬ Encoder Diversity (iter 14380):
  Avg similarity: 0.0429 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 22/100] [Batch 341/669 (51.0%)] [Iter 14390] Loss: 1.0775 (freq: 0.3595, raw: 0.7171, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[575,1001,680,859,507,655,233,207,518,117,881,170,781,947,900]


π”¬ Encoder Diversity (iter 14390):
  Avg similarity: 0.0268 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 22/100] [Batch 351/669 (52.5%)] [Iter 14400] Loss: 0.9470 (freq: 0.3042, raw: 0.6420, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[579,170,556,625,680,634,1001,550,297,578,1004,484,945,507,118]


π”¬ Encoder Diversity (iter 14400):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 22/100] [Batch 361/669 (54.0%)] [Iter 14410] Loss: 1.0761 (freq: 0.3729, raw: 0.7024, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[507,597,575,170,680,781,579,4,233,881,835,862,572,945,513]


π”¬ Encoder Diversity (iter 14410):
  Avg similarity: 0.0790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 22/100] [Batch 371/669 (55.5%)] [Iter 14420] Loss: 1.2141 (freq: 0.4263, raw: 0.7869, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[597,507,233,859,426,781,122,944,835,31,170,552,985,900,771]


π”¬ Encoder Diversity (iter 14420):
  Avg similarity: 0.0586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 22/100] [Batch 381/669 (57.0%)] [Iter 14430] Loss: 1.1721 (freq: 0.4159, raw: 0.7554, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[556,507,575,862,655,944,519,720,513,197,951,802,1001,645,170]


π”¬ Encoder Diversity (iter 14430):
  Avg similarity: 0.0429 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 22/100] [Batch 391/669 (58.4%)] [Iter 14440] Loss: 1.1289 (freq: 0.3965, raw: 0.7316, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[985,207,513,197,28,464,945,862,729,409,90,575,840,253,951]


π”¬ Encoder Diversity (iter 14440):
  Avg similarity: 0.0534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 22/100] [Batch 401/669 (59.9%)] [Iter 14450] Loss: 0.9138 (freq: 0.2880, raw: 0.6251, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 772/1024 (75.4%) Top5:[1001,575,645,170,655,484,556,518,715,724,391,507,680,634,117]


π”¬ Encoder Diversity (iter 14450):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 22/100] [Batch 411/669 (61.4%)] [Iter 14460] Loss: 1.2570 (freq: 0.4897, raw: 0.7664, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 780/1024 (76.2%) Top5:[513,117,464,207,951,759,833,384,945,944,597,253,575,913,629]


π”¬ Encoder Diversity (iter 14460):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 22/100] [Batch 421/669 (62.9%)] [Iter 14470] Loss: 1.0596 (freq: 0.3558, raw: 0.7030, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[207,951,513,947,945,833,629,862,117,843,597,90,384,253,151]


π”¬ Encoder Diversity (iter 14470):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 22/100] [Batch 431/669 (64.4%)] [Iter 14480] Loss: 1.3532 (freq: 0.5166, raw: 0.8357, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[629,951,645,277,207,28,1017,513,913,21,575,833,802,759,122]


π”¬ Encoder Diversity (iter 14480):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 22/100] [Batch 441/669 (65.9%)] [Iter 14490] Loss: 0.9608 (freq: 0.3319, raw: 0.6281, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[881,947,277,1017,771,91,21,862,556,913,1020,715,575,802,133]


π”¬ Encoder Diversity (iter 14490):
  Avg similarity: 0.0249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 22/100] [Batch 451/669 (67.4%)] [Iter 14500] Loss: 0.7982 (freq: 0.2413, raw: 0.5561, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[945,597,680,572,170,881,493,634,31,277,859,117,21,951,910]


π”¬ Encoder Diversity (iter 14500):
  Avg similarity: 0.0254 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 22/100] [Batch 461/669 (68.9%)] [Iter 14510] Loss: 1.2597 (freq: 0.4434, raw: 0.8154, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[951,116,926,320,197,945,759,239,277,519,409,207,835,833,391]


π”¬ Encoder Diversity (iter 14510):
  Avg similarity: 0.0316 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 22/100] [Batch 471/669 (70.4%)] [Iter 14520] Loss: 1.1694 (freq: 0.4079, raw: 0.7607, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[117,484,391,634,575,944,771,951,170,852,802,31,753,122,881]


π”¬ Encoder Diversity (iter 14520):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 22/100] [Batch 481/669 (71.9%)] [Iter 14530] Loss: 0.7058 (freq: 0.2047, raw: 0.5005, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[634,484,1005,244,645,116,715,944,764,556,699,117,575,207,391]


π”¬ Encoder Diversity (iter 14530):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 22/100] [Batch 491/669 (73.4%)] [Iter 14540] Loss: 0.9314 (freq: 0.2981, raw: 0.6326, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 804/1024 (78.5%) Top5:[117,575,484,945,597,634,655,320,518,862,116,913,1001,947,207]


π”¬ Encoder Diversity (iter 14540):
  Avg similarity: 0.0559 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 22/100] [Batch 501/669 (74.9%)] [Iter 14550] Loss: 1.0923 (freq: 0.4043, raw: 0.6871, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[945,629,117,419,634,855,575,944,835,320,513,354,881,911,239]


π”¬ Encoder Diversity (iter 14550):
  Avg similarity: 0.0424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 22/100] [Batch 511/669 (76.4%)] [Iter 14560] Loss: 0.7693 (freq: 0.2296, raw: 0.5390, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 782/1024 (76.4%) Top5:[117,951,881,440,419,944,277,493,855,244,484,116,764,575,631]


π”¬ Encoder Diversity (iter 14560):
  Avg similarity: 0.0406 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 22/100] [Batch 521/669 (77.9%)] [Iter 14570] Loss: 0.9399 (freq: 0.3153, raw: 0.6238, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[513,116,21,632,197,951,945,60,9,28,471,440,720,207,117]


π”¬ Encoder Diversity (iter 14570):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 22/100] [Batch 531/669 (79.4%)] [Iter 14580] Loss: 1.0985 (freq: 0.3956, raw: 0.7021, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[881,944,764,1001,391,597,117,507,233,771,493,513,781,641,122]


π”¬ Encoder Diversity (iter 14580):
  Avg similarity: 0.0612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 22/100] [Batch 541/669 (80.9%)] [Iter 14590] Loss: 1.1187 (freq: 0.4291, raw: 0.6889, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[513,277,354,951,207,629,21,389,472,859,759,28,471,578,320]


π”¬ Encoder Diversity (iter 14590):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 22/100] [Batch 551/669 (82.4%)] [Iter 14600] Loss: 1.2027 (freq: 0.4306, raw: 0.7713, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[859,122,117,513,828,575,277,655,507,666,31,881,764,170,389]


π”¬ Encoder Diversity (iter 14600):
  Avg similarity: 0.0796 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9586 (0.0=collapsed)
[Epoch 22/100] [Batch 561/669 (83.9%)] [Iter 14610] Loss: 0.9000 (freq: 0.2745, raw: 0.6248, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[973,771,910,655,207,277,859,409,835,320,493,666,484,440,789]


π”¬ Encoder Diversity (iter 14610):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 22/100] [Batch 571/669 (85.4%)] [Iter 14620] Loss: 1.0191 (freq: 0.3483, raw: 0.6700, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[575,239,655,277,484,835,771,440,911,1005,629,881,699,493,117]


π”¬ Encoder Diversity (iter 14620):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 22/100] [Batch 581/669 (86.8%)] [Iter 14630] Loss: 1.1881 (freq: 0.4254, raw: 0.7619, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 775/1024 (75.7%) Top5:[484,493,440,575,207,944,244,597,655,117,771,947,1017,1005,31]


π”¬ Encoder Diversity (iter 14630):
  Avg similarity: 0.0207 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 22/100] [Batch 591/669 (88.3%)] [Iter 14640] Loss: 0.8004 (freq: 0.2532, raw: 0.5465, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[472,945,951,277,60,507,729,484,699,641,715,244,835,881,680]


π”¬ Encoder Diversity (iter 14640):
  Avg similarity: 0.0292 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 22/100] [Batch 601/669 (89.8%)] [Iter 14650] Loss: 1.2205 (freq: 0.4572, raw: 0.7625, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[239,944,507,391,911,484,715,881,680,835,472,244,951,700,699]


π”¬ Encoder Diversity (iter 14650):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 22/100] [Batch 611/669 (91.3%)] [Iter 14660] Loss: 1.0623 (freq: 0.3435, raw: 0.7181, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[945,835,828,277,354,116,575,513,597,1014,419,715,944,226,133]


π”¬ Encoder Diversity (iter 14660):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 22/100] [Batch 621/669 (92.8%)] [Iter 14670] Loss: 1.1927 (freq: 0.4316, raw: 0.7604, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[911,518,944,391,170,835,1005,1017,1001,575,789,324,715,764,709]


π”¬ Encoder Diversity (iter 14670):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 22/100] [Batch 631/669 (94.3%)] [Iter 14680] Loss: 1.2376 (freq: 0.4664, raw: 0.7703, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[1017,945,859,944,729,947,862,426,391,575,597,802,60,253,122]


π”¬ Encoder Diversity (iter 14680):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 22/100] [Batch 641/669 (95.8%)] [Iter 14690] Loss: 0.7827 (freq: 0.2510, raw: 0.5309, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 739/1024 (72.2%) Top5:[1005,835,518,239,944,391,911,484,125,655,1001,881,507,493,597]


π”¬ Encoder Diversity (iter 14690):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 22/100] [Batch 651/669 (97.3%)] [Iter 14700] Loss: 0.9140 (freq: 0.3072, raw: 0.6060, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[835,597,117,666,1017,944,859,122,575,239,493,356,771,881,709]


π”¬ Encoder Diversity (iter 14700):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 22/100] [Batch 661/669 (98.8%)] [Iter 14710] Loss: 1.3410 (freq: 0.5179, raw: 0.8222, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[207,629,729,910,253,947,998,1020,945,835,277,197,364,117,409]


π”¬ Encoder Diversity (iter 14710):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)

================================================================================
[Epoch 22] Validation Results:
  Total Loss: 0.5693
  Freq Loss:  0.1707
  Raw Loss:   0.3978
  Quant Loss: 0.0007
  π“ Codebook Usage: 509/1024 (49.7%)
  π“ Codebook Entropy: 4.8271 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 25532 (19.6%)
  Top 10 most used codes:
    1. Code 666: 2807 times (2.16%)
    2. Code 645: 2731 times (2.10%)
    3. Code 518: 2668 times (2.05%)
    4. Code 365: 2627 times (2.02%)
    5. Code 99: 2596 times (1.99%)
    6. Code 835: 2572 times (1.98%)
    7. Code 170: 2430 times (1.87%)
    8. Code 764: 2387 times (1.83%)
    9. Code 680: 2362 times (1.81%)
    10. Code 358: 2352 times (1.81%)
  Bottom 5 least used codes (among used):
    1. Code 232: 1 times (0.00%)
    2. Code 932: 1 times (0.00%)
    3. Code 984: 2 times (0.00%)
    4. Code 78: 2 times (0.00%)
    5. Code 755: 3 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 22
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 23/100] [Batch 2/669 (0.3%)] [Iter 14720] Loss: 0.9870 (freq: 0.3669, raw: 0.6191, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 964/1024 (94.1%) Top5:[493,117,1017,1001,835,317,575,324,944,709,365,239,358,518,426]


π”¬ Encoder Diversity (iter 14720):
  Avg similarity: 0.0598 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 23/100] [Batch 12/669 (1.8%)] [Iter 14730] Loss: 0.9806 (freq: 0.3294, raw: 0.6504, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 932/1024 (91.0%) Top5:[645,117,575,835,239,484,764,680,715,1001,1005,59,356,170,507]


π”¬ Encoder Diversity (iter 14730):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 23/100] [Batch 22/669 (3.3%)] [Iter 14740] Loss: 0.6697 (freq: 0.1811, raw: 0.4879, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[493,1004,859,597,944,575,1017,117,686,426,356,835,709,545,518]


π”¬ Encoder Diversity (iter 14740):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 23/100] [Batch 32/669 (4.8%)] [Iter 14750] Loss: 1.2208 (freq: 0.4808, raw: 0.7392, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[835,418,575,680,364,662,929,877,170,870,829,947,936,1014,236]


π”¬ Encoder Diversity (iter 14750):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 23/100] [Batch 42/669 (6.3%)] [Iter 14760] Loss: 1.0691 (freq: 0.3485, raw: 0.7198, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[944,947,76,877,136,764,1014,1004,493,494,215,929,859,721,597]


π”¬ Encoder Diversity (iter 14760):
  Avg similarity: 0.0248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 23/100] [Batch 52/669 (7.8%)] [Iter 14770] Loss: 1.2191 (freq: 0.4567, raw: 0.7615, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[859,1014,835,946,597,944,215,986,781,122,789,575,1004,494,239]


π”¬ Encoder Diversity (iter 14770):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 23/100] [Batch 62/669 (9.3%)] [Iter 14780] Loss: 0.9435 (freq: 0.3205, raw: 0.6223, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[1014,835,575,877,351,316,76,116,136,810,1004,829,453,324,109]


π”¬ Encoder Diversity (iter 14780):
  Avg similarity: 0.0543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 23/100] [Batch 72/669 (10.8%)] [Iter 14790] Loss: 0.6742 (freq: 0.1886, raw: 0.4849, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[835,859,944,597,1001,1017,575,493,518,317,771,686,122,116,709]


π”¬ Encoder Diversity (iter 14790):
  Avg similarity: 0.0511 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 23/100] [Batch 82/669 (12.3%)] [Iter 14800] Loss: 1.0389 (freq: 0.3580, raw: 0.6801, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[597,630,929,599,215,13,947,575,877,351,364,944,337,493,236]


π”¬ Encoder Diversity (iter 14800):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 23/100] [Batch 92/669 (13.8%)] [Iter 14810] Loss: 1.0613 (freq: 0.3860, raw: 0.6744, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[764,21,947,116,397,599,494,351,877,944,829,680,994,645,575]


π”¬ Encoder Diversity (iter 14810):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 23/100] [Batch 102/669 (15.2%)] [Iter 14820] Loss: 1.2931 (freq: 0.4860, raw: 0.8062, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[351,494,630,545,1014,215,136,236,632,877,575,316,929,324,690]


π”¬ Encoder Diversity (iter 14820):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 23/100] [Batch 112/669 (16.7%)] [Iter 14830] Loss: 1.1959 (freq: 0.4204, raw: 0.7747, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[597,493,835,1001,1017,575,859,771,588,663,911,686,365,356,680]


π”¬ Encoder Diversity (iter 14830):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 23/100] [Batch 122/669 (18.2%)] [Iter 14840] Loss: 1.1666 (freq: 0.4131, raw: 0.7526, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[545,215,575,870,835,632,1014,810,829,318,236,438,76,21,946]


π”¬ Encoder Diversity (iter 14840):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 23/100] [Batch 132/669 (19.7%)] [Iter 14850] Loss: 1.1949 (freq: 0.4192, raw: 0.7749, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[1017,835,575,597,493,615,944,881,1014,897,117,680,818,859,424]


π”¬ Encoder Diversity (iter 14850):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 23/100] [Batch 142/669 (21.2%)] [Iter 14860] Loss: 1.3524 (freq: 0.5266, raw: 0.8249, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[1014,136,947,215,630,632,886,21,545,877,116,13,929,19,49]


π”¬ Encoder Diversity (iter 14860):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9525 (0.0=collapsed)
[Epoch 23/100] [Batch 152/669 (22.7%)] [Iter 14870] Loss: 0.7196 (freq: 0.2243, raw: 0.4946, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[835,1001,881,947,789,117,575,645,21,480,507,771,599,256,621]


π”¬ Encoder Diversity (iter 14870):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 23/100] [Batch 162/669 (24.2%)] [Iter 14880] Loss: 1.0761 (freq: 0.3823, raw: 0.6929, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[575,859,484,1001,881,835,994,929,239,597,393,236,493,370,680]


π”¬ Encoder Diversity (iter 14880):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 23/100] [Batch 172/669 (25.7%)] [Iter 14890] Loss: 1.0689 (freq: 0.3738, raw: 0.6944, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[1017,588,493,859,742,929,881,877,666,789,818,575,597,239,365]


π”¬ Encoder Diversity (iter 14890):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 23/100] [Batch 182/669 (27.2%)] [Iter 14900] Loss: 1.1773 (freq: 0.4062, raw: 0.7703, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[493,597,117,311,575,625,49,961,21,116,797,337,599,457,789]


π”¬ Encoder Diversity (iter 14900):
  Avg similarity: 0.0760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 23/100] [Batch 192/669 (28.7%)] [Iter 14910] Loss: 1.3573 (freq: 0.4497, raw: 0.9067, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[21,929,1014,284,116,81,402,690,135,337,457,486,521,318,961]


π”¬ Encoder Diversity (iter 14910):
  Avg similarity: 0.0721 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 23/100] [Batch 202/669 (30.2%)] [Iter 14920] Loss: 1.1853 (freq: 0.4289, raw: 0.7556, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[877,599,545,483,160,507,575,944,311,484,117,81,1014,426,256]


π”¬ Encoder Diversity (iter 14920):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 23/100] [Batch 212/669 (31.7%)] [Iter 14930] Loss: 1.0687 (freq: 0.3810, raw: 0.6869, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[1014,920,929,215,829,947,311,630,81,113,337,117,877,944,599]


π”¬ Encoder Diversity (iter 14930):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 23/100] [Batch 222/669 (33.2%)] [Iter 14940] Loss: 1.0084 (freq: 0.3827, raw: 0.6248, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[1014,136,393,457,947,929,211,877,545,1004,21,19,632,337,81]


π”¬ Encoder Diversity (iter 14940):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 23/100] [Batch 232/669 (34.7%)] [Iter 14950] Loss: 1.0586 (freq: 0.4001, raw: 0.6576, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[911,575,483,538,808,365,789,1017,835,169,117,781,621,1001,944]


π”¬ Encoder Diversity (iter 14950):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 23/100] [Batch 242/669 (36.2%)] [Iter 14960] Loss: 0.9695 (freq: 0.3313, raw: 0.6374, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[835,911,586,599,483,944,905,538,116,575,833,117,1017,877,773]


π”¬ Encoder Diversity (iter 14960):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 23/100] [Batch 252/669 (37.7%)] [Iter 14970] Loss: 0.8323 (freq: 0.2520, raw: 0.5796, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[911,944,1017,781,365,117,771,597,717,623,773,440,818,833,484]


π”¬ Encoder Diversity (iter 14970):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 23/100] [Batch 262/669 (39.2%)] [Iter 14980] Loss: 1.0659 (freq: 0.3917, raw: 0.6734, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[483,1014,911,905,169,742,545,835,337,575,507,117,20,833,224]


π”¬ Encoder Diversity (iter 14980):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 23/100] [Batch 272/669 (40.7%)] [Iter 14990] Loss: 1.1586 (freq: 0.4143, raw: 0.7434, quant: 0.0010, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[1014,117,833,483,630,214,575,538,370,169,20,484,545,1004,835]


π”¬ Encoder Diversity (iter 14990):
  Avg similarity: 0.0467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 23/100] [Batch 282/669 (42.2%)] [Iter 15000] Loss: 0.6953 (freq: 0.1956, raw: 0.4990, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[1017,944,493,426,771,911,81,575,1014,116,337,936,929,507,215]


π”¬ Encoder Diversity (iter 15000):
  Avg similarity: 0.0339 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 23/100] [Batch 292/669 (43.6%)] [Iter 15010] Loss: 1.1075 (freq: 0.3863, raw: 0.7204, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[457,215,337,480,1014,538,929,21,646,575,117,116,625,311,393]


π”¬ Encoder Diversity (iter 15010):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 23/100] [Batch 302/669 (45.1%)] [Iter 15020] Loss: 1.2027 (freq: 0.4245, raw: 0.7773, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[20,719,575,764,117,742,1001,169,483,835,905,370,808,879,538]


π”¬ Encoder Diversity (iter 15020):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 23/100] [Batch 312/669 (46.6%)] [Iter 15030] Loss: 1.0729 (freq: 0.3973, raw: 0.6748, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[136,1014,507,128,21,994,215,483,742,835,311,538,630,480,370]


π”¬ Encoder Diversity (iter 15030):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 23/100] [Batch 322/669 (48.1%)] [Iter 15040] Loss: 1.1963 (freq: 0.4450, raw: 0.7505, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[483,835,216,538,1001,507,575,545,215,911,833,484,632,764,773]


π”¬ Encoder Diversity (iter 15040):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 23/100] [Batch 332/669 (49.6%)] [Iter 15050] Loss: 1.3428 (freq: 0.5168, raw: 0.8251, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[1014,947,316,636,21,136,944,545,116,19,929,337,961,625,49]


π”¬ Encoder Diversity (iter 15050):
  Avg similarity: 0.0626 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 23/100] [Batch 342/669 (51.1%)] [Iter 15060] Loss: 1.1117 (freq: 0.3490, raw: 0.7619, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[944,1014,117,136,636,845,781,835,646,717,393,575,1017,911,224]


π”¬ Encoder Diversity (iter 15060):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 23/100] [Batch 352/669 (52.6%)] [Iter 15070] Loss: 1.2232 (freq: 0.4645, raw: 0.7578, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[1014,947,49,944,835,136,117,575,284,911,483,845,1001,215,21]


π”¬ Encoder Diversity (iter 15070):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 23/100] [Batch 362/669 (54.1%)] [Iter 15080] Loss: 1.1917 (freq: 0.4248, raw: 0.7660, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[911,581,835,833,597,136,117,994,483,1017,575,929,944,49,239]


π”¬ Encoder Diversity (iter 15080):
  Avg similarity: 0.0194 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 23/100] [Batch 372/669 (55.6%)] [Iter 15090] Loss: 1.0791 (freq: 0.3871, raw: 0.6912, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[929,911,944,597,586,116,215,835,231,493,256,337,128,483,773]


π”¬ Encoder Diversity (iter 15090):
  Avg similarity: 0.0634 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 23/100] [Batch 382/669 (57.1%)] [Iter 15100] Loss: 1.1777 (freq: 0.4326, raw: 0.7442, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[929,215,1004,337,311,21,19,167,116,1014,690,1009,1005,953,480]


π”¬ Encoder Diversity (iter 15100):
  Avg similarity: 0.0835 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 23/100] [Batch 392/669 (58.6%)] [Iter 15110] Loss: 1.3002 (freq: 0.4861, raw: 0.8133, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[636,21,877,1004,480,545,116,215,947,690,364,109,845,929,944]


π”¬ Encoder Diversity (iter 15110):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 23/100] [Batch 402/669 (60.1%)] [Iter 15120] Loss: 0.9513 (freq: 0.3378, raw: 0.6127, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 787/1024 (76.9%) Top5:[597,717,911,1001,1014,575,881,835,789,117,493,365,157,483,480]


π”¬ Encoder Diversity (iter 15120):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 23/100] [Batch 412/669 (61.6%)] [Iter 15130] Loss: 0.9505 (freq: 0.2855, raw: 0.6642, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[911,835,484,19,1014,483,833,545,20,717,575,337,773,117,21]


π”¬ Encoder Diversity (iter 15130):
  Avg similarity: 0.0631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 23/100] [Batch 422/669 (63.1%)] [Iter 15140] Loss: 1.1697 (freq: 0.3906, raw: 0.7783, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[1014,658,1001,717,21,835,493,961,761,575,597,545,773,881,651]


π”¬ Encoder Diversity (iter 15140):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 23/100] [Batch 432/669 (64.6%)] [Iter 15150] Loss: 1.2088 (freq: 0.4604, raw: 0.7475, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[256,835,719,483,239,944,1014,845,584,773,116,214,881,20,284]


π”¬ Encoder Diversity (iter 15150):
  Avg similarity: 0.0657 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9571 (0.0=collapsed)
[Epoch 23/100] [Batch 442/669 (66.1%)] [Iter 15160] Loss: 1.2009 (freq: 0.4254, raw: 0.7747, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[597,881,947,835,545,339,700,1001,929,256,994,480,522,157,116]


π”¬ Encoder Diversity (iter 15160):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 23/100] [Batch 452/669 (67.6%)] [Iter 15170] Loss: 1.0939 (freq: 0.4026, raw: 0.6904, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[929,215,636,49,167,632,116,1014,480,19,947,136,284,330,21]


π”¬ Encoder Diversity (iter 15170):
  Avg similarity: 0.0831 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 23/100] [Batch 462/669 (69.1%)] [Iter 15180] Loss: 1.4327 (freq: 0.5007, raw: 0.9312, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[632,845,136,116,545,1014,337,581,457,211,480,494,167,49,929]


π”¬ Encoder Diversity (iter 15180):
  Avg similarity: 0.0302 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 23/100] [Batch 472/669 (70.6%)] [Iter 15190] Loss: 1.2595 (freq: 0.4389, raw: 0.8198, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[480,877,929,215,581,944,630,117,330,597,845,21,116,714,1014]


π”¬ Encoder Diversity (iter 15190):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 23/100] [Batch 482/669 (72.0%)] [Iter 15200] Loss: 1.3589 (freq: 0.5323, raw: 0.8256, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[944,929,597,493,584,1014,116,256,636,1017,881,841,947,572,835]


π”¬ Encoder Diversity (iter 15200):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 23/100] [Batch 492/669 (73.5%)] [Iter 15210] Loss: 1.1585 (freq: 0.4163, raw: 0.7414, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[941,575,911,700,493,239,370,1014,1017,636,773,21,526,929,833]


π”¬ Encoder Diversity (iter 15210):
  Avg similarity: 0.0342 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 23/100] [Batch 502/669 (75.0%)] [Iter 15220] Loss: 0.8550 (freq: 0.2808, raw: 0.5735, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[1017,493,911,944,439,20,575,554,773,1001,256,104,584,717,442]


π”¬ Encoder Diversity (iter 15220):
  Avg similarity: 0.0581 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 23/100] [Batch 512/669 (76.5%)] [Iter 15230] Loss: 1.0376 (freq: 0.3769, raw: 0.6599, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[947,330,116,1014,49,845,21,961,929,136,581,632,636,682,593]


π”¬ Encoder Diversity (iter 15230):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 23/100] [Batch 522/669 (78.0%)] [Iter 15240] Loss: 1.0647 (freq: 0.3591, raw: 0.7048, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[49,575,764,1014,636,929,928,881,911,700,215,136,21,526,20]


π”¬ Encoder Diversity (iter 15240):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 23/100] [Batch 532/669 (79.5%)] [Iter 15250] Loss: 0.9705 (freq: 0.3236, raw: 0.6461, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[944,761,20,929,881,773,847,581,216,814,21,717,785,39,986]


π”¬ Encoder Diversity (iter 15250):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 23/100] [Batch 542/669 (81.0%)] [Iter 15260] Loss: 0.9111 (freq: 0.2718, raw: 0.6386, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[215,330,21,116,682,136,947,961,49,636,581,764,284,211,117]


π”¬ Encoder Diversity (iter 15260):
  Avg similarity: 0.0627 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 23/100] [Batch 552/669 (82.5%)] [Iter 15270] Loss: 0.8781 (freq: 0.2862, raw: 0.5912, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[835,215,938,773,116,493,1014,818,646,330,457,284,117,881,584]


π”¬ Encoder Diversity (iter 15270):
  Avg similarity: 0.0467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 23/100] [Batch 562/669 (84.0%)] [Iter 15280] Loss: 0.9308 (freq: 0.3142, raw: 0.6159, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[493,575,835,818,938,761,1017,717,814,554,947,584,439,116,789]


π”¬ Encoder Diversity (iter 15280):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 23/100] [Batch 572/669 (85.5%)] [Iter 15290] Loss: 1.3429 (freq: 0.5196, raw: 0.8224, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[947,330,1005,215,116,1014,646,457,636,632,845,428,658,929,877]


π”¬ Encoder Diversity (iter 15290):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 23/100] [Batch 582/669 (87.0%)] [Iter 15300] Loss: 1.2166 (freq: 0.4541, raw: 0.7616, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[938,584,157,493,1017,717,761,20,789,944,597,117,554,835,833]


π”¬ Encoder Diversity (iter 15300):
  Avg similarity: 0.0201 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 23/100] [Batch 592/669 (88.5%)] [Iter 15310] Loss: 1.0733 (freq: 0.3873, raw: 0.6852, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[330,136,116,1014,646,39,1001,931,636,947,493,581,483,545,215]


π”¬ Encoder Diversity (iter 15310):
  Avg similarity: 0.0992 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9455 (0.0=collapsed)
[Epoch 23/100] [Batch 602/669 (90.0%)] [Iter 15320] Loss: 1.1190 (freq: 0.3449, raw: 0.7733, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[947,136,116,581,658,480,1014,169,215,21,646,81,877,690,630]


π”¬ Encoder Diversity (iter 15320):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 23/100] [Batch 612/669 (91.5%)] [Iter 15330] Loss: 1.3194 (freq: 0.4688, raw: 0.8497, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[928,581,157,714,330,575,636,277,160,493,526,116,646,21,19]


π”¬ Encoder Diversity (iter 15330):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 23/100] [Batch 622/669 (93.0%)] [Iter 15340] Loss: 1.2979 (freq: 0.4414, raw: 0.8556, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[581,457,21,116,330,211,136,1017,636,420,277,877,682,157,911]


π”¬ Encoder Diversity (iter 15340):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 23/100] [Batch 632/669 (94.5%)] [Iter 15350] Loss: 1.3347 (freq: 0.5032, raw: 0.8306, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[330,117,929,938,833,575,554,1001,835,813,593,157,597,116,27]


π”¬ Encoder Diversity (iter 15350):
  Avg similarity: 0.0302 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 23/100] [Batch 642/669 (96.0%)] [Iter 15360] Loss: 1.1570 (freq: 0.3890, raw: 0.7671, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[554,835,277,575,117,267,207,1001,597,239,27,526,938,714,911]


π”¬ Encoder Diversity (iter 15360):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 23/100] [Batch 652/669 (97.5%)] [Iter 15370] Loss: 1.2579 (freq: 0.5041, raw: 0.7528, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[773,944,1001,239,785,117,20,636,717,835,545,378,597,911,621]


π”¬ Encoder Diversity (iter 15370):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 23/100] [Batch 662/669 (99.0%)] [Iter 15380] Loss: 1.2868 (freq: 0.4941, raw: 0.7918, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[493,117,630,658,636,157,632,944,136,216,49,330,597,929,835]


π”¬ Encoder Diversity (iter 15380):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)

================================================================================
[Epoch 23] Validation Results:
  Total Loss: 0.5825
  Freq Loss:  0.1733
  Raw Loss:   0.4084
  Quant Loss: 0.0008
  π“ Codebook Usage: 344/1024 (33.6%)
  π“ Codebook Entropy: 4.3757 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 32344 (24.8%)
  Top 10 most used codes:
    1. Code 493: 3751 times (2.88%)
    2. Code 621: 3611 times (2.77%)
    3. Code 378: 3579 times (2.75%)
    4. Code 597: 3437 times (2.64%)
    5. Code 1001: 3210 times (2.47%)
    6. Code 277: 2997 times (2.30%)
    7. Code 813: 2960 times (2.27%)
    8. Code 847: 2948 times (2.26%)
    9. Code 207: 2934 times (2.25%)
    10. Code 719: 2917 times (2.24%)
  Bottom 5 least used codes (among used):
    1. Code 959: 1 times (0.00%)
    2. Code 940: 1 times (0.00%)
    3. Code 506: 1 times (0.00%)
    4. Code 443: 2 times (0.00%)
    5. Code 242: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 24/100] [Batch 3/669 (0.4%)] [Iter 15390] Loss: 1.0141 (freq: 0.3778, raw: 0.6354, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 980/1024 (95.7%) Top5:[117,493,947,486,928,157,835,575,944,1001,905,483,439,136,267]


π”¬ Encoder Diversity (iter 15390):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 24/100] [Batch 13/669 (1.9%)] [Iter 15400] Loss: 1.2962 (freq: 0.4875, raw: 0.8078, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 971/1024 (94.8%) Top5:[117,493,277,526,486,795,135,783,378,157,905,346,207,232,556]


π”¬ Encoder Diversity (iter 15400):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 24/100] [Batch 23/669 (3.4%)] [Iter 15410] Loss: 0.9408 (freq: 0.3348, raw: 0.6052, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[277,117,157,835,597,911,526,493,714,928,719,575,267,160,584]


π”¬ Encoder Diversity (iter 15410):
  Avg similarity: 0.0820 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 24/100] [Batch 33/669 (4.9%)] [Iter 15420] Loss: 1.0316 (freq: 0.3313, raw: 0.6994, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[783,197,794,135,728,239,232,976,556,597,182,269,987,698,16]


π”¬ Encoder Diversity (iter 15420):
  Avg similarity: 0.0548 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 24/100] [Batch 43/669 (6.4%)] [Iter 15430] Loss: 1.3287 (freq: 0.5037, raw: 0.8242, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[526,835,197,719,239,911,117,277,575,426,462,597,928,160,27]


π”¬ Encoder Diversity (iter 15430):
  Avg similarity: 0.0556 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 24/100] [Batch 53/669 (7.9%)] [Iter 15440] Loss: 1.4639 (freq: 0.5702, raw: 0.8927, quant: 0.0010, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[575,117,938,559,239,944,818,835,761,717,976,531,911,881,597]


π”¬ Encoder Diversity (iter 15440):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 24/100] [Batch 63/669 (9.4%)] [Iter 15450] Loss: 1.2188 (freq: 0.4420, raw: 0.7759, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[197,783,117,900,232,794,575,609,182,428,556,597,818,49,911]


π”¬ Encoder Diversity (iter 15450):
  Avg similarity: 0.0689 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 24/100] [Batch 73/669 (10.9%)] [Iter 15460] Loss: 0.8028 (freq: 0.2778, raw: 0.5242, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[117,783,232,864,269,597,976,818,378,968,69,930,947,197,794]


π”¬ Encoder Diversity (iter 15460):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 24/100] [Batch 83/669 (12.4%)] [Iter 15470] Loss: 0.9421 (freq: 0.3264, raw: 0.6149, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[303,232,911,483,197,794,199,947,621,49,990,559,575,220,1018]


π”¬ Encoder Diversity (iter 15470):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 24/100] [Batch 93/669 (13.9%)] [Iter 15480] Loss: 0.8592 (freq: 0.2589, raw: 0.5996, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[783,526,727,905,117,135,719,277,220,27,432,615,976,489,987]


π”¬ Encoder Diversity (iter 15480):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 24/100] [Batch 103/669 (15.4%)] [Iter 15490] Loss: 0.9546 (freq: 0.3421, raw: 0.6116, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[717,944,621,727,479,783,125,303,493,269,835,938,1018,900,680]


π”¬ Encoder Diversity (iter 15490):
  Avg similarity: 0.0660 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 24/100] [Batch 113/669 (16.9%)] [Iter 15500] Loss: 1.2040 (freq: 0.4471, raw: 0.7560, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[976,1018,135,303,968,987,443,783,83,232,49,761,269,795,217]


π”¬ Encoder Diversity (iter 15500):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 24/100] [Batch 123/669 (18.4%)] [Iter 15510] Loss: 1.0959 (freq: 0.4156, raw: 0.6795, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[428,987,1018,900,783,314,597,621,232,277,135,443,483,554,69]


π”¬ Encoder Diversity (iter 15510):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 24/100] [Batch 133/669 (19.9%)] [Iter 15520] Loss: 0.7030 (freq: 0.2418, raw: 0.4604, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[277,554,575,483,493,833,881,597,489,719,117,267,818,798,526]


π”¬ Encoder Diversity (iter 15520):
  Avg similarity: 0.0535 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 24/100] [Batch 143/669 (21.4%)] [Iter 15530] Loss: 0.7782 (freq: 0.2663, raw: 0.5111, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[930,794,783,987,976,65,512,968,232,559,277,49,428,780,182]


π”¬ Encoder Diversity (iter 15530):
  Avg similarity: 0.0524 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 24/100] [Batch 153/669 (22.9%)] [Iter 15540] Loss: 1.1311 (freq: 0.3851, raw: 0.7451, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[554,835,303,269,198,16,407,930,597,864,65,493,928,728,232]


π”¬ Encoder Diversity (iter 15540):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 24/100] [Batch 163/669 (24.4%)] [Iter 15550] Loss: 1.1904 (freq: 0.4570, raw: 0.7325, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[727,135,232,900,83,512,559,968,609,493,197,794,269,944,65]


π”¬ Encoder Diversity (iter 15550):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 24/100] [Batch 173/669 (25.9%)] [Iter 15560] Loss: 1.3492 (freq: 0.5218, raw: 0.8265, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[493,609,479,554,575,232,559,125,987,773,976,944,794,354,49]


π”¬ Encoder Diversity (iter 15560):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 24/100] [Batch 183/669 (27.4%)] [Iter 15570] Loss: 1.2798 (freq: 0.4504, raw: 0.8285, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[232,794,559,930,609,83,277,900,197,49,905,597,719,789,415]


π”¬ Encoder Diversity (iter 15570):
  Avg similarity: 0.0393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 24/100] [Batch 193/669 (28.8%)] [Iter 15580] Loss: 0.8353 (freq: 0.2819, raw: 0.5526, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[493,575,719,818,911,938,944,928,157,881,621,117,378,559,199]


π”¬ Encoder Diversity (iter 15580):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 24/100] [Batch 203/669 (30.3%)] [Iter 15590] Loss: 0.9861 (freq: 0.3564, raw: 0.6290, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 782/1024 (76.4%) Top5:[559,575,968,609,944,157,197,976,938,207,346,798,117,135,83]


π”¬ Encoder Diversity (iter 15590):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 24/100] [Batch 213/669 (31.8%)] [Iter 15600] Loss: 0.8451 (freq: 0.2987, raw: 0.5456, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[911,531,794,719,117,835,559,798,609,881,938,597,432,378,526]


π”¬ Encoder Diversity (iter 15600):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 24/100] [Batch 223/669 (33.3%)] [Iter 15610] Loss: 1.1865 (freq: 0.4150, raw: 0.7707, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[493,968,944,938,483,575,609,269,554,846,157,78,717,199,135]


π”¬ Encoder Diversity (iter 15610):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 24/100] [Batch 233/669 (34.8%)] [Iter 15620] Loss: 1.3408 (freq: 0.5276, raw: 0.8123, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[987,938,928,794,575,78,443,773,727,597,269,157,834,609,378]


π”¬ Encoder Diversity (iter 15620):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 24/100] [Batch 243/669 (36.3%)] [Iter 15630] Loss: 1.0290 (freq: 0.3659, raw: 0.6623, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[794,65,559,269,773,117,928,575,526,135,881,220,182,531,554]


π”¬ Encoder Diversity (iter 15630):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 24/100] [Batch 253/669 (37.8%)] [Iter 15640] Loss: 1.0289 (freq: 0.3347, raw: 0.6934, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[783,164,938,976,78,846,900,65,49,197,415,26,911,378,314]


π”¬ Encoder Diversity (iter 15640):
  Avg similarity: 0.0942 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9394 (0.0=collapsed)
[Epoch 24/100] [Batch 263/669 (39.3%)] [Iter 15650] Loss: 1.1935 (freq: 0.4139, raw: 0.7787, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[773,554,938,531,78,575,1011,378,621,157,717,987,966,269,818]


π”¬ Encoder Diversity (iter 15650):
  Avg similarity: 0.0429 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9625 (0.0=collapsed)
[Epoch 24/100] [Batch 273/669 (40.8%)] [Iter 15660] Loss: 1.0764 (freq: 0.3453, raw: 0.7302, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[794,987,968,727,67,818,217,269,26,49,222,579,966,559,443]


π”¬ Encoder Diversity (iter 15660):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 24/100] [Batch 283/669 (42.3%)] [Iter 15670] Loss: 0.8267 (freq: 0.2727, raw: 0.5532, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[575,798,818,968,269,746,489,579,16,526,277,169,833,531,217]


π”¬ Encoder Diversity (iter 15670):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 24/100] [Batch 293/669 (43.8%)] [Iter 15680] Loss: 0.9729 (freq: 0.3485, raw: 0.6235, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[575,493,117,911,169,1005,526,798,717,277,818,126,938,621,157]


π”¬ Encoder Diversity (iter 15680):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 24/100] [Batch 303/669 (45.3%)] [Iter 15690] Loss: 0.8543 (freq: 0.2989, raw: 0.5546, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[930,968,938,911,746,575,609,521,489,314,443,69,493,597,727]


π”¬ Encoder Diversity (iter 15690):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 24/100] [Batch 313/669 (46.8%)] [Iter 15700] Loss: 1.2932 (freq: 0.4913, raw: 0.8009, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[314,303,269,443,14,559,655,968,1001,332,987,277,65,493,217]


π”¬ Encoder Diversity (iter 15700):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 24/100] [Batch 323/669 (48.3%)] [Iter 15710] Loss: 0.9522 (freq: 0.3085, raw: 0.6429, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[26,727,609,1018,987,930,728,976,513,308,521,65,794,968,157]


π”¬ Encoder Diversity (iter 15710):
  Avg similarity: 0.0482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 24/100] [Batch 333/669 (49.8%)] [Iter 15720] Loss: 1.1834 (freq: 0.4012, raw: 0.7814, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[773,575,881,938,976,117,26,157,308,269,717,1018,966,415,197]


π”¬ Encoder Diversity (iter 15720):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 24/100] [Batch 343/669 (51.3%)] [Iter 15730] Loss: 1.1701 (freq: 0.4115, raw: 0.7577, quant: 0.0009, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[575,117,157,928,818,881,489,773,762,597,608,299,798,531,554]


π”¬ Encoder Diversity (iter 15730):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 24/100] [Batch 353/669 (52.8%)] [Iter 15740] Loss: 1.1963 (freq: 0.3999, raw: 0.7956, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[575,818,794,798,938,559,911,968,117,6,796,26,727,608,804]


π”¬ Encoder Diversity (iter 15740):
  Avg similarity: 0.0695 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 24/100] [Batch 363/669 (54.3%)] [Iter 15750] Loss: 1.0263 (freq: 0.3423, raw: 0.6831, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[559,117,797,157,928,881,277,299,575,323,968,987,911,621,521]


π”¬ Encoder Diversity (iter 15750):
  Avg similarity: 0.0679 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 24/100] [Batch 373/669 (55.8%)] [Iter 15760] Loss: 1.1452 (freq: 0.4105, raw: 0.7339, quant: 0.0008, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[117,976,269,928,833,911,493,1005,239,764,346,521,575,565,559]


π”¬ Encoder Diversity (iter 15760):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 24/100] [Batch 383/669 (57.2%)] [Iter 15770] Loss: 1.1179 (freq: 0.4185, raw: 0.6986, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[976,308,727,346,521,303,426,900,581,728,443,966,182,938,100]


π”¬ Encoder Diversity (iter 15770):
  Avg similarity: 0.0492 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 24/100] [Batch 393/669 (58.7%)] [Iter 15780] Loss: 1.0418 (freq: 0.3277, raw: 0.7133, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[575,968,157,581,108,1018,465,951,818,609,230,804,976,100,26]


π”¬ Encoder Diversity (iter 15780):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 24/100] [Batch 403/669 (60.2%)] [Iter 15790] Loss: 1.1486 (freq: 0.4051, raw: 0.7426, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[314,987,783,269,157,22,968,575,152,26,125,151,746,717,167]


π”¬ Encoder Diversity (iter 15790):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 24/100] [Batch 413/669 (61.7%)] [Iter 15800] Loss: 1.1154 (freq: 0.3807, raw: 0.7337, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[489,928,575,526,117,197,597,493,798,239,833,716,1005,881,443]


π”¬ Encoder Diversity (iter 15800):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 24/100] [Batch 423/669 (63.2%)] [Iter 15810] Loss: 1.2872 (freq: 0.4754, raw: 0.8110, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[575,314,26,968,49,783,794,597,976,749,938,269,157,443,987]


π”¬ Encoder Diversity (iter 15810):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 24/100] [Batch 433/669 (64.7%)] [Iter 15820] Loss: 1.1926 (freq: 0.4148, raw: 0.7770, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[762,717,575,976,783,773,493,125,829,749,881,938,951,151,443]


π”¬ Encoder Diversity (iter 15820):
  Avg similarity: 0.0563 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 24/100] [Batch 443/669 (66.2%)] [Iter 15830] Loss: 1.1344 (freq: 0.4260, raw: 0.7076, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[575,762,493,911,749,818,615,794,531,157,303,355,239,117,938]


π”¬ Encoder Diversity (iter 15830):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 24/100] [Batch 453/669 (67.7%)] [Iter 15840] Loss: 0.8026 (freq: 0.2408, raw: 0.5610, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[783,575,968,727,314,197,100,355,521,217,151,579,938,800,426]


π”¬ Encoder Diversity (iter 15840):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 24/100] [Batch 463/669 (69.2%)] [Iter 15850] Loss: 1.2040 (freq: 0.4256, raw: 0.7776, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[579,314,746,794,559,783,1006,762,465,728,152,151,222,230,443]


π”¬ Encoder Diversity (iter 15850):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 24/100] [Batch 473/669 (70.7%)] [Iter 15860] Loss: 0.9399 (freq: 0.3229, raw: 0.6162, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[773,493,22,749,798,1001,938,762,951,49,928,374,521,575,125]


π”¬ Encoder Diversity (iter 15860):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 24/100] [Batch 483/669 (72.2%)] [Iter 15870] Loss: 1.2625 (freq: 0.4438, raw: 0.8177, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[968,746,355,928,700,794,521,443,14,526,49,152,222,764,117]


π”¬ Encoder Diversity (iter 15870):
  Avg similarity: 0.0505 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 24/100] [Batch 493/669 (73.7%)] [Iter 15880] Loss: 1.1454 (freq: 0.3916, raw: 0.7530, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[746,157,239,833,911,575,493,968,521,928,117,818,700,631,621]


π”¬ Encoder Diversity (iter 15880):
  Avg similarity: 0.0784 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9512 (0.0=collapsed)
[Epoch 24/100] [Batch 503/669 (75.2%)] [Iter 15890] Loss: 0.9356 (freq: 0.3188, raw: 0.6160, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[157,597,911,493,928,575,762,374,938,152,567,26,691,763,565]


π”¬ Encoder Diversity (iter 15890):
  Avg similarity: 0.0511 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 24/100] [Batch 513/669 (76.7%)] [Iter 15900] Loss: 0.9118 (freq: 0.3234, raw: 0.5875, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[559,700,615,323,117,493,374,794,938,911,631,165,567,157,49]


π”¬ Encoder Diversity (iter 15900):
  Avg similarity: 0.0545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 24/100] [Batch 523/669 (78.2%)] [Iter 15910] Loss: 1.2224 (freq: 0.3971, raw: 0.8244, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[26,579,426,575,49,820,335,987,951,1018,968,783,314,308,67]


π”¬ Encoder Diversity (iter 15910):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 24/100] [Batch 533/669 (79.7%)] [Iter 15920] Loss: 1.0925 (freq: 0.4063, raw: 0.6853, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[938,477,575,134,951,987,911,727,493,157,559,531,881,859,117]


π”¬ Encoder Diversity (iter 15920):
  Avg similarity: 0.0280 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 24/100] [Batch 543/669 (81.2%)] [Iter 15930] Loss: 0.9271 (freq: 0.3119, raw: 0.6144, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[798,575,157,559,749,169,49,951,217,493,976,928,437,426,579]


π”¬ Encoder Diversity (iter 15930):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 24/100] [Batch 553/669 (82.7%)] [Iter 15940] Loss: 0.9292 (freq: 0.3346, raw: 0.5939, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[798,928,749,597,493,157,575,938,859,477,461,303,804,559,222]


π”¬ Encoder Diversity (iter 15940):
  Avg similarity: 0.0439 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 24/100] [Batch 563/669 (84.2%)] [Iter 15950] Loss: 0.9505 (freq: 0.3356, raw: 0.6142, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[798,928,938,575,496,585,879,157,845,531,567,559,902,962,299]


π”¬ Encoder Diversity (iter 15950):
  Avg similarity: 0.0633 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 24/100] [Batch 573/669 (85.7%)] [Iter 15960] Loss: 0.9110 (freq: 0.2800, raw: 0.6302, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[859,813,349,938,773,902,804,426,575,477,335,157,534,269,22]


π”¬ Encoder Diversity (iter 15960):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 24/100] [Batch 583/669 (87.1%)] [Iter 15970] Loss: 0.7052 (freq: 0.2248, raw: 0.4797, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 779/1024 (76.1%) Top5:[962,567,798,531,440,151,157,879,597,366,911,61,461,493,443]


π”¬ Encoder Diversity (iter 15970):
  Avg similarity: 0.0636 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 24/100] [Batch 593/669 (88.6%)] [Iter 15980] Loss: 1.2191 (freq: 0.4397, raw: 0.7785, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[26,157,239,938,928,432,14,796,575,443,167,911,308,314,134]


π”¬ Encoder Diversity (iter 15980):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 24/100] [Batch 603/669 (90.1%)] [Iter 15990] Loss: 1.1502 (freq: 0.4333, raw: 0.7160, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[575,157,182,496,911,881,231,938,727,239,477,567,597,710,355]


π”¬ Encoder Diversity (iter 15990):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 24/100] [Batch 613/669 (91.6%)] [Iter 16000] Loss: 1.1959 (freq: 0.4007, raw: 0.7943, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[938,609,746,217,157,182,349,575,443,496,426,197,559,469,26]


π”¬ Encoder Diversity (iter 16000):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 24/100] [Batch 623/669 (93.1%)] [Iter 16010] Loss: 1.3277 (freq: 0.4717, raw: 0.8551, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[575,928,182,565,349,493,938,968,134,966,443,112,157,426,197]


π”¬ Encoder Diversity (iter 16010):
  Avg similarity: 0.0430 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 24/100] [Batch 633/669 (94.6%)] [Iter 16020] Loss: 1.0903 (freq: 0.3908, raw: 0.6987, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[938,813,349,749,534,575,157,859,597,804,928,374,968,493,426]


π”¬ Encoder Diversity (iter 16020):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 24/100] [Batch 643/669 (96.1%)] [Iter 16030] Loss: 0.7742 (freq: 0.2428, raw: 0.5306, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[879,962,938,426,437,813,493,773,232,26,496,749,949,597,157]


π”¬ Encoder Diversity (iter 16030):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 24/100] [Batch 653/669 (97.6%)] [Iter 16040] Loss: 1.0227 (freq: 0.3282, raw: 0.6936, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[879,157,329,804,928,575,859,565,960,749,911,197,938,426,117]


π”¬ Encoder Diversity (iter 16040):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 24/100] [Batch 663/669 (99.1%)] [Iter 16050] Loss: 0.8221 (freq: 0.2426, raw: 0.5788, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[329,804,938,575,727,134,349,813,185,949,26,366,818,859,112]


π”¬ Encoder Diversity (iter 16050):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)

================================================================================
[Epoch 24] Validation Results:
  Total Loss: 0.5795
  Freq Loss:  0.1711
  Raw Loss:   0.4076
  Quant Loss: 0.0008
  π“ Codebook Usage: 546/1024 (53.3%)
  π“ Codebook Entropy: 4.8285 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 29644 (22.8%)
  Top 10 most used codes:
    1. Code 962: 3908 times (3.00%)
    2. Code 631: 3539 times (2.72%)
    3. Code 833: 3145 times (2.42%)
    4. Code 567: 3134 times (2.41%)
    5. Code 597: 3038 times (2.33%)
    6. Code 879: 2679 times (2.06%)
    7. Code 818: 2674 times (2.05%)
    8. Code 798: 2537 times (1.95%)
    9. Code 531: 2532 times (1.94%)
    10. Code 231: 2458 times (1.89%)
  Bottom 5 least used codes (among used):
    1. Code 277: 1 times (0.00%)
    2. Code 66: 1 times (0.00%)
    3. Code 361: 1 times (0.00%)
    4. Code 551: 1 times (0.00%)
    5. Code 472: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 25/100] [Batch 4/669 (0.6%)] [Iter 16060] Loss: 1.3891 (freq: 0.5654, raw: 0.8227, quant: 0.0010, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 998/1024 (97.5%) Top5:[938,559,818,710,157,615,813,859,949,397,762,69,415,81,749]


π”¬ Encoder Diversity (iter 16060):
  Avg similarity: 0.0530 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 25/100] [Batch 14/669 (2.1%)] [Iter 16070] Loss: 1.2928 (freq: 0.4675, raw: 0.8243, quant: 0.0010, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 923/1024 (90.1%) Top5:[239,554,615,818,1001,531,287,911,773,575,949,445,938,169,157]


π”¬ Encoder Diversity (iter 16070):
  Avg similarity: 0.0254 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 25/100] [Batch 24/669 (3.6%)] [Iter 16080] Loss: 1.0480 (freq: 0.3538, raw: 0.6933, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[938,911,431,81,798,818,477,531,833,859,773,879,597,374,157]


π”¬ Encoder Diversity (iter 16080):
  Avg similarity: 0.0276 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 25/100] [Batch 34/669 (5.1%)] [Iter 16090] Loss: 0.5624 (freq: 0.1739, raw: 0.3879, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[749,493,149,575,477,938,597,911,984,157,146,567,962,710,61]


π”¬ Encoder Diversity (iter 16090):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 25/100] [Batch 44/669 (6.6%)] [Iter 16100] Loss: 1.1667 (freq: 0.4515, raw: 0.7143, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 769/1024 (75.1%) Top5:[798,157,647,559,173,364,938,607,104,984,366,139,665,575,232]


π”¬ Encoder Diversity (iter 16100):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 25/100] [Batch 54/669 (8.1%)] [Iter 16110] Loss: 0.8941 (freq: 0.2907, raw: 0.6027, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[798,575,157,749,928,938,245,911,117,149,437,597,366,992,406]


π”¬ Encoder Diversity (iter 16110):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 25/100] [Batch 64/669 (9.6%)] [Iter 16120] Loss: 1.1983 (freq: 0.4280, raw: 0.7694, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[157,938,437,813,477,928,984,81,773,231,117,245,804,798,575]


π”¬ Encoder Diversity (iter 16120):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 25/100] [Batch 74/669 (11.1%)] [Iter 16130] Loss: 0.8005 (freq: 0.2896, raw: 0.5102, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[928,157,477,531,938,773,117,804,534,529,104,231,949,984,419]


π”¬ Encoder Diversity (iter 16130):
  Avg similarity: 0.0520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 25/100] [Batch 84/669 (12.6%)] [Iter 16140] Loss: 1.0691 (freq: 0.3871, raw: 0.6811, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[149,175,984,634,938,205,287,647,696,992,245,493,773,771,220]


π”¬ Encoder Diversity (iter 16140):
  Avg similarity: 0.0857 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9444 (0.0=collapsed)
[Epoch 25/100] [Batch 94/669 (14.1%)] [Iter 16150] Loss: 1.2009 (freq: 0.4143, raw: 0.7857, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[287,984,606,364,546,919,576,245,276,923,175,771,664,419,634]


π”¬ Encoder Diversity (iter 16150):
  Avg similarity: 0.0688 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 25/100] [Batch 104/669 (15.5%)] [Iter 16160] Loss: 1.2711 (freq: 0.4494, raw: 0.8207, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[710,146,984,597,647,245,232,634,720,61,287,933,992,364,198]


π”¬ Encoder Diversity (iter 16160):
  Avg similarity: 0.0170 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 25/100] [Batch 114/669 (17.0%)] [Iter 16170] Loss: 1.2738 (freq: 0.4374, raw: 0.8356, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[992,938,531,773,771,445,984,615,962,575,61,366,395,157,245]


π”¬ Encoder Diversity (iter 16170):
  Avg similarity: 0.0437 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 25/100] [Batch 124/669 (18.5%)] [Iter 16180] Loss: 0.8594 (freq: 0.2996, raw: 0.5589, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[984,364,287,696,201,564,146,647,415,399,771,149,606,992,245]


π”¬ Encoder Diversity (iter 16180):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 25/100] [Batch 134/669 (20.0%)] [Iter 16190] Loss: 1.1459 (freq: 0.3788, raw: 0.7663, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[818,992,173,647,415,958,984,923,374,597,576,554,239,962,138]


π”¬ Encoder Diversity (iter 16190):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 25/100] [Batch 144/669 (21.5%)] [Iter 16200] Loss: 1.2224 (freq: 0.4200, raw: 0.8015, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[157,104,575,564,938,928,38,798,366,198,374,984,663,775,437]


π”¬ Encoder Diversity (iter 16200):
  Avg similarity: 0.0210 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 25/100] [Batch 154/669 (23.0%)] [Iter 16210] Loss: 0.9707 (freq: 0.3339, raw: 0.6361, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[818,477,597,554,575,531,157,245,762,287,239,721,415,938,949]


π”¬ Encoder Diversity (iter 16210):
  Avg similarity: 0.0534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 25/100] [Batch 164/669 (24.5%)] [Iter 16220] Loss: 0.8382 (freq: 0.2957, raw: 0.5416, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[245,283,287,720,415,492,364,992,606,753,607,564,671,445,437]


π”¬ Encoder Diversity (iter 16220):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 25/100] [Batch 174/669 (26.0%)] [Iter 16230] Loss: 1.3100 (freq: 0.5082, raw: 0.8010, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[559,938,647,104,575,798,720,984,725,287,634,374,149,696,157]


π”¬ Encoder Diversity (iter 16230):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 25/100] [Batch 184/669 (27.5%)] [Iter 16240] Loss: 1.0737 (freq: 0.3462, raw: 0.7267, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[559,696,415,564,938,276,146,753,492,169,523,104,818,647,283]


π”¬ Encoder Diversity (iter 16240):
  Avg similarity: 0.0726 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9491 (0.0=collapsed)
[Epoch 25/100] [Batch 194/669 (29.0%)] [Iter 16250] Loss: 0.9794 (freq: 0.3654, raw: 0.6132, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[938,430,157,804,818,813,762,773,559,378,529,554,575,239,798]


π”¬ Encoder Diversity (iter 16250):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 25/100] [Batch 204/669 (30.5%)] [Iter 16260] Loss: 1.1800 (freq: 0.4232, raw: 0.7559, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[575,157,818,339,239,597,938,231,663,807,554,638,498,198,804]


π”¬ Encoder Diversity (iter 16260):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 25/100] [Batch 214/669 (32.0%)] [Iter 16270] Loss: 1.1663 (freq: 0.3940, raw: 0.7715, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[647,157,492,599,117,597,656,651,437,559,859,300,984,813,748]


π”¬ Encoder Diversity (iter 16270):
  Avg similarity: 0.0565 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 25/100] [Batch 224/669 (33.5%)] [Iter 16280] Loss: 1.2857 (freq: 0.4287, raw: 0.8561, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[938,287,117,104,647,157,419,498,992,554,606,198,919,664,607]


π”¬ Encoder Diversity (iter 16280):
  Avg similarity: 0.0254 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 25/100] [Batch 234/669 (35.0%)] [Iter 16290] Loss: 1.3517 (freq: 0.5026, raw: 0.8482, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[559,992,205,691,773,157,437,753,651,938,647,505,984,531,153]


π”¬ Encoder Diversity (iter 16290):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 25/100] [Batch 244/669 (36.5%)] [Iter 16300] Loss: 0.8865 (freq: 0.3018, raw: 0.5838, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[807,938,437,992,149,656,231,818,505,300,399,245,696,364,157]


π”¬ Encoder Diversity (iter 16300):
  Avg similarity: 0.0293 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 25/100] [Batch 254/669 (38.0%)] [Iter 16310] Loss: 0.9088 (freq: 0.2873, raw: 0.6207, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[647,938,437,984,576,634,656,415,559,505,300,992,597,445,198]


π”¬ Encoder Diversity (iter 16310):
  Avg similarity: 0.0277 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 25/100] [Batch 264/669 (39.5%)] [Iter 16320] Loss: 1.2274 (freq: 0.4618, raw: 0.7647, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[938,818,656,859,117,597,231,157,798,762,696,721,773,575,386]


π”¬ Encoder Diversity (iter 16320):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 25/100] [Batch 274/669 (41.0%)] [Iter 16330] Loss: 1.0354 (freq: 0.3790, raw: 0.6556, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[283,575,117,691,606,720,991,231,287,818,505,245,576,647,597]


π”¬ Encoder Diversity (iter 16330):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 25/100] [Batch 284/669 (42.5%)] [Iter 16340] Loss: 1.0920 (freq: 0.3771, raw: 0.7140, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[575,818,798,198,498,597,647,656,554,117,638,343,477,720,104]


π”¬ Encoder Diversity (iter 16340):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 25/100] [Batch 294/669 (43.9%)] [Iter 16350] Loss: 0.9231 (freq: 0.2931, raw: 0.6292, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 779/1024 (76.1%) Top5:[597,117,816,968,607,647,818,663,992,575,656,689,807,343,634]


π”¬ Encoder Diversity (iter 16350):
  Avg similarity: 0.0492 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 25/100] [Batch 304/669 (45.4%)] [Iter 16360] Loss: 0.9286 (freq: 0.3142, raw: 0.6137, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[374,656,498,804,858,575,21,807,634,798,399,176,689,437,984]


π”¬ Encoder Diversity (iter 16360):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 25/100] [Batch 314/669 (46.9%)] [Iter 16370] Loss: 1.3461 (freq: 0.4673, raw: 0.8779, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[343,283,663,117,287,858,575,218,214,597,656,944,691,437,205]


π”¬ Encoder Diversity (iter 16370):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 25/100] [Batch 324/669 (48.4%)] [Iter 16380] Loss: 1.0608 (freq: 0.3863, raw: 0.6737, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[773,938,813,117,477,575,165,984,804,859,656,968,374,437,107]


π”¬ Encoder Diversity (iter 16380):
  Avg similarity: 0.0678 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 25/100] [Batch 334/669 (49.9%)] [Iter 16390] Loss: 1.2554 (freq: 0.4132, raw: 0.8413, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[647,362,245,505,607,419,437,165,984,968,157,938,442,656,804]


π”¬ Encoder Diversity (iter 16390):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 25/100] [Batch 344/669 (51.4%)] [Iter 16400] Loss: 1.4203 (freq: 0.5068, raw: 0.9127, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[300,696,276,559,607,663,725,495,919,969,415,287,984,968,599]


π”¬ Encoder Diversity (iter 16400):
  Avg similarity: 0.0496 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 25/100] [Batch 354/669 (52.9%)] [Iter 16410] Loss: 1.0851 (freq: 0.3932, raw: 0.6911, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[245,974,634,559,287,720,576,505,606,445,984,919,623,607,104]


π”¬ Encoder Diversity (iter 16410):
  Avg similarity: 0.0541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 25/100] [Batch 364/669 (54.4%)] [Iter 16420] Loss: 0.9693 (freq: 0.3461, raw: 0.6224, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[968,773,117,656,107,554,157,343,498,807,804,634,944,597,198]


π”¬ Encoder Diversity (iter 16420):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 25/100] [Batch 374/669 (55.9%)] [Iter 16430] Loss: 1.1813 (freq: 0.4150, raw: 0.7654, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[696,597,157,804,807,287,968,117,107,656,773,198,505,366,1018]


π”¬ Encoder Diversity (iter 16430):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 25/100] [Batch 384/669 (57.4%)] [Iter 16440] Loss: 1.1606 (freq: 0.3985, raw: 0.7612, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[505,634,117,300,104,984,992,41,165,283,647,442,919,415,599]


π”¬ Encoder Diversity (iter 16440):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 25/100] [Batch 394/669 (58.9%)] [Iter 16450] Loss: 1.3426 (freq: 0.5212, raw: 0.8204, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[117,656,107,607,804,173,623,938,554,165,859,104,773,634,599]


π”¬ Encoder Diversity (iter 16450):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 25/100] [Batch 404/669 (60.4%)] [Iter 16460] Loss: 1.1856 (freq: 0.4231, raw: 0.7617, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[437,505,984,729,183,559,550,647,415,442,176,607,758,104,919]


π”¬ Encoder Diversity (iter 16460):
  Avg similarity: 0.0226 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 25/100] [Batch 414/669 (61.9%)] [Iter 16470] Loss: 1.3102 (freq: 0.4935, raw: 0.8158, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[656,798,117,176,173,984,992,374,169,107,245,283,792,938,492]


π”¬ Encoder Diversity (iter 16470):
  Avg similarity: 0.0263 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 25/100] [Batch 424/669 (63.4%)] [Iter 16480] Loss: 1.2910 (freq: 0.4602, raw: 0.8299, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[107,554,656,117,798,858,374,944,773,984,157,938,378,596,230]


π”¬ Encoder Diversity (iter 16480):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 25/100] [Batch 434/669 (64.9%)] [Iter 16490] Loss: 1.1730 (freq: 0.4025, raw: 0.7697, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[938,656,107,426,230,117,554,165,798,169,818,239,811,919,374]


π”¬ Encoder Diversity (iter 16490):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 25/100] [Batch 444/669 (66.4%)] [Iter 16500] Loss: 0.8104 (freq: 0.2888, raw: 0.5208, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[938,656,415,651,769,364,559,287,332,107,691,554,426,442,291]


π”¬ Encoder Diversity (iter 16500):
  Avg similarity: 0.0226 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 25/100] [Batch 454/669 (67.9%)] [Iter 16510] Loss: 1.4649 (freq: 0.5915, raw: 0.8724, quant: 0.0010, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[492,919,415,696,758,505,559,725,576,656,623,220,107,442,445]


π”¬ Encoder Diversity (iter 16510):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 25/100] [Batch 464/669 (69.4%)] [Iter 16520] Loss: 1.0564 (freq: 0.3521, raw: 0.7036, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[477,813,430,919,107,804,976,968,117,656,818,454,230,773,366]


π”¬ Encoder Diversity (iter 16520):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 25/100] [Batch 474/669 (70.9%)] [Iter 16530] Loss: 1.4540 (freq: 0.5580, raw: 0.8950, quant: 0.0010, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[374,230,696,656,559,597,554,968,117,403,919,447,239,107,773]


π”¬ Encoder Diversity (iter 16530):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 25/100] [Batch 484/669 (72.3%)] [Iter 16540] Loss: 1.3924 (freq: 0.5067, raw: 0.8848, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[758,607,984,287,492,696,647,671,437,919,220,283,634,230,173]


π”¬ Encoder Diversity (iter 16540):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 25/100] [Batch 494/669 (73.8%)] [Iter 16550] Loss: 0.9860 (freq: 0.3509, raw: 0.6343, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[169,245,117,492,647,389,702,21,230,729,364,919,623,157,798]


π”¬ Encoder Diversity (iter 16550):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 25/100] [Batch 504/669 (75.3%)] [Iter 16560] Loss: 1.0069 (freq: 0.3643, raw: 0.6417, quant: 0.0009, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[656,938,559,720,447,944,426,117,157,389,230,623,597,374,107]


π”¬ Encoder Diversity (iter 16560):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 25/100] [Batch 514/669 (76.8%)] [Iter 16570] Loss: 0.9567 (freq: 0.3215, raw: 0.6343, quant: 0.0008, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[767,720,389,74,173,117,492,505,245,623,193,437,976,919,696]


π”¬ Encoder Diversity (iter 16570):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 25/100] [Batch 524/669 (78.3%)] [Iter 16580] Loss: 1.0342 (freq: 0.3263, raw: 0.7070, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[74,291,656,984,492,1021,169,844,287,157,968,389,758,107,858]


π”¬ Encoder Diversity (iter 16580):
  Avg similarity: 0.0217 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 25/100] [Batch 534/669 (79.8%)] [Iter 16590] Loss: 1.0375 (freq: 0.3399, raw: 0.6968, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[968,169,623,696,165,656,389,1021,366,492,984,607,245,559,529]


π”¬ Encoder Diversity (iter 16590):
  Avg similarity: 0.0284 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 25/100] [Batch 544/669 (81.3%)] [Iter 16600] Loss: 1.2994 (freq: 0.4845, raw: 0.8140, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[984,758,389,656,623,245,663,74,691,919,107,492,607,283,968]


π”¬ Encoder Diversity (iter 16600):
  Avg similarity: 0.0545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 25/100] [Batch 554/669 (82.8%)] [Iter 16610] Loss: 1.2213 (freq: 0.4557, raw: 0.7647, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[597,445,107,623,173,968,984,656,696,857,157,621,844,231,117]


π”¬ Encoder Diversity (iter 16610):
  Avg similarity: 0.0600 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 25/100] [Batch 564/669 (84.3%)] [Iter 16620] Loss: 1.1948 (freq: 0.4560, raw: 0.7379, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[836,758,559,437,623,984,919,691,220,747,403,445,764,607,81]


π”¬ Encoder Diversity (iter 16620):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 25/100] [Batch 574/669 (85.8%)] [Iter 16630] Loss: 1.0303 (freq: 0.3505, raw: 0.6790, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[559,173,193,656,836,968,426,991,389,664,239,976,437,157,804]


π”¬ Encoder Diversity (iter 16630):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 25/100] [Batch 584/669 (87.3%)] [Iter 16640] Loss: 1.2986 (freq: 0.4596, raw: 0.8382, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[956,656,193,157,107,647,919,968,623,415,447,29,813,804,621]


π”¬ Encoder Diversity (iter 16640):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 25/100] [Batch 594/669 (88.8%)] [Iter 16650] Loss: 1.0793 (freq: 0.3767, raw: 0.7017, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[437,157,507,857,621,990,623,597,154,454,488,107,656,117,74]


π”¬ Encoder Diversity (iter 16650):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 25/100] [Batch 604/669 (90.3%)] [Iter 16660] Loss: 1.0465 (freq: 0.3557, raw: 0.6899, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[437,623,984,1021,283,747,836,607,149,195,245,696,857,767,157]


π”¬ Encoder Diversity (iter 16660):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 25/100] [Batch 614/669 (91.8%)] [Iter 16670] Loss: 0.9474 (freq: 0.3545, raw: 0.5921, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[447,656,154,426,968,231,597,844,477,157,818,74,575,554,107]


π”¬ Encoder Diversity (iter 16670):
  Avg similarity: 0.0668 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 25/100] [Batch 624/669 (93.3%)] [Iter 16680] Loss: 0.9344 (freq: 0.3360, raw: 0.5976, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[426,597,844,818,447,239,173,559,857,157,696,394,437,374,656]


π”¬ Encoder Diversity (iter 16680):
  Avg similarity: 0.0840 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9458 (0.0=collapsed)
[Epoch 25/100] [Batch 634/669 (94.8%)] [Iter 16690] Loss: 1.0682 (freq: 0.3769, raw: 0.6904, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[165,767,107,621,729,857,117,437,447,696,81,507,477,972,426]


π”¬ Encoder Diversity (iter 16690):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 25/100] [Batch 644/669 (96.3%)] [Iter 16700] Loss: 1.1780 (freq: 0.4157, raw: 0.7614, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[985,818,165,656,621,447,559,764,117,154,903,239,399,245,439]


π”¬ Encoder Diversity (iter 16700):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 25/100] [Batch 654/669 (97.8%)] [Iter 16710] Loss: 0.6891 (freq: 0.2233, raw: 0.4651, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[857,656,818,74,239,231,968,621,157,426,149,639,154,844,785]


π”¬ Encoder Diversity (iter 16710):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 25/100] [Batch 664/669 (99.3%)] [Iter 16720] Loss: 1.2483 (freq: 0.4557, raw: 0.7916, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[169,403,767,27,442,245,992,758,559,362,647,157,117,522,399]


π”¬ Encoder Diversity (iter 16720):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)

================================================================================
[Epoch 25] Validation Results:
  Total Loss: 0.5735
  Freq Loss:  0.1709
  Raw Loss:   0.4018
  Quant Loss: 0.0008
  π“ Codebook Usage: 405/1024 (39.6%)
  π“ Codebook Entropy: 4.5937 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 29428 (22.6%)
  Top 10 most used codes:
    1. Code 673: 3653 times (2.81%)
    2. Code 968: 3408 times (2.62%)
    3. Code 834: 3133 times (2.41%)
    4. Code 799: 3105 times (2.38%)
    5. Code 154: 2938 times (2.26%)
    6. Code 597: 2927 times (2.25%)
    7. Code 107: 2697 times (2.07%)
    8. Code 813: 2573 times (1.98%)
    9. Code 239: 2566 times (1.97%)
    10. Code 389: 2428 times (1.86%)
  Bottom 5 least used codes (among used):
    1. Code 402: 1 times (0.00%)
    2. Code 321: 1 times (0.00%)
    3. Code 211: 2 times (0.00%)
    4. Code 83: 2 times (0.00%)
    5. Code 24: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 3/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 26/100] [Batch 5/669 (0.7%)] [Iter 16730] Loss: 1.2239 (freq: 0.4769, raw: 0.7461, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 1012/1024 (98.8%) Top5:[663,747,559,173,653,394,239,857,117,1021,157,660,389,858,818]


π”¬ Encoder Diversity (iter 16730):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 26/100] [Batch 15/669 (2.2%)] [Iter 16740] Loss: 0.8982 (freq: 0.2728, raw: 0.6246, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[162,818,857,673,968,499,389,1021,660,858,844,426,165,173,656]


π”¬ Encoder Diversity (iter 16740):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 26/100] [Batch 25/669 (3.7%)] [Iter 16750] Loss: 1.2010 (freq: 0.4104, raw: 0.7898, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[177,422,968,447,165,594,930,230,621,903,656,117,857,821,431]


π”¬ Encoder Diversity (iter 16750):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 26/100] [Batch 35/669 (5.2%)] [Iter 16760] Loss: 0.9362 (freq: 0.3226, raw: 0.6127, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[447,437,656,818,857,968,446,157,165,582,621,230,176,575,107]


π”¬ Encoder Diversity (iter 16760):
  Avg similarity: 0.0411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 26/100] [Batch 45/669 (6.7%)] [Iter 16770] Loss: 0.9713 (freq: 0.3513, raw: 0.6193, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[601,469,594,479,356,413,930,431,437,174,114,422,983,843,138]


π”¬ Encoder Diversity (iter 16770):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 26/100] [Batch 55/669 (8.2%)] [Iter 16780] Loss: 1.1853 (freq: 0.4342, raw: 0.7502, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[117,821,843,165,446,431,498,621,587,479,437,448,819,656,413]


π”¬ Encoder Diversity (iter 16780):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 26/100] [Batch 65/669 (9.7%)] [Iter 16790] Loss: 1.0562 (freq: 0.3498, raw: 0.7055, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[930,671,425,844,567,448,403,819,760,138,437,177,696,422,413]


π”¬ Encoder Diversity (iter 16790):
  Avg similarity: 0.0645 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 26/100] [Batch 75/669 (11.2%)] [Iter 16800] Loss: 0.8444 (freq: 0.2977, raw: 0.5459, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[439,621,437,995,446,230,448,602,29,843,425,165,447,179,187]


π”¬ Encoder Diversity (iter 16800):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 26/100] [Batch 85/669 (12.7%)] [Iter 16810] Loss: 1.3103 (freq: 0.5065, raw: 0.8029, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[843,422,138,671,175,437,933,167,601,460,559,930,177,479,587]


π”¬ Encoder Diversity (iter 16810):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 26/100] [Batch 95/669 (14.2%)] [Iter 16820] Loss: 1.0052 (freq: 0.3725, raw: 0.6318, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[771,230,621,165,903,702,843,447,112,671,177,29,747,520,575]


π”¬ Encoder Diversity (iter 16820):
  Avg similarity: 0.0240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 26/100] [Batch 105/669 (15.7%)] [Iter 16830] Loss: 0.7462 (freq: 0.2509, raw: 0.4945, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[968,857,447,239,844,818,157,660,858,154,499,446,621,785,853]


π”¬ Encoder Diversity (iter 16830):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 26/100] [Batch 115/669 (17.2%)] [Iter 16840] Loss: 1.0762 (freq: 0.3658, raw: 0.7096, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[447,230,165,857,818,239,747,843,177,413,439,601,532,154,785]


π”¬ Encoder Diversity (iter 16840):
  Avg similarity: 0.0260 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 26/100] [Batch 125/669 (18.7%)] [Iter 16850] Loss: 0.9150 (freq: 0.3045, raw: 0.6096, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[403,920,843,397,278,174,938,601,696,413,821,819,930,587,114]


π”¬ Encoder Diversity (iter 16850):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 26/100] [Batch 135/669 (20.2%)] [Iter 16860] Loss: 1.3967 (freq: 0.4776, raw: 0.9182, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[821,448,506,397,920,403,174,363,278,413,594,177,204,587,433]


π”¬ Encoder Diversity (iter 16860):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 26/100] [Batch 145/669 (21.7%)] [Iter 16870] Loss: 1.0343 (freq: 0.3688, raw: 0.6647, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[559,1021,968,621,587,174,446,157,447,844,671,656,1019,406,165]


π”¬ Encoder Diversity (iter 16870):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 26/100] [Batch 155/669 (23.2%)] [Iter 16880] Loss: 1.0539 (freq: 0.3453, raw: 0.7078, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[747,165,656,447,968,857,446,708,818,844,621,406,1019,154,671]


π”¬ Encoder Diversity (iter 16880):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 26/100] [Batch 165/669 (24.7%)] [Iter 16890] Loss: 1.2924 (freq: 0.4712, raw: 0.8203, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[173,447,968,747,437,154,844,843,439,174,427,239,702,446,656]


π”¬ Encoder Diversity (iter 16890):
  Avg similarity: 0.0465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 26/100] [Batch 175/669 (26.2%)] [Iter 16900] Loss: 1.1010 (freq: 0.3989, raw: 0.7012, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[920,165,161,821,154,177,567,983,446,601,114,174,857,479,447]


π”¬ Encoder Diversity (iter 16900):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 26/100] [Batch 185/669 (27.7%)] [Iter 16910] Loss: 0.9491 (freq: 0.3126, raw: 0.6357, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[439,403,821,447,920,174,823,239,217,747,499,114,189,446,632]


π”¬ Encoder Diversity (iter 16910):
  Avg similarity: 0.0246 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 26/100] [Batch 195/669 (29.1%)] [Iter 16920] Loss: 0.9619 (freq: 0.3273, raw: 0.6338, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[632,601,397,764,818,962,821,594,403,177,843,1004,938,582,448]


π”¬ Encoder Diversity (iter 16920):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 26/100] [Batch 205/669 (30.6%)] [Iter 16930] Loss: 1.0868 (freq: 0.3845, raw: 0.7015, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[601,165,920,112,903,506,747,143,375,189,843,173,446,815,403]


π”¬ Encoder Diversity (iter 16930):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 26/100] [Batch 215/669 (32.1%)] [Iter 16940] Loss: 1.1774 (freq: 0.4186, raw: 0.7578, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[747,165,447,520,857,173,403,771,601,903,671,175,446,920,621]


π”¬ Encoder Diversity (iter 16940):
  Avg similarity: 0.0506 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 26/100] [Batch 225/669 (33.6%)] [Iter 16950] Loss: 1.1035 (freq: 0.4310, raw: 0.6716, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[446,747,375,165,112,154,843,920,903,447,853,671,764,968,621]


π”¬ Encoder Diversity (iter 16950):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 26/100] [Batch 235/669 (35.1%)] [Iter 16960] Loss: 1.2771 (freq: 0.4558, raw: 0.8204, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[853,447,340,1021,394,621,594,968,234,582,920,207,857,962,756]


π”¬ Encoder Diversity (iter 16960):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 26/100] [Batch 245/669 (36.6%)] [Iter 16970] Loss: 1.1646 (freq: 0.4104, raw: 0.7534, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[818,843,844,821,1019,621,174,995,499,246,173,602,587,601,356]


π”¬ Encoder Diversity (iter 16970):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 26/100] [Batch 255/669 (38.1%)] [Iter 16980] Loss: 0.9107 (freq: 0.2809, raw: 0.6290, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[621,460,173,37,632,420,446,447,239,747,671,433,821,165,413]


π”¬ Encoder Diversity (iter 16980):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 26/100] [Batch 265/669 (39.6%)] [Iter 16990] Loss: 1.3060 (freq: 0.4666, raw: 0.8385, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[821,460,920,656,506,843,818,193,621,771,747,532,926,177,173]


π”¬ Encoder Diversity (iter 16990):
  Avg similarity: 0.0405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 26/100] [Batch 275/669 (41.1%)] [Iter 17000] Loss: 0.8956 (freq: 0.2748, raw: 0.6200, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[843,112,447,920,621,317,173,506,413,926,193,821,189,779,375]


π”¬ Encoder Diversity (iter 17000):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 26/100] [Batch 285/669 (42.6%)] [Iter 17010] Loss: 0.9330 (freq: 0.2991, raw: 0.6331, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[843,747,397,272,653,174,87,577,506,621,230,403,771,413,175]


π”¬ Encoder Diversity (iter 17010):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 26/100] [Batch 295/669 (44.1%)] [Iter 17020] Loss: 1.0675 (freq: 0.3587, raw: 0.7080, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 744/1024 (72.7%) Top5:[621,1019,76,272,857,174,818,748,447,601,577,433,234,317,446]


π”¬ Encoder Diversity (iter 17020):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 26/100] [Batch 305/669 (45.6%)] [Iter 17030] Loss: 1.3335 (freq: 0.4998, raw: 0.8328, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[818,413,747,447,403,175,506,520,112,843,422,460,844,821,621]


π”¬ Encoder Diversity (iter 17030):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 26/100] [Batch 315/669 (47.1%)] [Iter 17040] Loss: 1.0227 (freq: 0.3474, raw: 0.6744, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[1021,601,857,447,317,939,621,844,779,559,165,968,818,420,403]


π”¬ Encoder Diversity (iter 17040):
  Avg similarity: 0.0242 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 26/100] [Batch 325/669 (48.6%)] [Iter 17050] Loss: 1.0675 (freq: 0.3863, raw: 0.6804, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[818,621,939,447,1021,602,67,823,317,627,968,340,567,747,601]


π”¬ Encoder Diversity (iter 17050):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 26/100] [Batch 335/669 (50.1%)] [Iter 17060] Loss: 1.0083 (freq: 0.3578, raw: 0.6497, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[795,165,3,567,275,601,413,177,587,114,506,843,764,747,857]


π”¬ Encoder Diversity (iter 17060):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 26/100] [Batch 345/669 (51.6%)] [Iter 17070] Loss: 1.2083 (freq: 0.4689, raw: 0.7385, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[165,934,577,601,844,857,447,939,372,671,413,995,968,317,188]


π”¬ Encoder Diversity (iter 17070):
  Avg similarity: 0.0168 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 26/100] [Batch 355/669 (53.1%)] [Iter 17080] Loss: 1.1752 (freq: 0.4292, raw: 0.7451, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[795,601,567,413,460,484,480,818,819,433,174,420,632,671,100]


π”¬ Encoder Diversity (iter 17080):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 26/100] [Batch 365/669 (54.6%)] [Iter 17090] Loss: 1.1792 (freq: 0.3842, raw: 0.7941, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[601,413,340,818,1021,795,447,154,3,821,968,317,278,520,446]


π”¬ Encoder Diversity (iter 17090):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 26/100] [Batch 375/669 (56.1%)] [Iter 17100] Loss: 1.1047 (freq: 0.4282, raw: 0.6756, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[601,559,818,403,1019,632,594,446,174,621,447,795,460,328,87]


π”¬ Encoder Diversity (iter 17100):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 26/100] [Batch 385/669 (57.5%)] [Iter 17110] Loss: 1.1861 (freq: 0.4295, raw: 0.7558, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[818,621,173,601,567,1019,447,747,420,175,795,594,926,413,13]


π”¬ Encoder Diversity (iter 17110):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 26/100] [Batch 395/669 (59.0%)] [Iter 17120] Loss: 1.0145 (freq: 0.3810, raw: 0.6326, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[747,601,403,173,112,328,133,1019,317,138,446,447,189,13,632]


π”¬ Encoder Diversity (iter 17120):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 26/100] [Batch 405/669 (60.5%)] [Iter 17130] Loss: 1.1303 (freq: 0.4293, raw: 0.7002, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[821,818,601,747,632,653,596,920,139,173,520,1019,345,403,406]


π”¬ Encoder Diversity (iter 17130):
  Avg similarity: 0.0594 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 26/100] [Batch 415/669 (62.0%)] [Iter 17140] Loss: 0.8414 (freq: 0.2923, raw: 0.5484, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[447,818,621,499,67,207,968,795,239,394,1021,559,949,601,343]


π”¬ Encoder Diversity (iter 17140):
  Avg similarity: 0.0511 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 26/100] [Batch 425/669 (63.5%)] [Iter 17150] Loss: 0.8613 (freq: 0.2954, raw: 0.5652, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[621,818,656,447,239,949,317,920,843,795,191,653,161,819,133]


π”¬ Encoder Diversity (iter 17150):
  Avg similarity: 0.0378 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 26/100] [Batch 435/669 (65.0%)] [Iter 17160] Loss: 1.1565 (freq: 0.4219, raw: 0.7338, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[204,520,926,484,433,247,100,413,272,460,343,278,87,653,420]


π”¬ Encoder Diversity (iter 17160):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 26/100] [Batch 445/669 (66.5%)] [Iter 17170] Loss: 1.3458 (freq: 0.5149, raw: 0.8299, quant: 0.0010, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[413,343,7,926,819,406,114,596,621,433,278,938,403,843,434]


π”¬ Encoder Diversity (iter 17170):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 26/100] [Batch 455/669 (68.0%)] [Iter 17180] Loss: 0.8448 (freq: 0.3142, raw: 0.5298, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[843,433,945,559,926,596,272,795,632,601,621,656,818,484,7]


π”¬ Encoder Diversity (iter 17180):
  Avg similarity: 0.0563 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 26/100] [Batch 465/669 (69.5%)] [Iter 17190] Loss: 0.9779 (freq: 0.3008, raw: 0.6764, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 804/1024 (78.5%) Top5:[112,818,189,447,819,413,596,844,133,601,621,949,968,595,272]


π”¬ Encoder Diversity (iter 17190):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 26/100] [Batch 475/669 (71.0%)] [Iter 17200] Loss: 1.2913 (freq: 0.4623, raw: 0.8280, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[447,818,77,336,968,375,1022,1021,449,949,844,239,317,3,843]


π”¬ Encoder Diversity (iter 17200):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 26/100] [Batch 485/669 (72.5%)] [Iter 17210] Loss: 0.8459 (freq: 0.2767, raw: 0.5684, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[818,447,77,189,317,449,621,747,336,949,9,885,844,219,112]


π”¬ Encoder Diversity (iter 17210):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 26/100] [Batch 495/669 (74.0%)] [Iter 17220] Loss: 1.3044 (freq: 0.4636, raw: 0.8398, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[818,447,219,1021,133,857,336,189,449,621,317,885,968,239,7]


π”¬ Encoder Diversity (iter 17220):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 26/100] [Batch 505/669 (75.5%)] [Iter 17230] Loss: 1.1512 (freq: 0.4472, raw: 0.7031, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[272,336,343,9,317,177,656,602,843,595,818,447,601,174,3]


π”¬ Encoder Diversity (iter 17230):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 26/100] [Batch 515/669 (77.0%)] [Iter 17240] Loss: 1.2952 (freq: 0.4722, raw: 0.8221, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[420,596,601,926,460,174,567,821,433,484,403,413,559,671,278]


π”¬ Encoder Diversity (iter 17240):
  Avg similarity: 0.0659 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 26/100] [Batch 525/669 (78.5%)] [Iter 17250] Loss: 1.0485 (freq: 0.3627, raw: 0.6849, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[343,40,843,447,272,601,317,602,818,747,701,545,846,133,403]


π”¬ Encoder Diversity (iter 17250):
  Avg similarity: 0.0224 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 26/100] [Batch 535/669 (80.0%)] [Iter 17260] Loss: 1.3196 (freq: 0.4769, raw: 0.8418, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[926,413,864,819,272,420,987,920,228,821,843,567,601,7,621]


π”¬ Encoder Diversity (iter 17260):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 26/100] [Batch 545/669 (81.5%)] [Iter 17270] Loss: 1.2968 (freq: 0.5041, raw: 0.7917, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[559,656,433,821,499,161,602,1008,484,9,133,645,567,469,413]


π”¬ Encoder Diversity (iter 17270):
  Avg similarity: 0.0268 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 26/100] [Batch 555/669 (83.0%)] [Iter 17280] Loss: 0.9172 (freq: 0.3082, raw: 0.6082, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[559,133,701,818,656,577,272,375,946,885,747,449,843,949,426]


π”¬ Encoder Diversity (iter 17280):
  Avg similarity: 0.0487 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 26/100] [Batch 565/669 (84.5%)] [Iter 17290] Loss: 0.8602 (freq: 0.2676, raw: 0.5918, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[559,821,819,413,343,174,747,601,596,433,460,1019,946,272,271]


π”¬ Encoder Diversity (iter 17290):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 26/100] [Batch 575/669 (85.9%)] [Iter 17300] Loss: 1.1529 (freq: 0.4064, raw: 0.7456, quant: 0.0009, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[656,413,818,747,317,343,228,1019,821,621,449,7,596,447,177]


π”¬ Encoder Diversity (iter 17300):
  Avg similarity: 0.0349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 26/100] [Batch 585/669 (87.4%)] [Iter 17310] Loss: 0.9393 (freq: 0.2927, raw: 0.6458, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[40,818,447,449,949,656,747,559,621,228,923,885,133,567,317]


π”¬ Encoder Diversity (iter 17310):
  Avg similarity: 0.0548 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 26/100] [Batch 595/669 (88.9%)] [Iter 17320] Loss: 0.9158 (freq: 0.3253, raw: 0.5896, quant: 0.0008, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[747,818,308,621,449,559,40,3,631,228,983,447,970,420,295]


π”¬ Encoder Diversity (iter 17320):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 26/100] [Batch 605/669 (90.4%)] [Iter 17330] Loss: 1.2774 (freq: 0.4691, raw: 0.8073, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[447,818,413,40,631,601,577,308,336,3,499,173,721,406,272]


π”¬ Encoder Diversity (iter 17330):
  Avg similarity: 0.0249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 26/100] [Batch 615/669 (91.9%)] [Iter 17340] Loss: 1.0147 (freq: 0.3273, raw: 0.6865, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[447,143,413,949,885,189,40,631,449,133,818,173,747,13,233]


π”¬ Encoder Diversity (iter 17340):
  Avg similarity: 0.0589 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 26/100] [Batch 625/669 (93.4%)] [Iter 17350] Loss: 1.1978 (freq: 0.4401, raw: 0.7568, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[818,631,447,559,143,844,40,403,233,228,308,317,747,645,843]


π”¬ Encoder Diversity (iter 17350):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 26/100] [Batch 635/669 (94.9%)] [Iter 17360] Loss: 1.0155 (freq: 0.3064, raw: 0.7083, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[596,447,938,520,413,567,818,278,926,945,923,460,949,174,233]


π”¬ Encoder Diversity (iter 17360):
  Avg similarity: 0.0277 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 26/100] [Batch 645/669 (96.4%)] [Iter 17370] Loss: 1.1853 (freq: 0.4392, raw: 0.7452, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[945,747,7,308,818,207,447,160,596,843,1008,67,520,413,833]


π”¬ Encoder Diversity (iter 17370):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 26/100] [Batch 655/669 (97.9%)] [Iter 17380] Loss: 1.1766 (freq: 0.4135, raw: 0.7623, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[949,818,143,260,602,272,447,631,656,40,920,133,237,413,228]


π”¬ Encoder Diversity (iter 17380):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 26/100] [Batch 665/669 (99.4%)] [Iter 17390] Loss: 1.2048 (freq: 0.4591, raw: 0.7448, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[747,174,601,428,326,995,1008,337,559,40,272,596,420,333,615]


π”¬ Encoder Diversity (iter 17390):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)

================================================================================
[Epoch 26] Validation Results:
  Total Loss: 0.5806
  Freq Loss:  0.1710
  Raw Loss:   0.4087
  Quant Loss: 0.0008
  π“ Codebook Usage: 451/1024 (44.0%)
  π“ Codebook Entropy: 4.5544 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 29553 (22.7%)
  Top 10 most used codes:
    1. Code 450: 3623 times (2.78%)
    2. Code 317: 3183 times (2.44%)
    3. Code 308: 2940 times (2.26%)
    4. Code 631: 2935 times (2.25%)
    5. Code 3: 2899 times (2.23%)
    6. Code 233: 2879 times (2.21%)
    7. Code 701: 2843 times (2.18%)
    8. Code 77: 2834 times (2.18%)
    9. Code 499: 2734 times (2.10%)
    10. Code 40: 2683 times (2.06%)
  Bottom 5 least used codes (among used):
    1. Code 403: 1 times (0.00%)
    2. Code 93: 1 times (0.00%)
    3. Code 527: 1 times (0.00%)
    4. Code 877: 1 times (0.00%)
    5. Code 570: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 4/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 27/100] [Batch 6/669 (0.9%)] [Iter 17400] Loss: 1.0136 (freq: 0.3683, raw: 0.6444, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 1018/1024 (99.4%) Top5:[631,40,747,499,143,9,823,970,228,559,13,449,1021,844,375]


π”¬ Encoder Diversity (iter 17400):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 27/100] [Batch 16/669 (2.4%)] [Iter 17410] Loss: 0.6977 (freq: 0.2325, raw: 0.4644, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 946/1024 (92.4%) Top5:[143,40,13,818,995,949,449,133,447,408,317,747,923,233,555]


π”¬ Encoder Diversity (iter 17410):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 27/100] [Batch 26/669 (3.9%)] [Iter 17420] Loss: 0.9806 (freq: 0.3502, raw: 0.6295, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[342,143,175,559,747,246,632,375,408,133,631,447,514,13,222]


π”¬ Encoder Diversity (iter 17420):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 27/100] [Batch 36/669 (5.4%)] [Iter 17430] Loss: 1.3386 (freq: 0.5070, raw: 0.8307, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[133,868,447,233,905,143,173,13,317,448,818,995,336,342,40]


π”¬ Encoder Diversity (iter 17430):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 27/100] [Batch 46/669 (6.9%)] [Iter 17440] Loss: 1.0435 (freq: 0.3807, raw: 0.6620, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[868,842,308,342,760,577,299,446,8,814,207,91,559,522,487]


π”¬ Encoder Diversity (iter 17440):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 27/100] [Batch 56/669 (8.4%)] [Iter 17450] Loss: 1.3200 (freq: 0.5030, raw: 0.8161, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[868,386,145,632,8,970,487,806,559,342,1017,514,640,447,133]


π”¬ Encoder Diversity (iter 17450):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9586 (0.0=collapsed)
[Epoch 27/100] [Batch 66/669 (9.9%)] [Iter 17460] Loss: 0.9453 (freq: 0.3332, raw: 0.6113, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[847,386,868,222,8,652,419,522,46,311,446,89,94,447,818]


π”¬ Encoder Diversity (iter 17460):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 27/100] [Batch 76/669 (11.4%)] [Iter 17470] Loss: 1.1614 (freq: 0.3728, raw: 0.7878, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[386,296,237,419,868,89,1017,407,522,514,356,46,311,487,222]


π”¬ Encoder Diversity (iter 17470):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 27/100] [Batch 86/669 (12.9%)] [Iter 17480] Loss: 1.0520 (freq: 0.3626, raw: 0.6886, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[308,818,109,343,386,949,602,447,844,228,137,631,868,499,317]


π”¬ Encoder Diversity (iter 17480):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 27/100] [Batch 96/669 (14.3%)] [Iter 17490] Loss: 1.1064 (freq: 0.3963, raw: 0.7092, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[386,64,487,844,228,949,842,342,868,336,747,621,595,556,818]


π”¬ Encoder Diversity (iter 17490):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 27/100] [Batch 106/669 (15.8%)] [Iter 17500] Loss: 1.2873 (freq: 0.4765, raw: 0.8098, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[228,342,64,336,308,514,447,970,612,706,449,478,559,222,246]


π”¬ Encoder Diversity (iter 17500):
  Avg similarity: 0.0685 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 27/100] [Batch 116/669 (17.3%)] [Iter 17510] Loss: 1.0674 (freq: 0.4027, raw: 0.6639, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[995,621,640,923,336,97,143,412,342,133,13,38,949,559,228]


π”¬ Encoder Diversity (iter 17510):
  Avg similarity: 0.0622 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 27/100] [Batch 126/669 (18.8%)] [Iter 17520] Loss: 0.8828 (freq: 0.2806, raw: 0.6014, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[446,246,342,556,1021,386,653,91,222,565,868,64,407,878,8]


π”¬ Encoder Diversity (iter 17520):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 27/100] [Batch 136/669 (20.3%)] [Iter 17530] Loss: 1.0789 (freq: 0.3663, raw: 0.7118, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[818,631,447,228,308,550,109,747,823,300,3,64,559,638,143]


π”¬ Encoder Diversity (iter 17530):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 27/100] [Batch 146/669 (21.8%)] [Iter 17540] Loss: 0.8716 (freq: 0.2820, raw: 0.5887, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[638,447,109,300,342,818,219,868,308,631,487,621,478,336,203]


π”¬ Encoder Diversity (iter 17540):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 27/100] [Batch 156/669 (23.3%)] [Iter 17550] Loss: 1.3830 (freq: 0.5504, raw: 0.8316, quant: 0.0010, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[386,342,407,647,286,109,447,1017,300,94,91,252,868,652,964]


π”¬ Encoder Diversity (iter 17550):
  Avg similarity: 0.0380 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 27/100] [Batch 166/669 (24.8%)] [Iter 17560] Loss: 1.0989 (freq: 0.4102, raw: 0.6878, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[46,342,386,448,222,559,917,268,343,522,830,89,901,514,311]


π”¬ Encoder Diversity (iter 17560):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 27/100] [Batch 176/669 (26.3%)] [Iter 17570] Loss: 0.8089 (freq: 0.2554, raw: 0.5528, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[640,109,923,476,228,638,493,747,449,300,386,133,602,3,13]


π”¬ Encoder Diversity (iter 17570):
  Avg similarity: 0.0248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 27/100] [Batch 186/669 (27.8%)] [Iter 17580] Loss: 1.0567 (freq: 0.3634, raw: 0.6925, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[386,818,91,868,901,698,40,607,640,577,830,300,252,94,747]


π”¬ Encoder Diversity (iter 17580):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 27/100] [Batch 196/669 (29.3%)] [Iter 17590] Loss: 1.0439 (freq: 0.3350, raw: 0.7081, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[621,823,64,514,94,631,602,40,300,446,447,747,818,308,133]


π”¬ Encoder Diversity (iter 17590):
  Avg similarity: 0.0711 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 27/100] [Batch 206/669 (30.8%)] [Iter 17600] Loss: 1.2994 (freq: 0.5099, raw: 0.7885, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[133,901,747,139,300,698,514,818,94,640,572,923,143,868,736]


π”¬ Encoder Diversity (iter 17600):
  Avg similarity: 0.0660 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 27/100] [Batch 216/669 (32.3%)] [Iter 17610] Loss: 1.3267 (freq: 0.5042, raw: 0.8216, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 801/1024 (78.2%) Top5:[94,8,446,818,386,514,299,559,296,222,632,336,449,256,246]


π”¬ Encoder Diversity (iter 17610):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 27/100] [Batch 226/669 (33.8%)] [Iter 17620] Loss: 1.0298 (freq: 0.3404, raw: 0.6886, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[386,923,747,61,447,640,995,252,407,949,514,375,632,222,814]


π”¬ Encoder Diversity (iter 17620):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 27/100] [Batch 236/669 (35.3%)] [Iter 17630] Loss: 1.1866 (freq: 0.4138, raw: 0.7719, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 758/1024 (74.0%) Top5:[94,818,40,109,446,317,64,336,46,91,89,228,407,949,621]


π”¬ Encoder Diversity (iter 17630):
  Avg similarity: 0.0272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 27/100] [Batch 246/669 (36.8%)] [Iter 17640] Loss: 1.1294 (freq: 0.3841, raw: 0.7444, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[386,94,407,317,172,40,336,559,419,476,932,818,493,595,577]


π”¬ Encoder Diversity (iter 17640):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 27/100] [Batch 256/669 (38.3%)] [Iter 17650] Loss: 0.9003 (freq: 0.2717, raw: 0.6279, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[94,747,407,64,109,814,46,638,640,447,818,386,949,556,342]


π”¬ Encoder Diversity (iter 17650):
  Avg similarity: 0.0746 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 27/100] [Batch 266/669 (39.8%)] [Iter 17660] Loss: 0.9263 (freq: 0.3054, raw: 0.6201, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[556,514,386,342,94,917,407,595,64,109,512,476,133,868,46]


π”¬ Encoder Diversity (iter 17660):
  Avg similarity: 0.0245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 27/100] [Batch 276/669 (41.3%)] [Iter 17670] Loss: 0.9869 (freq: 0.3361, raw: 0.6501, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[94,868,447,631,109,407,386,478,818,336,732,800,300,979,556]


π”¬ Encoder Diversity (iter 17670):
  Avg similarity: 0.0601 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 27/100] [Batch 286/669 (42.8%)] [Iter 17680] Loss: 0.8150 (freq: 0.2661, raw: 0.5481, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[806,595,868,949,818,632,407,447,830,556,61,558,621,901,91]


π”¬ Encoder Diversity (iter 17680):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9581 (0.0=collapsed)
[Epoch 27/100] [Batch 296/669 (44.2%)] [Iter 17690] Loss: 0.9001 (freq: 0.3292, raw: 0.5700, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[317,818,386,407,631,923,478,559,109,447,747,640,64,556,289]


π”¬ Encoder Diversity (iter 17690):
  Avg similarity: 0.0468 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 27/100] [Batch 306/669 (45.7%)] [Iter 17700] Loss: 1.2075 (freq: 0.4270, raw: 0.7797, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[631,109,747,862,818,949,447,995,923,558,61,13,830,133,939]


π”¬ Encoder Diversity (iter 17700):
  Avg similarity: 0.0557 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 27/100] [Batch 316/669 (47.2%)] [Iter 17710] Loss: 0.9667 (freq: 0.3661, raw: 0.5998, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[559,407,830,631,109,222,522,983,384,64,647,386,736,487,751]


π”¬ Encoder Diversity (iter 17710):
  Avg similarity: 0.0531 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 27/100] [Batch 326/669 (48.7%)] [Iter 17720] Loss: 0.9677 (freq: 0.3541, raw: 0.6127, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[94,407,747,868,640,830,222,64,447,556,818,299,109,493,424]


π”¬ Encoder Diversity (iter 17720):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 27/100] [Batch 336/669 (50.2%)] [Iter 17730] Loss: 1.1795 (freq: 0.4289, raw: 0.7498, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[602,222,300,640,228,109,621,449,732,923,419,424,830,800,185]


π”¬ Encoder Diversity (iter 17730):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 27/100] [Batch 346/669 (51.7%)] [Iter 17740] Loss: 1.3181 (freq: 0.4688, raw: 0.8484, quant: 0.0010, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[386,901,949,94,934,878,868,427,558,862,932,545,296,246,64]


π”¬ Encoder Diversity (iter 17740):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 27/100] [Batch 356/669 (53.2%)] [Iter 17750] Loss: 1.0382 (freq: 0.3748, raw: 0.6625, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[384,751,736,386,94,652,909,446,296,698,454,64,577,478,91]


π”¬ Encoder Diversity (iter 17750):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 27/100] [Batch 366/669 (54.7%)] [Iter 17760] Loss: 0.8346 (freq: 0.2791, raw: 0.5547, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[228,818,109,751,631,172,542,638,133,814,441,621,934,386,253]


π”¬ Encoder Diversity (iter 17760):
  Avg similarity: 0.0524 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 27/100] [Batch 376/669 (56.2%)] [Iter 17770] Loss: 1.0343 (freq: 0.3409, raw: 0.6925, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[556,386,747,711,878,133,751,559,814,289,632,106,325,342,228]


π”¬ Encoder Diversity (iter 17770):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 27/100] [Batch 386/669 (57.7%)] [Iter 17780] Loss: 0.9274 (freq: 0.3258, raw: 0.6008, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[556,386,94,40,698,818,3,545,868,621,165,222,884,559,375]


π”¬ Encoder Diversity (iter 17780):
  Avg similarity: 0.0281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 27/100] [Batch 396/669 (59.2%)] [Iter 17790] Loss: 0.9628 (freq: 0.3531, raw: 0.6089, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 913/1024 (89.2%) Top5:[556,342,386,818,407,830,94,228,165,612,983,40,678,656,64]


π”¬ Encoder Diversity (iter 17790):
  Avg similarity: 0.0697 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9545 (0.0=collapsed)
[Epoch 27/100] [Batch 406/669 (60.7%)] [Iter 17800] Loss: 0.9406 (freq: 0.3077, raw: 0.6321, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[487,94,934,747,983,407,559,228,868,342,556,678,814,299,447]


π”¬ Encoder Diversity (iter 17800):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 27/100] [Batch 416/669 (62.2%)] [Iter 17810] Loss: 1.2177 (freq: 0.4580, raw: 0.7588, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[106,747,228,559,558,844,441,647,602,631,979,61,800,823,732]


π”¬ Encoder Diversity (iter 17810):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 27/100] [Batch 426/669 (63.7%)] [Iter 17820] Loss: 1.0137 (freq: 0.3496, raw: 0.6634, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[542,172,689,386,336,818,781,638,286,595,844,375,800,602,109]


π”¬ Encoder Diversity (iter 17820):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 27/100] [Batch 436/669 (65.2%)] [Iter 17830] Loss: 1.2454 (freq: 0.4992, raw: 0.7452, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[222,542,730,595,94,64,342,446,237,818,681,172,556,375,246]


π”¬ Encoder Diversity (iter 17830):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 27/100] [Batch 446/669 (66.7%)] [Iter 17840] Loss: 1.0708 (freq: 0.3878, raw: 0.6822, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[94,493,386,556,246,818,678,901,91,289,299,446,934,602,222]


π”¬ Encoder Diversity (iter 17840):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9545 (0.0=collapsed)
[Epoch 27/100] [Batch 456/669 (68.2%)] [Iter 17850] Loss: 0.8982 (freq: 0.3220, raw: 0.5754, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[447,94,109,631,542,818,781,638,949,228,336,300,923,689,106]


π”¬ Encoder Diversity (iter 17850):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 27/100] [Batch 466/669 (69.7%)] [Iter 17860] Loss: 0.8965 (freq: 0.2737, raw: 0.6221, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[949,185,656,447,595,228,789,830,638,818,109,89,814,449,747]


π”¬ Encoder Diversity (iter 17860):
  Avg similarity: 0.0280 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 27/100] [Batch 476/669 (71.2%)] [Iter 17870] Loss: 1.1763 (freq: 0.4483, raw: 0.7271, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[901,94,185,222,789,556,299,602,300,815,474,818,814,447,89]


π”¬ Encoder Diversity (iter 17870):
  Avg similarity: 0.0235 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 27/100] [Batch 486/669 (72.6%)] [Iter 17880] Loss: 1.4525 (freq: 0.5444, raw: 0.9071, quant: 0.0010, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[747,165,979,751,638,823,514,923,621,830,419,296,901,631,556]


π”¬ Encoder Diversity (iter 17880):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 27/100] [Batch 496/669 (74.1%)] [Iter 17890] Loss: 1.0303 (freq: 0.3630, raw: 0.6664, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[559,165,983,736,514,653,747,689,73,296,386,289,612,299,998]


π”¬ Encoder Diversity (iter 17890):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 27/100] [Batch 506/669 (75.6%)] [Iter 17900] Loss: 1.0211 (freq: 0.3688, raw: 0.6514, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[751,165,514,678,474,89,299,559,818,8,317,232,289,446,949]


π”¬ Encoder Diversity (iter 17900):
  Avg similarity: 0.0203 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 27/100] [Batch 516/669 (77.1%)] [Iter 17910] Loss: 1.0040 (freq: 0.3415, raw: 0.6617, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[710,949,447,818,336,602,747,8,228,800,689,52,631,559,419]


π”¬ Encoder Diversity (iter 17910):
  Avg similarity: 0.0524 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 27/100] [Batch 526/669 (78.6%)] [Iter 17920] Loss: 1.2753 (freq: 0.4527, raw: 0.8217, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[751,901,747,678,764,299,8,559,949,934,447,133,296,91,446]


π”¬ Encoder Diversity (iter 17920):
  Avg similarity: 0.0393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 27/100] [Batch 536/669 (80.1%)] [Iter 17930] Loss: 1.0342 (freq: 0.3399, raw: 0.6936, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[901,818,631,730,595,656,447,336,638,185,542,407,419,621,94]


π”¬ Encoder Diversity (iter 17930):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 27/100] [Batch 546/669 (81.6%)] [Iter 17940] Loss: 0.9763 (freq: 0.3692, raw: 0.6063, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[356,862,577,934,106,631,64,474,559,185,257,818,678,299,165]


π”¬ Encoder Diversity (iter 17940):
  Avg similarity: 0.0269 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 27/100] [Batch 556/669 (83.1%)] [Iter 17950] Loss: 0.8771 (freq: 0.2742, raw: 0.6021, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[447,257,923,979,61,818,939,228,949,283,747,13,407,336,106]


π”¬ Encoder Diversity (iter 17950):
  Avg similarity: 0.0576 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 27/100] [Batch 566/669 (84.6%)] [Iter 17960] Loss: 1.0389 (freq: 0.3830, raw: 0.6551, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[818,690,185,631,559,106,299,545,901,89,228,610,300,751,602]


π”¬ Encoder Diversity (iter 17960):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 27/100] [Batch 576/669 (86.1%)] [Iter 17970] Loss: 1.2044 (freq: 0.4429, raw: 0.7605, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[602,818,901,447,474,40,222,610,678,296,631,632,228,185,454]


π”¬ Encoder Diversity (iter 17970):
  Avg similarity: 0.0783 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 27/100] [Batch 586/669 (87.6%)] [Iter 17980] Loss: 1.0977 (freq: 0.4077, raw: 0.6891, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[901,299,454,909,222,514,91,917,979,619,165,449,928,678,632]


π”¬ Encoder Diversity (iter 17980):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 27/100] [Batch 596/669 (89.1%)] [Iter 17990] Loss: 1.2249 (freq: 0.4509, raw: 0.7732, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[559,64,446,747,474,447,935,909,246,145,283,13,299,407,729]


π”¬ Encoder Diversity (iter 17990):
  Avg similarity: 0.0754 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 27/100] [Batch 606/669 (90.6%)] [Iter 18000] Loss: 1.1347 (freq: 0.3966, raw: 0.7372, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[407,228,653,185,40,631,514,94,299,64,109,818,419,901,89]


π”¬ Encoder Diversity (iter 18000):
  Avg similarity: 0.0411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 27/100] [Batch 616/669 (92.1%)] [Iter 18010] Loss: 1.0644 (freq: 0.3757, raw: 0.6879, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[64,823,830,185,818,61,522,602,145,862,386,747,983,40,133]


π”¬ Encoder Diversity (iter 18010):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 27/100] [Batch 626/669 (93.6%)] [Iter 18020] Loss: 1.1644 (freq: 0.4018, raw: 0.7617, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[407,46,133,751,983,94,89,91,165,299,979,868,419,342,901]


π”¬ Encoder Diversity (iter 18020):
  Avg similarity: 0.0322 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 27/100] [Batch 636/669 (95.1%)] [Iter 18030] Loss: 1.1866 (freq: 0.4312, raw: 0.7546, quant: 0.0009, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[185,751,862,764,818,407,533,868,631,419,447,671,602,289,280]


π”¬ Encoder Diversity (iter 18030):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 27/100] [Batch 646/669 (96.6%)] [Iter 18040] Loss: 0.9858 (freq: 0.3530, raw: 0.6320, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[185,133,145,934,747,407,577,342,300,64,638,89,454,106,94]


π”¬ Encoder Diversity (iter 18040):
  Avg similarity: 0.0309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 27/100] [Batch 656/669 (98.1%)] [Iter 18050] Loss: 1.0450 (freq: 0.3580, raw: 0.6862, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[145,542,638,165,296,923,949,809,283,747,736,814,556,446,64]


π”¬ Encoder Diversity (iter 18050):
  Avg similarity: 0.0621 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 27/100] [Batch 666/669 (99.6%)] [Iter 18060] Loss: 1.2673 (freq: 0.4444, raw: 0.8220, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[375,901,342,165,228,830,545,645,185,222,625,454,818,267,253]


π”¬ Encoder Diversity (iter 18060):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)

================================================================================
[Epoch 27] Validation Results:
  Total Loss: 0.5557
  Freq Loss:  0.1670
  Raw Loss:   0.3879
  Quant Loss: 0.0008
  π“ Codebook Usage: 626/1024 (61.1%)
  π“ Codebook Entropy: 5.2044 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 23768 (18.3%)
  Top 10 most used codes:
    1. Code 582: 3017 times (2.32%)
    2. Code 809: 2725 times (2.09%)
    3. Code 3: 2718 times (2.09%)
    4. Code 610: 2629 times (2.02%)
    5. Code 283: 2221 times (1.71%)
    6. Code 749: 2207 times (1.70%)
    7. Code 939: 2185 times (1.68%)
    8. Code 9: 2069 times (1.59%)
    9. Code 656: 2062 times (1.58%)
    10. Code 513: 1935 times (1.49%)
  Bottom 5 least used codes (among used):
    1. Code 45: 1 times (0.00%)
    2. Code 977: 2 times (0.00%)
    3. Code 288: 2 times (0.00%)
    4. Code 516: 3 times (0.00%)
    5. Code 329: 5 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 27
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 28/100] [Batch 7/669 (1.0%)] [Iter 18070] Loss: 1.0930 (freq: 0.3963, raw: 0.6957, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 1007/1024 (98.3%) Top5:[145,447,602,818,300,65,228,923,1020,185,736,542,844,830,253]


π”¬ Encoder Diversity (iter 18070):
  Avg similarity: 0.0326 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 28/100] [Batch 17/669 (2.5%)] [Iter 18080] Loss: 1.1512 (freq: 0.4086, raw: 0.7416, quant: 0.0010, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 935/1024 (91.3%) Top5:[685,979,4,919,389,736,489,818,230,505,237,164,564,747,337]


π”¬ Encoder Diversity (iter 18080):
  Avg similarity: 0.0505 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 28/100] [Batch 27/669 (4.0%)] [Iter 18090] Loss: 1.0683 (freq: 0.4037, raw: 0.6637, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[185,602,486,389,228,818,610,949,1003,631,844,739,564,709,823]


π”¬ Encoder Diversity (iter 18090):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 28/100] [Batch 37/669 (5.5%)] [Iter 18100] Loss: 1.3124 (freq: 0.5027, raw: 0.8089, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[818,747,862,979,447,923,185,1020,610,228,602,638,748,145,513]


π”¬ Encoder Diversity (iter 18100):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 28/100] [Batch 47/669 (7.0%)] [Iter 18110] Loss: 1.0079 (freq: 0.3236, raw: 0.6835, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[505,185,447,818,889,145,164,979,254,4,747,732,1019,631,228]


π”¬ Encoder Diversity (iter 18110):
  Avg similarity: 0.0758 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9530 (0.0=collapsed)
[Epoch 28/100] [Batch 57/669 (8.5%)] [Iter 18120] Loss: 0.9327 (freq: 0.3153, raw: 0.6166, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[979,109,818,145,300,649,610,447,513,232,747,61,823,732,181]


π”¬ Encoder Diversity (iter 18120):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 28/100] [Batch 67/669 (10.0%)] [Iter 18130] Loss: 1.1652 (freq: 0.4079, raw: 0.7564, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[50,4,8,722,747,889,447,109,118,505,818,20,58,330,631]


π”¬ Encoder Diversity (iter 18130):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 28/100] [Batch 77/669 (11.5%)] [Iter 18140] Loss: 1.0963 (freq: 0.4313, raw: 0.6642, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[267,447,8,556,818,979,747,38,823,164,13,545,939,237,182]


π”¬ Encoder Diversity (iter 18140):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 28/100] [Batch 87/669 (13.0%)] [Iter 18150] Loss: 0.9314 (freq: 0.2781, raw: 0.6524, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[254,4,439,185,862,389,939,228,949,818,58,564,1019,283,330]


π”¬ Encoder Diversity (iter 18150):
  Avg similarity: 0.0316 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 28/100] [Batch 97/669 (14.5%)] [Iter 18160] Loss: 1.1728 (freq: 0.4129, raw: 0.7590, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[602,185,49,638,648,545,267,949,26,505,823,109,612,889,268]


π”¬ Encoder Diversity (iter 18160):
  Avg similarity: 0.0565 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 28/100] [Batch 107/669 (16.0%)] [Iter 18170] Loss: 1.0565 (freq: 0.3715, raw: 0.6842, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[889,505,602,254,345,1019,159,50,164,698,134,4,268,54,953]


π”¬ Encoder Diversity (iter 18170):
  Avg similarity: 0.0632 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 28/100] [Batch 117/669 (17.5%)] [Iter 18180] Loss: 0.9398 (freq: 0.3439, raw: 0.5951, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[78,254,447,331,44,698,709,862,953,182,4,442,648,768,330]


π”¬ Encoder Diversity (iter 18180):
  Avg similarity: 0.0460 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 28/100] [Batch 127/669 (19.0%)] [Iter 18190] Loss: 1.2141 (freq: 0.4371, raw: 0.7762, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[185,862,331,345,631,953,78,709,648,20,101,722,844,823,58]


π”¬ Encoder Diversity (iter 18190):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 28/100] [Batch 137/669 (20.5%)] [Iter 18200] Loss: 0.9912 (freq: 0.3745, raw: 0.6157, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[818,345,331,134,300,61,862,228,698,38,1019,254,389,439,50]


π”¬ Encoder Diversity (iter 18200):
  Avg similarity: 0.1063 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9369 (0.0=collapsed)
[Epoch 28/100] [Batch 147/669 (22.0%)] [Iter 18210] Loss: 0.8461 (freq: 0.2782, raw: 0.5671, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[4,889,954,1019,254,795,230,698,505,50,185,134,1003,8,58]


π”¬ Encoder Diversity (iter 18210):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 28/100] [Batch 157/669 (23.5%)] [Iter 18220] Loss: 1.2536 (freq: 0.4397, raw: 0.8130, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[254,118,889,230,54,58,564,8,159,164,698,862,205,505,4]


π”¬ Encoder Diversity (iter 18220):
  Avg similarity: 0.0543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)
[Epoch 28/100] [Batch 167/669 (25.0%)] [Iter 18230] Loss: 1.1975 (freq: 0.4612, raw: 0.7353, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[505,442,164,722,804,26,345,889,230,58,564,389,8,932,54]


π”¬ Encoder Diversity (iter 18230):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 28/100] [Batch 177/669 (26.5%)] [Iter 18240] Loss: 0.9576 (freq: 0.3322, raw: 0.6246, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[818,787,612,656,447,862,827,923,212,691,747,345,109,1015,638]


π”¬ Encoder Diversity (iter 18240):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 28/100] [Batch 187/669 (28.0%)] [Iter 18250] Loss: 1.1856 (freq: 0.4192, raw: 0.7655, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[439,889,954,818,653,134,447,345,939,254,407,505,830,54,4]


π”¬ Encoder Diversity (iter 18250):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 28/100] [Batch 197/669 (29.4%)] [Iter 18260] Loss: 0.9783 (freq: 0.3583, raw: 0.6192, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[818,691,732,447,439,862,844,4,345,1015,859,949,653,830,656]


π”¬ Encoder Diversity (iter 18260):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 28/100] [Batch 207/669 (30.9%)] [Iter 18270] Loss: 0.7380 (freq: 0.2314, raw: 0.5058, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[889,134,205,334,425,109,185,331,58,183,612,61,54,212,118]


π”¬ Encoder Diversity (iter 18270):
  Avg similarity: 0.0636 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 28/100] [Batch 217/669 (32.4%)] [Iter 18280] Loss: 1.1010 (freq: 0.3819, raw: 0.7182, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[818,691,185,844,334,638,159,447,15,109,999,656,722,26,612]


π”¬ Encoder Diversity (iter 18280):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 28/100] [Batch 227/669 (33.9%)] [Iter 18290] Loss: 1.2080 (freq: 0.4603, raw: 0.7468, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[4,183,954,889,134,648,254,8,50,389,818,230,454,164,564]


π”¬ Encoder Diversity (iter 18290):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9520 (0.0=collapsed)
[Epoch 28/100] [Batch 237/669 (35.4%)] [Iter 18300] Loss: 1.3096 (freq: 0.4593, raw: 0.8494, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[4,454,230,954,134,447,185,26,389,44,345,571,949,212,698]


π”¬ Encoder Diversity (iter 18300):
  Avg similarity: 0.0603 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 28/100] [Batch 247/669 (36.9%)] [Iter 18310] Loss: 0.9550 (freq: 0.3594, raw: 0.5948, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[8,818,691,345,185,862,709,447,26,722,254,164,489,132,771]


π”¬ Encoder Diversity (iter 18310):
  Avg similarity: 0.0369 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 28/100] [Batch 257/669 (38.4%)] [Iter 18320] Loss: 1.1167 (freq: 0.3783, raw: 0.7376, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[345,1019,159,164,168,685,564,442,50,889,331,919,212,205,612]


π”¬ Encoder Diversity (iter 18320):
  Avg similarity: 0.0705 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 28/100] [Batch 267/669 (39.9%)] [Iter 18330] Loss: 1.1878 (freq: 0.4244, raw: 0.7625, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[1019,954,58,101,8,442,134,447,159,731,389,505,183,949,4]


π”¬ Encoder Diversity (iter 18330):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 28/100] [Batch 277/669 (41.4%)] [Iter 18340] Loss: 1.0054 (freq: 0.3167, raw: 0.6879, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[954,1003,50,889,58,723,447,145,237,134,862,26,450,183,4]


π”¬ Encoder Diversity (iter 18340):
  Avg similarity: 0.0520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 28/100] [Batch 287/669 (42.9%)] [Iter 18350] Loss: 1.4147 (freq: 0.5075, raw: 0.9063, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[447,489,118,889,58,230,954,110,54,389,818,917,795,827,4]


π”¬ Encoder Diversity (iter 18350):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 28/100] [Batch 297/669 (44.4%)] [Iter 18360] Loss: 1.3072 (freq: 0.4708, raw: 0.8355, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[454,954,204,862,44,923,58,1003,345,859,582,722,1020,656,489]


π”¬ Encoder Diversity (iter 18360):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 28/100] [Batch 307/669 (45.9%)] [Iter 18370] Loss: 1.3118 (freq: 0.4669, raw: 0.8440, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[1019,291,230,656,489,159,859,345,923,54,454,648,439,232,4]


π”¬ Encoder Diversity (iter 18370):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 28/100] [Batch 317/669 (47.4%)] [Iter 18380] Loss: 1.2826 (freq: 0.4173, raw: 0.8643, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[4,889,58,101,994,656,334,862,505,50,204,489,954,844,774]


π”¬ Encoder Diversity (iter 18380):
  Avg similarity: 0.0266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 28/100] [Batch 327/669 (48.9%)] [Iter 18390] Loss: 0.8216 (freq: 0.2933, raw: 0.5275, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[442,204,691,859,612,1015,889,159,447,168,923,101,545,50,26]


π”¬ Encoder Diversity (iter 18390):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 28/100] [Batch 337/669 (50.4%)] [Iter 18400] Loss: 1.1627 (freq: 0.4255, raw: 0.7364, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[774,786,4,564,134,8,954,889,442,454,530,1020,177,254,26]


π”¬ Encoder Diversity (iter 18400):
  Avg similarity: 0.0967 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9525 (0.0=collapsed)
[Epoch 28/100] [Batch 347/669 (51.9%)] [Iter 18410] Loss: 1.0594 (freq: 0.3615, raw: 0.6970, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[4,889,698,50,723,110,954,254,78,818,862,109,159,134,8]


π”¬ Encoder Diversity (iter 18410):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 28/100] [Batch 357/669 (53.4%)] [Iter 18420] Loss: 1.1810 (freq: 0.4396, raw: 0.7406, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[818,862,4,638,109,954,844,612,345,994,185,237,747,648,545]


π”¬ Encoder Diversity (iter 18420):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 28/100] [Batch 367/669 (54.9%)] [Iter 18430] Loss: 1.1502 (freq: 0.4266, raw: 0.7226, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 753/1024 (73.5%) Top5:[204,818,246,862,674,493,844,777,3,191,185,612,917,908,847]


π”¬ Encoder Diversity (iter 18430):
  Avg similarity: 0.0266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 28/100] [Batch 377/669 (56.4%)] [Iter 18440] Loss: 1.3602 (freq: 0.5303, raw: 0.8289, quant: 0.0010, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[4,447,78,994,254,612,295,638,185,862,818,908,631,545,844]


π”¬ Encoder Diversity (iter 18440):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 28/100] [Batch 387/669 (57.8%)] [Iter 18450] Loss: 1.0380 (freq: 0.3521, raw: 0.6850, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[731,185,4,954,254,722,168,908,447,164,818,295,889,810,389]


π”¬ Encoder Diversity (iter 18450):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 28/100] [Batch 397/669 (59.3%)] [Iter 18460] Loss: 1.2482 (freq: 0.4554, raw: 0.7919, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[818,185,954,4,638,726,109,1019,204,447,994,145,747,862,674]


π”¬ Encoder Diversity (iter 18460):
  Avg similarity: 0.0670 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 28/100] [Batch 407/669 (60.8%)] [Iter 18470] Loss: 0.9319 (freq: 0.3039, raw: 0.6272, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 787/1024 (76.9%) Top5:[185,818,638,812,447,204,334,602,1015,810,612,830,908,631,246]


π”¬ Encoder Diversity (iter 18470):
  Avg similarity: 0.0441 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 28/100] [Batch 417/669 (62.3%)] [Iter 18480] Loss: 1.2221 (freq: 0.4537, raw: 0.7674, quant: 0.0010, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[4,134,818,1019,889,26,204,345,8,674,54,726,118,177,13]


π”¬ Encoder Diversity (iter 18480):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 28/100] [Batch 427/669 (63.8%)] [Iter 18490] Loss: 1.0522 (freq: 0.3686, raw: 0.6827, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[612,818,889,954,631,830,726,334,496,185,109,254,994,844,330]


π”¬ Encoder Diversity (iter 18490):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 28/100] [Batch 437/669 (65.3%)] [Iter 18500] Loss: 1.1320 (freq: 0.3933, raw: 0.7379, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[954,889,345,44,26,50,20,230,442,4,78,564,786,1020,212]


π”¬ Encoder Diversity (iter 18500):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 28/100] [Batch 447/669 (66.8%)] [Iter 18510] Loss: 0.9417 (freq: 0.3378, raw: 0.6031, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[612,185,545,496,76,447,638,818,118,685,334,168,489,862,954]


π”¬ Encoder Diversity (iter 18510):
  Avg similarity: 0.0237 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 28/100] [Batch 457/669 (68.3%)] [Iter 18520] Loss: 0.8737 (freq: 0.2874, raw: 0.5855, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[185,954,722,212,818,1015,862,889,454,54,182,830,153,787,422]


π”¬ Encoder Diversity (iter 18520):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 28/100] [Batch 467/669 (69.8%)] [Iter 18530] Loss: 1.2868 (freq: 0.4857, raw: 0.8002, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[345,118,810,954,889,489,4,334,134,496,818,1019,812,58,164]


π”¬ Encoder Diversity (iter 18530):
  Avg similarity: 0.0735 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 28/100] [Batch 477/669 (71.3%)] [Iter 18540] Loss: 0.9289 (freq: 0.3188, raw: 0.6092, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[818,185,638,145,221,1015,871,726,862,204,631,179,134,632,613]


π”¬ Encoder Diversity (iter 18540):
  Avg similarity: 0.0557 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 28/100] [Batch 487/669 (72.8%)] [Iter 18550] Loss: 1.1636 (freq: 0.4090, raw: 0.7537, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[818,221,200,726,638,163,862,422,731,185,134,308,849,747,204]


π”¬ Encoder Diversity (iter 18550):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 28/100] [Batch 497/669 (74.3%)] [Iter 18560] Loss: 1.1228 (freq: 0.4239, raw: 0.6979, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[726,818,204,200,613,908,747,476,955,777,862,185,145,954,45]


π”¬ Encoder Diversity (iter 18560):
  Avg similarity: 0.0277 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 28/100] [Batch 507/669 (75.8%)] [Iter 18570] Loss: 0.9412 (freq: 0.3272, raw: 0.6131, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[447,185,612,822,961,818,810,849,613,631,698,118,345,954,862]


π”¬ Encoder Diversity (iter 18570):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 28/100] [Batch 517/669 (77.3%)] [Iter 18580] Loss: 1.0172 (freq: 0.3494, raw: 0.6670, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[747,955,818,871,613,612,476,862,726,145,447,638,127,185,200]


π”¬ Encoder Diversity (iter 18580):
  Avg similarity: 0.0328 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 28/100] [Batch 527/669 (78.8%)] [Iter 18590] Loss: 1.1111 (freq: 0.3755, raw: 0.7347, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[345,954,134,501,384,8,889,183,50,26,98,330,726,822,118]


π”¬ Encoder Diversity (iter 18590):
  Avg similarity: 0.0571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 28/100] [Batch 537/669 (80.3%)] [Iter 18600] Loss: 1.1926 (freq: 0.4295, raw: 0.7623, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[4,134,889,786,501,58,489,78,50,183,54,118,564,685,26]


π”¬ Encoder Diversity (iter 18600):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 28/100] [Batch 547/669 (81.8%)] [Iter 18610] Loss: 1.2009 (freq: 0.4381, raw: 0.7619, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[345,442,212,830,330,818,709,786,613,498,889,544,731,638,612]


π”¬ Encoder Diversity (iter 18610):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 28/100] [Batch 557/669 (83.3%)] [Iter 18620] Loss: 1.1539 (freq: 0.3757, raw: 0.7773, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[954,159,889,50,118,345,26,134,110,58,200,818,726,78,212]


π”¬ Encoder Diversity (iter 18620):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 28/100] [Batch 567/669 (84.8%)] [Iter 18630] Loss: 0.9259 (freq: 0.2939, raw: 0.6312, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[818,185,908,612,955,726,862,1011,830,954,638,58,204,737,631]


π”¬ Encoder Diversity (iter 18630):
  Avg similarity: 0.0267 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 28/100] [Batch 577/669 (86.2%)] [Iter 18640] Loss: 1.2357 (freq: 0.4595, raw: 0.7754, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[818,726,501,889,134,58,345,954,45,777,822,127,8,955,212]


π”¬ Encoder Diversity (iter 18640):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 28/100] [Batch 587/669 (87.7%)] [Iter 18650] Loss: 0.8617 (freq: 0.3019, raw: 0.5590, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[818,726,955,185,908,822,631,638,8,801,862,145,923,889,830]


π”¬ Encoder Diversity (iter 18650):
  Avg similarity: 0.0384 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 28/100] [Batch 597/669 (89.2%)] [Iter 18660] Loss: 1.2523 (freq: 0.4178, raw: 0.8336, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[4,489,889,862,726,801,185,954,777,183,955,818,907,697,153]


π”¬ Encoder Diversity (iter 18660):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 28/100] [Batch 607/669 (90.7%)] [Iter 18670] Loss: 0.9416 (freq: 0.3024, raw: 0.6383, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[818,726,134,955,889,786,613,908,4,50,862,58,923,422,8]


π”¬ Encoder Diversity (iter 18670):
  Avg similarity: 0.0320 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 28/100] [Batch 617/669 (92.2%)] [Iter 18680] Loss: 0.7306 (freq: 0.2087, raw: 0.5212, quant: 0.0008, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[185,110,955,889,200,134,726,4,58,50,818,536,862,1011,127]


π”¬ Encoder Diversity (iter 18680):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 28/100] [Batch 627/669 (93.7%)] [Iter 18690] Loss: 1.1551 (freq: 0.4346, raw: 0.7196, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[134,8,58,345,889,501,731,630,50,4,110,489,564,454,183]


π”¬ Encoder Diversity (iter 18690):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 28/100] [Batch 637/669 (95.2%)] [Iter 18700] Loss: 1.0433 (freq: 0.3291, raw: 0.7133, quant: 0.0009, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[345,682,501,709,499,384,489,698,118,422,630,230,544,58,726]


π”¬ Encoder Diversity (iter 18700):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 28/100] [Batch 647/669 (96.7%)] [Iter 18710] Loss: 1.2794 (freq: 0.4844, raw: 0.7941, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[166,134,118,889,954,498,153,786,58,818,110,177,489,463,955]


π”¬ Encoder Diversity (iter 18710):
  Avg similarity: 0.0615 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 28/100] [Batch 657/669 (98.2%)] [Iter 18720] Loss: 0.7471 (freq: 0.2437, raw: 0.5026, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[955,613,185,8,818,638,631,889,737,1015,830,758,801,168,297]


π”¬ Encoder Diversity (iter 18720):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 28/100] [Batch 667/669 (99.7%)] [Iter 18730] Loss: 0.8702 (freq: 0.2964, raw: 0.5729, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[889,818,134,786,758,345,164,501,955,536,709,188,489,638,613]


π”¬ Encoder Diversity (iter 18730):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)

================================================================================
[Epoch 28] Validation Results:
  Total Loss: 0.5675
  Freq Loss:  0.1667
  Raw Loss:   0.4000
  Quant Loss: 0.0008
  π“ Codebook Usage: 384/1024 (37.5%)
  π“ Codebook Entropy: 4.6245 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 30879 (23.7%)
  Top 10 most used codes:
    1. Code 1011: 4160 times (3.20%)
    2. Code 188: 3707 times (2.85%)
    3. Code 612: 3403 times (2.61%)
    4. Code 297: 3065 times (2.35%)
    5. Code 923: 3028 times (2.33%)
    6. Code 613: 2862 times (2.20%)
    7. Code 955: 2737 times (2.10%)
    8. Code 76: 2711 times (2.08%)
    9. Code 670: 2650 times (2.04%)
    10. Code 638: 2556 times (1.96%)
  Bottom 5 least used codes (among used):
    1. Code 978: 1 times (0.00%)
    2. Code 780: 1 times (0.00%)
    3. Code 201: 1 times (0.00%)
    4. Code 680: 2 times (0.00%)
    5. Code 559: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 29/100] [Batch 8/669 (1.2%)] [Iter 18740] Loss: 0.9009 (freq: 0.2984, raw: 0.6016, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[631,818,3,964,1001,638,185,862,801,830,726,908,613,1003,548]


π”¬ Encoder Diversity (iter 18740):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 29/100] [Batch 18/669 (2.7%)] [Iter 18750] Loss: 0.8133 (freq: 0.2733, raw: 0.5391, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[862,955,535,818,758,145,638,612,200,891,1011,801,1001,871,188]


π”¬ Encoder Diversity (iter 18750):
  Avg similarity: 0.0689 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 29/100] [Batch 28/669 (4.2%)] [Iter 18760] Loss: 1.0785 (freq: 0.3755, raw: 0.7022, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[385,682,891,691,13,440,315,413,818,1003,524,231,726,18,796]


π”¬ Encoder Diversity (iter 18760):
  Avg similarity: 0.0347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 29/100] [Batch 38/669 (5.7%)] [Iter 18770] Loss: 1.2101 (freq: 0.4341, raw: 0.7751, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[818,440,423,161,18,1003,891,74,1019,1011,894,964,267,524,655]


π”¬ Encoder Diversity (iter 18770):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 29/100] [Batch 48/669 (7.2%)] [Iter 18780] Loss: 1.2006 (freq: 0.4462, raw: 0.7535, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[440,758,161,726,1018,1015,74,385,13,818,241,12,1011,535,334]


π”¬ Encoder Diversity (iter 18780):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 29/100] [Batch 58/669 (8.7%)] [Iter 18790] Loss: 1.3829 (freq: 0.5144, raw: 0.8675, quant: 0.0010, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[796,524,13,891,691,323,635,161,818,413,74,875,963,385,408]


π”¬ Encoder Diversity (iter 18790):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 29/100] [Batch 68/669 (10.2%)] [Iter 18800] Loss: 0.9520 (freq: 0.3114, raw: 0.6397, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[726,818,862,955,1015,631,584,13,747,323,618,535,837,70,476]


π”¬ Encoder Diversity (iter 18800):
  Avg similarity: 0.0245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 29/100] [Batch 78/669 (11.7%)] [Iter 18810] Loss: 1.3282 (freq: 0.5101, raw: 0.8171, quant: 0.0010, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[796,691,726,440,765,161,315,535,635,185,818,223,1015,1011,591]


π”¬ Encoder Diversity (iter 18810):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 29/100] [Batch 88/669 (13.2%)] [Iter 18820] Loss: 1.3265 (freq: 0.5085, raw: 0.8171, quant: 0.0010, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[440,847,161,1018,631,315,584,891,837,385,13,568,796,682,371]


π”¬ Encoder Diversity (iter 18820):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 29/100] [Batch 98/669 (14.6%)] [Iter 18830] Loss: 0.8918 (freq: 0.3044, raw: 0.5866, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[535,584,76,161,613,960,223,818,801,429,891,334,12,280,70]


π”¬ Encoder Diversity (iter 18830):
  Avg similarity: 0.0322 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 29/100] [Batch 108/669 (16.1%)] [Iter 18840] Loss: 1.1890 (freq: 0.4221, raw: 0.7660, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[747,161,796,298,385,818,315,440,726,863,408,70,682,535,323]


π”¬ Encoder Diversity (iter 18840):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 29/100] [Batch 118/669 (17.6%)] [Iter 18850] Loss: 1.0913 (freq: 0.3928, raw: 0.6977, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[535,955,62,469,297,613,70,223,429,818,631,18,12,837,298]


π”¬ Encoder Diversity (iter 18850):
  Avg similarity: 0.0512 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 29/100] [Batch 128/669 (19.1%)] [Iter 18860] Loss: 1.3277 (freq: 0.4488, raw: 0.8779, quant: 0.0010, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[796,875,440,837,27,542,568,691,13,62,908,765,535,684,584]


π”¬ Encoder Diversity (iter 18860):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 29/100] [Batch 138/669 (20.6%)] [Iter 18870] Loss: 1.1458 (freq: 0.4042, raw: 0.7407, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[818,796,631,862,955,18,591,74,535,185,385,35,161,70,469]


π”¬ Encoder Diversity (iter 18870):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 29/100] [Batch 148/669 (22.1%)] [Iter 18880] Loss: 1.2204 (freq: 0.4847, raw: 0.7347, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[862,267,818,591,469,758,62,297,70,61,1015,76,613,830,185]


π”¬ Encoder Diversity (iter 18880):
  Avg similarity: 0.0745 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)
[Epoch 29/100] [Batch 158/669 (23.6%)] [Iter 18890] Loss: 1.3274 (freq: 0.5244, raw: 0.8020, quant: 0.0010, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[371,837,726,385,161,461,408,584,45,862,70,13,818,694,914]


π”¬ Encoder Diversity (iter 18890):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 29/100] [Batch 168/669 (25.1%)] [Iter 18900] Loss: 1.3346 (freq: 0.5135, raw: 0.8201, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[818,862,161,847,385,758,837,207,185,631,334,13,987,584,568]


π”¬ Encoder Diversity (iter 18900):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 29/100] [Batch 178/669 (26.6%)] [Iter 18910] Loss: 1.0389 (freq: 0.3507, raw: 0.6874, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[837,440,875,584,612,161,613,682,862,542,70,207,568,127,694]


π”¬ Encoder Diversity (iter 18910):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 29/100] [Batch 188/669 (28.1%)] [Iter 18920] Loss: 1.0636 (freq: 0.3909, raw: 0.6719, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[385,875,440,988,413,987,185,796,161,62,223,386,862,535,18]


π”¬ Encoder Diversity (iter 18920):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 29/100] [Batch 198/669 (29.6%)] [Iter 18930] Loss: 1.1888 (freq: 0.4108, raw: 0.7772, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[818,74,161,647,429,13,542,568,689,871,334,691,613,432,70]


π”¬ Encoder Diversity (iter 18930):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 29/100] [Batch 208/669 (31.1%)] [Iter 18940] Loss: 0.8836 (freq: 0.2629, raw: 0.6199, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[385,323,538,568,796,74,917,691,61,987,231,27,13,606,440]


π”¬ Encoder Diversity (iter 18940):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 29/100] [Batch 218/669 (32.6%)] [Iter 18950] Loss: 1.0972 (freq: 0.4162, raw: 0.6801, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[818,466,70,469,726,613,280,747,535,27,631,82,871,891,13]


π”¬ Encoder Diversity (iter 18950):
  Avg similarity: 0.0462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 29/100] [Batch 228/669 (34.1%)] [Iter 18960] Loss: 1.3598 (freq: 0.5360, raw: 0.8229, quant: 0.0010, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[440,837,13,818,437,796,584,758,891,371,862,432,833,385,469]


π”¬ Encoder Diversity (iter 18960):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 29/100] [Batch 238/669 (35.6%)] [Iter 18970] Loss: 1.2647 (freq: 0.4258, raw: 0.8380, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[542,847,538,27,323,758,385,371,647,747,400,837,440,631,513]


π”¬ Encoder Diversity (iter 18970):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 29/100] [Batch 248/669 (37.1%)] [Iter 18980] Loss: 0.9824 (freq: 0.2882, raw: 0.6933, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[185,862,440,837,161,385,942,682,524,13,27,847,70,818,371]


π”¬ Encoder Diversity (iter 18980):
  Avg similarity: 0.0496 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 29/100] [Batch 258/669 (38.6%)] [Iter 18990] Loss: 1.0376 (freq: 0.3357, raw: 0.7010, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[818,1011,631,185,385,758,765,27,70,694,939,457,613,231,13]


π”¬ Encoder Diversity (iter 18990):
  Avg similarity: 0.0954 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9439 (0.0=collapsed)
[Epoch 29/100] [Batch 268/669 (40.1%)] [Iter 19000] Loss: 1.1130 (freq: 0.3739, raw: 0.7382, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[385,837,27,440,315,432,682,875,568,231,689,161,917,606,74]


π”¬ Encoder Diversity (iter 19000):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 29/100] [Batch 278/669 (41.6%)] [Iter 19010] Loss: 1.0110 (freq: 0.3220, raw: 0.6882, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[847,267,231,1019,682,960,631,862,64,987,70,524,82,27,535]


π”¬ Encoder Diversity (iter 19010):
  Avg similarity: 0.0541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 29/100] [Batch 288/669 (43.0%)] [Iter 19020] Loss: 1.1183 (freq: 0.3722, raw: 0.7452, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[13,385,161,862,837,942,960,1021,27,988,241,74,1018,584,568]


π”¬ Encoder Diversity (iter 19020):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 29/100] [Batch 298/669 (44.5%)] [Iter 19030] Loss: 1.3008 (freq: 0.4785, raw: 0.8213, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[862,535,70,818,207,13,830,891,121,755,349,457,837,613,267]


π”¬ Encoder Diversity (iter 19030):
  Avg similarity: 0.0543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 29/100] [Batch 308/669 (46.0%)] [Iter 19040] Loss: 1.1841 (freq: 0.4219, raw: 0.7613, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[13,440,796,371,27,818,568,942,689,461,161,535,584,925,70]


π”¬ Encoder Diversity (iter 19040):
  Avg similarity: 0.0506 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 29/100] [Batch 318/669 (47.5%)] [Iter 19050] Loss: 1.1648 (freq: 0.4182, raw: 0.7458, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[818,10,278,779,70,755,61,1018,241,185,613,1015,1021,682,280]


π”¬ Encoder Diversity (iter 19050):
  Avg similarity: 0.0301 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 29/100] [Batch 328/669 (49.0%)] [Iter 19060] Loss: 0.8577 (freq: 0.2737, raw: 0.5832, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[796,13,241,533,440,682,837,818,691,385,1011,1015,988,231,185]


π”¬ Encoder Diversity (iter 19060):
  Avg similarity: 0.0276 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 29/100] [Batch 338/669 (50.5%)] [Iter 19070] Loss: 1.2589 (freq: 0.4585, raw: 0.7995, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[579,13,942,440,691,385,682,847,533,714,1002,1021,818,538,185]


π”¬ Encoder Diversity (iter 19070):
  Avg similarity: 0.0291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 29/100] [Batch 348/669 (52.0%)] [Iter 19080] Loss: 0.6803 (freq: 0.2182, raw: 0.4613, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[818,13,541,385,278,235,185,755,960,230,425,127,371,538,231]


π”¬ Encoder Diversity (iter 19080):
  Avg similarity: 0.0292 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 29/100] [Batch 358/669 (53.5%)] [Iter 19090] Loss: 1.0517 (freq: 0.3534, raw: 0.6975, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[818,524,207,371,694,387,1014,914,538,490,438,837,561,385,440]


π”¬ Encoder Diversity (iter 19090):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 29/100] [Batch 368/669 (55.0%)] [Iter 19100] Loss: 1.0491 (freq: 0.3618, raw: 0.6865, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[315,385,13,765,524,891,837,875,241,114,437,266,463,942,278]


π”¬ Encoder Diversity (iter 19100):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 29/100] [Batch 378/669 (56.5%)] [Iter 19110] Loss: 0.9217 (freq: 0.3361, raw: 0.5847, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[542,241,371,818,714,278,387,925,779,830,315,280,27,631,207]


π”¬ Encoder Diversity (iter 19110):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 29/100] [Batch 388/669 (58.0%)] [Iter 19120] Loss: 1.1767 (freq: 0.4304, raw: 0.7454, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[385,988,942,315,13,185,682,837,349,818,241,280,461,714,231]


π”¬ Encoder Diversity (iter 19120):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 29/100] [Batch 398/669 (59.5%)] [Iter 19130] Loss: 1.2098 (freq: 0.4305, raw: 0.7784, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[726,694,70,371,1014,818,871,862,1011,207,490,387,863,108,121]


π”¬ Encoder Diversity (iter 19130):
  Avg similarity: 0.0466 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 29/100] [Batch 408/669 (61.0%)] [Iter 19140] Loss: 1.1952 (freq: 0.4578, raw: 0.7365, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[385,584,682,837,13,891,875,988,250,606,533,315,613,689,541]


π”¬ Encoder Diversity (iter 19140):
  Avg similarity: 0.0414 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 29/100] [Batch 418/669 (62.5%)] [Iter 19150] Loss: 1.0691 (freq: 0.3893, raw: 0.6789, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[1015,818,387,185,1014,755,490,108,613,871,631,280,726,682,863]


π”¬ Encoder Diversity (iter 19150):
  Avg similarity: 0.0700 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 29/100] [Batch 428/669 (64.0%)] [Iter 19160] Loss: 1.0601 (freq: 0.3878, raw: 0.6714, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[315,27,726,818,942,914,43,891,542,74,440,837,682,349,241]


π”¬ Encoder Diversity (iter 19160):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 29/100] [Batch 438/669 (65.5%)] [Iter 19170] Loss: 1.2962 (freq: 0.4806, raw: 0.8147, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[1014,385,942,440,726,796,241,987,161,13,691,400,988,231,714]


π”¬ Encoder Diversity (iter 19170):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 29/100] [Batch 448/669 (67.0%)] [Iter 19180] Loss: 0.9296 (freq: 0.3070, raw: 0.6217, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[818,70,404,1015,942,185,490,1014,429,612,1011,207,726,387,334]


π”¬ Encoder Diversity (iter 19180):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 29/100] [Batch 458/669 (68.5%)] [Iter 19190] Loss: 1.2861 (freq: 0.4461, raw: 0.8391, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[726,942,490,185,70,1014,1015,207,818,334,612,694,891,271,438]


π”¬ Encoder Diversity (iter 19190):
  Avg similarity: 0.0284 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 29/100] [Batch 468/669 (70.0%)] [Iter 19200] Loss: 0.9748 (freq: 0.3340, raw: 0.6400, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[349,440,354,151,13,818,914,70,43,315,942,691,542,694,207]


π”¬ Encoder Diversity (iter 19200):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 29/100] [Batch 478/669 (71.4%)] [Iter 19210] Loss: 0.8546 (freq: 0.2841, raw: 0.5696, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[1014,862,70,440,334,207,185,371,11,429,613,760,631,271,13]


π”¬ Encoder Diversity (iter 19210):
  Avg similarity: 0.0790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 29/100] [Batch 488/669 (72.9%)] [Iter 19220] Loss: 0.6831 (freq: 0.1921, raw: 0.4902, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[568,440,988,691,161,942,760,385,151,538,13,27,461,524,241]


π”¬ Encoder Diversity (iter 19220):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 29/100] [Batch 498/669 (74.4%)] [Iter 19230] Loss: 1.1741 (freq: 0.4239, raw: 0.7493, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[797,385,960,942,207,185,108,891,70,241,315,354,689,27,568]


π”¬ Encoder Diversity (iter 19230):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 29/100] [Batch 508/669 (75.9%)] [Iter 19240] Loss: 1.2898 (freq: 0.4536, raw: 0.8352, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[349,691,987,538,241,689,1014,354,584,579,282,27,385,440,400]


π”¬ Encoder Diversity (iter 19240):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 29/100] [Batch 518/669 (77.4%)] [Iter 19250] Loss: 0.9546 (freq: 0.3203, raw: 0.6335, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[13,818,691,830,207,27,847,1015,1014,371,185,241,891,538,429]


π”¬ Encoder Diversity (iter 19250):
  Avg similarity: 0.0165 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 29/100] [Batch 528/669 (78.9%)] [Iter 19260] Loss: 0.8851 (freq: 0.2687, raw: 0.6156, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[691,925,987,385,185,541,986,714,349,429,579,797,1014,27,61]


π”¬ Encoder Diversity (iter 19260):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 29/100] [Batch 538/669 (80.4%)] [Iter 19270] Loss: 1.0350 (freq: 0.3632, raw: 0.6710, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[986,714,185,207,385,818,691,891,1014,70,125,1011,282,535,195]


π”¬ Encoder Diversity (iter 19270):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 29/100] [Batch 548/669 (81.9%)] [Iter 19280] Loss: 1.0529 (freq: 0.3665, raw: 0.6856, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[442,207,538,987,986,465,231,691,535,461,682,447,925,612,61]


π”¬ Encoder Diversity (iter 19280):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 29/100] [Batch 558/669 (83.4%)] [Iter 19290] Loss: 1.2945 (freq: 0.4588, raw: 0.8348, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[241,925,437,13,440,682,538,986,863,151,760,400,195,184,714]


π”¬ Encoder Diversity (iter 19290):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 29/100] [Batch 568/669 (84.9%)] [Iter 19300] Loss: 0.7458 (freq: 0.2640, raw: 0.4810, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[185,818,714,371,1011,568,108,440,480,760,704,1014,195,775,199]


π”¬ Encoder Diversity (iter 19300):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 29/100] [Batch 578/669 (86.4%)] [Iter 19310] Loss: 1.0448 (freq: 0.3747, raw: 0.6694, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[195,440,207,743,760,579,942,108,185,480,914,797,714,27,315]


π”¬ Encoder Diversity (iter 19310):
  Avg similarity: 0.0250 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 29/100] [Batch 588/669 (87.9%)] [Iter 19320] Loss: 1.0404 (freq: 0.3484, raw: 0.6912, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[929,440,74,13,682,195,837,249,584,315,714,108,461,231,151]


π”¬ Encoder Diversity (iter 19320):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 29/100] [Batch 598/669 (89.4%)] [Iter 19330] Loss: 1.0710 (freq: 0.3545, raw: 0.7155, quant: 0.0009, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[1011,480,151,195,818,862,837,185,108,743,1014,371,440,121,760]


π”¬ Encoder Diversity (iter 19330):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 29/100] [Batch 608/669 (90.9%)] [Iter 19340] Loss: 1.0729 (freq: 0.3243, raw: 0.7477, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[818,891,797,371,1014,231,192,942,108,995,524,951,241,197,195]


π”¬ Encoder Diversity (iter 19340):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 29/100] [Batch 618/669 (92.4%)] [Iter 19350] Loss: 0.9721 (freq: 0.3169, raw: 0.6544, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[315,942,995,891,195,440,75,760,267,524,465,689,682,349,74]


π”¬ Encoder Diversity (iter 19350):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 29/100] [Batch 628/669 (93.9%)] [Iter 19360] Loss: 1.2215 (freq: 0.4445, raw: 0.7760, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[208,231,440,824,942,837,818,465,70,714,151,241,830,185,125]


π”¬ Encoder Diversity (iter 19360):
  Avg similarity: 0.0641 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 29/100] [Batch 638/669 (95.4%)] [Iter 19370] Loss: 1.1544 (freq: 0.4098, raw: 0.7437, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[818,891,70,371,185,1014,207,74,1015,208,830,942,195,199,121]


π”¬ Encoder Diversity (iter 19370):
  Avg similarity: 0.0645 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9550 (0.0=collapsed)
[Epoch 29/100] [Batch 648/669 (96.9%)] [Iter 19380] Loss: 0.8986 (freq: 0.3033, raw: 0.5945, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[830,1014,125,818,682,995,1011,726,714,70,330,796,929,988,187]


π”¬ Encoder Diversity (iter 19380):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 29/100] [Batch 658/669 (98.4%)] [Iter 19390] Loss: 1.2901 (freq: 0.4625, raw: 0.8267, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[241,151,440,760,231,995,156,579,524,682,315,987,13,349,27]


π”¬ Encoder Diversity (iter 19390):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 29/100] [Batch 668/669 (99.9%)] [Iter 19400] Loss: 0.8917 (freq: 0.3288, raw: 0.5620, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[1014,208,187,925,797,159,863,429,1001,70,818,1015,538,830,689]


π”¬ Encoder Diversity (iter 19400):
  Avg similarity: 0.0380 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)

================================================================================
[Epoch 29] Validation Results:
  Total Loss: 0.5690
  Freq Loss:  0.1651
  Raw Loss:   0.4030
  Quant Loss: 0.0009
  π“ Codebook Usage: 472/1024 (46.1%)
  π“ Codebook Entropy: 4.7399 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 29886 (23.0%)
  Top 10 most used codes:
    1. Code 197: 3688 times (2.83%)
    2. Code 442: 3287 times (2.52%)
    3. Code 860: 3265 times (2.51%)
    4. Code 612: 3123 times (2.40%)
    5. Code 1011: 3033 times (2.33%)
    6. Code 108: 2856 times (2.19%)
    7. Code 447: 2773 times (2.13%)
    8. Code 207: 2707 times (2.08%)
    9. Code 377: 2703 times (2.08%)
    10. Code 862: 2451 times (1.88%)
  Bottom 5 least used codes (among used):
    1. Code 193: 1 times (0.00%)
    2. Code 44: 1 times (0.00%)
    3. Code 203: 1 times (0.00%)
    4. Code 289: 1 times (0.00%)
    5. Code 275: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 30/100] [Batch 9/669 (1.3%)] [Iter 19410] Loss: 1.1999 (freq: 0.4704, raw: 0.7285, quant: 0.0010, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[824,830,70,192,195,1011,1015,818,75,447,501,207,535,612,280]


π”¬ Encoder Diversity (iter 19410):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 30/100] [Batch 19/669 (2.8%)] [Iter 19420] Loss: 0.9301 (freq: 0.3089, raw: 0.6204, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[192,1011,207,195,818,797,185,377,860,387,1014,197,830,857,587]


π”¬ Encoder Diversity (iter 19420):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 30/100] [Batch 29/669 (4.3%)] [Iter 19430] Loss: 1.0461 (freq: 0.3626, raw: 0.6827, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[486,589,637,774,1011,987,725,575,837,195,197,192,857,818,139]


π”¬ Encoder Diversity (iter 19430):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 30/100] [Batch 39/669 (5.8%)] [Iter 19440] Loss: 1.0850 (freq: 0.3955, raw: 0.6886, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[207,933,288,486,185,122,997,818,208,457,824,195,226,387,829]


π”¬ Encoder Diversity (iter 19440):
  Avg similarity: 0.0532 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 30/100] [Batch 49/669 (7.3%)] [Iter 19450] Loss: 1.0832 (freq: 0.3781, raw: 0.7042, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[288,795,566,509,457,13,486,350,267,458,81,387,987,590,75]


π”¬ Encoder Diversity (iter 19450):
  Avg similarity: 0.0438 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 30/100] [Batch 59/669 (8.8%)] [Iter 19460] Loss: 1.0696 (freq: 0.3942, raw: 0.6744, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[207,458,429,797,837,1014,69,418,108,141,98,13,376,587,280]


π”¬ Encoder Diversity (iter 19460):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 30/100] [Batch 69/669 (10.3%)] [Iter 19470] Loss: 0.7923 (freq: 0.2548, raw: 0.5367, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[13,795,288,457,566,486,205,883,820,565,856,590,47,509,279]


π”¬ Encoder Diversity (iter 19470):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 30/100] [Batch 79/669 (11.8%)] [Iter 19480] Loss: 0.8750 (freq: 0.2579, raw: 0.6162, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[207,566,775,288,208,185,589,1014,108,13,509,857,820,47,157]


π”¬ Encoder Diversity (iter 19480):
  Avg similarity: 0.0504 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 30/100] [Batch 89/669 (13.3%)] [Iter 19490] Loss: 1.4372 (freq: 0.5347, raw: 0.9016, quant: 0.0010, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[509,513,575,47,387,837,1022,288,566,84,309,240,139,774,589]


π”¬ Encoder Diversity (iter 19490):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 30/100] [Batch 99/669 (14.8%)] [Iter 19500] Loss: 1.3143 (freq: 0.4763, raw: 0.8371, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[795,458,13,1022,288,824,509,1014,207,818,937,566,830,927,775]


π”¬ Encoder Diversity (iter 19500):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 30/100] [Batch 109/669 (16.3%)] [Iter 19510] Loss: 0.9804 (freq: 0.3676, raw: 0.6119, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[458,509,818,535,860,208,1014,70,857,185,830,371,442,207,566]


π”¬ Encoder Diversity (iter 19510):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 30/100] [Batch 119/669 (17.8%)] [Iter 19520] Loss: 0.9154 (freq: 0.3310, raw: 0.5836, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[207,195,535,612,121,280,824,1014,458,274,997,927,1011,818,775]


π”¬ Encoder Diversity (iter 19520):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 30/100] [Batch 129/669 (19.3%)] [Iter 19530] Loss: 1.2062 (freq: 0.4538, raw: 0.7515, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[509,350,288,486,795,589,991,987,502,856,457,207,575,1013,774]


π”¬ Encoder Diversity (iter 19530):
  Avg similarity: 0.0309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 30/100] [Batch 139/669 (20.8%)] [Iter 19540] Loss: 1.1380 (freq: 0.4098, raw: 0.7273, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[575,820,207,1013,818,288,987,716,457,795,1014,153,604,638,143]


π”¬ Encoder Diversity (iter 19540):
  Avg similarity: 0.0710 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 30/100] [Batch 149/669 (22.3%)] [Iter 19550] Loss: 1.2779 (freq: 0.4668, raw: 0.8102, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[566,933,13,509,279,883,81,795,1013,226,288,818,820,589,575]


π”¬ Encoder Diversity (iter 19550):
  Avg similarity: 0.0661 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9518 (0.0=collapsed)
[Epoch 30/100] [Batch 159/669 (23.8%)] [Iter 19560] Loss: 1.1086 (freq: 0.4195, raw: 0.6882, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[509,774,288,258,566,933,856,458,818,1011,187,486,820,1015,1013]


π”¬ Encoder Diversity (iter 19560):
  Avg similarity: 0.0436 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 30/100] [Batch 169/669 (25.3%)] [Iter 19570] Loss: 1.2762 (freq: 0.4691, raw: 0.8062, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[267,820,795,565,288,589,929,350,509,457,933,205,631,387,725]


π”¬ Encoder Diversity (iter 19570):
  Avg similarity: 0.0647 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 30/100] [Batch 179/669 (26.8%)] [Iter 19580] Loss: 0.9242 (freq: 0.3369, raw: 0.5864, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[207,797,1014,830,818,429,279,535,185,819,121,70,991,195,857]


π”¬ Encoder Diversity (iter 19580):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 30/100] [Batch 189/669 (28.3%)] [Iter 19590] Loss: 0.6581 (freq: 0.2043, raw: 0.4529, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[1011,883,535,991,442,830,40,267,1014,818,121,207,280,509,587]


π”¬ Encoder Diversity (iter 19590):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 30/100] [Batch 199/669 (29.7%)] [Iter 19600] Loss: 1.2872 (freq: 0.4534, raw: 0.8330, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[933,566,818,509,13,856,350,795,575,857,458,279,288,226,565]


π”¬ Encoder Diversity (iter 19600):
  Avg similarity: 0.0172 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 30/100] [Batch 209/669 (31.2%)] [Iter 19610] Loss: 1.1605 (freq: 0.4068, raw: 0.7528, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[818,321,458,765,185,207,1011,997,856,13,394,205,837,122,121]


π”¬ Encoder Diversity (iter 19610):
  Avg similarity: 0.0585 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 30/100] [Batch 219/669 (32.7%)] [Iter 19620] Loss: 1.2283 (freq: 0.4125, raw: 0.8149, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[509,795,515,933,856,486,837,716,350,566,820,987,958,575,774]


π”¬ Encoder Diversity (iter 19620):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 30/100] [Batch 229/669 (34.2%)] [Iter 19630] Loss: 1.1697 (freq: 0.4344, raw: 0.7344, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[930,195,458,208,837,991,818,13,185,509,883,566,207,937,333]


π”¬ Encoder Diversity (iter 19630):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 30/100] [Batch 239/669 (35.7%)] [Iter 19640] Loss: 0.7678 (freq: 0.2428, raw: 0.5242, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[207,818,535,824,70,429,981,627,121,195,930,291,991,725,682]


π”¬ Encoder Diversity (iter 19640):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 30/100] [Batch 249/669 (37.2%)] [Iter 19650] Loss: 1.1856 (freq: 0.4619, raw: 0.7228, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[565,350,509,818,195,486,226,991,16,566,1013,273,1014,185,70]


π”¬ Encoder Diversity (iter 19650):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 30/100] [Batch 259/669 (38.7%)] [Iter 19660] Loss: 0.7003 (freq: 0.2289, raw: 0.4706, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[818,509,991,728,195,1014,280,797,333,284,824,765,933,108,1013]


π”¬ Encoder Diversity (iter 19660):
  Avg similarity: 0.0668 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 30/100] [Batch 269/669 (40.2%)] [Iter 19670] Loss: 1.3515 (freq: 0.5420, raw: 0.8085, quant: 0.0010, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[486,933,565,1022,457,765,195,1003,1014,824,70,857,81,818,509]


π”¬ Encoder Diversity (iter 19670):
  Avg similarity: 0.0302 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 30/100] [Batch 279/669 (41.7%)] [Iter 19680] Loss: 1.1682 (freq: 0.3935, raw: 0.7739, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[830,70,818,207,857,991,682,509,280,768,1014,457,343,130,68]


π”¬ Encoder Diversity (iter 19680):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 30/100] [Batch 289/669 (43.2%)] [Iter 19690] Loss: 1.0983 (freq: 0.3805, raw: 0.7169, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[837,130,991,392,70,291,75,280,205,267,240,250,565,1013,197]


π”¬ Encoder Diversity (iter 19690):
  Avg similarity: 0.0347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 30/100] [Batch 299/669 (44.7%)] [Iter 19700] Loss: 1.3129 (freq: 0.4891, raw: 0.8229, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[765,458,682,535,824,997,429,207,728,118,240,279,958,291,68]


π”¬ Encoder Diversity (iter 19700):
  Avg similarity: 0.0338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 30/100] [Batch 309/669 (46.2%)] [Iter 19710] Loss: 1.2797 (freq: 0.4679, raw: 0.8108, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 923/1024 (90.1%) Top5:[117,394,280,130,856,725,933,837,458,207,937,656,860,509,987]


π”¬ Encoder Diversity (iter 19710):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 30/100] [Batch 319/669 (47.7%)] [Iter 19720] Loss: 1.2194 (freq: 0.4532, raw: 0.7653, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[818,486,195,768,535,26,280,289,70,208,458,185,121,612,117]


π”¬ Encoder Diversity (iter 19720):
  Avg similarity: 0.0320 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 30/100] [Batch 329/669 (49.2%)] [Iter 19730] Loss: 1.0173 (freq: 0.3597, raw: 0.6568, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[226,117,565,486,856,130,1013,795,207,509,457,258,782,288,195]


π”¬ Encoder Diversity (iter 19730):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 30/100] [Batch 339/669 (50.7%)] [Iter 19740] Loss: 1.0299 (freq: 0.3595, raw: 0.6695, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[309,795,512,879,300,226,566,207,117,130,1013,908,820,856,783]


π”¬ Encoder Diversity (iter 19740):
  Avg similarity: 0.0509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 30/100] [Batch 349/669 (52.2%)] [Iter 19750] Loss: 0.9934 (freq: 0.3592, raw: 0.6333, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[818,509,595,289,130,830,566,824,26,288,991,549,291,350,101]


π”¬ Encoder Diversity (iter 19750):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 30/100] [Batch 359/669 (53.7%)] [Iter 19760] Loss: 1.0246 (freq: 0.3443, raw: 0.6794, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[13,566,289,908,819,240,280,856,820,1014,273,509,987,818,205]


π”¬ Encoder Diversity (iter 19760):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 30/100] [Batch 369/669 (55.2%)] [Iter 19770] Loss: 1.0787 (freq: 0.3874, raw: 0.6904, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[509,991,818,765,819,208,535,121,1013,837,26,958,908,207,49]


π”¬ Encoder Diversity (iter 19770):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 30/100] [Batch 379/669 (56.7%)] [Iter 19780] Loss: 1.3841 (freq: 0.4640, raw: 0.9191, quant: 0.0010, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[509,566,765,284,140,288,350,457,582,81,273,937,48,991,768]


π”¬ Encoder Diversity (iter 19780):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 30/100] [Batch 389/669 (58.1%)] [Iter 19790] Loss: 1.1444 (freq: 0.4486, raw: 0.6949, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[933,765,883,509,279,458,130,205,118,258,273,471,1013,908,117]


π”¬ Encoder Diversity (iter 19790):
  Avg similarity: 0.0209 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 30/100] [Batch 399/669 (59.6%)] [Iter 19800] Loss: 1.4173 (freq: 0.5403, raw: 0.8761, quant: 0.0010, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[509,70,464,818,195,258,130,595,458,289,280,288,1003,991,26]


π”¬ Encoder Diversity (iter 19800):
  Avg similarity: 0.0482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 30/100] [Batch 409/669 (61.1%)] [Iter 19810] Loss: 1.0272 (freq: 0.3592, raw: 0.6670, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[795,130,350,566,13,509,309,1013,486,1003,289,258,458,933,765]


π”¬ Encoder Diversity (iter 19810):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 30/100] [Batch 419/669 (62.6%)] [Iter 19820] Loss: 1.1751 (freq: 0.4007, raw: 0.7735, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[818,288,130,991,535,267,207,280,582,26,871,795,692,765,1013]


π”¬ Encoder Diversity (iter 19820):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 30/100] [Batch 429/669 (64.1%)] [Iter 19830] Loss: 0.9357 (freq: 0.3236, raw: 0.6113, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[1013,288,309,582,486,883,446,997,280,824,26,267,48,350,13]


π”¬ Encoder Diversity (iter 19830):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 30/100] [Batch 439/669 (65.6%)] [Iter 19840] Loss: 1.0774 (freq: 0.3976, raw: 0.6790, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[958,458,471,1013,863,273,856,883,887,725,101,824,390,141,486]


π”¬ Encoder Diversity (iter 19840):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 30/100] [Batch 449/669 (67.1%)] [Iter 19850] Loss: 1.0657 (freq: 0.4035, raw: 0.6613, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[185,26,280,446,819,991,1014,883,535,887,284,291,933,1013,226]


π”¬ Encoder Diversity (iter 19850):
  Avg similarity: 0.0505 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 30/100] [Batch 459/669 (68.6%)] [Iter 19860] Loss: 1.0507 (freq: 0.3791, raw: 0.6708, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[818,1013,130,991,280,289,512,26,5,843,565,765,267,226,13]


π”¬ Encoder Diversity (iter 19860):
  Avg similarity: 0.0437 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 30/100] [Batch 469/669 (70.1%)] [Iter 19870] Loss: 1.0436 (freq: 0.3411, raw: 0.7017, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[289,818,486,856,373,958,768,692,205,566,446,280,991,130,429]


π”¬ Encoder Diversity (iter 19870):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 30/100] [Batch 479/669 (71.6%)] [Iter 19880] Loss: 1.0581 (freq: 0.3688, raw: 0.6884, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[130,258,205,226,289,908,486,457,458,118,1022,13,284,856,1003]


π”¬ Encoder Diversity (iter 19880):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 30/100] [Batch 489/669 (73.1%)] [Iter 19890] Loss: 0.8273 (freq: 0.2665, raw: 0.5599, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[909,267,692,509,818,289,991,291,819,195,884,26,429,1013,108]


π”¬ Encoder Diversity (iter 19890):
  Avg similarity: 0.0304 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 30/100] [Batch 499/669 (74.6%)] [Iter 19900] Loss: 0.8717 (freq: 0.2790, raw: 0.5919, quant: 0.0008, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[991,819,284,350,486,818,1014,280,185,524,830,765,130,26,309]


π”¬ Encoder Diversity (iter 19900):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 30/100] [Batch 509/669 (76.1%)] [Iter 19910] Loss: 1.1788 (freq: 0.4311, raw: 0.7468, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[280,991,13,670,819,887,837,783,26,350,566,207,1003,118,582]


π”¬ Encoder Diversity (iter 19910):
  Avg similarity: 0.0550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 30/100] [Batch 519/669 (77.6%)] [Iter 19920] Loss: 0.9659 (freq: 0.3529, raw: 0.6121, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[280,309,13,566,195,284,207,819,670,524,267,130,818,185,638]


π”¬ Encoder Diversity (iter 19920):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 30/100] [Batch 529/669 (79.1%)] [Iter 19930] Loss: 1.2190 (freq: 0.4220, raw: 0.7960, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[280,991,856,765,267,309,908,108,291,207,471,458,552,117,692]


π”¬ Encoder Diversity (iter 19930):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 30/100] [Batch 539/669 (80.6%)] [Iter 19940] Loss: 1.1000 (freq: 0.4118, raw: 0.6873, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[458,205,768,101,692,309,818,939,509,937,471,505,595,996,267]


π”¬ Encoder Diversity (iter 19940):
  Avg similarity: 0.0762 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 30/100] [Batch 549/669 (82.1%)] [Iter 19950] Loss: 1.1303 (freq: 0.3705, raw: 0.7589, quant: 0.0009, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[768,692,127,274,819,818,909,862,289,108,280,569,291,670,284]


π”¬ Encoder Diversity (iter 19950):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 30/100] [Batch 559/669 (83.6%)] [Iter 19960] Loss: 0.5086 (freq: 0.1435, raw: 0.3644, quant: 0.0007, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[692,569,195,140,856,26,207,991,274,58,121,504,1013,819,670]


π”¬ Encoder Diversity (iter 19960):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 30/100] [Batch 569/669 (85.1%)] [Iter 19970] Loss: 0.9430 (freq: 0.3253, raw: 0.6168, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[692,280,819,413,350,569,273,768,291,939,207,603,1013,871,582]


π”¬ Encoder Diversity (iter 19970):
  Avg similarity: 0.0468 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 30/100] [Batch 579/669 (86.5%)] [Iter 19980] Loss: 1.3825 (freq: 0.4716, raw: 0.9100, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[13,273,350,1013,289,883,226,205,908,692,122,457,192,566,486]


π”¬ Encoder Diversity (iter 19980):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 30/100] [Batch 589/669 (88.0%)] [Iter 19990] Loss: 1.0146 (freq: 0.3535, raw: 0.6603, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[350,226,908,856,192,130,289,457,205,647,1013,950,13,207,280]


π”¬ Encoder Diversity (iter 19990):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 30/100] [Batch 599/669 (89.5%)] [Iter 20000] Loss: 1.2832 (freq: 0.4616, raw: 0.8207, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[458,1013,273,565,267,856,947,413,505,226,130,566,950,883,207]


π”¬ Encoder Diversity (iter 20000):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 30/100] [Batch 609/669 (91.0%)] [Iter 20010] Loss: 0.9544 (freq: 0.3074, raw: 0.6461, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[289,458,1013,118,267,996,390,413,908,947,945,350,991,605,280]


π”¬ Encoder Diversity (iter 20010):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 30/100] [Batch 619/669 (92.5%)] [Iter 20020] Loss: 1.0601 (freq: 0.4091, raw: 0.6501, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[776,991,284,26,582,902,695,486,768,603,605,997,950,818,280]


π”¬ Encoder Diversity (iter 20020):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 30/100] [Batch 629/669 (94.0%)] [Iter 20030] Loss: 1.1283 (freq: 0.3818, raw: 0.7456, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[683,274,692,939,742,569,505,663,729,109,350,289,240,997,192]


π”¬ Encoder Diversity (iter 20030):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 30/100] [Batch 639/669 (95.5%)] [Iter 20040] Loss: 1.1425 (freq: 0.4313, raw: 0.7102, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[1013,458,457,535,117,289,267,991,195,360,692,205,765,311,603]


π”¬ Encoder Diversity (iter 20040):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 30/100] [Batch 649/669 (97.0%)] [Iter 20050] Loss: 1.0516 (freq: 0.3544, raw: 0.6963, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[1013,457,109,692,603,958,350,566,273,360,683,505,991,663,908]


π”¬ Encoder Diversity (iter 20050):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 30/100] [Batch 659/669 (98.5%)] [Iter 20060] Loss: 1.3431 (freq: 0.4753, raw: 0.8668, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[289,226,908,1013,566,205,109,267,350,360,458,273,457,240,1022]


π”¬ Encoder Diversity (iter 20060):
  Avg similarity: 0.0454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 30/100] [Batch 669/669 (100.0%)] [Iter 20070] Loss: 1.2343 (freq: 0.4695, raw: 0.7639, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[765,535,6,458,413,1013,109,289,267,776,207,670,856,140,108]


================================================================================
[Epoch 30] Validation Results:
  Total Loss: 0.5795
  Freq Loss:  0.1647
  Raw Loss:   0.4139
  Quant Loss: 0.0009
  π“ Codebook Usage: 560/1024 (54.7%)
  π“ Codebook Entropy: 4.9360 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 29098 (22.3%)
  Top 10 most used codes:
    1. Code 776: 4062 times (3.12%)
    2. Code 110: 3741 times (2.87%)
    3. Code 605: 3638 times (2.79%)
    4. Code 26: 3030 times (2.33%)
    5. Code 582: 2543 times (1.95%)
    6. Code 195: 2512 times (1.93%)
    7. Code 121: 2433 times (1.87%)
    8. Code 687: 2421 times (1.86%)
    9. Code 742: 2418 times (1.86%)
    10. Code 1: 2300 times (1.77%)
  Bottom 5 least used codes (among used):
    1. Code 281: 1 times (0.00%)
    2. Code 129: 1 times (0.00%)
    3. Code 468: 1 times (0.00%)
    4. Code 972: 1 times (0.00%)
    5. Code 806: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 3/10
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 29 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 20070):
  Avg similarity: 0.0747 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 31/100] [Batch 10/669 (1.5%)] [Iter 20080] Loss: 0.9004 (freq: 0.2933, raw: 0.6063, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 1022/1024 (99.8%) Top5:[509,207,273,195,291,280,109,505,535,902,991,670,26,692,58]


π”¬ Encoder Diversity (iter 20080):
  Avg similarity: 0.0531 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 31/100] [Batch 20/669 (3.0%)] [Iter 20090] Loss: 1.1835 (freq: 0.4339, raw: 0.7487, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[569,603,458,683,535,663,109,898,272,991,805,195,550,101,121]


π”¬ Encoder Diversity (iter 20090):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 31/100] [Batch 30/669 (4.5%)] [Iter 20100] Loss: 1.1881 (freq: 0.4322, raw: 0.7550, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[898,109,845,195,663,818,374,692,535,81,690,521,740,806,455]


π”¬ Encoder Diversity (iter 20100):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 31/100] [Batch 40/669 (6.0%)] [Iter 20110] Loss: 0.8999 (freq: 0.2866, raw: 0.6124, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[898,109,692,740,291,663,582,535,521,108,81,991,346,26,819]


π”¬ Encoder Diversity (iter 20110):
  Avg similarity: 0.0755 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 31/100] [Batch 50/669 (7.5%)] [Iter 20120] Loss: 1.2614 (freq: 0.4650, raw: 0.7955, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[690,496,81,509,101,252,1023,521,380,683,339,20,768,280,966]


π”¬ Encoder Diversity (iter 20120):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 31/100] [Batch 60/669 (9.0%)] [Iter 20130] Loss: 1.0171 (freq: 0.3440, raw: 0.6722, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 801/1024 (78.2%) Top5:[991,683,280,127,109,505,692,805,788,663,535,997,121,742,740]


π”¬ Encoder Diversity (iter 20130):
  Avg similarity: 0.0554 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 31/100] [Batch 70/669 (10.5%)] [Iter 20140] Loss: 1.0667 (freq: 0.3418, raw: 0.7239, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[19,690,740,59,768,727,742,81,898,455,920,977,806,550,273]


π”¬ Encoder Diversity (iter 20140):
  Avg similarity: 0.0404 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 31/100] [Batch 80/669 (12.0%)] [Iter 20150] Loss: 0.8849 (freq: 0.2881, raw: 0.5960, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[991,683,670,849,59,582,52,603,509,455,280,121,698,528,207]


π”¬ Encoder Diversity (iter 20150):
  Avg similarity: 0.0210 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 31/100] [Batch 90/669 (13.5%)] [Iter 20160] Loss: 0.9989 (freq: 0.3441, raw: 0.6540, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[280,535,902,26,283,81,509,687,346,670,991,254,768,921,692]


π”¬ Encoder Diversity (iter 20160):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 31/100] [Batch 100/669 (14.9%)] [Iter 20170] Loss: 0.9742 (freq: 0.3491, raw: 0.6242, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[806,81,690,752,59,346,109,798,20,550,921,727,692,509,254]


π”¬ Encoder Diversity (iter 20170):
  Avg similarity: 0.0793 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9530 (0.0=collapsed)
[Epoch 31/100] [Batch 110/669 (16.4%)] [Iter 20180] Loss: 1.0429 (freq: 0.3537, raw: 0.6884, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[921,692,52,535,273,339,603,768,740,109,670,521,121,81,126]


π”¬ Encoder Diversity (iter 20180):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 31/100] [Batch 120/669 (17.9%)] [Iter 20190] Loss: 1.2242 (freq: 0.4536, raw: 0.7696, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[550,921,339,920,692,740,59,101,521,502,81,109,991,430,535]


π”¬ Encoder Diversity (iter 20190):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 31/100] [Batch 130/669 (19.4%)] [Iter 20200] Loss: 0.9183 (freq: 0.2883, raw: 0.6292, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[921,977,339,806,19,692,59,52,697,270,868,81,430,789,740]


π”¬ Encoder Diversity (iter 20200):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 31/100] [Batch 140/669 (20.9%)] [Iter 20210] Loss: 1.3233 (freq: 0.4938, raw: 0.8285, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[509,692,668,798,81,273,768,810,697,603,977,535,921,496,195]


π”¬ Encoder Diversity (iter 20210):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 31/100] [Batch 150/669 (22.4%)] [Iter 20220] Loss: 0.9247 (freq: 0.3345, raw: 0.5893, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[740,697,509,690,461,81,550,607,925,833,759,496,661,668,502]


π”¬ Encoder Diversity (iter 20220):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 31/100] [Batch 160/669 (23.9%)] [Iter 20230] Loss: 1.4352 (freq: 0.5474, raw: 0.8868, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[740,690,59,81,668,708,509,697,430,925,810,977,806,661,603]


π”¬ Encoder Diversity (iter 20230):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 31/100] [Batch 170/669 (25.4%)] [Iter 20240] Loss: 0.9150 (freq: 0.3146, raw: 0.5996, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[81,991,740,59,697,550,921,810,108,922,509,508,521,819,52]


π”¬ Encoder Diversity (iter 20240):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 31/100] [Batch 180/669 (26.9%)] [Iter 20250] Loss: 1.3024 (freq: 0.4702, raw: 0.8313, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[374,109,833,663,991,550,508,697,692,195,740,845,280,108,58]


π”¬ Encoder Diversity (iter 20250):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 31/100] [Batch 190/669 (28.4%)] [Iter 20260] Loss: 0.9613 (freq: 0.3389, raw: 0.6216, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[903,991,740,81,789,690,126,283,727,920,868,339,430,280,509]


π”¬ Encoder Diversity (iter 20260):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 31/100] [Batch 200/669 (29.9%)] [Iter 20270] Loss: 1.2969 (freq: 0.4975, raw: 0.7985, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[109,991,697,509,508,668,270,207,58,346,75,915,833,692,20]


π”¬ Encoder Diversity (iter 20270):
  Avg similarity: 0.0689 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 31/100] [Batch 210/669 (31.4%)] [Iter 20280] Loss: 1.4112 (freq: 0.5046, raw: 0.9057, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[921,550,798,81,40,697,809,118,339,455,740,188,977,668,59]


π”¬ Encoder Diversity (iter 20280):
  Avg similarity: 0.0193 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 31/100] [Batch 220/669 (32.9%)] [Iter 20290] Loss: 1.2768 (freq: 0.4628, raw: 0.8132, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[798,608,550,118,921,690,683,109,81,922,509,528,806,849,705]


π”¬ Encoder Diversity (iter 20290):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 31/100] [Batch 230/669 (34.4%)] [Iter 20300] Loss: 1.0161 (freq: 0.3318, raw: 0.6835, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 782/1024 (76.4%) Top5:[921,550,697,52,991,1023,690,798,339,220,692,608,854,528,1]


π”¬ Encoder Diversity (iter 20300):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 31/100] [Batch 240/669 (35.9%)] [Iter 20310] Loss: 1.3183 (freq: 0.5117, raw: 0.8057, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[603,925,509,380,806,550,700,954,52,40,991,697,708,108,958]


π”¬ Encoder Diversity (iter 20310):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 31/100] [Batch 250/669 (37.4%)] [Iter 20320] Loss: 0.8201 (freq: 0.2949, raw: 0.5244, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[109,921,508,273,697,705,991,818,385,603,40,280,608,550,58]


π”¬ Encoder Diversity (iter 20320):
  Avg similarity: 0.0349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 31/100] [Batch 260/669 (38.9%)] [Iter 20330] Loss: 1.0530 (freq: 0.3611, raw: 0.6910, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[550,690,697,109,508,52,939,805,377,809,603,854,849,887,663]


π”¬ Encoder Diversity (iter 20330):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 31/100] [Batch 270/669 (40.4%)] [Iter 20340] Loss: 1.1054 (freq: 0.3740, raw: 0.7305, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[550,921,19,273,52,697,1023,977,990,270,740,220,898,592,755]


π”¬ Encoder Diversity (iter 20340):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 31/100] [Batch 280/669 (41.9%)] [Iter 20350] Loss: 1.3105 (freq: 0.4786, raw: 0.8309, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[52,109,845,921,505,273,740,728,207,690,377,461,1014,755,496]


π”¬ Encoder Diversity (iter 20350):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 31/100] [Batch 290/669 (43.3%)] [Iter 20360] Loss: 1.4411 (freq: 0.5334, raw: 0.9068, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[921,898,509,81,697,977,118,740,700,661,457,52,520,59,755]


π”¬ Encoder Diversity (iter 20360):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 31/100] [Batch 300/669 (44.8%)] [Iter 20370] Loss: 0.8170 (freq: 0.2686, raw: 0.5476, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[991,109,535,833,887,939,441,921,508,198,997,683,509,692,898]


π”¬ Encoder Diversity (iter 20370):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 31/100] [Batch 310/669 (46.3%)] [Iter 20380] Loss: 1.1370 (freq: 0.4011, raw: 0.7350, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[921,59,697,898,24,455,81,684,1023,202,810,705,1006,915,109]


π”¬ Encoder Diversity (iter 20380):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 31/100] [Batch 320/669 (47.8%)] [Iter 20390] Loss: 0.9336 (freq: 0.3529, raw: 0.5799, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[991,109,958,280,692,705,81,59,990,921,697,898,118,683,509]


π”¬ Encoder Diversity (iter 20390):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 31/100] [Batch 330/669 (49.3%)] [Iter 20400] Loss: 1.2613 (freq: 0.4657, raw: 0.7946, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[59,990,52,550,17,339,915,798,991,109,1023,280,925,697,24]


π”¬ Encoder Diversity (iter 20400):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9571 (0.0=collapsed)
[Epoch 31/100] [Batch 340/669 (50.8%)] [Iter 20410] Loss: 0.9871 (freq: 0.3156, raw: 0.6706, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[819,690,1020,280,109,692,939,603,13,663,991,312,854,509,20]


π”¬ Encoder Diversity (iter 20410):
  Avg similarity: 0.0629 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 31/100] [Batch 350/669 (52.3%)] [Iter 20420] Loss: 1.3062 (freq: 0.4926, raw: 0.8127, quant: 0.0010, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[603,958,705,109,690,991,509,52,528,697,195,508,535,280,59]


π”¬ Encoder Diversity (iter 20420):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 31/100] [Batch 360/669 (53.8%)] [Iter 20430] Loss: 1.0396 (freq: 0.3704, raw: 0.6684, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[690,898,109,252,52,958,692,705,508,561,819,521,925,603,280]


π”¬ Encoder Diversity (iter 20430):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 31/100] [Batch 370/669 (55.3%)] [Iter 20440] Loss: 0.7341 (freq: 0.2298, raw: 0.5035, quant: 0.0007, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[789,509,977,280,991,535,925,958,59,697,809,81,921,1023,177]


π”¬ Encoder Diversity (iter 20440):
  Avg similarity: 0.0599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 31/100] [Batch 380/669 (56.8%)] [Iter 20450] Loss: 1.0921 (freq: 0.3750, raw: 0.7162, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[705,939,663,1023,509,690,273,798,59,958,280,81,455,833,819]


π”¬ Encoder Diversity (iter 20450):
  Avg similarity: 0.0380 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 31/100] [Batch 390/669 (58.3%)] [Iter 20460] Loss: 0.9983 (freq: 0.3339, raw: 0.6636, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[762,692,819,195,683,603,705,898,320,597,273,663,958,991,535]


π”¬ Encoder Diversity (iter 20460):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 31/100] [Batch 400/669 (59.8%)] [Iter 20470] Loss: 1.1988 (freq: 0.4429, raw: 0.7550, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[109,683,59,898,914,663,958,991,280,692,708,887,1023,806,245]


π”¬ Encoder Diversity (iter 20470):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 31/100] [Batch 410/669 (61.3%)] [Iter 20480] Loss: 0.8360 (freq: 0.2987, raw: 0.5364, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[280,683,312,508,59,762,663,320,177,845,108,514,997,849,182]


π”¬ Encoder Diversity (iter 20480):
  Avg similarity: 0.0261 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 31/100] [Batch 420/669 (62.8%)] [Iter 20490] Loss: 1.1937 (freq: 0.4250, raw: 0.7678, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[692,280,663,991,854,700,762,898,59,683,81,677,997,819,528]


π”¬ Encoder Diversity (iter 20490):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 31/100] [Batch 430/669 (64.3%)] [Iter 20500] Loss: 1.0333 (freq: 0.3487, raw: 0.6837, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[59,569,898,198,690,108,352,661,455,921,13,914,990,273,19]


π”¬ Encoder Diversity (iter 20500):
  Avg similarity: 0.0293 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 31/100] [Batch 440/669 (65.8%)] [Iter 20510] Loss: 0.9304 (freq: 0.3122, raw: 0.6173, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[252,990,663,508,280,692,59,898,95,177,273,52,589,441,108]


π”¬ Encoder Diversity (iter 20510):
  Avg similarity: 0.0210 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9768 (0.0=collapsed)
[Epoch 31/100] [Batch 450/669 (67.3%)] [Iter 20520] Loss: 1.1581 (freq: 0.4299, raw: 0.7274, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[59,708,692,898,508,668,108,868,997,888,177,887,697,441,914]


π”¬ Encoder Diversity (iter 20520):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 31/100] [Batch 460/669 (68.8%)] [Iter 20530] Loss: 0.9342 (freq: 0.3289, raw: 0.6044, quant: 0.0009, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[898,690,509,697,592,990,521,267,59,674,430,833,60,174,126]


π”¬ Encoder Diversity (iter 20530):
  Avg similarity: 0.0207 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 31/100] [Batch 470/669 (70.3%)] [Iter 20540] Loss: 0.8096 (freq: 0.2720, raw: 0.5368, quant: 0.0008, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[109,108,692,280,663,854,535,597,509,188,690,273,762,991,59]


π”¬ Encoder Diversity (iter 20540):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 31/100] [Batch 480/669 (71.7%)] [Iter 20550] Loss: 0.9126 (freq: 0.2872, raw: 0.6246, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[990,663,603,921,690,273,997,991,109,59,697,708,925,252,898]


π”¬ Encoder Diversity (iter 20550):
  Avg similarity: 0.0660 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 31/100] [Batch 490/669 (73.2%)] [Iter 20560] Loss: 1.2026 (freq: 0.4548, raw: 0.7469, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[898,668,925,509,663,59,708,935,921,344,101,273,280,188,690]


π”¬ Encoder Diversity (iter 20560):
  Avg similarity: 0.0328 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 31/100] [Batch 500/669 (74.7%)] [Iter 20570] Loss: 1.1720 (freq: 0.4571, raw: 0.7140, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[697,74,59,898,810,914,491,1023,692,798,925,509,249,921,118]


π”¬ Encoder Diversity (iter 20570):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 31/100] [Batch 510/669 (76.2%)] [Iter 20580] Loss: 1.0835 (freq: 0.3937, raw: 0.6889, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[921,692,809,663,118,990,59,1023,280,249,697,810,81,344,521]


π”¬ Encoder Diversity (iter 20580):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 31/100] [Batch 520/669 (77.7%)] [Iter 20590] Loss: 0.9105 (freq: 0.3051, raw: 0.6046, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[692,509,280,683,708,819,508,182,198,762,898,109,977,690,668]


π”¬ Encoder Diversity (iter 20590):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 31/100] [Batch 530/669 (79.2%)] [Iter 20600] Loss: 0.8581 (freq: 0.3013, raw: 0.5559, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[898,656,220,118,222,925,668,810,589,182,496,690,547,95,708]


π”¬ Encoder Diversity (iter 20600):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 31/100] [Batch 540/669 (80.7%)] [Iter 20610] Loss: 1.1567 (freq: 0.4027, raw: 0.7532, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[809,59,898,914,990,921,692,925,52,690,663,509,81,249,888]


π”¬ Encoder Diversity (iter 20610):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 31/100] [Batch 550/669 (82.2%)] [Iter 20620] Loss: 1.1839 (freq: 0.4513, raw: 0.7317, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[921,898,1023,914,990,698,59,118,195,81,535,19,810,52,249]


π”¬ Encoder Diversity (iter 20620):
  Avg similarity: 0.0622 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 31/100] [Batch 560/669 (83.7%)] [Iter 20630] Loss: 1.1423 (freq: 0.3905, raw: 0.7509, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[921,990,809,692,101,991,344,273,683,1023,597,603,59,528,52]


π”¬ Encoder Diversity (iter 20630):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 31/100] [Batch 570/669 (85.2%)] [Iter 20640] Loss: 1.0962 (freq: 0.4124, raw: 0.6829, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[182,1023,251,535,508,708,798,59,177,854,195,306,845,569,921]


π”¬ Encoder Diversity (iter 20640):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 31/100] [Batch 580/669 (86.7%)] [Iter 20650] Loss: 0.8226 (freq: 0.2736, raw: 0.5482, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[921,898,1023,914,59,990,854,697,925,52,708,868,280,698,589]


π”¬ Encoder Diversity (iter 20650):
  Avg similarity: 0.0238 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 31/100] [Batch 590/669 (88.2%)] [Iter 20660] Loss: 1.2822 (freq: 0.4736, raw: 0.8077, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[59,914,312,273,377,52,898,109,921,147,702,430,616,683,19]


π”¬ Encoder Diversity (iter 20660):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 31/100] [Batch 600/669 (89.7%)] [Iter 20670] Loss: 0.9040 (freq: 0.3021, raw: 0.6011, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[925,898,109,702,344,280,736,306,1023,396,508,690,991,377,126]


π”¬ Encoder Diversity (iter 20670):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 31/100] [Batch 610/669 (91.2%)] [Iter 20680] Loss: 1.2055 (freq: 0.4365, raw: 0.7680, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[702,668,661,59,273,658,188,914,220,52,798,312,925,990,13]


π”¬ Encoder Diversity (iter 20680):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 31/100] [Batch 620/669 (92.7%)] [Iter 20690] Loss: 1.1376 (freq: 0.4058, raw: 0.7308, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[925,692,147,108,59,690,854,109,508,683,280,663,762,344,561]


π”¬ Encoder Diversity (iter 20690):
  Avg similarity: 0.0234 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 31/100] [Batch 630/669 (94.2%)] [Iter 20700] Loss: 0.9108 (freq: 0.3067, raw: 0.6033, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[990,921,898,270,683,434,954,816,344,502,1023,312,925,252,220]


π”¬ Encoder Diversity (iter 20700):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 31/100] [Batch 640/669 (95.7%)] [Iter 20710] Loss: 0.9381 (freq: 0.3173, raw: 0.6199, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[702,921,935,52,708,1023,270,59,306,990,273,991,147,663,280]


π”¬ Encoder Diversity (iter 20710):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 31/100] [Batch 650/669 (97.2%)] [Iter 20720] Loss: 0.9684 (freq: 0.3346, raw: 0.6330, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[535,434,108,280,195,925,991,683,344,882,887,508,692,708,182]


π”¬ Encoder Diversity (iter 20720):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 31/100] [Batch 660/669 (98.7%)] [Iter 20730] Loss: 1.4053 (freq: 0.5269, raw: 0.8775, quant: 0.0010, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[925,1023,389,430,921,757,496,220,59,990,249,898,697,569,13]


π”¬ Encoder Diversity (iter 20730):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)

================================================================================
[Epoch 31] Validation Results:
  Total Loss: 0.5592
  Freq Loss:  0.1653
  Raw Loss:   0.3930
  Quant Loss: 0.0008
  π“ Codebook Usage: 546/1024 (53.3%)
  π“ Codebook Entropy: 5.0325 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 26571 (20.4%)
  Top 10 most used codes:
    1. Code 819: 3498 times (2.69%)
    2. Code 182: 3358 times (2.58%)
    3. Code 306: 2962 times (2.27%)
    4. Code 587: 2763 times (2.12%)
    5. Code 508: 2619 times (2.01%)
    6. Code 177: 2481 times (1.91%)
    7. Code 109: 2413 times (1.85%)
    8. Code 705: 2228 times (1.71%)
    9. Code 789: 2145 times (1.65%)
    10. Code 849: 2104 times (1.62%)
  Bottom 5 least used codes (among used):
    1. Code 236: 1 times (0.00%)
    2. Code 84: 1 times (0.00%)
    3. Code 8: 1 times (0.00%)
    4. Code 313: 2 times (0.00%)
    5. Code 11: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 4/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 32/100] [Batch 1/669 (0.1%)] [Iter 20740] Loss: 1.0088 (freq: 0.3469, raw: 0.6610, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[1020,772,898,683,434,921,195,663,868,935,59,280,1023,306,525]


π”¬ Encoder Diversity (iter 20740):
  Avg similarity: 0.0705 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 32/100] [Batch 11/669 (1.6%)] [Iter 20750] Loss: 0.9475 (freq: 0.3251, raw: 0.6215, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 1015/1024 (99.1%) Top5:[663,819,195,599,434,289,644,822,597,252,673,92,685,603,280]


π”¬ Encoder Diversity (iter 20750):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 32/100] [Batch 21/669 (3.1%)] [Iter 20760] Loss: 0.9152 (freq: 0.3215, raw: 0.5929, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 925/1024 (90.3%) Top5:[599,673,108,455,836,344,683,997,147,964,406,182,498,736,237]


π”¬ Encoder Diversity (iter 20760):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 32/100] [Batch 31/669 (4.6%)] [Iter 20770] Loss: 0.9569 (freq: 0.3235, raw: 0.6326, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[108,663,711,822,819,77,964,730,416,673,406,92,525,385,377]


π”¬ Encoder Diversity (iter 20770):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 32/100] [Batch 41/669 (6.1%)] [Iter 20780] Loss: 1.2932 (freq: 0.4800, raw: 0.8122, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[964,470,406,663,52,108,885,852,508,455,599,652,273,109,728]


π”¬ Encoder Diversity (iter 20780):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 32/100] [Batch 51/669 (7.6%)] [Iter 20790] Loss: 1.0659 (freq: 0.3636, raw: 0.7014, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[852,736,407,964,692,772,182,502,508,883,606,455,434,683,276]


π”¬ Encoder Diversity (iter 20790):
  Avg similarity: 0.0244 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 32/100] [Batch 61/669 (9.1%)] [Iter 20800] Loss: 0.8063 (freq: 0.2720, raw: 0.5335, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[244,711,606,406,683,599,991,964,106,852,280,195,692,935,344]


π”¬ Encoder Diversity (iter 20800):
  Avg similarity: 0.0292 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 32/100] [Batch 71/669 (10.6%)] [Iter 20810] Loss: 1.0345 (freq: 0.3616, raw: 0.6720, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[109,663,92,885,558,498,147,615,377,730,273,280,720,644,196]


π”¬ Encoder Diversity (iter 20810):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 32/100] [Batch 81/669 (12.1%)] [Iter 20820] Loss: 1.1523 (freq: 0.3841, raw: 0.7673, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[964,885,852,928,627,106,883,196,147,273,502,78,280,720,202]


π”¬ Encoder Diversity (iter 20820):
  Avg similarity: 0.0790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 32/100] [Batch 91/669 (13.6%)] [Iter 20830] Loss: 0.8952 (freq: 0.3096, raw: 0.5848, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[663,885,498,109,615,434,644,603,196,379,728,619,280,182,92]


π”¬ Encoder Diversity (iter 20830):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 32/100] [Batch 101/669 (15.1%)] [Iter 20840] Loss: 1.1458 (freq: 0.4165, raw: 0.7283, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[509,406,700,52,683,455,106,806,738,434,195,644,244,69,377]


π”¬ Encoder Diversity (iter 20840):
  Avg similarity: 0.0285 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 32/100] [Batch 111/669 (16.6%)] [Iter 20850] Loss: 1.3352 (freq: 0.5037, raw: 0.8305, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[852,964,273,720,147,836,435,599,935,498,928,52,54,803,943]


π”¬ Encoder Diversity (iter 20850):
  Avg similarity: 0.1148 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 32/100] [Batch 121/669 (18.1%)] [Iter 20860] Loss: 0.8905 (freq: 0.2724, raw: 0.6172, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[730,720,852,52,803,406,700,964,428,683,509,416,711,928,382]


π”¬ Encoder Diversity (iter 20860):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 32/100] [Batch 131/669 (19.6%)] [Iter 20870] Loss: 1.0030 (freq: 0.3548, raw: 0.6474, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[280,434,195,663,652,108,109,720,692,344,535,816,306,416,182]


π”¬ Encoder Diversity (iter 20870):
  Avg similarity: 0.0192 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 32/100] [Batch 141/669 (21.1%)] [Iter 20880] Loss: 1.2573 (freq: 0.4573, raw: 0.7991, quant: 0.0010, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[928,52,700,885,406,943,730,276,596,720,196,558,806,803,92]


π”¬ Encoder Diversity (iter 20880):
  Avg similarity: 0.0225 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 32/100] [Batch 151/669 (22.6%)] [Iter 20890] Loss: 1.3541 (freq: 0.4658, raw: 0.8874, quant: 0.0010, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[428,928,730,406,683,700,328,509,615,666,382,92,599,106,816]


π”¬ Encoder Diversity (iter 20890):
  Avg similarity: 0.0568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 32/100] [Batch 161/669 (24.1%)] [Iter 20900] Loss: 0.7361 (freq: 0.2107, raw: 0.5246, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[406,683,885,928,954,195,599,223,428,991,435,730,280,106,948]


π”¬ Encoder Diversity (iter 20900):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 32/100] [Batch 171/669 (25.6%)] [Iter 20910] Loss: 1.1807 (freq: 0.4052, raw: 0.7745, quant: 0.0010, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[428,964,599,816,796,885,928,106,280,535,652,290,335,196,728]


π”¬ Encoder Diversity (iter 20910):
  Avg similarity: 0.0576 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 32/100] [Batch 181/669 (27.1%)] [Iter 20920] Loss: 0.8956 (freq: 0.2984, raw: 0.5963, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[406,720,928,852,964,428,836,599,730,741,106,276,711,509,54]


π”¬ Encoder Diversity (iter 20920):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 32/100] [Batch 191/669 (28.6%)] [Iter 20930] Loss: 1.1099 (freq: 0.3908, raw: 0.7182, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[280,406,928,711,508,273,599,434,816,306,852,52,594,195,435]


π”¬ Encoder Diversity (iter 20930):
  Avg similarity: 0.0609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 32/100] [Batch 201/669 (30.0%)] [Iter 20940] Loss: 1.2133 (freq: 0.3848, raw: 0.8276, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[599,923,195,434,730,663,498,52,108,182,816,885,652,435,308]


π”¬ Encoder Diversity (iter 20940):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 32/100] [Batch 211/669 (31.5%)] [Iter 20950] Loss: 1.2112 (freq: 0.4461, raw: 0.7642, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[852,943,948,885,54,928,730,106,196,52,658,435,700,738,593]


π”¬ Encoder Diversity (iter 20950):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 32/100] [Batch 221/669 (33.0%)] [Iter 20960] Loss: 1.1746 (freq: 0.4182, raw: 0.7554, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[147,434,700,280,382,816,92,720,328,377,350,273,692,195,435]


π”¬ Encoder Diversity (iter 20960):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 32/100] [Batch 231/669 (34.5%)] [Iter 20970] Loss: 1.1113 (freq: 0.3665, raw: 0.7438, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[280,1005,434,290,692,730,964,428,652,720,195,108,308,599,224]


π”¬ Encoder Diversity (iter 20970):
  Avg similarity: 0.0389 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 32/100] [Batch 241/669 (36.0%)] [Iter 20980] Loss: 1.2099 (freq: 0.4292, raw: 0.7797, quant: 0.0010, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[730,928,428,852,981,964,99,1005,797,943,470,196,54,658,218]


π”¬ Encoder Diversity (iter 20980):
  Avg similarity: 0.0273 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 32/100] [Batch 251/669 (37.5%)] [Iter 20990] Loss: 1.1808 (freq: 0.4424, raw: 0.7375, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[92,535,692,428,615,908,328,602,280,434,182,195,928,377,289]


π”¬ Encoder Diversity (iter 20990):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 32/100] [Batch 261/669 (39.0%)] [Iter 21000] Loss: 0.9192 (freq: 0.3229, raw: 0.5954, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[928,700,508,615,767,385,195,428,722,981,692,406,964,280,224]


π”¬ Encoder Diversity (iter 21000):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 32/100] [Batch 271/669 (40.5%)] [Iter 21010] Loss: 1.0463 (freq: 0.3675, raw: 0.6779, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[663,603,195,692,652,615,377,816,282,508,308,182,602,416,120]


π”¬ Encoder Diversity (iter 21010):
  Avg similarity: 0.0210 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 32/100] [Batch 281/669 (42.0%)] [Iter 21020] Loss: 1.2876 (freq: 0.4843, raw: 0.8023, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[767,627,526,658,406,435,363,849,509,335,120,54,806,407,319]


π”¬ Encoder Diversity (iter 21020):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 32/100] [Batch 291/669 (43.5%)] [Iter 21030] Loss: 1.0837 (freq: 0.3817, raw: 0.7011, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[273,663,498,195,434,700,883,748,535,602,705,377,652,328,147]


π”¬ Encoder Diversity (iter 21030):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 32/100] [Batch 301/669 (45.0%)] [Iter 21040] Loss: 0.9105 (freq: 0.3234, raw: 0.5863, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[195,700,182,106,772,964,280,802,663,147,535,1005,720,730,615]


π”¬ Encoder Diversity (iter 21040):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 32/100] [Batch 311/669 (46.5%)] [Iter 21050] Loss: 0.9952 (freq: 0.3327, raw: 0.6617, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[663,885,1017,889,599,535,195,451,428,343,869,528,652,730,244]


π”¬ Encoder Diversity (iter 21050):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 32/100] [Batch 321/669 (48.0%)] [Iter 21060] Loss: 1.3199 (freq: 0.5036, raw: 0.8153, quant: 0.0010, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[428,54,273,943,290,720,106,281,335,195,599,182,99,885,77]


π”¬ Encoder Diversity (iter 21060):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 32/100] [Batch 331/669 (49.5%)] [Iter 21070] Loss: 1.1698 (freq: 0.4120, raw: 0.7569, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[106,720,796,885,849,92,615,428,281,289,195,280,627,290,700]


π”¬ Encoder Diversity (iter 21070):
  Avg similarity: 0.0543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 32/100] [Batch 341/669 (51.0%)] [Iter 21080] Loss: 1.3009 (freq: 0.4805, raw: 0.8195, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[136,106,964,281,627,224,526,852,720,599,943,428,885,700,501]


π”¬ Encoder Diversity (iter 21080):
  Avg similarity: 0.0652 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 32/100] [Batch 351/669 (52.5%)] [Iter 21090] Loss: 0.6971 (freq: 0.2402, raw: 0.4561, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[280,42,692,869,195,928,428,1005,535,434,508,20,889,406,603]


π”¬ Encoder Diversity (iter 21090):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 32/100] [Batch 361/669 (54.0%)] [Iter 21100] Loss: 0.8373 (freq: 0.2889, raw: 0.5475, quant: 0.0008, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[692,498,666,92,602,182,1005,816,350,663,661,233,748,428,308]


π”¬ Encoder Diversity (iter 21100):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 32/100] [Batch 371/669 (55.5%)] [Iter 21110] Loss: 0.9821 (freq: 0.3465, raw: 0.6347, quant: 0.0009, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[964,738,202,935,54,599,526,849,692,224,627,885,1018,273,282]


π”¬ Encoder Diversity (iter 21110):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 32/100] [Batch 381/669 (57.0%)] [Iter 21120] Loss: 0.9090 (freq: 0.3128, raw: 0.5953, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[351,663,350,147,434,289,92,273,182,615,498,330,923,200,195]


π”¬ Encoder Diversity (iter 21120):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 32/100] [Batch 391/669 (58.4%)] [Iter 21130] Loss: 1.0589 (freq: 0.3720, raw: 0.6860, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[231,281,106,806,928,470,407,935,627,330,636,964,615,599,526]


π”¬ Encoder Diversity (iter 21130):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 32/100] [Batch 401/669 (59.9%)] [Iter 21140] Loss: 0.9350 (freq: 0.3148, raw: 0.6193, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[720,106,428,330,509,767,615,849,54,498,1005,233,928,92,462]


π”¬ Encoder Diversity (iter 21140):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 32/100] [Batch 411/669 (61.4%)] [Iter 21150] Loss: 1.2217 (freq: 0.4201, raw: 0.8007, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[852,700,428,599,730,509,928,614,218,42,1005,498,330,526,202]


π”¬ Encoder Diversity (iter 21150):
  Avg similarity: 0.0400 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 32/100] [Batch 421/669 (62.9%)] [Iter 21160] Loss: 1.2861 (freq: 0.4284, raw: 0.8568, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[720,52,106,928,852,428,730,372,224,42,318,943,614,406,351]


π”¬ Encoder Diversity (iter 21160):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9625 (0.0=collapsed)
[Epoch 32/100] [Batch 431/669 (64.4%)] [Iter 21170] Loss: 1.0378 (freq: 0.3471, raw: 0.6899, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[280,663,12,200,434,652,195,182,852,692,923,928,273,535,428]


π”¬ Encoder Diversity (iter 21170):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 32/100] [Batch 441/669 (65.9%)] [Iter 21180] Loss: 1.1965 (freq: 0.4263, raw: 0.7693, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[280,852,182,856,195,663,928,106,351,535,434,273,299,692,42]


π”¬ Encoder Diversity (iter 21180):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 32/100] [Batch 451/669 (67.4%)] [Iter 21190] Loss: 1.3255 (freq: 0.4954, raw: 0.8292, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[106,636,259,231,330,218,428,928,1005,627,406,484,849,260,372]


π”¬ Encoder Diversity (iter 21190):
  Avg similarity: 0.0719 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 32/100] [Batch 461/669 (68.9%)] [Iter 21200] Loss: 0.9184 (freq: 0.3263, raw: 0.5913, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[335,636,848,509,428,663,928,692,951,856,666,363,498,406,540]


π”¬ Encoder Diversity (iter 21200):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 32/100] [Batch 471/669 (70.4%)] [Iter 21210] Loss: 1.2966 (freq: 0.4740, raw: 0.8217, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[106,281,767,720,398,428,928,509,614,636,54,885,627,700,363]


π”¬ Encoder Diversity (iter 21210):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 32/100] [Batch 481/669 (71.9%)] [Iter 21220] Loss: 1.1777 (freq: 0.4090, raw: 0.7678, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[636,434,943,498,501,273,964,663,627,509,885,218,852,738,202]


π”¬ Encoder Diversity (iter 21220):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 32/100] [Batch 491/669 (73.4%)] [Iter 21230] Loss: 0.8216 (freq: 0.2528, raw: 0.5680, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[928,498,106,434,856,943,428,700,318,218,852,233,614,663,42]


π”¬ Encoder Diversity (iter 21230):
  Avg similarity: 0.0230 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 32/100] [Batch 501/669 (74.9%)] [Iter 21240] Loss: 0.9018 (freq: 0.2909, raw: 0.6101, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[363,928,852,42,434,106,501,120,789,997,260,202,435,259,218]


π”¬ Encoder Diversity (iter 21240):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 32/100] [Batch 511/669 (76.4%)] [Iter 21250] Loss: 1.2825 (freq: 0.4815, raw: 0.8001, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[434,883,501,498,928,663,856,106,720,136,767,92,233,231,308]


π”¬ Encoder Diversity (iter 21250):
  Avg similarity: 0.0251 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 32/100] [Batch 521/669 (77.9%)] [Iter 21260] Loss: 1.2267 (freq: 0.4690, raw: 0.7566, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[767,789,852,692,520,501,666,509,52,615,796,428,218,106,77]


π”¬ Encoder Diversity (iter 21260):
  Avg similarity: 0.0309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 32/100] [Batch 531/669 (79.4%)] [Iter 21270] Loss: 0.9098 (freq: 0.3186, raw: 0.5903, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 933/1024 (91.1%) Top5:[498,997,579,804,106,118,195,280,557,509,663,124,692,92,856]


π”¬ Encoder Diversity (iter 21270):
  Avg similarity: 0.0285 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 32/100] [Batch 541/669 (80.9%)] [Iter 21280] Loss: 0.8026 (freq: 0.2703, raw: 0.5315, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[498,988,106,663,421,434,195,280,615,540,997,237,928,700,520]


π”¬ Encoder Diversity (iter 21280):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 32/100] [Batch 551/669 (82.4%)] [Iter 21290] Loss: 1.0958 (freq: 0.3522, raw: 0.7426, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[147,700,988,498,182,273,663,195,280,209,106,281,290,675,501]


π”¬ Encoder Diversity (iter 21290):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 32/100] [Batch 561/669 (83.9%)] [Iter 21300] Loss: 1.2478 (freq: 0.4263, raw: 0.8205, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[700,928,106,318,273,540,428,919,289,520,330,281,434,441,280]


π”¬ Encoder Diversity (iter 21300):
  Avg similarity: 0.0624 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 32/100] [Batch 571/669 (85.4%)] [Iter 21310] Loss: 0.9084 (freq: 0.3025, raw: 0.6050, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[428,106,202,928,663,299,700,919,498,767,118,526,182,147,209]


π”¬ Encoder Diversity (iter 21310):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 32/100] [Batch 581/669 (86.8%)] [Iter 21320] Loss: 1.1627 (freq: 0.4004, raw: 0.7614, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[720,428,636,106,281,259,928,501,202,990,52,420,614,767,525]


π”¬ Encoder Diversity (iter 21320):
  Avg similarity: 0.0327 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 32/100] [Batch 591/669 (88.3%)] [Iter 21330] Loss: 1.0692 (freq: 0.3651, raw: 0.7032, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[330,578,856,106,273,501,498,967,434,928,971,182,195,202,692]


π”¬ Encoder Diversity (iter 21330):
  Avg similarity: 0.0246 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 32/100] [Batch 601/669 (89.8%)] [Iter 21340] Loss: 1.0311 (freq: 0.3689, raw: 0.6613, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[509,330,501,318,636,856,526,259,195,730,943,578,273,558,627]


π”¬ Encoder Diversity (iter 21340):
  Avg similarity: 0.0466 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 32/100] [Batch 611/669 (91.3%)] [Iter 21350] Loss: 1.4073 (freq: 0.5131, raw: 0.8932, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[273,692,435,428,299,260,202,964,971,318,195,928,502,281,849]


π”¬ Encoder Diversity (iter 21350):
  Avg similarity: 0.0270 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 32/100] [Batch 621/669 (92.8%)] [Iter 21360] Loss: 1.2394 (freq: 0.4841, raw: 0.7544, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[273,981,182,526,692,967,451,700,285,330,106,434,725,509,928]


π”¬ Encoder Diversity (iter 21360):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 32/100] [Batch 631/669 (94.3%)] [Iter 21370] Loss: 0.9413 (freq: 0.3393, raw: 0.6012, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[195,967,273,296,663,434,832,692,799,856,237,202,285,281,720]


π”¬ Encoder Diversity (iter 21370):
  Avg similarity: 0.0268 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 32/100] [Batch 641/669 (95.8%)] [Iter 21380] Loss: 1.0312 (freq: 0.3695, raw: 0.6608, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[228,106,195,692,202,147,981,525,332,273,440,428,259,720,52]


π”¬ Encoder Diversity (iter 21380):
  Avg similarity: 0.0237 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 32/100] [Batch 651/669 (97.3%)] [Iter 21390] Loss: 1.0033 (freq: 0.3407, raw: 0.6618, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[720,967,405,526,578,451,856,421,52,502,428,232,692,525,195]


π”¬ Encoder Diversity (iter 21390):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 32/100] [Batch 661/669 (98.8%)] [Iter 21400] Loss: 0.9243 (freq: 0.3179, raw: 0.6056, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[627,428,720,501,526,202,578,232,849,832,852,296,106,52,136]


π”¬ Encoder Diversity (iter 21400):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)

================================================================================
[Epoch 32] Validation Results:
  Total Loss: 0.5566
  Freq Loss:  0.1668
  Raw Loss:   0.3890
  Quant Loss: 0.0009
  π“ Codebook Usage: 460/1024 (44.9%)
  π“ Codebook Entropy: 4.7209 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28076 (21.6%)
  Top 10 most used codes:
    1. Code 497: 3590 times (2.76%)
    2. Code 986: 3036 times (2.33%)
    3. Code 182: 3028 times (2.33%)
    4. Code 14: 3024 times (2.32%)
    5. Code 156: 2890 times (2.22%)
    6. Code 228: 2623 times (2.01%)
    7. Code 147: 2493 times (1.91%)
    8. Code 971: 2483 times (1.91%)
    9. Code 728: 2459 times (1.89%)
    10. Code 502: 2450 times (1.88%)
  Bottom 5 least used codes (among used):
    1. Code 774: 1 times (0.00%)
    2. Code 694: 1 times (0.00%)
    3. Code 573: 1 times (0.00%)
    4. Code 947: 5 times (0.00%)
    5. Code 915: 5 times (0.00%)
================================================================================

[EarlyStopping] Patience 5/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 33/100] [Batch 2/669 (0.3%)] [Iter 21410] Loss: 1.4521 (freq: 0.6731, raw: 0.7778, quant: 0.0012, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 975/1024 (95.2%) Top5:[273,832,692,967,195,182,455,979,63,228,451,988,14,299,42]


π”¬ Encoder Diversity (iter 21410):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 33/100] [Batch 12/669 (1.8%)] [Iter 21420] Loss: 1.0612 (freq: 0.3621, raw: 0.6982, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 976/1024 (95.3%) Top5:[273,971,832,376,377,979,497,639,118,623,988,692,195,856,280]


π”¬ Encoder Diversity (iter 21420):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 33/100] [Batch 22/669 (3.3%)] [Iter 21430] Loss: 1.0724 (freq: 0.4082, raw: 0.6633, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[195,403,869,280,639,633,182,547,520,716,289,725,405,63,979]


π”¬ Encoder Diversity (iter 21430):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 33/100] [Batch 32/669 (4.8%)] [Iter 21440] Loss: 1.1608 (freq: 0.4258, raw: 0.7341, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[52,716,273,123,502,285,405,200,869,547,977,182,297,195,421]


π”¬ Encoder Diversity (iter 21440):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 33/100] [Batch 42/669 (6.3%)] [Iter 21450] Loss: 1.3582 (freq: 0.5317, raw: 0.8255, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[319,52,403,622,23,82,200,996,922,88,50,347,716,832,692]


π”¬ Encoder Diversity (iter 21450):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 33/100] [Batch 52/669 (7.8%)] [Iter 21460] Loss: 1.0999 (freq: 0.3750, raw: 0.7240, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[610,781,773,870,352,52,200,476,716,23,629,866,692,666,313]


π”¬ Encoder Diversity (iter 21460):
  Avg similarity: 0.0728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9512 (0.0=collapsed)
[Epoch 33/100] [Batch 62/669 (9.3%)] [Iter 21470] Loss: 1.0499 (freq: 0.3613, raw: 0.6878, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[917,781,52,313,376,127,977,610,822,200,773,301,716,629,23]


π”¬ Encoder Diversity (iter 21470):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 33/100] [Batch 72/669 (10.8%)] [Iter 21480] Loss: 1.2869 (freq: 0.4414, raw: 0.8446, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[781,195,52,428,971,639,228,7,272,856,773,313,979,352,832]


π”¬ Encoder Diversity (iter 21480):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 33/100] [Batch 82/669 (12.3%)] [Iter 21490] Loss: 1.0249 (freq: 0.3610, raw: 0.6630, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[228,195,622,502,856,52,23,692,273,199,773,570,781,755,403]


π”¬ Encoder Diversity (iter 21490):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9762 (0.0=collapsed)
[Epoch 33/100] [Batch 92/669 (13.8%)] [Iter 21500] Loss: 0.8689 (freq: 0.2910, raw: 0.5769, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[551,822,273,52,639,352,557,692,280,195,23,659,977,297,476]


π”¬ Encoder Diversity (iter 21500):
  Avg similarity: 0.0349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 33/100] [Batch 102/669 (15.2%)] [Iter 21510] Loss: 0.6410 (freq: 0.1987, raw: 0.4415, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[502,182,285,967,195,52,280,663,139,123,299,421,199,272,510]


π”¬ Encoder Diversity (iter 21510):
  Avg similarity: 0.0223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 33/100] [Batch 112/669 (16.7%)] [Iter 21520] Loss: 0.7648 (freq: 0.2238, raw: 0.5402, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[123,781,52,63,663,547,352,299,163,405,313,520,510,195,273]


π”¬ Encoder Diversity (iter 21520):
  Avg similarity: 0.0646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 33/100] [Batch 122/669 (18.2%)] [Iter 21530] Loss: 1.2336 (freq: 0.4550, raw: 0.7777, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[52,200,551,352,403,30,917,717,199,50,115,23,1014,309,781]


π”¬ Encoder Diversity (iter 21530):
  Avg similarity: 0.0466 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 33/100] [Batch 132/669 (19.7%)] [Iter 21540] Loss: 1.1061 (freq: 0.3767, raw: 0.7285, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[716,977,352,115,23,88,203,200,195,510,717,403,570,672,468]


π”¬ Encoder Diversity (iter 21540):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 33/100] [Batch 142/669 (21.2%)] [Iter 21550] Loss: 1.1748 (freq: 0.4303, raw: 0.7435, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[352,917,200,123,280,922,781,127,510,870,203,52,50,195,139]


π”¬ Encoder Diversity (iter 21550):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 33/100] [Batch 152/669 (22.7%)] [Iter 21560] Loss: 1.0223 (freq: 0.3403, raw: 0.6812, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[52,273,692,917,551,781,502,937,297,557,260,476,376,195,571]


π”¬ Encoder Diversity (iter 21560):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 33/100] [Batch 162/669 (24.2%)] [Iter 21570] Loss: 1.0561 (freq: 0.3782, raw: 0.6770, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[7,309,571,352,476,917,200,551,186,870,195,781,621,773,717]


π”¬ Encoder Diversity (iter 21570):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 33/100] [Batch 172/669 (25.7%)] [Iter 21580] Loss: 1.2533 (freq: 0.4665, raw: 0.7858, quant: 0.0010, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[773,7,195,692,781,468,272,352,610,663,235,967,280,273,30]


π”¬ Encoder Diversity (iter 21580):
  Avg similarity: 0.0634 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 33/100] [Batch 182/669 (27.2%)] [Iter 21590] Loss: 1.1758 (freq: 0.4110, raw: 0.7639, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[195,273,510,104,228,997,30,615,967,663,781,948,883,1019,376]


π”¬ Encoder Diversity (iter 21590):
  Avg similarity: 0.0302 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 33/100] [Batch 192/669 (28.7%)] [Iter 21600] Loss: 0.9767 (freq: 0.3478, raw: 0.6280, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[866,186,309,200,476,510,23,622,571,692,251,403,329,147,195]


π”¬ Encoder Diversity (iter 21600):
  Avg similarity: 0.0214 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 33/100] [Batch 202/669 (30.2%)] [Iter 21610] Loss: 0.7575 (freq: 0.2433, raw: 0.5133, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[692,967,195,624,272,854,52,289,286,30,861,273,917,866,503]


π”¬ Encoder Diversity (iter 21610):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 33/100] [Batch 212/669 (31.7%)] [Iter 21620] Loss: 1.1737 (freq: 0.4424, raw: 0.7303, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[324,716,52,476,781,309,773,629,82,491,621,663,692,23,123]


π”¬ Encoder Diversity (iter 21620):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 33/100] [Batch 222/669 (33.2%)] [Iter 21630] Loss: 1.0267 (freq: 0.3405, raw: 0.6853, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[781,324,52,629,692,510,663,195,352,615,832,716,299,280,503]


π”¬ Encoder Diversity (iter 21630):
  Avg similarity: 0.0599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 33/100] [Batch 232/669 (34.7%)] [Iter 21640] Loss: 0.9881 (freq: 0.3051, raw: 0.6821, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[663,967,195,272,280,23,421,503,585,692,856,104,510,289,917]


π”¬ Encoder Diversity (iter 21640):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 33/100] [Batch 242/669 (36.2%)] [Iter 21650] Loss: 0.9186 (freq: 0.3098, raw: 0.6080, quant: 0.0008, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[309,510,88,52,491,551,663,503,79,917,629,832,476,195,23]


π”¬ Encoder Diversity (iter 21650):
  Avg similarity: 0.0192 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 33/100] [Batch 252/669 (37.7%)] [Iter 21660] Loss: 1.0554 (freq: 0.3583, raw: 0.6962, quant: 0.0009, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[52,551,621,692,301,922,286,822,622,476,468,352,629,510,727]


π”¬ Encoder Diversity (iter 21660):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 33/100] [Batch 262/669 (39.2%)] [Iter 21670] Loss: 1.0368 (freq: 0.3663, raw: 0.6695, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[781,52,200,309,692,622,88,195,289,629,672,468,79,23,491]


π”¬ Encoder Diversity (iter 21670):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 33/100] [Batch 272/669 (40.7%)] [Iter 21680] Loss: 1.4682 (freq: 0.5696, raw: 0.8975, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[510,200,195,570,301,622,692,237,248,282,503,491,615,52,727]


π”¬ Encoder Diversity (iter 21680):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 33/100] [Batch 282/669 (42.2%)] [Iter 21690] Loss: 1.1143 (freq: 0.3805, raw: 0.7328, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[510,273,104,228,615,352,282,468,52,446,570,350,309,248,195]


π”¬ Encoder Diversity (iter 21690):
  Avg similarity: 0.0376 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 33/100] [Batch 292/669 (43.6%)] [Iter 21700] Loss: 1.0565 (freq: 0.3701, raw: 0.6855, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[352,781,476,88,716,324,830,822,228,663,671,468,301,622,23]


π”¬ Encoder Diversity (iter 21700):
  Avg similarity: 0.0484 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 33/100] [Batch 302/669 (45.1%)] [Iter 21710] Loss: 0.9410 (freq: 0.3200, raw: 0.6202, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[52,551,476,352,781,391,717,491,886,629,301,531,446,950,88]


π”¬ Encoder Diversity (iter 21710):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 33/100] [Batch 312/669 (46.6%)] [Iter 21720] Loss: 1.1921 (freq: 0.4388, raw: 0.7523, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[781,615,352,88,476,52,313,248,951,830,301,868,104,82,886]


π”¬ Encoder Diversity (iter 21720):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 33/100] [Batch 322/669 (48.1%)] [Iter 21730] Loss: 0.8907 (freq: 0.2653, raw: 0.6247, quant: 0.0008, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[615,289,503,868,510,773,692,273,52,491,79,663,832,282,352]


π”¬ Encoder Diversity (iter 21730):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 33/100] [Batch 332/669 (49.6%)] [Iter 21740] Loss: 1.1136 (freq: 0.3786, raw: 0.7341, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[773,88,52,781,352,717,476,922,203,82,491,23,324,886,629]


π”¬ Encoder Diversity (iter 21740):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 33/100] [Batch 342/669 (51.1%)] [Iter 21750] Loss: 0.9048 (freq: 0.2976, raw: 0.6064, quant: 0.0008, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[868,692,510,615,491,147,195,662,476,468,289,88,309,123,186]


π”¬ Encoder Diversity (iter 21750):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 33/100] [Batch 352/669 (52.6%)] [Iter 21760] Loss: 1.2173 (freq: 0.4435, raw: 0.7728, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[309,352,88,52,273,468,659,476,773,277,868,510,629,622,431]


π”¬ Encoder Diversity (iter 21760):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 33/100] [Batch 362/669 (54.1%)] [Iter 21770] Loss: 1.1152 (freq: 0.3831, raw: 0.7312, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[510,692,299,309,52,941,781,717,11,23,937,235,461,352,446]


π”¬ Encoder Diversity (iter 21770):
  Avg similarity: 0.0577 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 33/100] [Batch 372/669 (55.6%)] [Iter 21780] Loss: 1.2066 (freq: 0.4864, raw: 0.7192, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[52,67,23,950,309,403,79,642,301,203,572,127,717,491,622]


π”¬ Encoder Diversity (iter 21780):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 33/100] [Batch 382/669 (57.1%)] [Iter 21790] Loss: 1.1516 (freq: 0.4322, raw: 0.7185, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[510,788,692,272,1005,163,285,289,861,869,663,868,391,424,299]


π”¬ Encoder Diversity (iter 21790):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 33/100] [Batch 392/669 (58.6%)] [Iter 21800] Loss: 1.0522 (freq: 0.3358, raw: 0.7155, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 780/1024 (76.2%) Top5:[615,510,52,476,622,446,299,424,273,692,309,967,352,147,195]


π”¬ Encoder Diversity (iter 21800):
  Avg similarity: 0.0340 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 33/100] [Batch 402/669 (60.1%)] [Iter 21810] Loss: 0.7976 (freq: 0.2602, raw: 0.5366, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[510,967,82,195,491,147,937,446,788,615,104,629,917,237,235]


π”¬ Encoder Diversity (iter 21810):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 33/100] [Batch 412/669 (61.6%)] [Iter 21820] Loss: 0.9761 (freq: 0.3436, raw: 0.6316, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[868,510,622,491,967,272,474,886,309,557,160,280,615,123,237]


π”¬ Encoder Diversity (iter 21820):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 33/100] [Batch 422/669 (63.1%)] [Iter 21830] Loss: 1.1448 (freq: 0.4217, raw: 0.7222, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[123,491,88,773,147,468,324,629,82,352,587,922,531,476,412]


π”¬ Encoder Diversity (iter 21830):
  Avg similarity: 0.0282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 33/100] [Batch 432/669 (64.6%)] [Iter 21840] Loss: 1.0198 (freq: 0.3438, raw: 0.6751, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[23,773,491,352,622,629,52,474,476,485,717,313,403,468,309]


π”¬ Encoder Diversity (iter 21840):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 33/100] [Batch 442/669 (66.1%)] [Iter 21850] Loss: 1.0398 (freq: 0.3663, raw: 0.6726, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[52,476,474,629,788,313,622,412,491,822,309,235,941,88,352]


π”¬ Encoder Diversity (iter 21850):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 33/100] [Batch 452/669 (67.6%)] [Iter 21860] Loss: 0.8862 (freq: 0.2851, raw: 0.6003, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[622,716,309,23,629,773,717,551,88,352,531,491,52,788,781]


π”¬ Encoder Diversity (iter 21860):
  Avg similarity: 0.0401 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 33/100] [Batch 462/669 (69.1%)] [Iter 21870] Loss: 0.9061 (freq: 0.3034, raw: 0.6019, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[510,663,352,934,280,23,622,195,292,422,485,491,692,403,309]


π”¬ Encoder Diversity (iter 21870):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 33/100] [Batch 472/669 (70.6%)] [Iter 21880] Loss: 1.3527 (freq: 0.5331, raw: 0.8186, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[309,629,186,917,716,828,88,491,225,11,468,886,822,717,52]


π”¬ Encoder Diversity (iter 21880):
  Avg similarity: 0.0217 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 33/100] [Batch 482/669 (72.0%)] [Iter 21890] Loss: 1.0329 (freq: 0.3416, raw: 0.6903, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[88,967,491,309,237,510,299,123,225,280,934,407,186,63,137]


π”¬ Encoder Diversity (iter 21890):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 33/100] [Batch 492/669 (73.5%)] [Iter 21900] Loss: 0.8913 (freq: 0.2829, raw: 0.6075, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[773,622,491,828,510,967,692,309,195,615,716,424,629,299,127]


π”¬ Encoder Diversity (iter 21900):
  Avg similarity: 0.0609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 33/100] [Batch 502/669 (75.0%)] [Iter 21910] Loss: 1.3321 (freq: 0.5340, raw: 0.7972, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[773,123,941,622,934,137,510,235,407,476,468,716,485,717,79]


π”¬ Encoder Diversity (iter 21910):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 33/100] [Batch 512/669 (76.5%)] [Iter 21920] Loss: 0.9087 (freq: 0.2834, raw: 0.6246, quant: 0.0008, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[629,476,468,717,510,622,272,503,309,773,195,446,531,258,692]


π”¬ Encoder Diversity (iter 21920):
  Avg similarity: 0.0316 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 33/100] [Batch 522/669 (78.0%)] [Iter 21930] Loss: 1.0640 (freq: 0.3695, raw: 0.6936, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[510,272,692,967,422,868,629,904,299,1022,273,615,773,622,531]


π”¬ Encoder Diversity (iter 21930):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 33/100] [Batch 532/669 (79.5%)] [Iter 21940] Loss: 0.9257 (freq: 0.2944, raw: 0.6304, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[510,692,21,884,323,407,446,622,663,52,273,810,476,352,195]


π”¬ Encoder Diversity (iter 21940):
  Avg similarity: 0.0242 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 33/100] [Batch 542/669 (81.0%)] [Iter 21950] Loss: 0.8656 (freq: 0.3150, raw: 0.5497, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[510,692,967,21,299,273,941,237,904,810,531,629,663,323,195]


π”¬ Encoder Diversity (iter 21950):
  Avg similarity: 0.0730 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 33/100] [Batch 552/669 (82.5%)] [Iter 21960] Loss: 1.0672 (freq: 0.3821, raw: 0.6841, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[904,716,629,476,491,52,147,692,755,474,694,161,828,352,280]


π”¬ Encoder Diversity (iter 21960):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 33/100] [Batch 562/669 (84.0%)] [Iter 21970] Loss: 1.2089 (freq: 0.4191, raw: 0.7889, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[309,629,904,352,476,52,88,886,694,474,313,622,773,587,412]


π”¬ Encoder Diversity (iter 21970):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 33/100] [Batch 572/669 (85.5%)] [Iter 21980] Loss: 1.0667 (freq: 0.3723, raw: 0.6935, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[491,587,622,629,904,717,23,1018,692,88,301,299,272,309,118]


π”¬ Encoder Diversity (iter 21980):
  Avg similarity: 0.0313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 33/100] [Batch 582/669 (87.0%)] [Iter 21990] Loss: 0.9228 (freq: 0.3125, raw: 0.6095, quant: 0.0008, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[692,629,280,755,258,773,476,663,622,323,750,967,954,148,185]


π”¬ Encoder Diversity (iter 21990):
  Avg similarity: 0.0505 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 33/100] [Batch 592/669 (88.5%)] [Iter 22000] Loss: 1.2258 (freq: 0.4421, raw: 0.7827, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[476,52,309,800,717,692,629,622,181,627,324,88,703,531,499]


π”¬ Encoder Diversity (iter 22000):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 33/100] [Batch 602/669 (90.0%)] [Iter 22010] Loss: 0.8047 (freq: 0.2523, raw: 0.5515, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[21,629,485,937,272,364,717,884,82,446,237,88,622,692,422]


π”¬ Encoder Diversity (iter 22010):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 33/100] [Batch 612/669 (91.5%)] [Iter 22020] Loss: 1.0329 (freq: 0.3666, raw: 0.6653, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[692,123,82,272,629,422,23,498,352,587,750,510,967,934,313]


π”¬ Encoder Diversity (iter 22020):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 33/100] [Batch 622/669 (93.0%)] [Iter 22030] Loss: 1.1732 (freq: 0.4156, raw: 0.7568, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[760,498,407,474,272,934,195,755,422,21,973,82,468,503,476]


π”¬ Encoder Diversity (iter 22030):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 33/100] [Batch 632/669 (94.5%)] [Iter 22040] Loss: 1.1934 (freq: 0.4262, raw: 0.7663, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[446,498,235,466,622,52,951,917,123,476,185,127,799,79,491]


π”¬ Encoder Diversity (iter 22040):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 33/100] [Batch 642/669 (96.0%)] [Iter 22050] Loss: 1.1715 (freq: 0.4080, raw: 0.7626, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[967,498,510,503,937,562,629,195,884,422,663,272,716,557,692]


π”¬ Encoder Diversity (iter 22050):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 33/100] [Batch 652/669 (97.5%)] [Iter 22060] Loss: 1.0910 (freq: 0.3732, raw: 0.7169, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[181,531,468,23,52,622,703,235,88,476,822,716,886,629,485]


π”¬ Encoder Diversity (iter 22060):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 33/100] [Batch 662/669 (99.0%)] [Iter 22070] Loss: 1.1731 (freq: 0.4609, raw: 0.7112, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[904,622,476,570,503,822,446,123,195,934,510,272,967,185,88]


π”¬ Encoder Diversity (iter 22070):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)

================================================================================
[Epoch 33] Validation Results:
  Total Loss: 0.5564
  Freq Loss:  0.1639
  Raw Loss:   0.3916
  Quant Loss: 0.0008
  π“ Codebook Usage: 553/1024 (54.0%)
  π“ Codebook Entropy: 5.0025 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 25549 (19.6%)
  Top 10 most used codes:
    1. Code 967: 3126 times (2.40%)
    2. Code 663: 2978 times (2.29%)
    3. Code 258: 2828 times (2.17%)
    4. Code 63: 2667 times (2.05%)
    5. Code 559: 2585 times (1.99%)
    6. Code 154: 2342 times (1.80%)
    7. Code 285: 2319 times (1.78%)
    8. Code 195: 2287 times (1.76%)
    9. Code 997: 2211 times (1.70%)
    10. Code 272: 2206 times (1.69%)
  Bottom 5 least used codes (among used):
    1. Code 326: 1 times (0.00%)
    2. Code 48: 1 times (0.00%)
    3. Code 479: 1 times (0.00%)
    4. Code 780: 1 times (0.00%)
    5. Code 497: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 6/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 34/100] [Batch 3/669 (0.4%)] [Iter 22080] Loss: 1.2579 (freq: 0.4977, raw: 0.7592, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 997/1024 (97.4%) Top5:[309,916,339,510,446,693,407,692,364,503,82,424,884,663,195]


π”¬ Encoder Diversity (iter 22080):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 34/100] [Batch 13/669 (1.9%)] [Iter 22090] Loss: 1.4185 (freq: 0.5096, raw: 0.9079, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 959/1024 (93.7%) Top5:[510,973,99,458,640,755,750,0,569,498,195,273,627,503,208]


π”¬ Encoder Diversity (iter 22090):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 34/100] [Batch 23/669 (3.4%)] [Iter 22100] Loss: 0.8986 (freq: 0.3076, raw: 0.5901, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[967,510,941,272,273,916,422,503,578,692,1003,446,859,331,249]


π”¬ Encoder Diversity (iter 22100):
  Avg similarity: 0.0611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9497 (0.0=collapsed)
[Epoch 34/100] [Batch 33/669 (4.9%)] [Iter 22110] Loss: 1.2588 (freq: 0.4634, raw: 0.7943, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[1003,677,309,424,615,693,273,510,99,921,554,322,692,578,410]


π”¬ Encoder Diversity (iter 22110):
  Avg similarity: 0.0665 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 34/100] [Batch 43/669 (6.4%)] [Iter 22120] Loss: 1.0563 (freq: 0.3576, raw: 0.6978, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[1003,215,410,663,632,693,812,921,510,503,614,750,559,554,424]


π”¬ Encoder Diversity (iter 22120):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 34/100] [Batch 53/669 (7.9%)] [Iter 22130] Loss: 1.1834 (freq: 0.4361, raw: 0.7464, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[693,1003,692,510,503,967,640,951,424,498,422,663,921,557,249]


π”¬ Encoder Diversity (iter 22130):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 34/100] [Batch 63/669 (9.4%)] [Iter 22140] Loss: 1.1439 (freq: 0.3818, raw: 0.7612, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[309,921,677,894,693,410,331,458,99,765,422,632,510,446,147]


π”¬ Encoder Diversity (iter 22140):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 34/100] [Batch 73/669 (10.9%)] [Iter 22150] Loss: 0.8827 (freq: 0.2914, raw: 0.5904, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[1003,640,309,554,921,859,99,579,458,249,410,677,148,917,206]


π”¬ Encoder Diversity (iter 22150):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 34/100] [Batch 83/669 (12.4%)] [Iter 22160] Loss: 1.0580 (freq: 0.3814, raw: 0.6757, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[1003,309,921,765,498,951,640,82,369,677,206,249,446,322,215]


π”¬ Encoder Diversity (iter 22160):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 34/100] [Batch 93/669 (13.9%)] [Iter 22170] Loss: 1.2221 (freq: 0.4202, raw: 0.8009, quant: 0.0010, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[615,569,677,99,554,661,1003,331,430,322,403,309,846,619,7]


π”¬ Encoder Diversity (iter 22170):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 34/100] [Batch 103/669 (15.4%)] [Iter 22180] Loss: 1.1491 (freq: 0.3923, raw: 0.7559, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[498,206,510,682,458,1003,620,573,82,407,557,349,323,422,446]


π”¬ Encoder Diversity (iter 22180):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 34/100] [Batch 113/669 (16.9%)] [Iter 22190] Loss: 0.8502 (freq: 0.2805, raw: 0.5688, quant: 0.0008, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[498,510,407,937,951,941,967,195,847,1003,554,799,810,682,323]


π”¬ Encoder Diversity (iter 22190):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 34/100] [Batch 123/669 (18.4%)] [Iter 22200] Loss: 1.0122 (freq: 0.3330, raw: 0.6784, quant: 0.0009, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[677,941,1003,249,951,804,510,765,410,398,503,147,273,574,947]


π”¬ Encoder Diversity (iter 22200):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 34/100] [Batch 133/669 (19.9%)] [Iter 22210] Loss: 1.0168 (freq: 0.3668, raw: 0.6492, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[714,640,677,249,615,273,407,99,1003,682,951,921,148,89,472]


π”¬ Encoder Diversity (iter 22210):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 34/100] [Batch 143/669 (21.4%)] [Iter 22220] Loss: 1.0299 (freq: 0.3785, raw: 0.6505, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[941,693,951,812,663,215,323,677,249,503,369,446,765,424,573]


π”¬ Encoder Diversity (iter 22220):
  Avg similarity: 0.0624 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9551 (0.0=collapsed)
[Epoch 34/100] [Batch 153/669 (22.9%)] [Iter 22230] Loss: 1.0261 (freq: 0.3591, raw: 0.6661, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[249,458,230,554,614,99,677,503,143,112,246,457,439,859,498]


π”¬ Encoder Diversity (iter 22230):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 34/100] [Batch 163/669 (24.4%)] [Iter 22240] Loss: 1.1869 (freq: 0.4213, raw: 0.7646, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[458,422,246,230,472,1003,661,921,554,498,765,799,846,619,206]


π”¬ Encoder Diversity (iter 22240):
  Avg similarity: 0.0246 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 34/100] [Batch 173/669 (25.9%)] [Iter 22250] Loss: 0.7586 (freq: 0.2319, raw: 0.5258, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 820/1024 (80.1%) Top5:[510,692,916,941,195,422,804,753,557,273,89,693,384,503,967]


π”¬ Encoder Diversity (iter 22250):
  Avg similarity: 0.0243 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 34/100] [Batch 183/669 (27.4%)] [Iter 22260] Loss: 0.8203 (freq: 0.2792, raw: 0.5403, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[446,765,249,230,422,352,941,498,812,846,246,951,554,510,1003]


π”¬ Encoder Diversity (iter 22260):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9629 (0.0=collapsed)
[Epoch 34/100] [Batch 193/669 (28.8%)] [Iter 22270] Loss: 1.3038 (freq: 0.4827, raw: 0.8202, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[230,322,765,619,677,249,439,215,352,859,569,147,143,410,846]


π”¬ Encoder Diversity (iter 22270):
  Avg similarity: 0.0583 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9625 (0.0=collapsed)
[Epoch 34/100] [Batch 203/669 (30.3%)] [Iter 22280] Loss: 0.8610 (freq: 0.2536, raw: 0.6066, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[692,230,147,569,510,44,723,573,503,331,663,574,1008,909,554]


π”¬ Encoder Diversity (iter 22280):
  Avg similarity: 0.0550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 34/100] [Batch 213/669 (31.8%)] [Iter 22290] Loss: 0.9383 (freq: 0.3133, raw: 0.6241, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[249,921,230,812,765,835,687,692,99,554,996,574,826,941,548]


π”¬ Encoder Diversity (iter 22290):
  Avg similarity: 0.0673 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 34/100] [Batch 223/669 (33.3%)] [Iter 22300] Loss: 0.9116 (freq: 0.2860, raw: 0.6248, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[230,574,195,765,677,249,102,322,667,99,921,498,554,692,215]


π”¬ Encoder Diversity (iter 22300):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 34/100] [Batch 233/669 (34.8%)] [Iter 22310] Loss: 1.1440 (freq: 0.3983, raw: 0.7448, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[322,331,677,249,921,667,230,503,439,765,246,554,619,498,458]


π”¬ Encoder Diversity (iter 22310):
  Avg similarity: 0.0555 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 34/100] [Batch 243/669 (36.3%)] [Iter 22320] Loss: 1.0354 (freq: 0.3614, raw: 0.6731, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[230,916,921,458,573,661,44,765,627,503,692,677,934,322,195]


π”¬ Encoder Diversity (iter 22320):
  Avg similarity: 0.0517 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 34/100] [Batch 253/669 (37.8%)] [Iter 22330] Loss: 0.7047 (freq: 0.2146, raw: 0.4893, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[510,102,677,661,921,424,246,693,765,105,322,230,285,98,331]


π”¬ Encoder Diversity (iter 22330):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 34/100] [Batch 263/669 (39.3%)] [Iter 22340] Loss: 1.0187 (freq: 0.3866, raw: 0.6311, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[677,504,230,457,246,458,835,46,109,921,687,249,973,498,410]


π”¬ Encoder Diversity (iter 22340):
  Avg similarity: 0.0233 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 34/100] [Batch 273/669 (40.8%)] [Iter 22350] Loss: 1.0553 (freq: 0.3569, raw: 0.6975, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[322,249,230,147,554,458,246,799,812,109,846,765,143,693,102]


π”¬ Encoder Diversity (iter 22350):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 34/100] [Batch 283/669 (42.3%)] [Iter 22360] Loss: 1.3903 (freq: 0.5336, raw: 0.8557, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[99,967,206,1006,147,693,574,0,300,921,846,941,458,352,498]


π”¬ Encoder Diversity (iter 22360):
  Avg similarity: 0.0437 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 34/100] [Batch 293/669 (43.8%)] [Iter 22370] Loss: 0.7716 (freq: 0.2699, raw: 0.5009, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[322,99,249,846,246,804,765,1003,117,147,314,230,916,403,0]


π”¬ Encoder Diversity (iter 22370):
  Avg similarity: 0.0648 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 34/100] [Batch 303/669 (45.3%)] [Iter 22380] Loss: 1.3447 (freq: 0.5130, raw: 0.8307, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[249,921,804,677,143,859,322,1003,510,846,230,102,206,574,147]


π”¬ Encoder Diversity (iter 22380):
  Avg similarity: 0.0794 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9485 (0.0=collapsed)
[Epoch 34/100] [Batch 313/669 (46.8%)] [Iter 22390] Loss: 1.4426 (freq: 0.5563, raw: 0.8853, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[246,206,828,554,249,405,322,812,548,147,677,765,846,102,909]


π”¬ Encoder Diversity (iter 22390):
  Avg similarity: 0.0679 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9471 (0.0=collapsed)
[Epoch 34/100] [Batch 323/669 (48.3%)] [Iter 22400] Loss: 1.3598 (freq: 0.4757, raw: 0.8831, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[322,246,677,102,554,410,331,405,828,510,130,692,230,249,143]


π”¬ Encoder Diversity (iter 22400):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 34/100] [Batch 333/669 (49.8%)] [Iter 22410] Loss: 1.0292 (freq: 0.3860, raw: 0.6422, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[322,677,195,804,1008,617,841,230,246,143,557,859,828,458,214]


π”¬ Encoder Diversity (iter 22410):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 34/100] [Batch 343/669 (51.3%)] [Iter 22420] Loss: 1.1859 (freq: 0.4413, raw: 0.7437, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[322,916,909,937,677,751,510,230,859,804,921,458,422,272,557]


π”¬ Encoder Diversity (iter 22420):
  Avg similarity: 0.0236 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 34/100] [Batch 353/669 (52.8%)] [Iter 22430] Loss: 0.8303 (freq: 0.2711, raw: 0.5583, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[937,510,573,916,272,557,424,693,692,909,422,986,117,1,195]


π”¬ Encoder Diversity (iter 22430):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 34/100] [Batch 363/669 (54.3%)] [Iter 22440] Loss: 0.7795 (freq: 0.2772, raw: 0.5014, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[273,422,510,967,828,322,458,909,617,916,105,693,692,677,431]


π”¬ Encoder Diversity (iter 22440):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 34/100] [Batch 373/669 (55.8%)] [Iter 22450] Loss: 0.9195 (freq: 0.3295, raw: 0.5892, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[246,573,557,693,619,941,677,765,322,947,273,821,921,617,44]


π”¬ Encoder Diversity (iter 22450):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 34/100] [Batch 383/669 (57.2%)] [Iter 22460] Loss: 1.0124 (freq: 0.3417, raw: 0.6699, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[907,206,812,693,859,677,1008,230,273,973,510,246,472,571,323]


π”¬ Encoder Diversity (iter 22460):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 34/100] [Batch 393/669 (58.7%)] [Iter 22470] Loss: 0.9234 (freq: 0.3186, raw: 0.6038, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[941,510,273,693,828,484,967,751,937,557,916,573,44,663,294]


π”¬ Encoder Diversity (iter 22470):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 34/100] [Batch 403/669 (60.2%)] [Iter 22480] Loss: 1.0293 (freq: 0.3741, raw: 0.6543, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[812,916,554,273,322,961,948,765,692,941,937,331,230,369,667]


π”¬ Encoder Diversity (iter 22480):
  Avg similarity: 0.0406 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 34/100] [Batch 413/669 (61.7%)] [Iter 22490] Loss: 1.1095 (freq: 0.3985, raw: 0.7101, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[677,230,941,403,206,215,102,765,374,294,948,812,554,147,0]


π”¬ Encoder Diversity (iter 22490):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 34/100] [Batch 423/669 (63.2%)] [Iter 22500] Loss: 1.1571 (freq: 0.4310, raw: 0.7252, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[692,510,804,677,620,273,693,557,230,663,322,44,206,102,249]


π”¬ Encoder Diversity (iter 22500):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 34/100] [Batch 433/669 (64.7%)] [Iter 22510] Loss: 1.2022 (freq: 0.4440, raw: 0.7572, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[557,804,510,692,828,693,986,573,273,618,941,406,617,961,374]


π”¬ Encoder Diversity (iter 22510):
  Avg similarity: 0.0621 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 34/100] [Batch 443/669 (66.2%)] [Iter 22520] Loss: 1.4316 (freq: 0.5311, raw: 0.8995, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 919/1024 (89.7%) Top5:[923,650,765,921,215,458,413,410,374,745,677,670,619,554,99]


π”¬ Encoder Diversity (iter 22520):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 34/100] [Batch 453/669 (67.7%)] [Iter 22530] Loss: 1.1492 (freq: 0.4040, raw: 0.7443, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 915/1024 (89.4%) Top5:[215,99,677,554,374,331,195,812,622,685,961,109,199,206,147]


π”¬ Encoder Diversity (iter 22530):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 34/100] [Batch 463/669 (69.2%)] [Iter 22540] Loss: 1.0810 (freq: 0.3743, raw: 0.7058, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[677,215,941,745,331,554,937,859,472,907,81,374,322,246,230]


π”¬ Encoder Diversity (iter 22540):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 34/100] [Batch 473/669 (70.7%)] [Iter 22550] Loss: 0.9265 (freq: 0.3025, raw: 0.6232, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[937,693,322,510,246,692,615,941,273,424,827,230,751,897,206]


π”¬ Encoder Diversity (iter 22550):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 34/100] [Batch 483/669 (72.2%)] [Iter 22560] Loss: 0.9582 (freq: 0.3530, raw: 0.6043, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[921,410,322,81,934,504,246,283,835,986,230,147,677,859,206]


π”¬ Encoder Diversity (iter 22560):
  Avg similarity: 0.0708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 34/100] [Batch 493/669 (73.7%)] [Iter 22570] Loss: 1.2094 (freq: 0.4691, raw: 0.7394, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[921,961,765,246,677,446,907,510,109,99,802,554,947,667,692]


π”¬ Encoder Diversity (iter 22570):
  Avg similarity: 0.0586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 34/100] [Batch 503/669 (75.2%)] [Iter 22580] Loss: 1.1683 (freq: 0.4338, raw: 0.7336, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[677,246,961,99,921,322,907,612,374,650,230,381,410,439,331]


π”¬ Encoder Diversity (iter 22580):
  Avg similarity: 0.0720 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 34/100] [Batch 513/669 (76.7%)] [Iter 22590] Loss: 1.0455 (freq: 0.3470, raw: 0.6976, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[510,246,109,921,947,557,828,667,331,116,587,692,579,322,32]


π”¬ Encoder Diversity (iter 22590):
  Avg similarity: 0.0358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 34/100] [Batch 523/669 (78.2%)] [Iter 22600] Loss: 1.0635 (freq: 0.3854, raw: 0.6771, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[331,921,472,929,109,215,557,32,246,622,99,693,692,230,206]


π”¬ Encoder Diversity (iter 22600):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 34/100] [Batch 533/669 (79.7%)] [Iter 22610] Loss: 0.6049 (freq: 0.1740, raw: 0.4300, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[554,921,907,612,961,246,251,109,322,472,510,300,557,230,81]


π”¬ Encoder Diversity (iter 22610):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 34/100] [Batch 543/669 (81.2%)] [Iter 22620] Loss: 1.2006 (freq: 0.3729, raw: 0.8268, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[554,677,206,81,812,215,99,961,612,745,267,921,195,897,374]


π”¬ Encoder Diversity (iter 22620):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 34/100] [Batch 553/669 (82.7%)] [Iter 22630] Loss: 1.0611 (freq: 0.3924, raw: 0.6678, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[560,693,510,822,557,804,300,907,273,751,246,1,619,504,934]


π”¬ Encoder Diversity (iter 22630):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 34/100] [Batch 563/669 (84.2%)] [Iter 22640] Loss: 1.1653 (freq: 0.3940, raw: 0.7703, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[745,670,907,765,677,300,369,554,560,822,1021,510,410,439,251]


π”¬ Encoder Diversity (iter 22640):
  Avg similarity: 0.0239 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 34/100] [Batch 573/669 (85.7%)] [Iter 22650] Loss: 1.4176 (freq: 0.5070, raw: 0.9096, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[273,751,897,693,560,1008,300,557,510,804,294,587,615,249,1]


π”¬ Encoder Diversity (iter 22650):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 34/100] [Batch 583/669 (87.1%)] [Iter 22660] Loss: 1.0532 (freq: 0.3774, raw: 0.6750, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[685,693,560,692,821,941,300,751,557,273,510,202,959,291,246]


π”¬ Encoder Diversity (iter 22660):
  Avg similarity: 0.0639 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9492 (0.0=collapsed)
[Epoch 34/100] [Batch 593/669 (88.6%)] [Iter 22670] Loss: 1.2104 (freq: 0.4770, raw: 0.7324, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[554,685,322,249,410,102,921,996,677,230,947,835,619,460,931]


π”¬ Encoder Diversity (iter 22670):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 34/100] [Batch 603/669 (90.1%)] [Iter 22680] Loss: 1.1420 (freq: 0.4132, raw: 0.7279, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[554,931,907,439,15,374,560,961,424,643,246,622,1015,147,921]


π”¬ Encoder Diversity (iter 22680):
  Avg similarity: 0.0588 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9571 (0.0=collapsed)
[Epoch 34/100] [Batch 613/669 (91.6%)] [Iter 22690] Loss: 0.8711 (freq: 0.3010, raw: 0.5692, quant: 0.0008, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[510,557,374,907,941,251,685,273,504,202,654,267,1015,693,560]


π”¬ Encoder Diversity (iter 22690):
  Avg similarity: 0.0400 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 34/100] [Batch 623/669 (93.1%)] [Iter 22700] Loss: 1.1275 (freq: 0.4029, raw: 0.7237, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[374,554,439,246,322,620,677,929,230,765,95,897,685,116,945]


π”¬ Encoder Diversity (iter 22700):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 34/100] [Batch 633/669 (94.6%)] [Iter 22710] Loss: 1.2913 (freq: 0.4718, raw: 0.8185, quant: 0.0010, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[331,246,685,961,907,921,374,102,612,454,553,322,557,116,929]


π”¬ Encoder Diversity (iter 22710):
  Avg similarity: 0.0326 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 34/100] [Batch 643/669 (96.1%)] [Iter 22720] Loss: 1.0533 (freq: 0.3581, raw: 0.6943, quant: 0.0009, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[374,147,479,406,765,944,81,827,921,554,273,215,601,99,615]


π”¬ Encoder Diversity (iter 22720):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 34/100] [Batch 653/669 (97.6%)] [Iter 22730] Loss: 1.0587 (freq: 0.3687, raw: 0.6890, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[554,147,622,907,267,322,374,859,751,972,403,504,846,945,81]


π”¬ Encoder Diversity (iter 22730):
  Avg similarity: 0.0791 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 34/100] [Batch 663/669 (99.1%)] [Iter 22740] Loss: 1.2229 (freq: 0.4395, raw: 0.7824, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[931,554,961,374,99,331,560,267,751,249,812,612,897,215,921]


π”¬ Encoder Diversity (iter 22740):
  Avg similarity: 0.0641 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9571 (0.0=collapsed)

================================================================================
[Epoch 34] Validation Results:
  Total Loss: 0.5610
  Freq Loss:  0.1630
  Raw Loss:   0.3971
  Quant Loss: 0.0009
  π“ Codebook Usage: 523/1024 (51.1%)
  π“ Codebook Entropy: 4.9204 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28408 (21.8%)
  Top 10 most used codes:
    1. Code 804: 3845 times (2.95%)
    2. Code 218: 3401 times (2.61%)
    3. Code 242: 3219 times (2.47%)
    4. Code 1: 3204 times (2.46%)
    5. Code 802: 2840 times (2.18%)
    6. Code 273: 2668 times (2.05%)
    7. Code 693: 2455 times (1.89%)
    8. Code 692: 2304 times (1.77%)
    9. Code 571: 2265 times (1.74%)
    10. Code 479: 2207 times (1.70%)
  Bottom 5 least used codes (among used):
    1. Code 459: 1 times (0.00%)
    2. Code 395: 1 times (0.00%)
    3. Code 526: 1 times (0.00%)
    4. Code 926: 1 times (0.00%)
    5. Code 604: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 7/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 35/100] [Batch 4/669 (0.6%)] [Iter 22750] Loss: 1.0969 (freq: 0.4261, raw: 0.6699, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 1002/1024 (97.9%) Top5:[692,15,751,822,300,117,44,897,996,479,693,914,658,510,99]


π”¬ Encoder Diversity (iter 22750):
  Avg similarity: 0.0328 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 35/100] [Batch 14/669 (2.1%)] [Iter 22760] Loss: 1.1277 (freq: 0.4002, raw: 0.7266, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 948/1024 (92.6%) Top5:[242,693,920,413,510,995,822,874,492,206,117,479,937,357,941]


π”¬ Encoder Diversity (iter 22760):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 35/100] [Batch 24/669 (3.6%)] [Iter 22770] Loss: 0.9345 (freq: 0.3052, raw: 0.6285, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[692,866,874,446,460,868,565,693,492,863,242,117,557,607,240]


π”¬ Encoder Diversity (iter 22770):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 35/100] [Batch 34/669 (5.1%)] [Iter 22780] Loss: 0.9332 (freq: 0.3241, raw: 0.6083, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[933,510,492,999,1,206,920,291,692,868,619,863,804,478,995]


π”¬ Encoder Diversity (iter 22780):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 35/100] [Batch 44/669 (6.6%)] [Iter 22790] Loss: 0.9185 (freq: 0.3099, raw: 0.6078, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[291,920,188,796,333,429,715,206,607,999,505,863,446,241,204]


π”¬ Encoder Diversity (iter 22790):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 35/100] [Batch 54/669 (8.1%)] [Iter 22800] Loss: 1.1551 (freq: 0.3935, raw: 0.7607, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[863,995,796,715,638,822,29,897,333,20,492,446,466,273,117]


π”¬ Encoder Diversity (iter 22800):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 35/100] [Batch 64/669 (9.6%)] [Iter 22810] Loss: 1.4511 (freq: 0.5579, raw: 0.8922, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[995,607,874,863,478,413,20,188,492,466,796,151,265,425,386]


π”¬ Encoder Diversity (iter 22810):
  Avg similarity: 0.0500 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 35/100] [Batch 74/669 (11.1%)] [Iter 22820] Loss: 1.1104 (freq: 0.3739, raw: 0.7356, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[995,654,920,492,478,241,446,715,562,701,124,100,475,333,607]


π”¬ Encoder Diversity (iter 22820):
  Avg similarity: 0.0642 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 35/100] [Batch 84/669 (12.6%)] [Iter 22830] Loss: 1.1609 (freq: 0.4286, raw: 0.7314, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[333,897,478,995,492,413,206,715,505,607,20,752,851,265,188]


π”¬ Encoder Diversity (iter 22830):
  Avg similarity: 0.0141 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9783 (0.0=collapsed)
[Epoch 35/100] [Batch 94/669 (14.1%)] [Iter 22840] Loss: 0.9875 (freq: 0.3349, raw: 0.6516, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[897,752,668,814,429,492,995,323,369,300,560,719,654,510,446]


π”¬ Encoder Diversity (iter 22840):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 35/100] [Batch 104/669 (15.5%)] [Iter 22850] Loss: 1.1356 (freq: 0.3872, raw: 0.7474, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[492,995,15,425,863,607,692,920,478,874,668,429,413,265,21]


π”¬ Encoder Diversity (iter 22850):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 35/100] [Batch 114/669 (17.0%)] [Iter 22860] Loss: 1.0239 (freq: 0.3620, raw: 0.6611, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[21,615,920,85,692,718,413,273,15,492,460,585,719,607,242]


π”¬ Encoder Diversity (iter 22860):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 35/100] [Batch 124/669 (18.5%)] [Iter 22870] Loss: 0.9384 (freq: 0.3534, raw: 0.5841, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[439,466,562,874,492,995,814,752,638,241,557,100,206,478,20]


π”¬ Encoder Diversity (iter 22870):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 35/100] [Batch 134/669 (20.0%)] [Iter 22880] Loss: 0.8404 (freq: 0.2476, raw: 0.5920, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[719,21,357,15,692,100,273,585,510,693,242,920,619,300,206]


π”¬ Encoder Diversity (iter 22880):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 35/100] [Batch 144/669 (21.5%)] [Iter 22890] Loss: 0.9528 (freq: 0.3440, raw: 0.6079, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[995,369,897,337,693,478,188,334,863,100,719,751,373,413,295]


π”¬ Encoder Diversity (iter 22890):
  Avg similarity: 0.0568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 35/100] [Batch 154/669 (23.0%)] [Iter 22900] Loss: 1.0310 (freq: 0.3589, raw: 0.6711, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[863,920,413,995,492,796,668,557,999,446,241,638,654,1,822]


π”¬ Encoder Diversity (iter 22900):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 35/100] [Batch 164/669 (24.5%)] [Iter 22910] Loss: 1.3119 (freq: 0.4730, raw: 0.8379, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[863,607,188,300,413,874,796,373,369,492,995,466,701,562,822]


π”¬ Encoder Diversity (iter 22910):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 35/100] [Batch 174/669 (26.0%)] [Iter 22920] Loss: 1.0295 (freq: 0.3431, raw: 0.6855, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[413,863,20,607,137,300,668,478,492,584,429,995,838,752,510]


π”¬ Encoder Diversity (iter 22920):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 35/100] [Batch 184/669 (27.5%)] [Iter 22930] Loss: 1.3884 (freq: 0.4859, raw: 0.9015, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[607,780,562,863,206,188,752,373,291,638,119,439,814,926,141]


π”¬ Encoder Diversity (iter 22930):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 35/100] [Batch 194/669 (29.0%)] [Iter 22940] Loss: 0.9153 (freq: 0.3304, raw: 0.5840, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[560,510,15,868,44,557,724,719,1003,300,654,446,897,413,273]


π”¬ Encoder Diversity (iter 22940):
  Avg similarity: 0.0506 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 35/100] [Batch 204/669 (30.5%)] [Iter 22950] Loss: 1.1148 (freq: 0.3737, raw: 0.7402, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[638,413,724,863,560,100,562,995,478,466,291,718,933,607,90]


π”¬ Encoder Diversity (iter 22950):
  Avg similarity: 0.0405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 35/100] [Batch 214/669 (32.0%)] [Iter 22960] Loss: 1.1012 (freq: 0.4085, raw: 0.6917, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[413,439,638,995,874,188,466,796,933,619,588,715,607,863,170]


π”¬ Encoder Diversity (iter 22960):
  Avg similarity: 0.0182 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 35/100] [Batch 224/669 (33.5%)] [Iter 22970] Loss: 1.0670 (freq: 0.3932, raw: 0.6728, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[1,188,413,510,719,439,814,724,90,607,242,357,859,822,874]


π”¬ Encoder Diversity (iter 22970):
  Avg similarity: 0.0548 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 35/100] [Batch 234/669 (35.0%)] [Iter 22980] Loss: 1.1738 (freq: 0.4134, raw: 0.7595, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[863,439,334,562,478,466,151,620,607,20,874,100,597,584,413]


π”¬ Encoder Diversity (iter 22980):
  Avg similarity: 0.0292 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 35/100] [Batch 244/669 (36.5%)] [Iter 22990] Loss: 1.2028 (freq: 0.4585, raw: 0.7434, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[863,995,413,874,828,758,560,510,557,719,897,715,920,752,164]


π”¬ Encoder Diversity (iter 22990):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 35/100] [Batch 254/669 (38.0%)] [Iter 23000] Loss: 1.1989 (freq: 0.4533, raw: 0.7446, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[557,425,265,386,751,1003,814,859,300,796,863,124,560,588,13]


π”¬ Encoder Diversity (iter 23000):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 35/100] [Batch 264/669 (39.5%)] [Iter 23010] Loss: 1.0288 (freq: 0.3440, raw: 0.6839, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[413,863,933,979,1,874,995,1003,897,466,715,557,724,796,492]


π”¬ Encoder Diversity (iter 23010):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 35/100] [Batch 274/669 (41.0%)] [Iter 23020] Loss: 1.1789 (freq: 0.4191, raw: 0.7588, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[413,466,863,995,933,796,425,557,584,964,492,241,715,188,597]


π”¬ Encoder Diversity (iter 23020):
  Avg similarity: 0.0339 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 35/100] [Batch 284/669 (42.5%)] [Iter 23030] Loss: 1.0539 (freq: 0.3801, raw: 0.6729, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[557,446,828,491,413,693,995,15,724,814,751,1003,571,323,913]


π”¬ Encoder Diversity (iter 23030):
  Avg similarity: 0.0296 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 35/100] [Batch 294/669 (43.9%)] [Iter 23040] Loss: 1.1460 (freq: 0.3762, raw: 0.7688, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[557,995,300,822,814,413,863,692,718,1,933,510,874,897,357]


π”¬ Encoder Diversity (iter 23040):
  Avg similarity: 0.0738 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 35/100] [Batch 304/669 (45.4%)] [Iter 23050] Loss: 1.3138 (freq: 0.5252, raw: 0.7876, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[413,874,995,492,505,863,478,373,796,429,350,751,933,296,137]


π”¬ Encoder Diversity (iter 23050):
  Avg similarity: 0.0406 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 35/100] [Batch 314/669 (46.9%)] [Iter 23060] Loss: 1.1562 (freq: 0.3982, raw: 0.7571, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[863,796,413,995,897,188,557,814,76,933,560,100,638,300,137]


π”¬ Encoder Diversity (iter 23060):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 35/100] [Batch 324/669 (48.4%)] [Iter 23070] Loss: 0.9384 (freq: 0.3110, raw: 0.6265, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[863,995,413,701,796,188,948,692,510,526,300,76,429,515,920]


π”¬ Encoder Diversity (iter 23070):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 35/100] [Batch 334/669 (49.9%)] [Iter 23080] Loss: 0.8653 (freq: 0.2806, raw: 0.5838, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[692,822,510,897,526,357,532,273,718,515,300,560,724,491,242]


π”¬ Encoder Diversity (iter 23080):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 35/100] [Batch 344/669 (51.4%)] [Iter 23090] Loss: 0.7527 (freq: 0.2606, raw: 0.4913, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[429,897,863,814,413,100,796,515,466,774,491,428,865,868,242]


π”¬ Encoder Diversity (iter 23090):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 35/100] [Batch 354/669 (52.9%)] [Iter 23100] Loss: 1.1019 (freq: 0.4149, raw: 0.6860, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[607,796,466,492,13,532,863,393,246,163,638,995,334,300,429]


π”¬ Encoder Diversity (iter 23100):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 35/100] [Batch 364/669 (54.4%)] [Iter 23110] Loss: 1.1422 (freq: 0.3997, raw: 0.7415, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[796,995,333,562,429,560,273,466,398,814,774,188,617,758,170]


π”¬ Encoder Diversity (iter 23110):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 35/100] [Batch 374/669 (55.9%)] [Iter 23120] Loss: 1.0844 (freq: 0.3828, raw: 0.7007, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[890,995,863,1021,948,874,796,3,692,413,357,510,15,191,693]


π”¬ Encoder Diversity (iter 23120):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 35/100] [Batch 384/669 (57.4%)] [Iter 23130] Loss: 0.7294 (freq: 0.2098, raw: 0.5188, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[822,510,191,920,323,300,995,557,863,814,692,1021,874,619,492]


π”¬ Encoder Diversity (iter 23130):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 35/100] [Batch 394/669 (58.9%)] [Iter 23140] Loss: 0.9143 (freq: 0.3314, raw: 0.5821, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[288,668,796,774,429,265,638,326,701,995,425,863,890,188,141]


π”¬ Encoder Diversity (iter 23140):
  Avg similarity: 0.0338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 35/100] [Batch 404/669 (60.4%)] [Iter 23150] Loss: 0.9233 (freq: 0.3246, raw: 0.5978, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[510,188,300,326,562,1021,560,838,619,137,607,492,413,439,273]


π”¬ Encoder Diversity (iter 23150):
  Avg similarity: 0.0324 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 35/100] [Batch 414/669 (61.9%)] [Iter 23160] Loss: 0.9840 (freq: 0.3712, raw: 0.6118, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[781,265,100,774,339,13,562,373,712,838,429,425,796,822,151]


π”¬ Encoder Diversity (iter 23160):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 35/100] [Batch 424/669 (63.4%)] [Iter 23170] Loss: 1.0556 (freq: 0.3523, raw: 0.7023, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[995,796,413,492,715,874,522,890,188,510,607,160,774,562,265]


π”¬ Encoder Diversity (iter 23170):
  Avg similarity: 0.0706 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9525 (0.0=collapsed)
[Epoch 35/100] [Batch 434/669 (64.9%)] [Iter 23180] Loss: 1.0169 (freq: 0.3542, raw: 0.6618, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[638,995,452,288,874,562,863,796,265,413,188,160,510,607,701]


π”¬ Encoder Diversity (iter 23180):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 35/100] [Batch 444/669 (66.4%)] [Iter 23190] Loss: 1.1270 (freq: 0.4144, raw: 0.7116, quant: 0.0010, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[452,796,638,607,863,510,699,170,273,1003,920,995,758,701,151]


π”¬ Encoder Diversity (iter 23190):
  Avg similarity: 0.0566 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 35/100] [Batch 454/669 (67.9%)] [Iter 23200] Loss: 0.9860 (freq: 0.3416, raw: 0.6434, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[796,452,478,607,758,334,715,851,920,206,532,814,466,638,510]


π”¬ Encoder Diversity (iter 23200):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 35/100] [Batch 464/669 (69.4%)] [Iter 23210] Loss: 1.1321 (freq: 0.3754, raw: 0.7558, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[796,995,894,863,758,373,874,699,492,160,1012,562,398,413,265]


π”¬ Encoder Diversity (iter 23210):
  Avg similarity: 0.0198 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 35/100] [Batch 474/669 (70.9%)] [Iter 23220] Loss: 1.0609 (freq: 0.3782, raw: 0.6817, quant: 0.0009, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[920,897,515,510,557,802,829,479,901,796,863,295,242,638,15]


π”¬ Encoder Diversity (iter 23220):
  Avg similarity: 0.0248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 35/100] [Batch 484/669 (72.3%)] [Iter 23230] Loss: 0.7749 (freq: 0.2666, raw: 0.5075, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[615,510,585,428,920,515,897,822,830,532,295,373,814,466,562]


π”¬ Encoder Diversity (iter 23230):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 35/100] [Batch 494/669 (73.8%)] [Iter 23240] Loss: 1.0423 (freq: 0.3764, raw: 0.6650, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[466,510,933,863,1021,796,188,15,1012,995,479,607,731,724,588]


π”¬ Encoder Diversity (iter 23240):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 35/100] [Batch 504/669 (75.3%)] [Iter 23250] Loss: 1.0465 (freq: 0.3748, raw: 0.6708, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[874,638,863,920,814,479,644,265,188,137,557,124,724,796,192]


π”¬ Encoder Diversity (iter 23250):
  Avg similarity: 0.0630 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 35/100] [Batch 514/669 (76.8%)] [Iter 23260] Loss: 0.9053 (freq: 0.3243, raw: 0.5801, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[863,151,265,393,822,814,204,638,398,758,466,774,796,557,137]


π”¬ Encoder Diversity (iter 23260):
  Avg similarity: 0.0828 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 35/100] [Batch 524/669 (78.3%)] [Iter 23270] Loss: 1.0115 (freq: 0.3314, raw: 0.6791, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[1012,863,413,874,246,699,668,425,715,557,821,492,933,269,758]


π”¬ Encoder Diversity (iter 23270):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 35/100] [Batch 534/669 (79.8%)] [Iter 23280] Loss: 0.8770 (freq: 0.2746, raw: 0.6016, quant: 0.0008, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[874,995,510,699,863,933,557,413,638,441,466,584,802,796,429]


π”¬ Encoder Diversity (iter 23280):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 35/100] [Batch 544/669 (81.3%)] [Iter 23290] Loss: 1.1900 (freq: 0.4341, raw: 0.7549, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[796,863,995,562,874,1012,663,492,620,326,466,333,607,706,350]


π”¬ Encoder Diversity (iter 23290):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 35/100] [Batch 554/669 (82.8%)] [Iter 23300] Loss: 1.2614 (freq: 0.4681, raw: 0.7923, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[874,429,796,265,160,510,466,560,334,170,246,350,1021,822,137]


π”¬ Encoder Diversity (iter 23300):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)
[Epoch 35/100] [Batch 564/669 (84.3%)] [Iter 23310] Loss: 0.9082 (freq: 0.3235, raw: 0.5837, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[188,1021,687,814,265,429,492,557,18,491,137,273,333,334,73]


π”¬ Encoder Diversity (iter 23310):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 35/100] [Batch 574/669 (85.8%)] [Iter 23320] Loss: 1.1520 (freq: 0.4028, raw: 0.7483, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[492,796,452,466,863,265,510,933,429,137,638,607,441,425,334]


π”¬ Encoder Diversity (iter 23320):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 35/100] [Batch 584/669 (87.3%)] [Iter 23330] Loss: 1.1580 (freq: 0.3976, raw: 0.7594, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[510,511,879,714,731,863,644,1021,188,557,94,491,273,560,425]


π”¬ Encoder Diversity (iter 23330):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 35/100] [Batch 594/669 (88.8%)] [Iter 23340] Loss: 0.9523 (freq: 0.3317, raw: 0.6197, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[796,863,638,613,511,607,334,933,562,952,879,425,413,466,510]


π”¬ Encoder Diversity (iter 23340):
  Avg similarity: 0.0265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 35/100] [Batch 604/669 (90.3%)] [Iter 23350] Loss: 1.2565 (freq: 0.4741, raw: 0.7815, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[638,492,933,429,814,137,668,1021,150,715,863,413,901,326,265]


π”¬ Encoder Diversity (iter 23350):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 35/100] [Batch 614/669 (91.8%)] [Iter 23360] Loss: 1.0054 (freq: 0.3283, raw: 0.6762, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[452,897,247,718,510,802,597,492,413,701,814,1021,796,863,758]


π”¬ Encoder Diversity (iter 23360):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 35/100] [Batch 624/669 (93.3%)] [Iter 23370] Loss: 0.9944 (freq: 0.3560, raw: 0.6375, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[863,796,492,429,510,333,802,188,687,814,795,821,751,386,224]


π”¬ Encoder Diversity (iter 23370):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 35/100] [Batch 634/669 (94.8%)] [Iter 23380] Loss: 1.2343 (freq: 0.4216, raw: 0.8118, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[897,638,796,413,802,510,863,822,188,15,492,466,982,718,620]


π”¬ Encoder Diversity (iter 23380):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 35/100] [Batch 644/669 (96.3%)] [Iter 23390] Loss: 1.3340 (freq: 0.4992, raw: 0.8338, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[644,933,663,1012,224,18,897,863,751,715,492,29,796,429,392]


π”¬ Encoder Diversity (iter 23390):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 35/100] [Batch 654/669 (97.8%)] [Iter 23400] Loss: 1.1545 (freq: 0.4167, raw: 0.7369, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[933,796,492,874,863,620,123,1012,224,466,699,160,982,491,562]


π”¬ Encoder Diversity (iter 23400):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 35/100] [Batch 664/669 (99.3%)] [Iter 23410] Loss: 0.7748 (freq: 0.2499, raw: 0.5241, quant: 0.0008, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[560,897,920,814,802,413,510,982,523,115,731,890,18,492,345]


π”¬ Encoder Diversity (iter 23410):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)

================================================================================
[Epoch 35] Validation Results:
  Total Loss: 0.5531
  Freq Loss:  0.1659
  Raw Loss:   0.3864
  Quant Loss: 0.0008
  π“ Codebook Usage: 580/1024 (56.6%)
  π“ Codebook Entropy: 5.1340 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 25802 (19.8%)
  Top 10 most used codes:
    1. Code 532: 4084 times (3.14%)
    2. Code 392: 2859 times (2.20%)
    3. Code 450: 2770 times (2.13%)
    4. Code 781: 2710 times (2.08%)
    5. Code 266: 2697 times (2.07%)
    6. Code 907: 2355 times (1.81%)
    7. Code 897: 2164 times (1.66%)
    8. Code 493: 2106 times (1.62%)
    9. Code 814: 2038 times (1.57%)
    10. Code 510: 2019 times (1.55%)
  Bottom 5 least used codes (among used):
    1. Code 665: 1 times (0.00%)
    2. Code 255: 1 times (0.00%)
    3. Code 853: 1 times (0.00%)
    4. Code 948: 1 times (0.00%)
    5. Code 923: 1 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 35
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 36/100] [Batch 5/669 (0.7%)] [Iter 23420] Loss: 1.1618 (freq: 0.4342, raw: 0.7264, quant: 0.0011, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 1016/1024 (99.2%) Top5:[491,273,115,731,897,982,687,29,515,781,859,94,1021,490,15]


π”¬ Encoder Diversity (iter 23420):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 36/100] [Batch 15/669 (2.2%)] [Iter 23430] Loss: 0.9929 (freq: 0.3420, raw: 0.6500, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 950/1024 (92.8%) Top5:[510,731,644,515,273,388,1021,221,814,18,29,668,243,816,115]


π”¬ Encoder Diversity (iter 23430):
  Avg similarity: 0.0208 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 36/100] [Batch 25/669 (3.7%)] [Iter 23440] Loss: 0.9432 (freq: 0.3128, raw: 0.6295, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[624,897,815,510,273,731,822,523,859,243,673,821,923,491,493]


π”¬ Encoder Diversity (iter 23440):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 36/100] [Batch 35/669 (5.2%)] [Iter 23450] Loss: 0.9301 (freq: 0.3315, raw: 0.5977, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[815,624,15,221,38,839,510,814,731,560,388,44,920,429,137]


π”¬ Encoder Diversity (iter 23450):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 36/100] [Batch 45/669 (6.7%)] [Iter 23460] Loss: 1.0461 (freq: 0.3627, raw: 0.6824, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[731,221,546,137,128,624,15,570,429,510,686,96,815,421,390]


π”¬ Encoder Diversity (iter 23460):
  Avg similarity: 0.0269 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 36/100] [Batch 55/669 (8.2%)] [Iter 23470] Loss: 1.2355 (freq: 0.4019, raw: 0.8327, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[221,815,390,570,388,592,468,685,889,624,689,292,421,400,326]


π”¬ Encoder Diversity (iter 23470):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 36/100] [Batch 65/669 (9.7%)] [Iter 23480] Loss: 1.1487 (freq: 0.3973, raw: 0.7504, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[920,557,21,221,15,689,814,388,815,1021,923,429,839,802,560]


π”¬ Encoder Diversity (iter 23480):
  Avg similarity: 0.0376 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 36/100] [Batch 75/669 (11.2%)] [Iter 23490] Loss: 0.9436 (freq: 0.3281, raw: 0.6146, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[624,592,885,815,128,892,560,38,687,221,889,510,781,821,326]


π”¬ Encoder Diversity (iter 23490):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 36/100] [Batch 85/669 (12.7%)] [Iter 23500] Loss: 0.9110 (freq: 0.3418, raw: 0.5683, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[557,815,115,491,546,566,73,644,29,663,1003,515,363,15,560]


π”¬ Encoder Diversity (iter 23500):
  Avg similarity: 0.0302 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 36/100] [Batch 95/669 (14.2%)] [Iter 23510] Loss: 1.1225 (freq: 0.3927, raw: 0.7289, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[815,221,816,468,647,390,885,557,128,556,388,137,38,421,400]


π”¬ Encoder Diversity (iter 23510):
  Avg similarity: 0.0482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 36/100] [Batch 105/669 (15.7%)] [Iter 23520] Loss: 1.1325 (freq: 0.4068, raw: 0.7248, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[515,815,546,802,557,923,633,644,624,221,475,388,390,560,536]


π”¬ Encoder Diversity (iter 23520):
  Avg similarity: 0.0171 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 36/100] [Batch 115/669 (17.2%)] [Iter 23530] Loss: 1.0702 (freq: 0.3377, raw: 0.7316, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[815,816,38,59,673,400,885,685,128,221,510,633,878,557,349]


π”¬ Encoder Diversity (iter 23530):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 36/100] [Batch 125/669 (18.7%)] [Iter 23540] Loss: 0.9111 (freq: 0.3175, raw: 0.5927, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[689,685,44,878,243,349,920,388,592,273,687,221,624,762,15]


π”¬ Encoder Diversity (iter 23540):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 36/100] [Batch 135/669 (20.2%)] [Iter 23550] Loss: 0.9585 (freq: 0.3670, raw: 0.5906, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[557,673,515,221,920,137,421,624,388,853,29,592,760,929,543]


π”¬ Encoder Diversity (iter 23550):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 36/100] [Batch 145/669 (21.7%)] [Iter 23560] Loss: 1.0854 (freq: 0.3794, raw: 0.7051, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[920,557,624,429,1009,592,131,853,128,760,546,686,839,885,445]


π”¬ Encoder Diversity (iter 23560):
  Avg similarity: 0.0169 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9777 (0.0=collapsed)
[Epoch 36/100] [Batch 155/669 (23.2%)] [Iter 23570] Loss: 1.0472 (freq: 0.3801, raw: 0.6663, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[920,956,815,566,21,293,557,273,760,1009,839,491,467,363,802]


π”¬ Encoder Diversity (iter 23570):
  Avg similarity: 0.0226 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 36/100] [Batch 165/669 (24.7%)] [Iter 23580] Loss: 1.0719 (freq: 0.3898, raw: 0.6812, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[802,293,920,956,388,1021,557,1003,59,816,644,115,687,568,221]


π”¬ Encoder Diversity (iter 23580):
  Avg similarity: 0.0214 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 36/100] [Batch 175/669 (26.2%)] [Iter 23590] Loss: 1.0541 (freq: 0.3829, raw: 0.6702, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[293,920,214,731,816,358,21,1003,1010,557,332,491,1009,815,204]


π”¬ Encoder Diversity (iter 23590):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 36/100] [Batch 185/669 (27.7%)] [Iter 23600] Loss: 1.0423 (freq: 0.3625, raw: 0.6789, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[546,388,362,878,920,624,293,390,137,816,815,214,543,421,688]


π”¬ Encoder Diversity (iter 23600):
  Avg similarity: 0.0647 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 36/100] [Batch 195/669 (29.1%)] [Iter 23610] Loss: 0.9873 (freq: 0.3331, raw: 0.6533, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[815,816,293,566,388,221,568,885,731,390,25,84,1010,906,673]


π”¬ Encoder Diversity (iter 23610):
  Avg similarity: 0.0438 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 36/100] [Batch 205/669 (30.6%)] [Iter 23620] Loss: 1.2264 (freq: 0.4428, raw: 0.7827, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[816,568,815,576,59,221,445,633,673,371,264,15,592,878,421]


π”¬ Encoder Diversity (iter 23620):
  Avg similarity: 0.0411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 36/100] [Batch 215/669 (32.1%)] [Iter 23630] Loss: 1.3774 (freq: 0.5016, raw: 0.8748, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[221,816,668,892,388,633,570,1010,673,889,390,815,576,624,566]


π”¬ Encoder Diversity (iter 23630):
  Avg similarity: 0.0240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 36/100] [Batch 225/669 (33.6%)] [Iter 23640] Loss: 1.1137 (freq: 0.3836, raw: 0.7292, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[815,1010,523,847,467,515,468,881,461,429,783,719,816,824,802]


π”¬ Encoder Diversity (iter 23640):
  Avg similarity: 0.0246 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 36/100] [Batch 235/669 (35.1%)] [Iter 23650] Loss: 1.4059 (freq: 0.5124, raw: 0.8925, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[624,815,889,568,556,892,923,1013,221,429,885,906,847,783,214]


π”¬ Encoder Diversity (iter 23650):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 36/100] [Batch 245/669 (36.6%)] [Iter 23660] Loss: 1.0674 (freq: 0.4093, raw: 0.6572, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[815,816,847,624,429,892,802,878,390,221,468,961,824,556,637]


π”¬ Encoder Diversity (iter 23660):
  Avg similarity: 0.0244 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 36/100] [Batch 255/669 (38.1%)] [Iter 23670] Loss: 1.0993 (freq: 0.4155, raw: 0.6829, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[532,815,214,568,51,881,131,624,878,221,1003,802,15,1,386]


π”¬ Encoder Diversity (iter 23670):
  Avg similarity: 0.0239 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 36/100] [Batch 265/669 (39.6%)] [Iter 23680] Loss: 1.1385 (freq: 0.3966, raw: 0.7409, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[221,624,546,515,1010,388,568,802,814,29,510,881,561,540,361]


π”¬ Encoder Diversity (iter 23680):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 36/100] [Batch 275/669 (41.1%)] [Iter 23690] Loss: 1.2439 (freq: 0.4852, raw: 0.7578, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 916/1024 (89.5%) Top5:[568,429,221,815,61,624,468,637,556,821,543,515,557,371,1]


π”¬ Encoder Diversity (iter 23690):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 36/100] [Batch 285/669 (42.6%)] [Iter 23700] Loss: 0.6738 (freq: 0.1962, raw: 0.4768, quant: 0.0008, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[221,624,556,815,576,332,1,802,731,532,835,386,920,515,15]


π”¬ Encoder Diversity (iter 23700):
  Avg similarity: 0.0550 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 36/100] [Batch 295/669 (44.1%)] [Iter 23710] Loss: 0.8763 (freq: 0.2758, raw: 0.5996, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[920,881,1010,624,1009,532,566,880,347,923,1003,421,468,386,515]


π”¬ Encoder Diversity (iter 23710):
  Avg similarity: 0.0262 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 36/100] [Batch 305/669 (45.6%)] [Iter 23720] Loss: 1.1450 (freq: 0.4225, raw: 0.7215, quant: 0.0009, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[633,816,429,1010,920,847,566,61,802,390,923,731,815,719,835]


π”¬ Encoder Diversity (iter 23720):
  Avg similarity: 0.0243 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 36/100] [Batch 315/669 (47.1%)] [Iter 23730] Loss: 1.4164 (freq: 0.5318, raw: 0.8836, quant: 0.0010, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[923,516,815,892,624,61,568,221,468,633,816,739,889,44,37]


π”¬ Encoder Diversity (iter 23730):
  Avg similarity: 0.0492 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 36/100] [Batch 325/669 (48.6%)] [Iter 23740] Loss: 0.9073 (freq: 0.2962, raw: 0.6102, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[783,815,566,576,835,557,15,221,131,361,515,568,1021,814,644]


π”¬ Encoder Diversity (iter 23740):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 36/100] [Batch 335/669 (50.1%)] [Iter 23750] Loss: 0.8609 (freq: 0.2943, raw: 0.5657, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[515,468,892,719,686,815,556,15,923,1,981,1013,920,557,467]


π”¬ Encoder Diversity (iter 23750):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 36/100] [Batch 345/669 (51.6%)] [Iter 23760] Loss: 0.9242 (freq: 0.3135, raw: 0.6098, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[815,648,981,214,221,802,624,889,468,1010,256,566,923,292,61]


π”¬ Encoder Diversity (iter 23760):
  Avg similarity: 0.0642 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 36/100] [Batch 355/669 (53.1%)] [Iter 23770] Loss: 1.1120 (freq: 0.3968, raw: 0.7143, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[556,923,889,648,25,429,816,568,686,557,624,332,221,214,388]


π”¬ Encoder Diversity (iter 23770):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 36/100] [Batch 365/669 (54.6%)] [Iter 23780] Loss: 1.0607 (freq: 0.3725, raw: 0.6873, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[624,750,648,61,25,556,390,647,998,269,429,45,923,889,421]


π”¬ Encoder Diversity (iter 23780):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 36/100] [Batch 375/669 (56.1%)] [Iter 23790] Loss: 1.1059 (freq: 0.3765, raw: 0.7284, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[923,532,556,388,566,468,814,15,998,332,1000,594,568,516,164]


π”¬ Encoder Diversity (iter 23790):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 36/100] [Batch 385/669 (57.5%)] [Iter 23800] Loss: 1.1805 (freq: 0.4447, raw: 0.7349, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[429,920,516,568,221,226,256,878,37,633,388,998,981,889,664]


π”¬ Encoder Diversity (iter 23800):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 36/100] [Batch 395/669 (59.0%)] [Iter 23810] Loss: 1.1675 (freq: 0.4147, raw: 0.7518, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[923,568,468,221,673,633,1010,920,361,388,889,61,566,906,429]


π”¬ Encoder Diversity (iter 23810):
  Avg similarity: 0.0216 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 36/100] [Batch 405/669 (60.5%)] [Iter 23820] Loss: 1.1732 (freq: 0.4180, raw: 0.7542, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[889,388,981,723,468,221,815,568,594,648,923,816,371,352,343]


π”¬ Encoder Diversity (iter 23820):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 36/100] [Batch 415/669 (62.0%)] [Iter 23830] Loss: 0.9199 (freq: 0.2876, raw: 0.6315, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[920,582,802,468,566,388,815,352,347,731,556,137,214,76,624]


π”¬ Encoder Diversity (iter 23830):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 36/100] [Batch 425/669 (63.5%)] [Iter 23840] Loss: 0.9030 (freq: 0.3068, raw: 0.5953, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[617,923,981,802,566,388,221,332,343,892,429,686,637,515,1]


π”¬ Encoder Diversity (iter 23840):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 36/100] [Batch 435/669 (65.0%)] [Iter 23850] Loss: 1.2258 (freq: 0.4058, raw: 0.8191, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[221,633,889,923,686,815,892,594,468,624,954,556,388,617,390]


π”¬ Encoder Diversity (iter 23850):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 36/100] [Batch 445/669 (66.5%)] [Iter 23860] Loss: 1.1597 (freq: 0.4098, raw: 0.7490, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[923,221,815,1003,920,981,15,582,566,1021,633,532,816,61,557]


π”¬ Encoder Diversity (iter 23860):
  Avg similarity: 0.0733 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 36/100] [Batch 455/669 (68.0%)] [Iter 23870] Loss: 1.2111 (freq: 0.4608, raw: 0.7493, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[923,15,221,594,892,51,617,920,802,556,889,572,557,388,1]


π”¬ Encoder Diversity (iter 23870):
  Avg similarity: 0.0364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 36/100] [Batch 465/669 (69.5%)] [Iter 23880] Loss: 0.7632 (freq: 0.2466, raw: 0.5157, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[349,566,920,92,751,139,1,510,849,557,302,532,416,88,696]


π”¬ Encoder Diversity (iter 23880):
  Avg similarity: 0.0478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 36/100] [Batch 475/669 (71.0%)] [Iter 23890] Loss: 1.1874 (freq: 0.4323, raw: 0.7542, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[923,653,816,221,214,892,388,556,686,889,390,412,617,37,648]


π”¬ Encoder Diversity (iter 23890):
  Avg similarity: 0.0169 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 36/100] [Batch 485/669 (72.5%)] [Iter 23900] Loss: 1.2226 (freq: 0.4375, raw: 0.7842, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 839/1024 (81.9%) Top5:[566,515,719,889,390,673,594,191,38,694,388,532,816,633,445]


π”¬ Encoder Diversity (iter 23900):
  Avg similarity: 0.0752 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 36/100] [Batch 495/669 (74.0%)] [Iter 23910] Loss: 0.9400 (freq: 0.3318, raw: 0.6074, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[920,566,751,221,361,694,981,923,572,802,390,816,582,648,1010]


π”¬ Encoder Diversity (iter 23910):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 36/100] [Batch 505/669 (75.5%)] [Iter 23920] Loss: 0.9263 (freq: 0.3296, raw: 0.5959, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[923,352,137,532,998,566,390,719,347,889,835,221,648,76,694]


π”¬ Encoder Diversity (iter 23920):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 36/100] [Batch 515/669 (77.0%)] [Iter 23930] Loss: 1.0540 (freq: 0.3397, raw: 0.7134, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[214,624,388,892,751,633,352,889,390,221,783,269,648,724,572]


π”¬ Encoder Diversity (iter 23930):
  Avg similarity: 0.0249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 36/100] [Batch 525/669 (78.5%)] [Iter 23940] Loss: 1.0178 (freq: 0.3244, raw: 0.6925, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[214,61,892,889,624,412,638,783,566,724,920,221,210,155,751]


π”¬ Encoder Diversity (iter 23940):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 36/100] [Batch 535/669 (80.0%)] [Iter 23950] Loss: 1.1504 (freq: 0.3912, raw: 0.7582, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[566,390,918,802,137,751,920,664,349,332,557,633,388,347,532]


π”¬ Encoder Diversity (iter 23950):
  Avg similarity: 0.0833 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 36/100] [Batch 545/669 (81.5%)] [Iter 23960] Loss: 1.0254 (freq: 0.3828, raw: 0.6416, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[923,724,556,210,262,847,418,647,155,655,37,445,572,889,426]


π”¬ Encoder Diversity (iter 23960):
  Avg similarity: 0.0902 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 36/100] [Batch 555/669 (83.0%)] [Iter 23970] Loss: 0.9155 (freq: 0.3142, raw: 0.6004, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[655,221,343,816,624,889,556,38,653,214,568,388,390,468,633]


π”¬ Encoder Diversity (iter 23970):
  Avg similarity: 0.0659 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 36/100] [Batch 565/669 (84.5%)] [Iter 23980] Loss: 0.9391 (freq: 0.3249, raw: 0.6133, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[624,802,816,1022,566,515,445,556,426,637,532,221,920,214,137]


π”¬ Encoder Diversity (iter 23980):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 36/100] [Batch 575/669 (85.9%)] [Iter 23990] Loss: 0.9900 (freq: 0.3564, raw: 0.6326, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[390,352,556,923,816,594,221,724,647,543,566,617,655,388,321]


π”¬ Encoder Diversity (iter 23990):
  Avg similarity: 0.0449 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 36/100] [Batch 585/669 (87.4%)] [Iter 24000] Loss: 0.7418 (freq: 0.2317, raw: 0.5092, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[566,814,175,361,975,557,920,835,515,802,441,148,191,751,70]


π”¬ Encoder Diversity (iter 24000):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 36/100] [Batch 595/669 (88.9%)] [Iter 24010] Loss: 1.1998 (freq: 0.4242, raw: 0.7748, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[624,923,352,155,214,61,783,633,390,724,543,568,556,594,566]


π”¬ Encoder Diversity (iter 24010):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 36/100] [Batch 605/669 (90.4%)] [Iter 24020] Loss: 0.9706 (freq: 0.3193, raw: 0.6504, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[214,802,889,532,54,556,190,334,361,899,155,17,923,724,557]


π”¬ Encoder Diversity (iter 24020):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 36/100] [Batch 615/669 (91.9%)] [Iter 24030] Loss: 1.0432 (freq: 0.3698, raw: 0.6725, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[920,557,61,921,332,889,724,750,624,270,532,799,572,814,647]


π”¬ Encoder Diversity (iter 24030):
  Avg similarity: 0.0309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 36/100] [Batch 625/669 (93.4%)] [Iter 24040] Loss: 0.9163 (freq: 0.2923, raw: 0.6231, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[412,532,751,361,54,814,17,418,802,920,467,557,543,75,921]


π”¬ Encoder Diversity (iter 24040):
  Avg similarity: 0.0453 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 36/100] [Batch 635/669 (94.9%)] [Iter 24050] Loss: 1.2954 (freq: 0.4790, raw: 0.8154, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[214,221,624,429,388,556,648,54,543,390,418,332,920,190,799]


π”¬ Encoder Diversity (iter 24050):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 36/100] [Batch 645/669 (96.4%)] [Iter 24060] Loss: 0.8216 (freq: 0.2812, raw: 0.5396, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[214,920,137,802,648,816,556,557,70,361,54,262,813,332,24]


π”¬ Encoder Diversity (iter 24060):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 36/100] [Batch 655/669 (97.9%)] [Iter 24070] Loss: 1.0109 (freq: 0.3531, raw: 0.6570, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[332,444,991,538,54,50,802,918,59,60,751,349,532,557,361]


π”¬ Encoder Diversity (iter 24070):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 36/100] [Batch 665/669 (99.4%)] [Iter 24080] Loss: 0.9642 (freq: 0.3074, raw: 0.6559, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[617,332,412,88,783,155,568,306,566,878,857,221,572,262,624]


π”¬ Encoder Diversity (iter 24080):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)

================================================================================
[Epoch 36] Validation Results:
  Total Loss: 0.5637
  Freq Loss:  0.1646
  Raw Loss:   0.3982
  Quant Loss: 0.0009
  π“ Codebook Usage: 387/1024 (37.8%)
  π“ Codebook Entropy: 4.6437 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28112 (21.6%)
  Top 10 most used codes:
    1. Code 532: 3278 times (2.52%)
    2. Code 739: 3005 times (2.31%)
    3. Code 1022: 2967 times (2.28%)
    4. Code 718: 2800 times (2.15%)
    5. Code 392: 2775 times (2.13%)
    6. Code 991: 2736 times (2.10%)
    7. Code 538: 2690 times (2.07%)
    8. Code 229: 2624 times (2.02%)
    9. Code 566: 2623 times (2.01%)
    10. Code 515: 2614 times (2.01%)
  Bottom 5 least used codes (among used):
    1. Code 104: 1 times (0.00%)
    2. Code 91: 1 times (0.00%)
    3. Code 759: 1 times (0.00%)
    4. Code 771: 1 times (0.00%)
    5. Code 40: 5 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 37/100] [Batch 6/669 (0.9%)] [Iter 24090] Loss: 0.7942 (freq: 0.2462, raw: 0.5472, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 1022/1024 (99.8%) Top5:[221,323,899,191,920,673,88,566,334,911,467,481,802,1022,332]


π”¬ Encoder Diversity (iter 24090):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 37/100] [Batch 16/669 (2.4%)] [Iter 24100] Loss: 1.0637 (freq: 0.3640, raw: 0.6987, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[999,137,566,920,739,221,671,236,75,59,361,444,673,911,574]


π”¬ Encoder Diversity (iter 24100):
  Avg similarity: 0.0231 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 37/100] [Batch 26/669 (3.9%)] [Iter 24110] Loss: 1.2908 (freq: 0.4715, raw: 0.8184, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[920,462,332,911,814,999,542,739,566,673,4,323,532,735,668]


π”¬ Encoder Diversity (iter 24110):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 37/100] [Batch 36/669 (5.4%)] [Iter 24120] Loss: 1.3130 (freq: 0.5172, raw: 0.7948, quant: 0.0010, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[4,221,88,1001,566,673,462,60,236,911,647,351,999,980,137]


π”¬ Encoder Diversity (iter 24120):
  Avg similarity: 0.0264 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 37/100] [Batch 46/669 (6.9%)] [Iter 24130] Loss: 1.0917 (freq: 0.3759, raw: 0.7149, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[361,401,532,614,323,678,70,354,814,802,673,236,739,557,196]


π”¬ Encoder Diversity (iter 24130):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 37/100] [Batch 56/669 (8.4%)] [Iter 24140] Loss: 0.7886 (freq: 0.2909, raw: 0.4969, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[999,361,990,363,542,857,557,221,920,860,332,59,980,462,349]


π”¬ Encoder Diversity (iter 24140):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 37/100] [Batch 66/669 (9.9%)] [Iter 24150] Loss: 1.1242 (freq: 0.4102, raw: 0.7130, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[990,999,857,543,361,401,980,363,574,236,920,671,532,444,331]


π”¬ Encoder Diversity (iter 24150):
  Avg similarity: 0.0240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 37/100] [Batch 76/669 (11.4%)] [Iter 24160] Loss: 1.0100 (freq: 0.3595, raw: 0.6496, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[532,332,1,802,566,857,999,60,592,439,990,229,515,538,190]


π”¬ Encoder Diversity (iter 24160):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 37/100] [Batch 86/669 (12.9%)] [Iter 24170] Loss: 0.7474 (freq: 0.2170, raw: 0.5296, quant: 0.0008, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[999,417,990,236,583,920,401,419,4,671,614,462,361,481,432]


π”¬ Encoder Diversity (iter 24170):
  Avg similarity: 0.0212 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9774 (0.0=collapsed)
[Epoch 37/100] [Batch 96/669 (14.3%)] [Iter 24180] Loss: 1.2620 (freq: 0.4499, raw: 0.8111, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[574,221,590,999,598,543,462,990,236,417,823,432,911,836,300]


π”¬ Encoder Diversity (iter 24180):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 37/100] [Batch 106/669 (15.8%)] [Iter 24190] Loss: 1.0288 (freq: 0.3385, raw: 0.6894, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[401,802,990,999,814,52,920,439,980,4,361,332,574,614,590]


π”¬ Encoder Diversity (iter 24190):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 37/100] [Batch 116/669 (17.3%)] [Iter 24200] Loss: 1.0728 (freq: 0.3991, raw: 0.6728, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[574,137,980,802,52,206,920,419,501,361,899,793,583,236,836]


π”¬ Encoder Diversity (iter 24200):
  Avg similarity: 0.0338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 37/100] [Batch 126/669 (18.8%)] [Iter 24210] Loss: 1.1004 (freq: 0.3906, raw: 0.7089, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[543,802,735,137,462,814,574,381,417,148,1022,236,999,980,920]


π”¬ Encoder Diversity (iter 24210):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 37/100] [Batch 136/669 (20.3%)] [Iter 24220] Loss: 1.0199 (freq: 0.3736, raw: 0.6454, quant: 0.0009, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[419,574,590,221,598,52,4,6,836,911,314,999,656,236,814]


π”¬ Encoder Diversity (iter 24220):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 37/100] [Batch 146/669 (21.8%)] [Iter 24230] Loss: 0.9863 (freq: 0.3376, raw: 0.6478, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[532,802,997,566,920,175,739,75,501,751,857,60,441,543,557]


π”¬ Encoder Diversity (iter 24230):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 37/100] [Batch 156/669 (23.3%)] [Iter 24240] Loss: 1.0556 (freq: 0.3823, raw: 0.6723, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[598,417,990,130,228,583,381,656,862,300,432,236,802,700,614]


π”¬ Encoder Diversity (iter 24240):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 37/100] [Batch 166/669 (24.8%)] [Iter 24250] Loss: 1.1815 (freq: 0.4457, raw: 0.7349, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[598,583,195,331,980,656,1018,803,671,543,793,542,990,836,300]


π”¬ Encoder Diversity (iter 24250):
  Avg similarity: 0.0401 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 37/100] [Batch 176/669 (26.3%)] [Iter 24260] Loss: 0.4310 (freq: 0.1182, raw: 0.3121, quant: 0.0007, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[969,522,572,566,739,332,545,990,751,172,60,75,997,802,417]


π”¬ Encoder Diversity (iter 24260):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 37/100] [Batch 186/669 (27.8%)] [Iter 24270] Loss: 1.1240 (freq: 0.3982, raw: 0.7249, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[6,990,236,920,542,206,462,75,417,86,802,808,614,60,814]


π”¬ Encoder Diversity (iter 24270):
  Avg similarity: 0.0349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 37/100] [Batch 196/669 (29.3%)] [Iter 24280] Loss: 1.1236 (freq: 0.3977, raw: 0.7250, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[221,52,236,836,990,401,334,6,542,803,980,596,814,543,22]


π”¬ Encoder Diversity (iter 24280):
  Avg similarity: 0.0347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 37/100] [Batch 206/669 (30.8%)] [Iter 24290] Loss: 0.8505 (freq: 0.3054, raw: 0.5442, quant: 0.0008, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[52,574,532,462,332,1022,751,172,566,857,583,997,990,501,4]


π”¬ Encoder Diversity (iter 24290):
  Avg similarity: 0.0613 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 37/100] [Batch 216/669 (32.3%)] [Iter 24300] Loss: 1.1166 (freq: 0.3925, raw: 0.7231, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[574,1018,583,656,52,6,990,542,813,911,59,532,206,1,221]


π”¬ Encoder Diversity (iter 24300):
  Avg similarity: 0.0199 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9777 (0.0=collapsed)
[Epoch 37/100] [Batch 226/669 (33.8%)] [Iter 24310] Loss: 0.8489 (freq: 0.2694, raw: 0.5785, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[206,990,836,803,6,542,363,419,52,569,236,583,920,462,735]


π”¬ Encoder Diversity (iter 24310):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 37/100] [Batch 236/669 (35.3%)] [Iter 24320] Loss: 1.1573 (freq: 0.4169, raw: 0.7394, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[236,21,803,836,52,6,1018,613,417,542,522,266,574,802,300]


π”¬ Encoder Diversity (iter 24320):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 37/100] [Batch 246/669 (36.8%)] [Iter 24330] Loss: 0.9024 (freq: 0.3091, raw: 0.5924, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[920,814,990,547,60,501,441,802,148,137,54,515,221,6,332]


π”¬ Encoder Diversity (iter 24330):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 37/100] [Batch 256/669 (38.3%)] [Iter 24340] Loss: 1.0097 (freq: 0.3455, raw: 0.6633, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[6,547,334,836,221,491,137,574,236,877,545,542,572,980,857]


π”¬ Encoder Diversity (iter 24340):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 37/100] [Batch 266/669 (39.8%)] [Iter 24350] Loss: 0.9849 (freq: 0.3368, raw: 0.6472, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[574,836,557,751,59,75,236,281,148,969,999,60,814,381,6]


π”¬ Encoder Diversity (iter 24350):
  Avg similarity: 0.0466 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 37/100] [Batch 276/669 (41.3%)] [Iter 24360] Loss: 1.3799 (freq: 0.5118, raw: 0.8671, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[836,613,432,547,6,419,920,857,75,814,221,52,656,206,803]


π”¬ Encoder Diversity (iter 24360):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 37/100] [Batch 286/669 (42.8%)] [Iter 24370] Loss: 1.1843 (freq: 0.4271, raw: 0.7562, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[137,332,836,673,75,920,148,557,221,916,547,574,566,532,361]


π”¬ Encoder Diversity (iter 24370):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 37/100] [Batch 296/669 (44.2%)] [Iter 24380] Loss: 1.2875 (freq: 0.4621, raw: 0.8244, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[802,916,613,21,515,751,569,236,52,386,566,501,137,522,543]


π”¬ Encoder Diversity (iter 24380):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 37/100] [Batch 306/669 (45.7%)] [Iter 24390] Loss: 0.8720 (freq: 0.2945, raw: 0.5765, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[997,920,569,802,6,60,462,300,557,751,52,1,739,814,236]


π”¬ Encoder Diversity (iter 24390):
  Avg similarity: 0.0277 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 37/100] [Batch 316/669 (47.2%)] [Iter 24400] Loss: 1.3916 (freq: 0.5113, raw: 0.8792, quant: 0.0011, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[236,462,542,331,300,569,581,228,52,441,813,590,574,386,206]


π”¬ Encoder Diversity (iter 24400):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 37/100] [Batch 326/669 (48.7%)] [Iter 24410] Loss: 1.0479 (freq: 0.3694, raw: 0.6776, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[236,4,474,221,447,173,542,467,946,990,386,569,419,529,464]


π”¬ Encoder Diversity (iter 24410):
  Avg similarity: 0.0885 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9468 (0.0=collapsed)
[Epoch 37/100] [Batch 336/669 (50.2%)] [Iter 24420] Loss: 1.4182 (freq: 0.5300, raw: 0.8872, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[569,236,990,574,21,432,419,331,462,542,999,474,581,613,195]


π”¬ Encoder Diversity (iter 24420):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 37/100] [Batch 346/669 (51.7%)] [Iter 24430] Loss: 1.0953 (freq: 0.3585, raw: 0.7358, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[300,441,236,751,980,857,802,542,118,4,386,532,557,574,21]


π”¬ Encoder Diversity (iter 24430):
  Avg similarity: 0.0204 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 37/100] [Batch 356/669 (53.2%)] [Iter 24440] Loss: 1.3916 (freq: 0.5200, raw: 0.8707, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[4,236,21,186,221,980,581,52,195,432,134,542,751,258,462]


π”¬ Encoder Diversity (iter 24440):
  Avg similarity: 0.0332 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 37/100] [Batch 366/669 (54.7%)] [Iter 24450] Loss: 1.1729 (freq: 0.4401, raw: 0.7317, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[990,980,613,52,920,751,571,118,997,557,739,574,542,395,300]


π”¬ Encoder Diversity (iter 24450):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 37/100] [Batch 376/669 (56.2%)] [Iter 24460] Loss: 1.2884 (freq: 0.4731, raw: 0.8142, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[802,739,395,808,613,501,916,980,266,132,118,590,401,574,35]


π”¬ Encoder Diversity (iter 24460):
  Avg similarity: 0.0246 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 37/100] [Batch 386/669 (57.7%)] [Iter 24470] Loss: 1.1113 (freq: 0.4028, raw: 0.7075, quant: 0.0011, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[608,4,751,814,916,429,20,557,441,59,547,351,522,236,618]


π”¬ Encoder Diversity (iter 24470):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 37/100] [Batch 396/669 (59.2%)] [Iter 24480] Loss: 1.1350 (freq: 0.4145, raw: 0.7196, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[236,990,52,397,613,648,322,581,583,995,735,266,656,228,441]


π”¬ Encoder Diversity (iter 24480):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 37/100] [Batch 406/669 (60.7%)] [Iter 24490] Loss: 1.1143 (freq: 0.3600, raw: 0.7535, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[990,21,596,432,236,980,813,206,6,60,363,351,266,462,322]


π”¬ Encoder Diversity (iter 24490):
  Avg similarity: 0.0520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 37/100] [Batch 416/669 (62.2%)] [Iter 24500] Loss: 1.1442 (freq: 0.4205, raw: 0.7227, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[236,613,1018,386,118,515,857,813,648,351,995,557,814,432,6]


π”¬ Encoder Diversity (iter 24500):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 37/100] [Batch 426/669 (63.7%)] [Iter 24510] Loss: 0.6849 (freq: 0.2364, raw: 0.4477, quant: 0.0008, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[802,132,857,814,60,746,447,339,916,148,920,783,995,990,137]


π”¬ Encoder Diversity (iter 24510):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 37/100] [Batch 436/669 (65.2%)] [Iter 24520] Loss: 1.2366 (freq: 0.4520, raw: 0.7837, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[583,751,532,236,746,6,916,814,52,4,990,75,946,735,21]


π”¬ Encoder Diversity (iter 24520):
  Avg similarity: 0.0462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 37/100] [Batch 446/669 (66.7%)] [Iter 24530] Loss: 1.2321 (freq: 0.4270, raw: 0.8041, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[417,990,236,401,656,613,221,569,118,581,447,206,590,52,571]


π”¬ Encoder Diversity (iter 24530):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 37/100] [Batch 456/669 (68.2%)] [Iter 24540] Loss: 1.2869 (freq: 0.4732, raw: 0.8127, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[613,581,236,990,6,542,569,381,590,118,543,21,332,432,656]


π”¬ Encoder Diversity (iter 24540):
  Avg similarity: 0.0588 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 37/100] [Batch 466/669 (69.7%)] [Iter 24550] Loss: 1.4655 (freq: 0.5776, raw: 0.8869, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[236,574,118,990,206,432,417,803,6,808,141,756,542,441,462]


π”¬ Encoder Diversity (iter 24550):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 37/100] [Batch 476/669 (71.2%)] [Iter 24560] Loss: 0.9113 (freq: 0.3159, raw: 0.5944, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[832,118,1,920,751,814,332,737,441,694,613,206,902,515,236]


π”¬ Encoder Diversity (iter 24560):
  Avg similarity: 0.0167 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 37/100] [Batch 486/669 (72.6%)] [Iter 24570] Loss: 0.8396 (freq: 0.2844, raw: 0.5543, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[118,916,75,751,581,857,501,920,515,739,814,969,532,441,332]


π”¬ Encoder Diversity (iter 24570):
  Avg similarity: 0.0567 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 37/100] [Batch 496/669 (74.1%)] [Iter 24580] Loss: 1.0305 (freq: 0.3665, raw: 0.6630, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[236,990,462,134,206,331,574,590,569,581,980,6,363,258,4]


π”¬ Encoder Diversity (iter 24580):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 37/100] [Batch 506/669 (75.6%)] [Iter 24590] Loss: 1.3007 (freq: 0.4446, raw: 0.8551, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[738,574,980,331,656,386,746,221,542,581,803,739,583,547,206]


π”¬ Encoder Diversity (iter 24590):
  Avg similarity: 0.0218 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 37/100] [Batch 516/669 (77.1%)] [Iter 24600] Loss: 1.0255 (freq: 0.3597, raw: 0.6649, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[802,920,581,21,236,746,258,557,574,132,542,386,206,118,60]


π”¬ Encoder Diversity (iter 24600):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 37/100] [Batch 526/669 (78.6%)] [Iter 24610] Loss: 1.0935 (freq: 0.3773, raw: 0.7153, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[990,462,206,622,557,542,574,916,441,656,4,52,21,902,177]


π”¬ Encoder Diversity (iter 24610):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 37/100] [Batch 536/669 (80.1%)] [Iter 24620] Loss: 0.8000 (freq: 0.2311, raw: 0.5681, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[916,381,751,990,997,441,920,417,746,6,86,673,802,653,857]


π”¬ Encoder Diversity (iter 24620):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 37/100] [Batch 546/669 (81.6%)] [Iter 24630] Loss: 1.0685 (freq: 0.4033, raw: 0.6643, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[462,614,401,569,532,581,916,613,432,857,417,557,751,542,442]


π”¬ Encoder Diversity (iter 24630):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 37/100] [Batch 556/669 (83.1%)] [Iter 24640] Loss: 1.0633 (freq: 0.4050, raw: 0.6574, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[6,542,543,656,332,574,462,803,622,236,322,735,401,441,173]


π”¬ Encoder Diversity (iter 24640):
  Avg similarity: 0.0509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 37/100] [Batch 566/669 (84.6%)] [Iter 24650] Loss: 0.8017 (freq: 0.2676, raw: 0.5332, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[596,6,737,613,532,566,547,814,574,990,462,322,980,650,236]


π”¬ Encoder Diversity (iter 24650):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 37/100] [Batch 576/669 (86.1%)] [Iter 24660] Loss: 1.3217 (freq: 0.4923, raw: 0.8285, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[462,980,148,315,802,60,447,990,574,386,423,206,442,997,4]


π”¬ Encoder Diversity (iter 24660):
  Avg similarity: 0.0572 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 37/100] [Batch 586/669 (87.6%)] [Iter 24670] Loss: 1.1123 (freq: 0.4134, raw: 0.6979, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[542,462,386,980,746,990,295,141,574,52,417,1018,656,673,474]


π”¬ Encoder Diversity (iter 24670):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 37/100] [Batch 596/669 (89.1%)] [Iter 24680] Loss: 1.0460 (freq: 0.3874, raw: 0.6576, quant: 0.0009, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[6,557,75,581,332,746,569,441,462,670,802,916,613,148,995]


π”¬ Encoder Diversity (iter 24680):
  Avg similarity: 0.0683 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 37/100] [Batch 606/669 (90.6%)] [Iter 24690] Loss: 1.0733 (freq: 0.3445, raw: 0.7279, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[802,574,315,622,557,581,6,746,515,997,386,75,148,332,441]


π”¬ Encoder Diversity (iter 24690):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 37/100] [Batch 616/669 (92.1%)] [Iter 24700] Loss: 1.2672 (freq: 0.4690, raw: 0.7973, quant: 0.0010, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[206,990,462,670,574,52,613,386,4,802,746,601,401,332,542]


π”¬ Encoder Diversity (iter 24700):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 37/100] [Batch 626/669 (93.6%)] [Iter 24710] Loss: 1.3363 (freq: 0.5255, raw: 0.8098, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[331,86,542,401,574,622,462,990,836,997,206,436,732,583,236]


π”¬ Encoder Diversity (iter 24710):
  Avg similarity: 0.0692 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 37/100] [Batch 636/669 (95.1%)] [Iter 24720] Loss: 1.3226 (freq: 0.5129, raw: 0.8086, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[735,574,432,206,429,990,312,778,653,441,738,35,447,581,462]


π”¬ Encoder Diversity (iter 24720):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 37/100] [Batch 646/669 (96.6%)] [Iter 24730] Loss: 1.1617 (freq: 0.4364, raw: 0.7244, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[581,462,574,980,624,86,622,515,332,206,386,236,990,568,557]


π”¬ Encoder Diversity (iter 24730):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9629 (0.0=collapsed)
[Epoch 37/100] [Batch 656/669 (98.1%)] [Iter 24740] Loss: 1.0736 (freq: 0.3622, raw: 0.7104, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[670,462,432,590,574,236,206,596,569,581,919,735,990,21,322]


π”¬ Encoder Diversity (iter 24740):
  Avg similarity: 0.0393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 37/100] [Batch 666/669 (99.6%)] [Iter 24750] Loss: 1.2599 (freq: 0.4914, raw: 0.7675, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[574,400,429,1,462,670,467,351,386,1018,547,756,678,590,134]


π”¬ Encoder Diversity (iter 24750):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)

================================================================================
[Epoch 37] Validation Results:
  Total Loss: 0.5491
  Freq Loss:  0.1635
  Raw Loss:   0.3848
  Quant Loss: 0.0009
  π“ Codebook Usage: 607/1024 (59.3%)
  π“ Codebook Entropy: 5.1474 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 22718 (17.4%)
  Top 10 most used codes:
    1. Code 969: 2735 times (2.10%)
    2. Code 642: 2533 times (1.95%)
    3. Code 594: 2507 times (1.93%)
    4. Code 653: 2376 times (1.82%)
    5. Code 977: 2183 times (1.68%)
    6. Code 920: 2154 times (1.65%)
    7. Code 300: 2068 times (1.59%)
    8. Code 467: 2065 times (1.59%)
    9. Code 611: 2049 times (1.57%)
    10. Code 678: 2048 times (1.57%)
  Bottom 5 least used codes (among used):
    1. Code 626: 1 times (0.00%)
    2. Code 318: 1 times (0.00%)
    3. Code 192: 1 times (0.00%)
    4. Code 287: 2 times (0.00%)
    5. Code 638: 3 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 37
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 38/100] [Batch 7/669 (1.0%)] [Iter 24760] Loss: 1.0884 (freq: 0.3689, raw: 0.7185, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 1022/1024 (99.8%) Top5:[746,997,1018,75,386,532,429,916,515,778,653,332,802,631,368]


π”¬ Encoder Diversity (iter 24760):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 38/100] [Batch 17/669 (2.5%)] [Iter 24770] Loss: 1.2199 (freq: 0.4410, raw: 0.7780, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 943/1024 (92.1%) Top5:[386,539,429,137,557,780,538,587,368,837,262,221,975,1018,857]


π”¬ Encoder Diversity (iter 24770):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 38/100] [Batch 27/669 (4.0%)] [Iter 24780] Loss: 1.0205 (freq: 0.3281, raw: 0.6915, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[386,557,221,471,587,213,145,515,332,249,984,335,678,547,837]


π”¬ Encoder Diversity (iter 24780):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 38/100] [Batch 37/669 (5.5%)] [Iter 24790] Loss: 0.9573 (freq: 0.3389, raw: 0.6174, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[338,213,837,975,929,498,584,1018,700,808,1,284,814,335,44]


π”¬ Encoder Diversity (iter 24790):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 38/100] [Batch 47/669 (7.0%)] [Iter 24800] Loss: 1.0221 (freq: 0.3727, raw: 0.6485, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[332,857,501,571,780,145,678,1018,920,578,20,532,746,624,75]


π”¬ Encoder Diversity (iter 24800):
  Avg similarity: 0.0281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 38/100] [Batch 57/669 (8.5%)] [Iter 24810] Loss: 1.0154 (freq: 0.3263, raw: 0.6882, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[975,882,75,648,568,284,870,382,262,441,315,280,338,986,837]


π”¬ Encoder Diversity (iter 24810):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 38/100] [Batch 67/669 (10.0%)] [Iter 24820] Loss: 1.0502 (freq: 0.3531, raw: 0.6962, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[814,145,802,746,332,75,256,386,441,532,882,631,673,967,825]


π”¬ Encoder Diversity (iter 24820):
  Avg similarity: 0.0460 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 38/100] [Batch 77/669 (11.5%)] [Iter 24830] Loss: 1.1831 (freq: 0.3903, raw: 0.7918, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[262,382,284,249,145,837,648,498,825,975,138,213,568,332,882]


π”¬ Encoder Diversity (iter 24830):
  Avg similarity: 0.0588 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 38/100] [Batch 87/669 (13.0%)] [Iter 24840] Loss: 1.0023 (freq: 0.3425, raw: 0.6589, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[280,825,429,27,145,262,473,678,975,137,648,311,802,386,213]


π”¬ Encoder Diversity (iter 24840):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 38/100] [Batch 97/669 (14.5%)] [Iter 24850] Loss: 0.8825 (freq: 0.2970, raw: 0.5846, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[262,497,498,338,473,975,426,803,145,802,923,587,732,50,221]


π”¬ Encoder Diversity (iter 24850):
  Avg similarity: 0.0467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 38/100] [Batch 107/669 (16.0%)] [Iter 24860] Loss: 1.0507 (freq: 0.3986, raw: 0.6512, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[501,338,382,284,386,746,221,905,323,262,473,624,498,426,145]


π”¬ Encoder Diversity (iter 24860):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 38/100] [Batch 117/669 (17.5%)] [Iter 24870] Loss: 1.1896 (freq: 0.4250, raw: 0.7637, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[984,498,746,497,145,238,386,277,27,631,284,323,814,441,1]


π”¬ Encoder Diversity (iter 24870):
  Avg similarity: 0.0202 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9783 (0.0=collapsed)
[Epoch 38/100] [Batch 127/669 (19.0%)] [Iter 24880] Loss: 0.8872 (freq: 0.3062, raw: 0.5802, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[498,557,382,814,1,262,328,332,532,538,221,501,916,770,284]


π”¬ Encoder Diversity (iter 24880):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 38/100] [Batch 137/669 (20.5%)] [Iter 24890] Loss: 1.0868 (freq: 0.3841, raw: 0.7017, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[899,221,262,673,825,905,631,920,467,338,802,746,328,730,75]


π”¬ Encoder Diversity (iter 24890):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 38/100] [Batch 147/669 (22.0%)] [Iter 24900] Loss: 1.0235 (freq: 0.3601, raw: 0.6625, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[498,338,221,262,414,277,527,27,984,526,538,284,473,746,301]


π”¬ Encoder Diversity (iter 24900):
  Avg similarity: 0.0598 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 38/100] [Batch 157/669 (23.5%)] [Iter 24910] Loss: 0.9509 (freq: 0.3235, raw: 0.6266, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[498,497,539,304,471,802,746,557,382,277,367,125,386,825,814]


π”¬ Encoder Diversity (iter 24910):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 38/100] [Batch 167/669 (25.0%)] [Iter 24920] Loss: 1.2992 (freq: 0.4801, raw: 0.8181, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[498,473,382,338,880,262,497,213,44,277,323,975,145,825,587]


π”¬ Encoder Diversity (iter 24920):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 38/100] [Batch 177/669 (26.5%)] [Iter 24930] Loss: 0.8027 (freq: 0.2778, raw: 0.5241, quant: 0.0008, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[498,238,497,262,145,382,501,277,386,802,27,975,473,284,880]


π”¬ Encoder Diversity (iter 24930):
  Avg similarity: 0.0535 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 38/100] [Batch 187/669 (28.0%)] [Iter 24940] Loss: 1.0079 (freq: 0.3439, raw: 0.6631, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[497,386,975,421,75,498,277,825,328,473,145,683,802,315,50]


π”¬ Encoder Diversity (iter 24940):
  Avg similarity: 0.0270 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 38/100] [Batch 197/669 (29.4%)] [Iter 24950] Loss: 1.2325 (freq: 0.4265, raw: 0.8050, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[338,382,587,538,498,323,137,284,429,262,700,473,74,27,419]


π”¬ Encoder Diversity (iter 24950):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 38/100] [Batch 207/669 (30.9%)] [Iter 24960] Loss: 1.1135 (freq: 0.4075, raw: 0.7050, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[780,825,386,315,870,700,262,538,137,393,678,323,382,464,359]


π”¬ Encoder Diversity (iter 24960):
  Avg similarity: 0.0333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 38/100] [Batch 217/669 (32.4%)] [Iter 24970] Loss: 0.8955 (freq: 0.3138, raw: 0.5809, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[802,386,587,498,125,501,29,631,604,497,870,975,382,238,568]


π”¬ Encoder Diversity (iter 24970):
  Avg similarity: 0.0163 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9779 (0.0=collapsed)
[Epoch 38/100] [Batch 227/669 (33.9%)] [Iter 24980] Loss: 1.1450 (freq: 0.4500, raw: 0.6940, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[639,625,471,532,587,277,332,1,367,497,802,414,279,125,116]


π”¬ Encoder Diversity (iter 24980):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 38/100] [Batch 237/669 (35.4%)] [Iter 24990] Loss: 1.1801 (freq: 0.4185, raw: 0.7607, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[125,382,501,539,323,923,367,587,604,338,880,498,802,284,277]


π”¬ Encoder Diversity (iter 24990):
  Avg similarity: 0.0706 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 38/100] [Batch 247/669 (36.9%)] [Iter 25000] Loss: 0.9950 (freq: 0.3554, raw: 0.6387, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[332,825,125,532,471,382,984,639,515,473,746,700,789,526,120]


π”¬ Encoder Diversity (iter 25000):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 38/100] [Batch 257/669 (38.4%)] [Iter 25010] Loss: 0.8419 (freq: 0.2768, raw: 0.5642, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[382,367,825,498,1018,284,120,780,359,975,538,225,50,814,27]


π”¬ Encoder Diversity (iter 25010):
  Avg similarity: 0.0174 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9760 (0.0=collapsed)
[Epoch 38/100] [Batch 267/669 (39.9%)] [Iter 25020] Loss: 1.0794 (freq: 0.4028, raw: 0.6757, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[905,332,339,923,631,870,382,386,305,662,464,29,678,279,1]


π”¬ Encoder Diversity (iter 25020):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 38/100] [Batch 277/669 (41.4%)] [Iter 25030] Loss: 0.8604 (freq: 0.2744, raw: 0.5851, quant: 0.0008, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[332,426,746,975,359,532,1,905,498,814,414,55,662,338,27]


π”¬ Encoder Diversity (iter 25030):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 38/100] [Batch 287/669 (42.9%)] [Iter 25040] Loss: 1.1489 (freq: 0.4255, raw: 0.7224, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[587,683,332,125,411,867,1,359,382,1001,497,855,870,27,631]


π”¬ Encoder Diversity (iter 25040):
  Avg similarity: 0.0449 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 38/100] [Batch 297/669 (44.4%)] [Iter 25050] Loss: 1.0349 (freq: 0.3939, raw: 0.6400, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[277,587,338,464,359,794,426,880,74,975,471,825,335,48,538]


π”¬ Encoder Diversity (iter 25050):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 38/100] [Batch 307/669 (45.9%)] [Iter 25060] Loss: 1.0680 (freq: 0.4093, raw: 0.6578, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[382,639,44,825,604,497,464,367,392,470,347,116,498,975,279]


π”¬ Encoder Diversity (iter 25060):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9517 (0.0=collapsed)
[Epoch 38/100] [Batch 317/669 (47.4%)] [Iter 25070] Loss: 1.1096 (freq: 0.3935, raw: 0.7151, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[473,421,538,587,359,426,382,719,975,880,213,604,645,335,170]


π”¬ Encoder Diversity (iter 25070):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 38/100] [Batch 327/669 (48.9%)] [Iter 25080] Loss: 1.0896 (freq: 0.3898, raw: 0.6989, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[382,426,145,825,473,284,328,975,359,120,367,700,170,338,332]


π”¬ Encoder Diversity (iter 25080):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 38/100] [Batch 337/669 (50.4%)] [Iter 25090] Loss: 0.9822 (freq: 0.3350, raw: 0.6464, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[473,277,574,976,975,332,678,501,382,724,639,145,305,367,359]


π”¬ Encoder Diversity (iter 25090):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 38/100] [Batch 347/669 (51.9%)] [Iter 25100] Loss: 1.0602 (freq: 0.3468, raw: 0.7124, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[421,382,305,262,338,515,532,125,501,587,905,825,975,238,483]


π”¬ Encoder Diversity (iter 25100):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 38/100] [Batch 357/669 (53.4%)] [Iter 25110] Loss: 1.1330 (freq: 0.3988, raw: 0.7332, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[75,964,976,532,332,125,539,574,328,814,277,288,975,899,305]


π”¬ Encoder Diversity (iter 25110):
  Avg similarity: 0.0313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 38/100] [Batch 367/669 (54.9%)] [Iter 25120] Loss: 1.2898 (freq: 0.4846, raw: 0.8042, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[125,305,359,976,367,975,501,670,392,825,288,1,332,532,262]


π”¬ Encoder Diversity (iter 25120):
  Avg similarity: 0.0598 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9550 (0.0=collapsed)
[Epoch 38/100] [Batch 377/669 (56.4%)] [Iter 25130] Loss: 0.9222 (freq: 0.3163, raw: 0.6050, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[125,899,304,192,359,746,501,923,587,305,855,262,75,1,532]


π”¬ Encoder Diversity (iter 25130):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 38/100] [Batch 387/669 (57.8%)] [Iter 25140] Loss: 0.7664 (freq: 0.2429, raw: 0.5225, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[125,587,338,515,382,328,762,225,905,159,964,426,532,700,198]


π”¬ Encoder Diversity (iter 25140):
  Avg similarity: 0.0340 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 38/100] [Batch 397/669 (59.3%)] [Iter 25150] Loss: 1.1082 (freq: 0.3933, raw: 0.7140, quant: 0.0009, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[382,125,923,359,587,202,746,192,185,1,277,210,419,976,145]


π”¬ Encoder Diversity (iter 25150):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 38/100] [Batch 407/669 (60.8%)] [Iter 25160] Loss: 1.0044 (freq: 0.3357, raw: 0.6677, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[305,284,262,426,923,414,198,421,905,419,639,584,75,1,825]


π”¬ Encoder Diversity (iter 25160):
  Avg similarity: 0.0497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 38/100] [Batch 417/669 (62.3%)] [Iter 25170] Loss: 1.1427 (freq: 0.4313, raw: 0.7105, quant: 0.0010, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[923,976,305,746,125,328,829,675,347,145,367,426,905,975,279]


π”¬ Encoder Diversity (iter 25170):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 38/100] [Batch 427/669 (63.8%)] [Iter 25180] Loss: 1.2194 (freq: 0.4125, raw: 0.8059, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[421,382,426,367,238,587,975,262,202,604,923,825,137,483,284]


π”¬ Encoder Diversity (iter 25180):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 38/100] [Batch 437/669 (65.3%)] [Iter 25190] Loss: 0.8367 (freq: 0.2747, raw: 0.5611, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[367,639,923,975,338,515,746,426,369,359,473,825,167,604,905]


π”¬ Encoder Diversity (iter 25190):
  Avg similarity: 0.0142 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 38/100] [Batch 447/669 (66.8%)] [Iter 25200] Loss: 1.0375 (freq: 0.3328, raw: 0.7038, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[587,367,825,964,185,497,363,426,238,120,323,975,308,746,338]


π”¬ Encoder Diversity (iter 25200):
  Avg similarity: 0.0254 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 38/100] [Batch 457/669 (68.3%)] [Iter 25210] Loss: 1.1795 (freq: 0.4345, raw: 0.7440, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[367,975,262,414,138,426,587,539,221,202,170,338,825,833,724]


π”¬ Encoder Diversity (iter 25210):
  Avg similarity: 0.0711 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9478 (0.0=collapsed)
[Epoch 38/100] [Batch 467/669 (69.8%)] [Iter 25220] Loss: 0.8727 (freq: 0.2848, raw: 0.5870, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[975,359,277,923,829,305,833,497,125,905,421,746,246,683,420]


π”¬ Encoder Diversity (iter 25220):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 38/100] [Batch 477/669 (71.3%)] [Iter 25230] Loss: 1.1465 (freq: 0.4225, raw: 0.7230, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[382,426,359,284,262,75,323,367,138,587,192,532,137,975,221]


π”¬ Encoder Diversity (iter 25230):
  Avg similarity: 0.0293 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 38/100] [Batch 487/669 (72.8%)] [Iter 25240] Loss: 0.8201 (freq: 0.2827, raw: 0.5365, quant: 0.0008, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[850,964,746,359,415,305,675,328,75,332,501,598,367,670,125]


π”¬ Encoder Diversity (iter 25240):
  Avg similarity: 0.0436 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 38/100] [Batch 497/669 (74.3%)] [Iter 25250] Loss: 0.9468 (freq: 0.3484, raw: 0.5976, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[382,367,185,27,277,587,952,825,719,279,419,72,829,359,323]


π”¬ Encoder Diversity (iter 25250):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 38/100] [Batch 507/669 (75.8%)] [Iter 25260] Loss: 1.2111 (freq: 0.4678, raw: 0.7422, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[359,587,825,328,125,277,639,284,107,683,923,976,497,907,382]


π”¬ Encoder Diversity (iter 25260):
  Avg similarity: 0.0579 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 38/100] [Batch 517/669 (77.3%)] [Iter 25270] Loss: 1.2694 (freq: 0.4629, raw: 0.8055, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[27,277,367,284,825,426,225,313,202,348,497,296,419,262,880]


π”¬ Encoder Diversity (iter 25270):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9779 (0.0=collapsed)
[Epoch 38/100] [Batch 527/669 (78.8%)] [Iter 25280] Loss: 1.1383 (freq: 0.4044, raw: 0.7330, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[284,532,487,315,964,746,277,598,794,313,984,233,359,367,501]


π”¬ Encoder Diversity (iter 25280):
  Avg similarity: 0.0441 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 38/100] [Batch 537/669 (80.3%)] [Iter 25290] Loss: 1.0456 (freq: 0.3580, raw: 0.6866, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[829,27,367,284,833,359,426,905,907,700,757,587,382,664,308]


π”¬ Encoder Diversity (iter 25290):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 38/100] [Batch 547/669 (81.8%)] [Iter 25300] Loss: 1.1699 (freq: 0.4141, raw: 0.7548, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[284,367,569,639,975,301,645,984,700,225,323,426,907,382,145]


π”¬ Encoder Diversity (iter 25300):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 38/100] [Batch 557/669 (83.3%)] [Iter 25310] Loss: 1.2344 (freq: 0.4262, raw: 0.8072, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[367,27,476,284,382,975,277,587,790,313,426,497,138,202,72]


π”¬ Encoder Diversity (iter 25310):
  Avg similarity: 0.0642 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 38/100] [Batch 567/669 (84.8%)] [Iter 25320] Loss: 0.9213 (freq: 0.2962, raw: 0.6243, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[359,964,569,670,328,415,598,367,746,587,829,313,649,11,323]


π”¬ Encoder Diversity (iter 25320):
  Avg similarity: 0.0176 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 38/100] [Batch 577/669 (86.2%)] [Iter 25330] Loss: 0.9449 (freq: 0.3176, raw: 0.6265, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[367,587,277,639,382,923,598,279,284,746,822,27,975,359,140]


π”¬ Encoder Diversity (iter 25330):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 38/100] [Batch 587/669 (87.7%)] [Iter 25340] Loss: 1.2610 (freq: 0.4585, raw: 0.8015, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[367,639,284,497,382,238,700,27,279,184,587,221,604,569,202]


π”¬ Encoder Diversity (iter 25340):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 38/100] [Batch 597/669 (89.2%)] [Iter 25350] Loss: 0.9512 (freq: 0.3149, raw: 0.6354, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[367,27,279,923,238,746,125,430,569,885,421,497,262,202,359]


π”¬ Encoder Diversity (iter 25350):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 38/100] [Batch 607/669 (90.7%)] [Iter 25360] Loss: 1.2042 (freq: 0.4629, raw: 0.7403, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[569,359,746,328,367,923,174,829,151,305,415,256,318,277,448]


π”¬ Encoder Diversity (iter 25360):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 38/100] [Batch 617/669 (92.2%)] [Iter 25370] Loss: 1.1213 (freq: 0.3767, raw: 0.7437, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[850,856,318,382,185,569,238,198,359,822,816,993,829,928,151]


π”¬ Encoder Diversity (iter 25370):
  Avg similarity: 0.0340 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 38/100] [Batch 627/669 (93.7%)] [Iter 25380] Loss: 0.9619 (freq: 0.3414, raw: 0.6197, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[313,856,256,816,353,497,367,850,225,378,280,746,238,284,151]


π”¬ Encoder Diversity (iter 25380):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 38/100] [Batch 637/669 (95.2%)] [Iter 25390] Loss: 1.0519 (freq: 0.3623, raw: 0.6887, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[328,1012,816,382,151,353,27,850,367,587,359,856,746,928,302]


π”¬ Encoder Diversity (iter 25390):
  Avg similarity: 0.0538 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 38/100] [Batch 647/669 (96.7%)] [Iter 25400] Loss: 0.9802 (freq: 0.3387, raw: 0.6407, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[829,382,639,700,125,174,328,415,604,323,675,504,822,359,185]


π”¬ Encoder Diversity (iter 25400):
  Avg similarity: 0.0220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 38/100] [Batch 657/669 (98.2%)] [Iter 25410] Loss: 0.9419 (freq: 0.3120, raw: 0.6289, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[27,198,367,639,72,584,426,757,262,907,141,379,464,497,225]


π”¬ Encoder Diversity (iter 25410):
  Avg similarity: 0.0196 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9775 (0.0=collapsed)
[Epoch 38/100] [Batch 667/669 (99.7%)] [Iter 25420] Loss: 0.7414 (freq: 0.2446, raw: 0.4960, quant: 0.0008, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[328,382,829,822,415,320,367,27,598,587,999,359,1012,746,11]


π”¬ Encoder Diversity (iter 25420):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)

================================================================================
[Epoch 38] Validation Results:
  Total Loss: 0.5667
  Freq Loss:  0.1703
  Raw Loss:   0.3955
  Quant Loss: 0.0009
  π“ Codebook Usage: 454/1024 (44.3%)
  π“ Codebook Entropy: 4.7571 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28493 (21.9%)
  Top 10 most used codes:
    1. Code 532: 3257 times (2.50%)
    2. Code 151: 3106 times (2.39%)
    3. Code 23: 2894 times (2.22%)
    4. Code 192: 2886 times (2.22%)
    5. Code 816: 2829 times (2.17%)
    6. Code 260: 2796 times (2.15%)
    7. Code 378: 2713 times (2.08%)
    8. Code 125: 2703 times (2.08%)
    9. Code 1012: 2681 times (2.06%)
    10. Code 923: 2628 times (2.02%)
  Bottom 5 least used codes (among used):
    1. Code 562: 1 times (0.00%)
    2. Code 30: 1 times (0.00%)
    3. Code 718: 1 times (0.00%)
    4. Code 868: 1 times (0.00%)
    5. Code 177: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 39/100] [Batch 8/669 (1.2%)] [Iter 25430] Loss: 1.3007 (freq: 0.4505, raw: 0.8492, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 1024/1024 (100.0%) Top5:[262,11,415,829,598,359,414,833,907,757,202,174,313,683,328]


π”¬ Encoder Diversity (iter 25430):
  Avg similarity: 0.0352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 39/100] [Batch 18/669 (2.7%)] [Iter 25440] Loss: 0.8618 (freq: 0.2946, raw: 0.5664, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[262,923,907,313,702,160,1021,754,359,22,475,126,11,569,261]


π”¬ Encoder Diversity (iter 25440):
  Avg similarity: 0.0254 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 39/100] [Batch 28/669 (4.2%)] [Iter 25450] Loss: 0.7642 (freq: 0.2469, raw: 0.5165, quant: 0.0008, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[998,1012,829,746,1000,757,83,67,125,816,754,702,664,822,75]


π”¬ Encoder Diversity (iter 25450):
  Avg similarity: 0.0328 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 39/100] [Batch 38/669 (5.7%)] [Iter 25460] Loss: 1.1313 (freq: 0.4100, raw: 0.7203, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[707,754,998,31,702,1021,907,262,995,18,68,387,419,775,282]


π”¬ Encoder Diversity (iter 25460):
  Avg similarity: 0.0340 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 39/100] [Batch 48/669 (7.2%)] [Iter 25470] Loss: 1.0021 (freq: 0.3469, raw: 0.6543, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[415,359,675,923,829,1012,313,598,192,328,414,11,993,262,464]


π”¬ Encoder Diversity (iter 25470):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 39/100] [Batch 58/669 (8.7%)] [Iter 25480] Loss: 1.0428 (freq: 0.3430, raw: 0.6989, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[702,1000,475,31,998,853,464,587,754,22,335,313,552,68,75]


π”¬ Encoder Diversity (iter 25480):
  Avg similarity: 0.0187 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9778 (0.0=collapsed)
[Epoch 39/100] [Batch 68/669 (10.2%)] [Iter 25490] Loss: 0.9628 (freq: 0.3203, raw: 0.6417, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[328,200,415,754,359,22,598,914,262,833,313,993,910,822,430]


π”¬ Encoder Diversity (iter 25490):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 39/100] [Batch 78/669 (11.7%)] [Iter 25500] Loss: 1.0489 (freq: 0.3718, raw: 0.6762, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[702,707,1012,598,192,441,552,907,262,923,816,328,746,754,380]


π”¬ Encoder Diversity (iter 25500):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 39/100] [Batch 88/669 (13.2%)] [Iter 25510] Loss: 1.1507 (freq: 0.4048, raw: 0.7450, quant: 0.0010, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[754,328,822,816,147,856,444,914,214,670,202,31,855,598,999]


π”¬ Encoder Diversity (iter 25510):
  Avg similarity: 0.0767 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 39/100] [Batch 98/669 (14.6%)] [Iter 25520] Loss: 1.1390 (freq: 0.3816, raw: 0.7564, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[754,707,969,100,328,1012,670,910,387,868,313,193,598,415,22]


π”¬ Encoder Diversity (iter 25520):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 39/100] [Batch 108/669 (16.1%)] [Iter 25530] Loss: 0.7859 (freq: 0.2499, raw: 0.5352, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[923,707,670,996,68,190,683,552,262,387,75,601,1000,754,475]


π”¬ Encoder Diversity (iter 25530):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 39/100] [Batch 118/669 (17.6%)] [Iter 25540] Loss: 0.9700 (freq: 0.3415, raw: 0.6276, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[707,262,632,328,100,112,857,996,193,754,702,448,893,868,969]


π”¬ Encoder Diversity (iter 25540):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 39/100] [Batch 128/669 (19.1%)] [Iter 25550] Loss: 1.0441 (freq: 0.3588, raw: 0.6844, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[707,754,160,214,22,771,313,419,262,857,68,702,598,853,190]


π”¬ Encoder Diversity (iter 25550):
  Avg similarity: 0.0546 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 39/100] [Batch 138/669 (20.6%)] [Iter 25560] Loss: 0.9607 (freq: 0.3453, raw: 0.6145, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[833,702,328,414,359,829,345,362,415,598,192,581,822,125,448]


π”¬ Encoder Diversity (iter 25560):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 39/100] [Batch 148/669 (22.1%)] [Iter 25570] Loss: 1.1919 (freq: 0.4346, raw: 0.7564, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[663,702,914,754,22,255,1021,475,464,160,68,771,328,345,193]


π”¬ Encoder Diversity (iter 25570):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 39/100] [Batch 158/669 (23.6%)] [Iter 25580] Loss: 1.0258 (freq: 0.3241, raw: 0.7008, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[998,1021,202,995,907,262,190,702,464,775,193,214,603,601,313]


π”¬ Encoder Diversity (iter 25580):
  Avg similarity: 0.0295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 39/100] [Batch 168/669 (25.1%)] [Iter 25590] Loss: 1.0060 (freq: 0.3438, raw: 0.6613, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[707,581,702,754,603,328,31,196,853,833,255,22,262,419,762]


π”¬ Encoder Diversity (iter 25590):
  Avg similarity: 0.0178 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 39/100] [Batch 178/669 (26.6%)] [Iter 25600] Loss: 0.9514 (freq: 0.3049, raw: 0.6456, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[362,415,664,214,776,174,998,829,125,328,833,11,993,805,598]


π”¬ Encoder Diversity (iter 25600):
  Avg similarity: 0.0583 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 39/100] [Batch 188/669 (28.1%)] [Iter 25610] Loss: 0.8209 (freq: 0.2986, raw: 0.5214, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[998,805,968,444,259,214,475,776,753,816,986,754,853,977,22]


π”¬ Encoder Diversity (iter 25610):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 39/100] [Batch 198/669 (29.6%)] [Iter 25620] Loss: 1.0918 (freq: 0.3932, raw: 0.6977, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[707,22,754,313,869,419,262,160,598,853,68,998,1012,996,193]


π”¬ Encoder Diversity (iter 25620):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9554 (0.0=collapsed)
[Epoch 39/100] [Batch 208/669 (31.1%)] [Iter 25630] Loss: 1.1629 (freq: 0.3859, raw: 0.7761, quant: 0.0009, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[707,419,670,387,68,160,995,987,976,313,100,587,1000,702,22]


π”¬ Encoder Diversity (iter 25630):
  Avg similarity: 0.0789 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 39/100] [Batch 218/669 (32.6%)] [Iter 25640] Loss: 0.9233 (freq: 0.3116, raw: 0.6108, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[68,707,11,893,22,328,683,387,632,833,362,100,923,702,284]


π”¬ Encoder Diversity (iter 25640):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 39/100] [Batch 228/669 (34.1%)] [Iter 25650] Loss: 0.9245 (freq: 0.3097, raw: 0.6139, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[754,1012,707,475,893,702,640,829,100,1000,333,11,147,68,384]


π”¬ Encoder Diversity (iter 25650):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 39/100] [Batch 238/669 (35.6%)] [Iter 25660] Loss: 1.2510 (freq: 0.4342, raw: 0.8159, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[68,31,914,587,869,707,600,362,603,43,18,901,22,857,415]


π”¬ Encoder Diversity (iter 25660):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 39/100] [Batch 248/669 (37.1%)] [Iter 25670] Loss: 1.4569 (freq: 0.5857, raw: 0.8702, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[313,167,869,601,100,552,362,640,112,68,22,125,31,775,771]


π”¬ Encoder Diversity (iter 25670):
  Avg similarity: 0.0656 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9537 (0.0=collapsed)
[Epoch 39/100] [Batch 258/669 (38.6%)] [Iter 25680] Loss: 1.1058 (freq: 0.3687, raw: 0.7360, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[707,362,923,387,664,893,31,328,202,475,986,816,1021,833,857]


π”¬ Encoder Diversity (iter 25680):
  Avg similarity: 0.0192 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9762 (0.0=collapsed)
[Epoch 39/100] [Batch 268/669 (40.1%)] [Iter 25690] Loss: 1.1833 (freq: 0.3942, raw: 0.7882, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[998,851,387,822,601,384,853,893,430,598,776,313,926,829,214]


π”¬ Encoder Diversity (iter 25690):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 39/100] [Batch 278/669 (41.6%)] [Iter 25700] Loss: 0.9640 (freq: 0.3344, raw: 0.6287, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[31,640,823,987,601,67,714,893,244,262,928,552,846,896,419]


π”¬ Encoder Diversity (iter 25700):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 39/100] [Batch 288/669 (43.0%)] [Iter 25710] Loss: 1.1734 (freq: 0.4184, raw: 0.7541, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[893,1021,632,18,923,707,995,419,857,387,100,192,928,521,11]


π”¬ Encoder Diversity (iter 25710):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9770 (0.0=collapsed)
[Epoch 39/100] [Batch 298/669 (44.5%)] [Iter 25720] Loss: 1.0245 (freq: 0.3436, raw: 0.6799, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[923,968,714,822,544,907,833,857,754,598,776,31,359,680,387]


π”¬ Encoder Diversity (iter 25720):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 39/100] [Batch 308/669 (46.0%)] [Iter 25730] Loss: 1.1905 (freq: 0.4160, raw: 0.7736, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[1021,31,67,262,851,328,415,18,601,923,707,521,680,963,1000]


π”¬ Encoder Diversity (iter 25730):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 39/100] [Batch 318/669 (47.5%)] [Iter 25740] Loss: 0.8200 (freq: 0.2607, raw: 0.5584, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[31,822,968,707,334,387,669,754,100,893,1021,364,996,680,198]


π”¬ Encoder Diversity (iter 25740):
  Avg similarity: 0.0202 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 39/100] [Batch 328/669 (49.0%)] [Iter 25750] Loss: 0.8867 (freq: 0.3026, raw: 0.5832, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[1012,893,598,362,328,1021,822,829,680,262,100,333,415,707,663]


π”¬ Encoder Diversity (iter 25750):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 39/100] [Batch 338/669 (50.5%)] [Iter 25760] Loss: 0.9025 (freq: 0.3366, raw: 0.5650, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[31,1021,707,853,663,530,328,829,278,112,475,467,430,198,125]


π”¬ Encoder Diversity (iter 25760):
  Avg similarity: 0.0429 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 39/100] [Batch 348/669 (52.0%)] [Iter 25770] Loss: 0.5842 (freq: 0.1842, raw: 0.3991, quant: 0.0008, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[198,707,669,1011,448,1012,998,833,328,822,415,802,544,359,11]


π”¬ Encoder Diversity (iter 25770):
  Avg similarity: 0.0349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 39/100] [Batch 358/669 (53.5%)] [Iter 25780] Loss: 1.0432 (freq: 0.3666, raw: 0.6757, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[893,853,1021,707,486,475,31,996,998,851,750,387,313,663,334]


π”¬ Encoder Diversity (iter 25780):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 39/100] [Batch 368/669 (55.0%)] [Iter 25790] Loss: 1.0648 (freq: 0.3869, raw: 0.6769, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[893,1021,31,709,313,362,853,907,857,976,669,707,147,776,598]


π”¬ Encoder Diversity (iter 25790):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 39/100] [Batch 378/669 (56.5%)] [Iter 25800] Loss: 1.2392 (freq: 0.4326, raw: 0.8057, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[893,707,475,31,754,486,996,22,313,869,160,998,663,1021,100]


π”¬ Encoder Diversity (iter 25800):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 39/100] [Batch 388/669 (58.0%)] [Iter 25810] Loss: 1.3329 (freq: 0.4669, raw: 0.8650, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[754,475,100,893,1021,857,963,995,707,31,362,794,996,829,313]


π”¬ Encoder Diversity (iter 25810):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 39/100] [Batch 398/669 (59.5%)] [Iter 25820] Loss: 1.0627 (freq: 0.4091, raw: 0.6527, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[328,359,11,829,1012,474,362,620,822,521,707,833,1021,816,475]


π”¬ Encoder Diversity (iter 25820):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 39/100] [Batch 408/669 (61.0%)] [Iter 25830] Loss: 0.9398 (freq: 0.2918, raw: 0.6471, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[829,1012,794,993,598,199,333,11,125,923,364,530,996,430,776]


π”¬ Encoder Diversity (iter 25830):
  Avg similarity: 0.0490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 39/100] [Batch 418/669 (62.5%)] [Iter 25840] Loss: 1.4085 (freq: 0.5275, raw: 0.8800, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[857,996,193,31,112,1021,307,794,18,486,957,707,600,987,52]


π”¬ Encoder Diversity (iter 25840):
  Avg similarity: 0.0719 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 39/100] [Batch 428/669 (64.0%)] [Iter 25850] Loss: 1.0442 (freq: 0.3933, raw: 0.6498, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[31,193,963,833,707,88,1021,754,680,598,1012,877,18,328,313]


π”¬ Encoder Diversity (iter 25850):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 39/100] [Batch 438/669 (65.5%)] [Iter 25860] Loss: 0.9212 (freq: 0.3116, raw: 0.6087, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[11,930,333,1012,362,384,829,328,430,304,598,199,926,910,776]


π”¬ Encoder Diversity (iter 25860):
  Avg similarity: 0.0189 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 39/100] [Batch 448/669 (67.0%)] [Iter 25870] Loss: 1.0148 (freq: 0.3628, raw: 0.6510, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[125,448,829,1012,893,598,798,851,304,490,930,333,620,680,467]


π”¬ Encoder Diversity (iter 25870):
  Avg similarity: 0.0328 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 39/100] [Batch 458/669 (68.5%)] [Iter 25880] Loss: 0.7677 (freq: 0.2643, raw: 0.5026, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[739,214,851,31,709,620,893,257,334,707,33,313,475,199,530]


π”¬ Encoder Diversity (iter 25880):
  Avg similarity: 0.0358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 39/100] [Batch 468/669 (70.0%)] [Iter 25890] Loss: 0.9801 (freq: 0.3070, raw: 0.6722, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[833,829,328,125,31,853,776,1012,736,620,448,475,333,169,1014]


π”¬ Encoder Diversity (iter 25890):
  Avg similarity: 0.0520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 39/100] [Batch 478/669 (71.4%)] [Iter 25900] Loss: 0.9988 (freq: 0.3522, raw: 0.6457, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[475,998,1021,707,893,193,22,728,963,754,147,190,857,708,31]


π”¬ Encoder Diversity (iter 25900):
  Avg similarity: 0.0235 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 39/100] [Batch 488/669 (72.9%)] [Iter 25910] Loss: 1.0648 (freq: 0.3847, raw: 0.6792, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[926,754,996,833,190,88,776,1012,603,333,448,869,963,475,600]


π”¬ Encoder Diversity (iter 25910):
  Avg similarity: 0.0551 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 39/100] [Batch 498/669 (74.4%)] [Iter 25920] Loss: 0.7923 (freq: 0.2447, raw: 0.5467, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[199,1012,816,598,448,333,11,930,926,7,544,829,776,328,823]


π”¬ Encoder Diversity (iter 25920):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 39/100] [Batch 508/669 (75.9%)] [Iter 25930] Loss: 1.0486 (freq: 0.3774, raw: 0.6702, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[893,754,11,1012,101,475,707,321,125,996,486,1021,829,581,1000]


π”¬ Encoder Diversity (iter 25930):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 39/100] [Batch 518/669 (77.4%)] [Iter 25940] Loss: 1.1013 (freq: 0.3938, raw: 0.7065, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[926,829,963,1012,1021,598,728,840,414,776,833,11,328,754,544]


π”¬ Encoder Diversity (iter 25940):
  Avg similarity: 0.0273 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 39/100] [Batch 528/669 (78.9%)] [Iter 25950] Loss: 1.3628 (freq: 0.5343, raw: 0.8276, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[853,1000,31,996,257,475,101,857,160,1012,963,521,707,1021,926]


π”¬ Encoder Diversity (iter 25950):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 39/100] [Batch 538/669 (80.4%)] [Iter 25960] Loss: 1.0972 (freq: 0.4069, raw: 0.6893, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[600,996,1000,466,98,963,521,829,998,329,516,160,1012,321,228]


π”¬ Encoder Diversity (iter 25960):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 39/100] [Batch 548/669 (81.9%)] [Iter 25970] Loss: 0.6866 (freq: 0.2282, raw: 0.4575, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[1012,926,364,437,333,430,31,893,620,736,1006,833,238,963,313]


π”¬ Encoder Diversity (iter 25970):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 39/100] [Batch 558/669 (83.4%)] [Iter 25980] Loss: 1.1344 (freq: 0.3918, raw: 0.7416, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[754,160,632,963,581,31,1021,475,193,257,387,794,853,601,728]


π”¬ Encoder Diversity (iter 25980):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 39/100] [Batch 568/669 (84.9%)] [Iter 25990] Loss: 1.1809 (freq: 0.4167, raw: 0.7632, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[754,998,996,707,995,88,1012,31,214,22,466,728,963,530,328]


π”¬ Encoder Diversity (iter 25990):
  Avg similarity: 0.0326 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 39/100] [Batch 578/669 (86.4%)] [Iter 26000] Loss: 0.8802 (freq: 0.3008, raw: 0.5785, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[707,893,829,708,620,754,1012,857,486,125,569,823,328,31,530]


π”¬ Encoder Diversity (iter 26000):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 39/100] [Batch 588/669 (87.9%)] [Iter 26010] Loss: 1.1489 (freq: 0.4083, raw: 0.7396, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[1012,125,857,521,728,362,829,996,776,833,620,707,921,448,328]


π”¬ Encoder Diversity (iter 26010):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 39/100] [Batch 598/669 (89.4%)] [Iter 26020] Loss: 1.1836 (freq: 0.4398, raw: 0.7429, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[475,707,754,57,313,18,125,816,843,397,921,1012,853,928,101]


π”¬ Encoder Diversity (iter 26020):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 39/100] [Batch 608/669 (90.9%)] [Iter 26030] Loss: 0.8865 (freq: 0.2915, raw: 0.5941, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[754,993,125,475,762,328,88,486,995,708,963,930,569,329,829]


π”¬ Encoder Diversity (iter 26030):
  Avg similarity: 0.0468 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 39/100] [Batch 618/669 (92.4%)] [Iter 26040] Loss: 1.1714 (freq: 0.4211, raw: 0.7493, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[893,490,829,776,1012,387,170,930,328,333,430,383,773,734,816]


π”¬ Encoder Diversity (iter 26040):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 39/100] [Batch 628/669 (93.9%)] [Iter 26050] Loss: 1.3764 (freq: 0.4753, raw: 0.9000, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[893,679,998,754,475,851,963,362,816,125,31,466,853,387,28]


π”¬ Encoder Diversity (iter 26050):
  Avg similarity: 0.0486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 39/100] [Batch 638/669 (95.4%)] [Iter 26060] Loss: 1.4257 (freq: 0.5384, raw: 0.8863, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[816,466,214,893,728,762,262,475,160,333,98,11,770,28,930]


π”¬ Encoder Diversity (iter 26060):
  Avg similarity: 0.0262 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 39/100] [Batch 648/669 (96.9%)] [Iter 26070] Loss: 0.8636 (freq: 0.2623, raw: 0.6004, quant: 0.0009, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[430,843,1012,840,776,754,965,328,736,833,569,829,262,238,448]


π”¬ Encoder Diversity (iter 26070):
  Avg similarity: 0.0380 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 39/100] [Batch 658/669 (98.4%)] [Iter 26080] Loss: 1.1844 (freq: 0.4435, raw: 0.7399, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[926,829,965,1012,404,125,202,362,284,333,683,843,569,736,598]


π”¬ Encoder Diversity (iter 26080):
  Avg similarity: 0.0248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 39/100] [Batch 668/669 (99.9%)] [Iter 26090] Loss: 1.0276 (freq: 0.3502, raw: 0.6764, quant: 0.0010, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[926,893,1012,170,776,31,328,754,228,333,773,843,965,683,12]


π”¬ Encoder Diversity (iter 26090):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)

================================================================================
[Epoch 39] Validation Results:
  Total Loss: 0.5680
  Freq Loss:  0.1644
  Raw Loss:   0.4027
  Quant Loss: 0.0009
  π“ Codebook Usage: 431/1024 (42.1%)
  π“ Codebook Entropy: 4.7368 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 27026 (20.8%)
  Top 10 most used codes:
    1. Code 41: 3403 times (2.61%)
    2. Code 762: 2963 times (2.28%)
    3. Code 896: 2931 times (2.25%)
    4. Code 178: 2762 times (2.12%)
    5. Code 329: 2705 times (2.08%)
    6. Code 798: 2619 times (2.01%)
    7. Code 430: 2490 times (1.91%)
    8. Code 199: 2429 times (1.87%)
    9. Code 598: 2429 times (1.87%)
    10. Code 816: 2295 times (1.76%)
  Bottom 5 least used codes (among used):
    1. Code 260: 1 times (0.00%)
    2. Code 121: 1 times (0.00%)
    3. Code 265: 1 times (0.00%)
    4. Code 812: 1 times (0.00%)
    5. Code 270: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 40/100] [Batch 9/669 (1.3%)] [Iter 26100] Loss: 1.2063 (freq: 0.4328, raw: 0.7725, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[928,708,362,926,238,101,569,528,11,125,1000,1012,773,816,170]


π”¬ Encoder Diversity (iter 26100):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 40/100] [Batch 19/669 (2.8%)] [Iter 26110] Loss: 1.2017 (freq: 0.4642, raw: 0.7366, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 942/1024 (92.0%) Top5:[282,125,385,926,1012,98,1021,482,840,830,170,859,928,720,362]


π”¬ Encoder Diversity (iter 26110):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 40/100] [Batch 29/669 (4.3%)] [Iter 26120] Loss: 0.7427 (freq: 0.2390, raw: 0.5028, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[798,936,762,928,282,482,995,576,474,385,841,228,453,125,833]


π”¬ Encoder Diversity (iter 26120):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 40/100] [Batch 39/669 (5.8%)] [Iter 26130] Loss: 1.1906 (freq: 0.4465, raw: 0.7430, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[841,765,936,1021,708,27,385,543,683,362,430,15,569,854,183]


π”¬ Encoder Diversity (iter 26130):
  Avg similarity: 0.0404 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 40/100] [Batch 49/669 (7.3%)] [Iter 26140] Loss: 1.0308 (freq: 0.3951, raw: 0.6347, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[708,1021,841,666,125,993,816,576,430,362,453,521,720,736,197]


π”¬ Encoder Diversity (iter 26140):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 40/100] [Batch 59/669 (8.8%)] [Iter 26150] Loss: 0.7953 (freq: 0.2729, raw: 0.5215, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[683,228,708,1021,736,1012,841,856,448,296,125,816,521,178,926]


π”¬ Encoder Diversity (iter 26150):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 40/100] [Batch 69/669 (10.3%)] [Iter 26160] Loss: 1.0906 (freq: 0.3488, raw: 0.7409, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[543,375,708,453,841,854,429,868,623,362,183,287,765,704,1021]


π”¬ Encoder Diversity (iter 26160):
  Avg similarity: 0.0253 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 40/100] [Batch 79/669 (11.8%)] [Iter 26170] Loss: 1.1934 (freq: 0.4446, raw: 0.7478, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[1012,606,282,708,125,328,296,683,886,55,375,576,829,776,194]


π”¬ Encoder Diversity (iter 26170):
  Avg similarity: 0.0676 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 40/100] [Batch 89/669 (13.3%)] [Iter 26180] Loss: 1.0415 (freq: 0.3829, raw: 0.6576, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[328,1012,101,282,829,736,708,194,362,854,936,296,949,385,228]


π”¬ Encoder Diversity (iter 26180):
  Avg similarity: 0.0223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 40/100] [Batch 99/669 (14.8%)] [Iter 26190] Loss: 0.9154 (freq: 0.3153, raw: 0.5992, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[856,1012,362,841,643,854,683,936,286,829,949,473,843,521,547]


π”¬ Encoder Diversity (iter 26190):
  Avg similarity: 0.0565 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 40/100] [Batch 109/669 (16.3%)] [Iter 26200] Loss: 0.9118 (freq: 0.3117, raw: 0.5992, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[282,1021,708,286,765,643,521,824,1000,995,530,606,793,841,385]


π”¬ Encoder Diversity (iter 26200):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 40/100] [Batch 119/669 (17.8%)] [Iter 26210] Loss: 0.9074 (freq: 0.3151, raw: 0.5914, quant: 0.0008, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[375,829,282,177,474,1021,683,328,798,1012,385,708,843,776,684]


π”¬ Encoder Diversity (iter 26210):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 40/100] [Batch 129/669 (19.3%)] [Iter 26220] Loss: 1.1989 (freq: 0.4379, raw: 0.7600, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[1021,331,170,282,385,441,422,936,723,543,765,375,673,453,286]


π”¬ Encoder Diversity (iter 26220):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 40/100] [Batch 139/669 (20.8%)] [Iter 26230] Loss: 0.9395 (freq: 0.3153, raw: 0.6234, quant: 0.0008, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[949,543,242,843,255,841,362,854,683,482,829,1012,101,448,328]


π”¬ Encoder Diversity (iter 26230):
  Avg similarity: 0.0192 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 40/100] [Batch 149/669 (22.3%)] [Iter 26240] Loss: 1.1842 (freq: 0.4371, raw: 0.7462, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[829,926,949,101,170,362,284,328,282,1008,1012,856,976,441,988]


π”¬ Encoder Diversity (iter 26240):
  Avg similarity: 0.0391 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 40/100] [Batch 159/669 (23.8%)] [Iter 26250] Loss: 0.6970 (freq: 0.2263, raw: 0.4699, quant: 0.0008, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[282,362,1012,949,829,985,25,856,328,736,473,482,509,776,448]


π”¬ Encoder Diversity (iter 26250):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 40/100] [Batch 169/669 (25.3%)] [Iter 26260] Loss: 0.9472 (freq: 0.3154, raw: 0.6309, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[854,146,841,482,101,282,1021,824,643,765,543,708,569,1012,328]


π”¬ Encoder Diversity (iter 26260):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 40/100] [Batch 179/669 (26.8%)] [Iter 26270] Loss: 0.8678 (freq: 0.2827, raw: 0.5843, quant: 0.0008, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 915/1024 (89.4%) Top5:[1012,949,854,843,101,1021,215,715,936,271,816,282,441,765,328]


π”¬ Encoder Diversity (iter 26270):
  Avg similarity: 0.0221 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 40/100] [Batch 189/669 (28.3%)] [Iter 26280] Loss: 1.1775 (freq: 0.4383, raw: 0.7383, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 944/1024 (92.2%) Top5:[949,829,854,25,683,673,715,1021,543,841,101,328,482,576,282]


π”¬ Encoder Diversity (iter 26280):
  Avg similarity: 0.0614 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 40/100] [Batch 199/669 (29.7%)] [Iter 26290] Loss: 0.9886 (freq: 0.3392, raw: 0.6485, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 931/1024 (90.9%) Top5:[854,1021,841,15,765,170,816,1012,25,576,936,183,242,362,282]


π”¬ Encoder Diversity (iter 26290):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 40/100] [Batch 209/669 (31.2%)] [Iter 26300] Loss: 1.0608 (freq: 0.3466, raw: 0.7132, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[282,25,1021,1012,331,936,926,673,183,854,723,287,375,435,422]


π”¬ Encoder Diversity (iter 26300):
  Avg similarity: 0.0406 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 40/100] [Batch 219/669 (32.7%)] [Iter 26310] Loss: 1.1843 (freq: 0.4367, raw: 0.7467, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[282,25,328,543,1021,284,854,68,183,385,643,441,723,829,708]


π”¬ Encoder Diversity (iter 26310):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 40/100] [Batch 229/669 (34.2%)] [Iter 26320] Loss: 1.3527 (freq: 0.4637, raw: 0.8881, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[282,765,55,1021,854,824,936,429,25,183,723,385,435,483,266]


π”¬ Encoder Diversity (iter 26320):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 40/100] [Batch 239/669 (35.7%)] [Iter 26330] Loss: 1.2074 (freq: 0.4146, raw: 0.7918, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 913/1024 (89.2%) Top5:[1021,765,331,282,429,854,422,723,841,146,108,673,362,375,25]


π”¬ Encoder Diversity (iter 26330):
  Avg similarity: 0.0199 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 40/100] [Batch 249/669 (37.2%)] [Iter 26340] Loss: 0.9462 (freq: 0.3229, raw: 0.6224, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[282,765,1021,375,643,101,841,726,362,429,328,483,949,673,255]


π”¬ Encoder Diversity (iter 26340):
  Avg similarity: 0.0441 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 40/100] [Batch 259/669 (38.7%)] [Iter 26350] Loss: 0.7517 (freq: 0.2382, raw: 0.5125, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[101,55,146,328,282,936,1021,1012,643,829,841,673,830,125,878]


π”¬ Encoder Diversity (iter 26350):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 40/100] [Batch 269/669 (40.2%)] [Iter 26360] Loss: 1.2504 (freq: 0.4468, raw: 0.8026, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[878,936,282,422,1021,841,25,576,287,453,546,854,723,1000,104]


π”¬ Encoder Diversity (iter 26360):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 40/100] [Batch 279/669 (41.7%)] [Iter 26370] Loss: 1.2929 (freq: 0.5094, raw: 0.7824, quant: 0.0011, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[282,1021,765,266,736,854,101,841,708,206,576,482,936,543,127]


π”¬ Encoder Diversity (iter 26370):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 40/100] [Batch 289/669 (43.2%)] [Iter 26380] Loss: 1.1108 (freq: 0.3653, raw: 0.7446, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[441,936,422,816,786,576,949,843,736,284,643,101,841,976,683]


π”¬ Encoder Diversity (iter 26380):
  Avg similarity: 0.0436 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 40/100] [Batch 299/669 (44.7%)] [Iter 26390] Loss: 0.9671 (freq: 0.3106, raw: 0.6556, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[287,816,482,841,829,422,101,286,576,985,125,282,936,833,22]


π”¬ Encoder Diversity (iter 26390):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 40/100] [Batch 309/669 (46.2%)] [Iter 26400] Loss: 0.6571 (freq: 0.2114, raw: 0.4448, quant: 0.0008, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[1021,962,854,763,448,101,282,519,422,546,483,375,841,125,453]


π”¬ Encoder Diversity (iter 26400):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 40/100] [Batch 319/669 (47.7%)] [Iter 26410] Loss: 0.8801 (freq: 0.2883, raw: 0.5909, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[282,183,14,683,441,985,547,1021,949,328,843,820,849,864,482]


π”¬ Encoder Diversity (iter 26410):
  Avg similarity: 0.0393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 40/100] [Batch 329/669 (49.2%)] [Iter 26420] Loss: 1.1354 (freq: 0.4006, raw: 0.7339, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[282,841,285,136,854,287,422,546,25,985,530,266,15,375,242]


π”¬ Encoder Diversity (iter 26420):
  Avg similarity: 0.0474 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 40/100] [Batch 339/669 (50.7%)] [Iter 26430] Loss: 1.1490 (freq: 0.4005, raw: 0.7475, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[195,930,830,1021,136,841,949,985,282,331,422,500,530,843,125]


π”¬ Encoder Diversity (iter 26430):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 40/100] [Batch 349/669 (52.2%)] [Iter 26440] Loss: 0.8383 (freq: 0.2915, raw: 0.5458, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[841,121,926,829,282,1021,864,930,843,683,328,854,448,831,438]


π”¬ Encoder Diversity (iter 26440):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 40/100] [Batch 359/669 (53.7%)] [Iter 26450] Loss: 0.9212 (freq: 0.2928, raw: 0.6275, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[854,949,829,841,546,422,183,287,286,101,962,824,242,328,127]


π”¬ Encoder Diversity (iter 26450):
  Avg similarity: 0.0548 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 40/100] [Batch 369/669 (55.2%)] [Iter 26460] Loss: 0.8824 (freq: 0.3154, raw: 0.5660, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[422,15,282,266,375,831,714,287,841,546,824,136,765,331,127]


π”¬ Encoder Diversity (iter 26460):
  Avg similarity: 0.0244 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 40/100] [Batch 379/669 (56.7%)] [Iter 26470] Loss: 0.9137 (freq: 0.3041, raw: 0.6087, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[930,829,146,101,736,926,830,448,182,816,949,843,841,750,127]


π”¬ Encoder Diversity (iter 26470):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 40/100] [Batch 389/669 (58.1%)] [Iter 26480] Loss: 0.8934 (freq: 0.3167, raw: 0.5758, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[282,854,136,25,539,146,362,576,375,323,816,121,829,422,125]


π”¬ Encoder Diversity (iter 26480):
  Avg similarity: 0.0170 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9782 (0.0=collapsed)
[Epoch 40/100] [Batch 399/669 (59.6%)] [Iter 26490] Loss: 0.9148 (freq: 0.3349, raw: 0.5791, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[1012,1021,856,926,732,116,765,444,465,1000,125,75,362,282,507]


π”¬ Encoder Diversity (iter 26490):
  Avg similarity: 0.0248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 40/100] [Batch 409/669 (61.1%)] [Iter 26500] Loss: 1.3099 (freq: 0.4689, raw: 0.8399, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[282,829,422,707,831,136,217,930,734,15,732,1000,1021,949,423]


π”¬ Encoder Diversity (iter 26500):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 40/100] [Batch 419/669 (62.6%)] [Iter 26510] Loss: 1.0744 (freq: 0.3886, raw: 0.6848, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[926,918,362,985,786,829,831,961,949,121,441,182,736,824,1000]


π”¬ Encoder Diversity (iter 26510):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 40/100] [Batch 429/669 (64.1%)] [Iter 26520] Loss: 0.9304 (freq: 0.3226, raw: 0.6068, quant: 0.0009, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[829,1000,780,182,949,507,502,238,101,1012,843,736,830,422,75]


π”¬ Encoder Diversity (iter 26520):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9766 (0.0=collapsed)
[Epoch 40/100] [Batch 439/669 (65.6%)] [Iter 26530] Loss: 1.1392 (freq: 0.4162, raw: 0.7221, quant: 0.0010, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[507,949,101,331,330,362,285,950,282,714,758,765,1021,369,182]


π”¬ Encoder Diversity (iter 26530):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 40/100] [Batch 449/669 (67.1%)] [Iter 26540] Loss: 1.1560 (freq: 0.4292, raw: 0.7259, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[282,799,539,287,217,841,1012,949,854,707,507,435,285,15,732]


π”¬ Encoder Diversity (iter 26540):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 40/100] [Batch 459/669 (68.6%)] [Iter 26550] Loss: 1.1060 (freq: 0.3729, raw: 0.7322, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[1021,282,961,422,285,962,854,707,530,430,799,841,831,448,830]


π”¬ Encoder Diversity (iter 26550):
  Avg similarity: 0.0728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 40/100] [Batch 469/669 (70.1%)] [Iter 26560] Loss: 1.0285 (freq: 0.3647, raw: 0.6628, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[707,502,282,799,854,546,732,375,331,287,127,841,714,818,507]


π”¬ Encoder Diversity (iter 26560):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 40/100] [Batch 479/669 (71.6%)] [Iter 26570] Loss: 1.0570 (freq: 0.3664, raw: 0.6897, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[854,1021,643,831,287,841,422,507,331,530,15,708,734,217,707]


π”¬ Encoder Diversity (iter 26570):
  Avg similarity: 0.0772 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 40/100] [Batch 489/669 (73.1%)] [Iter 26580] Loss: 0.9017 (freq: 0.3048, raw: 0.5959, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[125,831,285,530,780,101,707,1021,799,282,448,782,714,422,330]


π”¬ Encoder Diversity (iter 26580):
  Avg similarity: 0.0224 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 40/100] [Batch 499/669 (74.6%)] [Iter 26590] Loss: 0.9983 (freq: 0.3560, raw: 0.6414, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[282,829,375,1012,949,331,448,841,707,854,101,266,736,576,369]


π”¬ Encoder Diversity (iter 26590):
  Avg similarity: 0.0266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9741 (0.0=collapsed)
[Epoch 40/100] [Batch 509/669 (76.1%)] [Iter 26600] Loss: 1.0121 (freq: 0.3546, raw: 0.6565, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[282,841,714,546,375,285,547,854,675,337,438,68,146,422,217]


π”¬ Encoder Diversity (iter 26600):
  Avg similarity: 0.0245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9776 (0.0=collapsed)
[Epoch 40/100] [Batch 519/669 (77.6%)] [Iter 26610] Loss: 1.1236 (freq: 0.4086, raw: 0.7141, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 920/1024 (89.8%) Top5:[841,375,183,1021,282,854,422,843,125,780,714,83,829,732,547]


π”¬ Encoder Diversity (iter 26610):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 40/100] [Batch 529/669 (79.1%)] [Iter 26620] Loss: 0.7903 (freq: 0.2622, raw: 0.5273, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[949,362,829,918,683,714,831,786,444,441,122,369,926,843,255]


π”¬ Encoder Diversity (iter 26620):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 40/100] [Batch 539/669 (80.6%)] [Iter 26630] Loss: 1.0238 (freq: 0.3502, raw: 0.6726, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[786,780,829,830,330,217,242,15,985,182,949,547,799,918,266]


π”¬ Encoder Diversity (iter 26630):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 40/100] [Batch 549/669 (82.1%)] [Iter 26640] Loss: 1.1108 (freq: 0.4054, raw: 0.7045, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[282,1021,708,854,317,55,841,539,464,141,786,285,422,780,530]


π”¬ Encoder Diversity (iter 26640):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 40/100] [Batch 559/669 (83.6%)] [Iter 26650] Loss: 1.2704 (freq: 0.4531, raw: 0.8163, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[843,732,282,525,146,780,125,854,422,841,547,362,708,949,690]


π”¬ Encoder Diversity (iter 26650):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 40/100] [Batch 569/669 (85.1%)] [Iter 26660] Loss: 1.0507 (freq: 0.4057, raw: 0.6441, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[546,282,480,146,782,962,786,285,242,732,330,422,918,369,765]


π”¬ Encoder Diversity (iter 26660):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 40/100] [Batch 579/669 (86.5%)] [Iter 26670] Loss: 0.8734 (freq: 0.2971, raw: 0.5754, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[242,799,841,824,282,422,15,547,714,330,957,146,940,1021,460]


π”¬ Encoder Diversity (iter 26670):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 40/100] [Batch 589/669 (88.0%)] [Iter 26680] Loss: 1.1000 (freq: 0.3759, raw: 0.7232, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[285,841,282,530,331,242,732,502,1012,854,25,422,714,949,786]


π”¬ Encoder Diversity (iter 26680):
  Avg similarity: 0.0424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 40/100] [Batch 599/669 (89.5%)] [Iter 26690] Loss: 1.1225 (freq: 0.3977, raw: 0.7238, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[780,448,182,101,949,1012,369,824,829,926,460,282,596,116,20]


π”¬ Encoder Diversity (iter 26690):
  Avg similarity: 0.0291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 40/100] [Batch 609/669 (91.0%)] [Iter 26700] Loss: 0.9648 (freq: 0.3271, raw: 0.6368, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[448,182,1012,949,369,786,782,1000,122,136,362,83,750,441,989]


π”¬ Encoder Diversity (iter 26700):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 40/100] [Batch 619/669 (92.5%)] [Iter 26710] Loss: 1.4605 (freq: 0.5742, raw: 0.8852, quant: 0.0011, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[841,546,15,1021,242,799,750,285,375,576,633,183,530,422,765]


π”¬ Encoder Diversity (iter 26710):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 40/100] [Batch 629/669 (94.0%)] [Iter 26720] Loss: 0.8114 (freq: 0.2647, raw: 0.5458, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[736,949,136,282,183,362,786,111,732,841,930,502,918,830,285]


π”¬ Encoder Diversity (iter 26720):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 40/100] [Batch 639/669 (95.5%)] [Iter 26730] Loss: 1.2730 (freq: 0.4747, raw: 0.7973, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[780,127,829,734,708,369,217,285,182,337,15,1021,525,547,183]


π”¬ Encoder Diversity (iter 26730):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 40/100] [Batch 649/669 (97.0%)] [Iter 26740] Loss: 0.8321 (freq: 0.2668, raw: 0.5644, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[282,375,829,841,736,1004,422,546,436,690,183,362,949,331,780]


π”¬ Encoder Diversity (iter 26740):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 40/100] [Batch 659/669 (98.5%)] [Iter 26750] Loss: 1.0361 (freq: 0.3303, raw: 0.7049, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[949,1021,546,841,732,422,780,436,182,136,1012,786,15,547,509]


π”¬ Encoder Diversity (iter 26750):
  Avg similarity: 0.0664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 40/100] [Batch 669/669 (100.0%)] [Iter 26760] Loss: 1.2045 (freq: 0.4561, raw: 0.7474, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[448,1004,829,708,183,1012,1021,603,450,30,451,780,882,950,182]


================================================================================
[Epoch 40] Validation Results:
  Total Loss: 0.5473
  Freq Loss:  0.1616
  Raw Loss:   0.3848
  Quant Loss: 0.0009
  π“ Codebook Usage: 488/1024 (47.7%)
  π“ Codebook Entropy: 5.0484 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 23267 (17.9%)
  Top 10 most used codes:
    1. Code 635: 3235 times (2.48%)
    2. Code 1000: 2719 times (2.09%)
    3. Code 0: 2361 times (1.81%)
    4. Code 788: 2342 times (1.80%)
    5. Code 780: 2165 times (1.66%)
    6. Code 362: 2125 times (1.63%)
    7. Code 961: 2123 times (1.63%)
    8. Code 829: 2102 times (1.61%)
    9. Code 736: 2066 times (1.59%)
    10. Code 610: 2029 times (1.56%)
  Bottom 5 least used codes (among used):
    1. Code 907: 1 times (0.00%)
    2. Code 849: 1 times (0.00%)
    3. Code 1: 1 times (0.00%)
    4. Code 403: 2 times (0.00%)
    5. Code 322: 2 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 40
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 39 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 26760):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 41/100] [Batch 10/669 (1.5%)] [Iter 26770] Loss: 1.0095 (freq: 0.3631, raw: 0.6454, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 1024/1024 (100.0%) Top5:[970,882,450,943,892,603,168,780,831,378,627,255,1012,587,518]


π”¬ Encoder Diversity (iter 26770):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 41/100] [Batch 20/669 (3.0%)] [Iter 26780] Loss: 1.3224 (freq: 0.5090, raw: 0.8123, quant: 0.0011, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[310,68,140,495,603,829,627,961,499,987,704,932,30,782,123]


π”¬ Encoder Diversity (iter 26780):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 41/100] [Batch 30/669 (4.5%)] [Iter 26790] Loss: 0.7382 (freq: 0.2052, raw: 0.5320, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[786,499,953,918,612,0,1012,240,794,146,111,814,843,495,408]


π”¬ Encoder Diversity (iter 26790):
  Avg similarity: 0.0567 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 41/100] [Batch 40/669 (6.0%)] [Iter 26800] Loss: 1.1805 (freq: 0.4315, raw: 0.7481, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[448,516,685,1004,21,982,603,262,1011,813,610,168,914,612,122]


π”¬ Encoder Diversity (iter 26800):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 41/100] [Batch 50/669 (7.5%)] [Iter 26810] Loss: 0.9795 (freq: 0.3331, raw: 0.6455, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[495,812,808,767,830,448,30,480,406,146,21,612,685,499,168]


π”¬ Encoder Diversity (iter 26810):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 41/100] [Batch 60/669 (9.0%)] [Iter 26820] Loss: 0.7768 (freq: 0.2443, raw: 0.5316, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[685,255,448,829,146,767,460,499,583,882,30,809,406,627,195]


π”¬ Encoder Diversity (iter 26820):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 41/100] [Batch 70/669 (10.5%)] [Iter 26830] Loss: 0.9018 (freq: 0.3076, raw: 0.5933, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[198,499,0,362,777,665,441,949,829,786,495,378,30,590,111]


π”¬ Encoder Diversity (iter 26830):
  Avg similarity: 0.0139 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9770 (0.0=collapsed)
[Epoch 41/100] [Batch 80/669 (12.0%)] [Iter 26840] Loss: 1.1241 (freq: 0.4140, raw: 0.7091, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[347,495,262,794,499,685,108,814,240,341,583,15,882,704,603]


π”¬ Encoder Diversity (iter 26840):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 41/100] [Batch 90/669 (13.5%)] [Iter 26850] Loss: 0.8407 (freq: 0.2766, raw: 0.5632, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[812,262,495,829,499,987,932,743,111,949,612,583,843,480,814]


π”¬ Encoder Diversity (iter 26850):
  Avg similarity: 0.0165 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9799 (0.0=collapsed)
[Epoch 41/100] [Batch 100/669 (14.9%)] [Iter 26860] Loss: 1.1563 (freq: 0.4112, raw: 0.7440, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[780,583,603,495,612,767,516,886,685,843,953,949,830,108,30]


π”¬ Encoder Diversity (iter 26860):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 41/100] [Batch 110/669 (16.4%)] [Iter 26870] Loss: 0.9392 (freq: 0.3381, raw: 0.6001, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[829,949,448,1012,450,736,182,460,597,683,970,830,780,385,786]


π”¬ Encoder Diversity (iter 26870):
  Avg similarity: 0.0227 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 41/100] [Batch 120/669 (17.9%)] [Iter 26880] Loss: 0.8115 (freq: 0.2693, raw: 0.5413, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[949,780,953,829,0,627,385,441,509,830,378,362,198,970,736]


π”¬ Encoder Diversity (iter 26880):
  Avg similarity: 0.0364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 41/100] [Batch 130/669 (19.4%)] [Iter 26890] Loss: 0.8968 (freq: 0.3277, raw: 0.5681, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[829,516,195,949,122,583,882,509,80,634,362,448,685,953,365]


π”¬ Encoder Diversity (iter 26890):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 41/100] [Batch 140/669 (20.9%)] [Iter 26900] Loss: 0.7133 (freq: 0.2259, raw: 0.4866, quant: 0.0008, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[195,953,385,365,843,499,460,987,1012,408,949,590,536,597,518]


π”¬ Encoder Diversity (iter 26900):
  Avg similarity: 0.0482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 41/100] [Batch 150/669 (22.4%)] [Iter 26910] Loss: 0.9579 (freq: 0.3310, raw: 0.6260, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[987,480,536,583,499,1011,286,833,516,406,1006,585,704,886,262]


π”¬ Encoder Diversity (iter 26910):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 41/100] [Batch 160/669 (23.9%)] [Iter 26920] Loss: 0.8857 (freq: 0.3164, raw: 0.5684, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[780,590,786,949,829,743,455,441,262,347,495,499,788,814,863]


π”¬ Encoder Diversity (iter 26920):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 41/100] [Batch 170/669 (25.4%)] [Iter 26930] Loss: 0.8399 (freq: 0.2717, raw: 0.5673, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[30,1011,930,814,590,310,829,1006,499,736,833,495,7,583,498]


π”¬ Encoder Diversity (iter 26930):
  Avg similarity: 0.0586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 41/100] [Batch 180/669 (26.9%)] [Iter 26940] Loss: 1.1807 (freq: 0.4325, raw: 0.7473, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[970,262,583,892,743,516,499,1011,1006,385,603,180,654,256,814]


π”¬ Encoder Diversity (iter 26940):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 41/100] [Batch 190/669 (28.4%)] [Iter 26950] Loss: 0.8954 (freq: 0.2866, raw: 0.6078, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[499,516,1006,970,585,932,460,480,21,324,286,812,536,30,987]


π”¬ Encoder Diversity (iter 26950):
  Avg similarity: 0.0611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 41/100] [Batch 200/669 (29.9%)] [Iter 26960] Loss: 0.6613 (freq: 0.2140, raw: 0.4464, quant: 0.0009, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[767,654,441,460,333,932,450,582,962,788,385,578,1004,583,590]


π”¬ Encoder Diversity (iter 26960):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 41/100] [Batch 210/669 (31.4%)] [Iter 26970] Loss: 1.1331 (freq: 0.4073, raw: 0.7248, quant: 0.0010, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[583,499,262,932,385,987,21,612,341,794,419,180,983,743,362]


π”¬ Encoder Diversity (iter 26970):
  Avg similarity: 0.0273 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 41/100] [Batch 220/669 (32.9%)] [Iter 26980] Loss: 1.3111 (freq: 0.4362, raw: 0.8738, quant: 0.0011, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[498,499,987,1011,583,480,612,450,829,262,184,603,685,753,161]


π”¬ Encoder Diversity (iter 26980):
  Avg similarity: 0.0219 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 41/100] [Batch 230/669 (34.4%)] [Iter 26990] Loss: 1.0440 (freq: 0.3911, raw: 0.6520, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 814/1024 (79.5%) Top5:[829,578,1012,122,450,930,385,786,780,333,460,1004,256,188,174]


π”¬ Encoder Diversity (iter 26990):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9629 (0.0=collapsed)
[Epoch 41/100] [Batch 240/669 (35.9%)] [Iter 27000] Loss: 1.1300 (freq: 0.3980, raw: 0.7311, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[991,932,590,995,177,833,174,406,385,829,987,583,812,262,886]


π”¬ Encoder Diversity (iter 27000):
  Avg similarity: 0.0339 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 41/100] [Batch 250/669 (37.4%)] [Iter 27010] Loss: 0.8816 (freq: 0.2820, raw: 0.5987, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[780,1004,499,385,495,260,987,962,174,450,930,177,829,861,690]


π”¬ Encoder Diversity (iter 27010):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 41/100] [Batch 260/669 (38.9%)] [Iter 27020] Loss: 1.1173 (freq: 0.3849, raw: 0.7315, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[539,860,861,821,182,793,814,179,1012,450,122,50,962,1006,603]


π”¬ Encoder Diversity (iter 27020):
  Avg similarity: 0.0159 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9780 (0.0=collapsed)
[Epoch 41/100] [Batch 270/669 (40.4%)] [Iter 27030] Loss: 1.0331 (freq: 0.3384, raw: 0.6938, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[499,498,753,932,262,970,21,583,513,1012,324,362,460,177,834]


π”¬ Encoder Diversity (iter 27030):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 41/100] [Batch 280/669 (41.9%)] [Iter 27040] Loss: 0.7676 (freq: 0.2443, raw: 0.5224, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[654,385,583,736,499,1012,495,182,262,991,1006,513,786,932,966]


π”¬ Encoder Diversity (iter 27040):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 41/100] [Batch 290/669 (43.3%)] [Iter 27050] Loss: 0.9313 (freq: 0.3310, raw: 0.5994, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[499,829,843,495,240,860,122,793,932,450,949,262,654,962,385]


π”¬ Encoder Diversity (iter 27050):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 41/100] [Batch 300/669 (44.8%)] [Iter 27060] Loss: 1.2528 (freq: 0.4573, raw: 0.7945, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[583,347,499,1006,460,753,362,1011,455,235,685,1012,970,833,654]


π”¬ Encoder Diversity (iter 27060):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 41/100] [Batch 310/669 (46.3%)] [Iter 27070] Loss: 1.2294 (freq: 0.4235, raw: 0.8049, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[499,932,753,605,794,7,419,987,495,970,240,406,536,262,814]


π”¬ Encoder Diversity (iter 27070):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 41/100] [Batch 320/669 (47.8%)] [Iter 27080] Loss: 1.2351 (freq: 0.4304, raw: 0.8037, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[182,654,829,932,460,949,1006,736,362,843,450,179,753,685,385]


π”¬ Encoder Diversity (iter 27080):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 41/100] [Batch 330/669 (49.3%)] [Iter 27090] Loss: 0.8972 (freq: 0.2869, raw: 0.6094, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[385,605,583,1006,590,536,495,900,685,903,406,829,1012,347,499]


π”¬ Encoder Diversity (iter 27090):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 41/100] [Batch 340/669 (50.8%)] [Iter 27100] Loss: 0.9511 (freq: 0.3274, raw: 0.6227, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[583,970,499,987,262,419,843,753,605,812,536,468,7,498,68]


π”¬ Encoder Diversity (iter 27100):
  Avg similarity: 0.0198 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 41/100] [Batch 350/669 (52.3%)] [Iter 27110] Loss: 0.9122 (freq: 0.3184, raw: 0.5928, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[499,455,495,385,949,753,732,932,829,480,583,704,654,987,1006]


π”¬ Encoder Diversity (iter 27110):
  Avg similarity: 0.0575 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 41/100] [Batch 360/669 (53.8%)] [Iter 27120] Loss: 1.1994 (freq: 0.3995, raw: 0.7988, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[1006,814,605,262,753,583,536,499,1011,970,495,324,1000,305,659]


π”¬ Encoder Diversity (iter 27120):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 41/100] [Batch 370/669 (55.3%)] [Iter 27130] Loss: 1.2293 (freq: 0.4225, raw: 0.8059, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[583,1011,932,536,513,654,978,1006,593,442,843,262,690,962,987]


π”¬ Encoder Diversity (iter 27130):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 41/100] [Batch 380/669 (56.8%)] [Iter 27140] Loss: 0.8395 (freq: 0.2538, raw: 0.5848, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[495,583,753,499,1011,347,455,385,736,182,934,654,843,235,605]


π”¬ Encoder Diversity (iter 27140):
  Avg similarity: 0.0330 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 41/100] [Batch 390/669 (58.3%)] [Iter 27150] Loss: 0.9076 (freq: 0.2933, raw: 0.6133, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[1006,583,1011,262,499,753,932,794,235,495,605,419,685,450,812]


π”¬ Encoder Diversity (iter 27150):
  Avg similarity: 0.0260 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 41/100] [Batch 400/669 (59.8%)] [Iter 27160] Loss: 0.9631 (freq: 0.3085, raw: 0.6537, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[605,843,455,533,685,1012,347,499,68,14,450,583,932,480,262]


π”¬ Encoder Diversity (iter 27160):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 41/100] [Batch 410/669 (61.3%)] [Iter 27170] Loss: 0.7494 (freq: 0.2302, raw: 0.5182, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[1012,385,362,654,685,786,736,843,770,182,949,236,962,184,442]


π”¬ Encoder Diversity (iter 27170):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 41/100] [Batch 420/669 (62.8%)] [Iter 27180] Loss: 1.2729 (freq: 0.4665, raw: 0.8053, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[987,536,605,843,347,991,406,9,583,262,767,495,858,624,455]


π”¬ Encoder Diversity (iter 27180):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 41/100] [Batch 430/669 (64.3%)] [Iter 27190] Loss: 1.1407 (freq: 0.4115, raw: 0.7282, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[732,794,499,932,605,347,987,536,743,406,995,900,814,583,455]


π”¬ Encoder Diversity (iter 27190):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 41/100] [Batch 440/669 (65.8%)] [Iter 27200] Loss: 1.1667 (freq: 0.4232, raw: 0.7425, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[495,962,732,583,843,991,900,1006,184,814,659,22,182,833,770]


π”¬ Encoder Diversity (iter 27200):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 41/100] [Batch 450/669 (67.3%)] [Iter 27210] Loss: 0.9976 (freq: 0.3570, raw: 0.6397, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[605,876,583,932,582,987,843,900,441,455,654,786,770,1004,182]


π”¬ Encoder Diversity (iter 27210):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 41/100] [Batch 460/669 (68.8%)] [Iter 27220] Loss: 1.1252 (freq: 0.3927, raw: 0.7314, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[605,495,843,932,536,743,704,814,869,583,987,347,903,68,280]


π”¬ Encoder Diversity (iter 27220):
  Avg similarity: 0.0332 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 41/100] [Batch 470/669 (70.3%)] [Iter 27230] Loss: 0.8775 (freq: 0.3004, raw: 0.5762, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[949,182,794,610,305,605,583,1000,262,533,612,385,495,347,654]


π”¬ Encoder Diversity (iter 27230):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 41/100] [Batch 480/669 (71.7%)] [Iter 27240] Loss: 1.0586 (freq: 0.3788, raw: 0.6788, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[495,987,605,767,1006,794,322,240,843,996,455,1011,876,681,612]


π”¬ Encoder Diversity (iter 27240):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 41/100] [Batch 490/669 (73.2%)] [Iter 27250] Loss: 0.8907 (freq: 0.3191, raw: 0.5707, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[605,324,1006,794,536,583,262,612,495,1000,580,347,1011,681,949]


π”¬ Encoder Diversity (iter 27250):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 41/100] [Batch 500/669 (74.7%)] [Iter 27260] Loss: 0.6364 (freq: 0.2003, raw: 0.4353, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[987,583,182,262,752,605,654,1012,962,934,794,995,480,685,497]


π”¬ Encoder Diversity (iter 27260):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 41/100] [Batch 510/669 (76.2%)] [Iter 27270] Loss: 1.2160 (freq: 0.4183, raw: 0.7967, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[794,605,197,987,681,1006,1000,814,900,992,21,1011,455,240,495]


π”¬ Encoder Diversity (iter 27270):
  Avg similarity: 0.0504 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 41/100] [Batch 520/669 (77.7%)] [Iter 27280] Loss: 1.0356 (freq: 0.3830, raw: 0.6516, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[794,605,786,262,362,770,934,246,987,182,326,654,991,817,949]


π”¬ Encoder Diversity (iter 27280):
  Avg similarity: 0.0247 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 41/100] [Batch 530/669 (79.2%)] [Iter 27290] Loss: 0.9691 (freq: 0.3368, raw: 0.6314, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[583,794,823,326,767,876,307,991,246,753,612,21,1012,685,533]


π”¬ Encoder Diversity (iter 27290):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 41/100] [Batch 540/669 (80.7%)] [Iter 27300] Loss: 1.0740 (freq: 0.3629, raw: 0.7101, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[536,1011,863,605,21,495,991,583,823,184,240,794,685,753,132]


π”¬ Encoder Diversity (iter 27300):
  Avg similarity: 0.0441 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 41/100] [Batch 550/669 (82.2%)] [Iter 27310] Loss: 1.1574 (freq: 0.4138, raw: 0.7425, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[605,495,184,812,753,612,240,794,685,991,966,536,380,362,987]


π”¬ Encoder Diversity (iter 27310):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 41/100] [Batch 560/669 (83.7%)] [Iter 27320] Loss: 1.1465 (freq: 0.4235, raw: 0.7220, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[280,495,452,1006,1000,326,426,685,286,182,836,427,814,697,605]


π”¬ Encoder Diversity (iter 27320):
  Avg similarity: 0.0225 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 41/100] [Batch 570/669 (85.2%)] [Iter 27330] Loss: 1.1805 (freq: 0.4343, raw: 0.7452, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[814,987,794,808,697,605,21,419,112,767,743,612,753,240,280]


π”¬ Encoder Diversity (iter 27330):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 41/100] [Batch 580/669 (86.7%)] [Iter 27340] Loss: 1.2553 (freq: 0.4360, raw: 0.8183, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[536,685,322,605,814,962,480,794,583,535,829,780,787,385,949]


π”¬ Encoder Diversity (iter 27340):
  Avg similarity: 0.0244 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 41/100] [Batch 590/669 (88.2%)] [Iter 27350] Loss: 0.9923 (freq: 0.3310, raw: 0.6603, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[987,900,685,949,385,182,536,934,736,326,962,932,583,808,235]


π”¬ Encoder Diversity (iter 27350):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 41/100] [Batch 600/669 (89.7%)] [Iter 27360] Loss: 0.9436 (freq: 0.3079, raw: 0.6347, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[794,605,182,987,583,590,1011,380,362,770,996,991,836,21,326]


π”¬ Encoder Diversity (iter 27360):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 41/100] [Batch 610/669 (91.2%)] [Iter 27370] Loss: 1.2784 (freq: 0.4514, raw: 0.8260, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[182,794,1006,590,583,385,987,932,605,172,498,322,817,536,419]


π”¬ Encoder Diversity (iter 27370):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 41/100] [Batch 620/669 (92.7%)] [Iter 27380] Loss: 0.6925 (freq: 0.2317, raw: 0.4599, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[583,814,932,987,934,536,685,182,949,380,1011,1006,480,286,767]


π”¬ Encoder Diversity (iter 27380):
  Avg similarity: 0.0226 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9771 (0.0=collapsed)
[Epoch 41/100] [Batch 630/669 (94.2%)] [Iter 27390] Loss: 0.7934 (freq: 0.2908, raw: 0.5017, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[685,932,583,659,182,536,915,1006,326,992,780,814,495,605,262]


π”¬ Encoder Diversity (iter 27390):
  Avg similarity: 0.0211 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 41/100] [Batch 640/669 (95.7%)] [Iter 27400] Loss: 1.1117 (freq: 0.3741, raw: 0.7367, quant: 0.0009, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[583,774,182,794,654,1006,326,362,235,976,685,932,132,333,212]


π”¬ Encoder Diversity (iter 27400):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 41/100] [Batch 650/669 (97.2%)] [Iter 27410] Loss: 1.0740 (freq: 0.3495, raw: 0.7234, quant: 0.0010, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[83,987,1006,324,583,823,605,863,33,996,1011,794,685,812,767]


π”¬ Encoder Diversity (iter 27410):
  Avg similarity: 0.0634 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 41/100] [Batch 660/669 (98.7%)] [Iter 27420] Loss: 1.2196 (freq: 0.4683, raw: 0.7502, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[605,1006,677,583,743,380,495,582,991,970,33,1011,818,987,322]


π”¬ Encoder Diversity (iter 27420):
  Avg similarity: 0.0184 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)

================================================================================
[Epoch 41] Validation Results:
  Total Loss: 0.5360
  Freq Loss:  0.1611
  Raw Loss:   0.3741
  Quant Loss: 0.0008
  π“ Codebook Usage: 739/1024 (72.2%)
  π“ Codebook Entropy: 5.6771 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 19020 (14.6%)
  Top 10 most used codes:
    1. Code 276: 2180 times (1.67%)
    2. Code 197: 2163 times (1.66%)
    3. Code 154: 2078 times (1.60%)
    4. Code 421: 2072 times (1.59%)
    5. Code 715: 1860 times (1.43%)
    6. Code 528: 1857 times (1.43%)
    7. Code 212: 1745 times (1.34%)
    8. Code 990: 1725 times (1.32%)
    9. Code 450: 1683 times (1.29%)
    10. Code 132: 1657 times (1.27%)
  Bottom 5 least used codes (among used):
    1. Code 418: 1 times (0.00%)
    2. Code 55: 1 times (0.00%)
    3. Code 801: 1 times (0.00%)
    4. Code 1009: 1 times (0.00%)
    5. Code 40: 2 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 41
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 42/100] [Batch 1/669 (0.1%)] [Iter 27430] Loss: 0.8487 (freq: 0.2635, raw: 0.5844, quant: 0.0008, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 931/1024 (90.9%) Top5:[685,353,326,984,949,982,385,582,450,934,780,936,829,720,817]


π”¬ Encoder Diversity (iter 27430):
  Avg similarity: 0.0637 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 42/100] [Batch 11/669 (1.6%)] [Iter 27440] Loss: 0.8645 (freq: 0.2901, raw: 0.5735, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 1009/1024 (98.5%) Top5:[900,685,182,450,326,385,541,353,236,737,780,654,936,920,132]


π”¬ Encoder Diversity (iter 27440):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 42/100] [Batch 21/669 (3.1%)] [Iter 27450] Loss: 1.2970 (freq: 0.4924, raw: 0.8036, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[385,484,682,817,757,748,182,936,671,685,900,19,724,934,541]


π”¬ Encoder Diversity (iter 27450):
  Avg similarity: 0.0397 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 42/100] [Batch 31/669 (4.6%)] [Iter 27460] Loss: 1.2192 (freq: 0.4551, raw: 0.7631, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[792,683,236,295,287,446,1006,911,38,748,535,991,385,226,182]


π”¬ Encoder Diversity (iter 27460):
  Avg similarity: 0.0339 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 42/100] [Batch 41/669 (6.1%)] [Iter 27470] Loss: 0.8037 (freq: 0.2604, raw: 0.5425, quant: 0.0008, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[287,446,77,683,529,792,88,892,720,911,535,757,83,982,578]


π”¬ Encoder Diversity (iter 27470):
  Avg similarity: 0.0449 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 42/100] [Batch 51/669 (7.6%)] [Iter 27480] Loss: 1.0319 (freq: 0.3499, raw: 0.6811, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[287,683,911,541,685,342,326,236,446,558,982,720,385,484,949]


π”¬ Encoder Diversity (iter 27480):
  Avg similarity: 0.0338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 42/100] [Batch 61/669 (9.1%)] [Iter 27490] Loss: 0.8929 (freq: 0.3084, raw: 0.5836, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[446,639,718,911,495,182,934,236,792,287,385,220,87,440,19]


π”¬ Encoder Diversity (iter 27490):
  Avg similarity: 0.0182 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 42/100] [Batch 71/669 (10.6%)] [Iter 27500] Loss: 0.9190 (freq: 0.3145, raw: 0.6036, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[446,67,342,287,812,683,757,792,495,517,1022,791,220,167,235]


π”¬ Encoder Diversity (iter 27500):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 42/100] [Batch 81/669 (12.1%)] [Iter 27510] Loss: 1.2620 (freq: 0.4637, raw: 0.7974, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[911,792,645,817,683,342,1000,1022,934,535,755,551,385,716,371]


π”¬ Encoder Diversity (iter 27510):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 42/100] [Batch 91/669 (13.6%)] [Iter 27520] Loss: 1.0132 (freq: 0.3257, raw: 0.6866, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[685,446,226,792,87,385,900,934,342,683,911,136,326,295,287]


π”¬ Encoder Diversity (iter 27520):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 42/100] [Batch 101/669 (15.1%)] [Iter 27530] Loss: 1.0892 (freq: 0.3719, raw: 0.7164, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 921/1024 (89.9%) Top5:[685,182,236,911,287,683,792,326,900,977,720,570,541,529,19]


π”¬ Encoder Diversity (iter 27530):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 42/100] [Batch 111/669 (16.6%)] [Iter 27540] Loss: 1.1114 (freq: 0.4054, raw: 0.7050, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[683,287,446,295,900,535,342,911,1022,791,136,19,720,812,127]


π”¬ Encoder Diversity (iter 27540):
  Avg similarity: 0.0213 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 42/100] [Batch 121/669 (18.1%)] [Iter 27550] Loss: 1.0270 (freq: 0.3273, raw: 0.6987, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[446,934,685,342,287,535,220,1000,19,748,184,949,720,792,683]


π”¬ Encoder Diversity (iter 27550):
  Avg similarity: 0.0220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 42/100] [Batch 131/669 (19.6%)] [Iter 27560] Loss: 1.1663 (freq: 0.4421, raw: 0.7231, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[446,19,287,578,226,385,184,250,53,517,369,1000,685,781,347]


π”¬ Encoder Diversity (iter 27560):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 42/100] [Batch 141/669 (21.1%)] [Iter 27570] Loss: 1.0082 (freq: 0.3624, raw: 0.6449, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[19,1006,949,385,780,934,817,1000,578,911,900,287,683,371,331]


π”¬ Encoder Diversity (iter 27570):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 42/100] [Batch 151/669 (22.6%)] [Iter 27580] Loss: 0.9948 (freq: 0.3568, raw: 0.6370, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[326,992,253,1022,529,446,385,654,746,685,949,429,371,238,19]


π”¬ Encoder Diversity (iter 27580):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 42/100] [Batch 161/669 (24.1%)] [Iter 27590] Loss: 0.8008 (freq: 0.2435, raw: 0.5564, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[446,19,900,920,342,578,685,1000,287,15,385,495,934,792,411]


π”¬ Encoder Diversity (iter 27590):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 42/100] [Batch 171/669 (25.6%)] [Iter 27600] Loss: 0.9037 (freq: 0.3389, raw: 0.5638, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[385,287,342,780,184,685,19,720,899,87,166,15,169,813,236]


π”¬ Encoder Diversity (iter 27600):
  Avg similarity: 0.0221 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 42/100] [Batch 181/669 (27.1%)] [Iter 27610] Loss: 1.0286 (freq: 0.3585, raw: 0.6691, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[911,792,287,716,683,578,54,88,685,411,19,83,137,295,717]


π”¬ Encoder Diversity (iter 27610):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9769 (0.0=collapsed)
[Epoch 42/100] [Batch 191/669 (28.6%)] [Iter 27620] Loss: 1.3676 (freq: 0.5028, raw: 0.8638, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[446,757,495,54,19,363,287,311,593,529,226,83,77,911,43]


π”¬ Encoder Diversity (iter 27620):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 42/100] [Batch 201/669 (30.0%)] [Iter 27630] Loss: 0.8727 (freq: 0.3024, raw: 0.5694, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[446,1022,911,529,385,411,342,136,780,593,679,139,182,287,792]


π”¬ Encoder Diversity (iter 27630):
  Avg similarity: 0.0216 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 42/100] [Batch 211/669 (31.5%)] [Iter 27640] Loss: 1.1208 (freq: 0.3766, raw: 0.7433, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[446,911,1006,220,780,287,311,757,83,385,226,77,900,411,170]


π”¬ Encoder Diversity (iter 27640):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 42/100] [Batch 221/669 (33.0%)] [Iter 27650] Loss: 0.9186 (freq: 0.3066, raw: 0.6111, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[446,311,220,342,755,792,287,899,170,817,790,19,780,326,0]


π”¬ Encoder Diversity (iter 27650):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 42/100] [Batch 231/669 (34.5%)] [Iter 27660] Loss: 1.0325 (freq: 0.3607, raw: 0.6708, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[287,911,342,326,137,170,220,716,446,792,411,371,19,529,311]


π”¬ Encoder Diversity (iter 27660):
  Avg similarity: 0.0304 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 42/100] [Batch 241/669 (36.0%)] [Iter 27670] Loss: 1.0886 (freq: 0.4212, raw: 0.6664, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[446,911,19,77,287,425,813,54,541,792,949,337,593,477,411]


π”¬ Encoder Diversity (iter 27670):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 42/100] [Batch 251/669 (37.5%)] [Iter 27680] Loss: 1.2056 (freq: 0.4195, raw: 0.7851, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[911,446,220,792,535,287,342,919,495,543,167,425,900,565,83]


π”¬ Encoder Diversity (iter 27680):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 42/100] [Batch 261/669 (39.0%)] [Iter 27690] Loss: 1.1103 (freq: 0.3590, raw: 0.7503, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[446,911,287,919,529,77,535,1006,296,220,440,136,812,1022,87]


π”¬ Encoder Diversity (iter 27690):
  Avg similarity: 0.0533 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 42/100] [Batch 271/669 (40.5%)] [Iter 27700] Loss: 1.3897 (freq: 0.5212, raw: 0.8674, quant: 0.0011, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[911,220,170,287,1022,716,538,326,295,136,54,362,446,565,311]


π”¬ Encoder Diversity (iter 27700):
  Avg similarity: 0.0608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 42/100] [Batch 281/669 (42.0%)] [Iter 27710] Loss: 1.1420 (freq: 0.4138, raw: 0.7273, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[446,1022,911,287,220,535,139,167,919,295,43,0,537,639,241]


π”¬ Encoder Diversity (iter 27710):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 42/100] [Batch 291/669 (43.5%)] [Iter 27720] Loss: 1.0153 (freq: 0.3352, raw: 0.6792, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 921/1024 (89.9%) Top5:[525,578,166,342,287,220,446,19,326,296,813,207,541,77,171]


π”¬ Encoder Diversity (iter 27720):
  Avg similarity: 0.0378 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 42/100] [Batch 301/669 (45.0%)] [Iter 27730] Loss: 0.9991 (freq: 0.3377, raw: 0.6604, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[911,716,287,919,43,170,136,405,529,535,565,446,541,1006,683]


π”¬ Encoder Diversity (iter 27730):
  Avg similarity: 0.0291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 42/100] [Batch 311/669 (46.5%)] [Iter 27740] Loss: 1.3638 (freq: 0.4885, raw: 0.8743, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 921/1024 (89.9%) Top5:[529,1022,167,446,911,535,1006,54,538,757,675,287,558,43,77]


π”¬ Encoder Diversity (iter 27740):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 42/100] [Batch 321/669 (48.0%)] [Iter 27750] Loss: 1.0292 (freq: 0.3541, raw: 0.6741, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[77,911,446,220,683,385,757,541,182,513,495,169,248,311,0]


π”¬ Encoder Diversity (iter 27750):
  Avg similarity: 0.0224 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 42/100] [Batch 331/669 (49.5%)] [Iter 27760] Loss: 0.8386 (freq: 0.3006, raw: 0.5371, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[541,294,856,841,813,385,614,661,7,712,337,759,962,81,182]


π”¬ Encoder Diversity (iter 27760):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 42/100] [Batch 341/669 (51.0%)] [Iter 27770] Loss: 0.8981 (freq: 0.3145, raw: 0.5827, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[856,511,287,446,541,780,535,470,737,841,248,525,342,170,543]


π”¬ Encoder Diversity (iter 27770):
  Avg similarity: 0.0565 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 42/100] [Batch 351/669 (52.5%)] [Iter 27780] Loss: 1.1885 (freq: 0.4253, raw: 0.7622, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[716,287,537,446,911,295,342,524,919,565,679,773,167,405,717]


π”¬ Encoder Diversity (iter 27780):
  Avg similarity: 0.0823 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 42/100] [Batch 361/669 (54.0%)] [Iter 27790] Loss: 0.7480 (freq: 0.2388, raw: 0.5083, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[716,871,287,446,683,296,1006,712,661,792,83,342,444,524,436]


π”¬ Encoder Diversity (iter 27790):
  Avg similarity: 0.0234 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 42/100] [Batch 371/669 (55.5%)] [Iter 27800] Loss: 1.0830 (freq: 0.3659, raw: 0.7161, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[1006,757,220,287,296,87,871,170,716,167,136,529,812,919,446]


π”¬ Encoder Diversity (iter 27800):
  Avg similarity: 0.0510 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 42/100] [Batch 381/669 (57.0%)] [Iter 27810] Loss: 1.0130 (freq: 0.3603, raw: 0.6517, quant: 0.0009, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[525,541,295,661,856,287,614,593,220,911,470,962,167,640,137]


π”¬ Encoder Diversity (iter 27810):
  Avg similarity: 0.0296 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 42/100] [Batch 391/669 (58.4%)] [Iter 27820] Loss: 0.9413 (freq: 0.3365, raw: 0.6038, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[220,287,250,1015,436,446,444,829,792,716,77,342,812,683,170]


π”¬ Encoder Diversity (iter 27820):
  Avg similarity: 0.0349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 42/100] [Batch 401/669 (59.9%)] [Iter 27830] Loss: 0.8892 (freq: 0.2933, raw: 0.5949, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 919/1024 (89.7%) Top5:[911,529,144,855,446,716,287,436,780,248,962,525,712,621,137]


π”¬ Encoder Diversity (iter 27830):
  Avg similarity: 0.1094 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9419 (0.0=collapsed)
[Epoch 42/100] [Batch 411/669 (61.4%)] [Iter 27840] Loss: 1.1369 (freq: 0.4287, raw: 0.7072, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[220,757,558,287,167,446,436,1022,259,535,773,538,136,170,862]


π”¬ Encoder Diversity (iter 27840):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 42/100] [Batch 421/669 (62.9%)] [Iter 27850] Loss: 1.2604 (freq: 0.4209, raw: 0.8385, quant: 0.0010, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[446,342,170,962,716,259,436,1006,296,87,812,535,780,538,6]


π”¬ Encoder Diversity (iter 27850):
  Avg similarity: 0.0558 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 42/100] [Batch 431/669 (64.4%)] [Iter 27860] Loss: 0.9252 (freq: 0.3347, raw: 0.5895, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[679,287,919,529,962,712,259,167,1022,170,967,295,1001,945,661]


π”¬ Encoder Diversity (iter 27860):
  Avg similarity: 0.0552 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 42/100] [Batch 441/669 (65.9%)] [Iter 27870] Loss: 0.8480 (freq: 0.2757, raw: 0.5713, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[962,259,446,169,855,385,841,363,220,182,137,87,967,856,661]


π”¬ Encoder Diversity (iter 27870):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 42/100] [Batch 451/669 (67.4%)] [Iter 27880] Loss: 1.1354 (freq: 0.4135, raw: 0.7209, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[716,220,446,841,170,1018,780,855,514,533,137,259,1006,182,535]


π”¬ Encoder Diversity (iter 27880):
  Avg similarity: 0.0671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 42/100] [Batch 461/669 (68.9%)] [Iter 27890] Loss: 1.1476 (freq: 0.4127, raw: 0.7339, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[287,780,1022,182,829,510,962,841,167,220,614,170,363,385,446]


π”¬ Encoder Diversity (iter 27890):
  Avg similarity: 0.0269 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 42/100] [Batch 471/669 (70.4%)] [Iter 27900] Loss: 0.9503 (freq: 0.3384, raw: 0.6109, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[182,780,385,855,342,151,750,911,220,716,967,248,593,446,157]


π”¬ Encoder Diversity (iter 27900):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 42/100] [Batch 481/669 (71.9%)] [Iter 27910] Loss: 0.9416 (freq: 0.3370, raw: 0.6036, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[446,529,220,716,495,436,54,812,535,77,919,170,856,296,248]


π”¬ Encoder Diversity (iter 27910):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 42/100] [Batch 491/669 (73.4%)] [Iter 27920] Loss: 1.0288 (freq: 0.3402, raw: 0.6877, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[446,455,716,436,679,495,856,792,5,461,911,431,1006,182,170]


π”¬ Encoder Diversity (iter 27920):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 42/100] [Batch 501/669 (74.9%)] [Iter 27930] Loss: 1.0363 (freq: 0.3800, raw: 0.6554, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[446,287,780,169,182,962,342,538,792,55,144,259,860,782,0]


π”¬ Encoder Diversity (iter 27930):
  Avg similarity: 0.0768 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 42/100] [Batch 511/669 (76.4%)] [Iter 27940] Loss: 0.9481 (freq: 0.3548, raw: 0.5924, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[137,855,182,780,259,327,227,716,661,436,792,169,554,337,87]


π”¬ Encoder Diversity (iter 27940):
  Avg similarity: 0.0774 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 42/100] [Batch 521/669 (77.9%)] [Iter 27950] Loss: 0.8192 (freq: 0.2792, raw: 0.5392, quant: 0.0008, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[182,541,256,385,259,554,782,962,220,780,855,614,716,446,1006]


π”¬ Encoder Diversity (iter 27950):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 42/100] [Batch 531/669 (79.4%)] [Iter 27960] Loss: 1.1574 (freq: 0.4310, raw: 0.7254, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[342,446,554,259,385,220,841,182,287,716,55,945,541,77,962]


π”¬ Encoder Diversity (iter 27960):
  Avg similarity: 0.0265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 42/100] [Batch 541/669 (80.9%)] [Iter 27970] Loss: 1.2605 (freq: 0.4591, raw: 0.8004, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[248,342,83,962,207,780,170,1006,420,60,1002,554,775,385,900]


π”¬ Encoder Diversity (iter 27970):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 42/100] [Batch 551/669 (82.4%)] [Iter 27980] Loss: 0.9221 (freq: 0.2775, raw: 0.6437, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[578,220,342,446,841,136,444,775,495,87,716,287,524,167,535]


π”¬ Encoder Diversity (iter 27980):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 42/100] [Batch 561/669 (83.9%)] [Iter 27990] Loss: 1.0878 (freq: 0.3753, raw: 0.7116, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[446,554,55,405,220,136,118,287,792,363,461,1001,938,593,495]


π”¬ Encoder Diversity (iter 27990):
  Avg similarity: 0.0483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 42/100] [Batch 571/669 (85.4%)] [Iter 28000] Loss: 0.9435 (freq: 0.3359, raw: 0.6067, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 916/1024 (89.5%) Top5:[446,529,871,220,883,780,716,287,431,614,118,55,812,60,342]


π”¬ Encoder Diversity (iter 28000):
  Avg similarity: 0.0185 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9773 (0.0=collapsed)
[Epoch 42/100] [Batch 581/669 (86.8%)] [Iter 28010] Loss: 0.9437 (freq: 0.3218, raw: 0.6209, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[259,446,220,118,83,1006,991,182,167,962,622,911,712,856,170]


π”¬ Encoder Diversity (iter 28010):
  Avg similarity: 0.0758 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 42/100] [Batch 591/669 (88.3%)] [Iter 28020] Loss: 0.6759 (freq: 0.2080, raw: 0.4670, quant: 0.0008, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[259,991,712,855,962,782,426,959,614,661,789,169,622,182,7]


π”¬ Encoder Diversity (iter 28020):
  Avg similarity: 0.0347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 42/100] [Batch 601/669 (89.8%)] [Iter 28030] Loss: 0.9257 (freq: 0.3100, raw: 0.6148, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[699,962,712,991,169,614,822,568,259,622,182,446,959,578,426]


π”¬ Encoder Diversity (iter 28030):
  Avg similarity: 0.0277 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 42/100] [Batch 611/669 (91.3%)] [Iter 28040] Loss: 0.9013 (freq: 0.2993, raw: 0.6010, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[962,182,775,169,420,87,1018,940,287,511,789,254,876,716,614]


π”¬ Encoder Diversity (iter 28040):
  Avg similarity: 0.0483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 42/100] [Batch 621/669 (92.8%)] [Iter 28050] Loss: 0.8531 (freq: 0.2733, raw: 0.5790, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[699,87,220,1015,446,436,782,962,182,55,614,524,712,495,170]


π”¬ Encoder Diversity (iter 28050):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 42/100] [Batch 631/669 (94.3%)] [Iter 28060] Loss: 0.9003 (freq: 0.3082, raw: 0.5912, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[716,962,699,87,254,773,511,259,554,170,451,614,220,679,256]


π”¬ Encoder Diversity (iter 28060):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 42/100] [Batch 641/669 (95.8%)] [Iter 28070] Loss: 0.8045 (freq: 0.2913, raw: 0.5124, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[342,962,385,446,182,773,679,1002,256,524,436,699,554,653,287]


π”¬ Encoder Diversity (iter 28070):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 42/100] [Batch 651/669 (97.3%)] [Iter 28080] Loss: 1.2525 (freq: 0.4208, raw: 0.8308, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[170,299,220,55,716,446,679,358,792,1006,118,906,547,495,455]


π”¬ Encoder Diversity (iter 28080):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 42/100] [Batch 661/669 (98.8%)] [Iter 28090] Loss: 1.2240 (freq: 0.4263, raw: 0.7967, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[279,342,524,529,219,220,1006,664,554,170,444,446,716,461,167]


π”¬ Encoder Diversity (iter 28090):
  Avg similarity: 0.0179 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)

================================================================================
[Epoch 42] Validation Results:
  Total Loss: 0.5673
  Freq Loss:  0.1646
  Raw Loss:   0.4017
  Quant Loss: 0.0010
  π“ Codebook Usage: 547/1024 (53.4%)
  π“ Codebook Entropy: 5.1005 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 24719 (19.0%)
  Top 10 most used codes:
    1. Code 840: 3001 times (2.30%)
    2. Code 822: 2920 times (2.24%)
    3. Code 962: 2615 times (2.01%)
    4. Code 426: 2532 times (1.94%)
    5. Code 829: 2484 times (1.91%)
    6. Code 259: 2302 times (1.77%)
    7. Code 420: 2280 times (1.75%)
    8. Code 977: 2224 times (1.71%)
    9. Code 782: 2198 times (1.69%)
    10. Code 614: 2163 times (1.66%)
  Bottom 5 least used codes (among used):
    1. Code 104: 1 times (0.00%)
    2. Code 5: 1 times (0.00%)
    3. Code 521: 1 times (0.00%)
    4. Code 818: 1 times (0.00%)
    5. Code 563: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 43/100] [Batch 2/669 (0.3%)] [Iter 28100] Loss: 0.7572 (freq: 0.2529, raw: 0.5033, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 966/1024 (94.3%) Top5:[137,712,220,780,358,450,87,962,259,342,426,182,840,773,1002]


π”¬ Encoder Diversity (iter 28100):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 43/100] [Batch 12/669 (1.8%)] [Iter 28110] Loss: 0.9373 (freq: 0.3152, raw: 0.6211, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 981/1024 (95.8%) Top5:[450,780,252,182,962,259,578,661,782,334,30,87,552,385,7]


π”¬ Encoder Diversity (iter 28110):
  Avg similarity: 0.0517 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 43/100] [Batch 22/669 (3.3%)] [Iter 28120] Loss: 1.0248 (freq: 0.3410, raw: 0.6829, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[705,287,331,729,614,897,322,942,334,488,182,7,780,578,103]


π”¬ Encoder Diversity (iter 28120):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 43/100] [Batch 32/669 (4.8%)] [Iter 28130] Loss: 0.9164 (freq: 0.3252, raw: 0.5904, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[729,383,133,898,450,942,872,331,648,945,212,569,322,182,705]


π”¬ Encoder Diversity (iter 28130):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 43/100] [Batch 42/669 (6.3%)] [Iter 28140] Loss: 1.0111 (freq: 0.3447, raw: 0.6654, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[729,648,872,287,849,337,411,552,212,383,140,780,151,769,232]


π”¬ Encoder Diversity (iter 28140):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 43/100] [Batch 52/669 (7.8%)] [Iter 28150] Loss: 1.1412 (freq: 0.4057, raw: 0.7346, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[729,696,81,648,182,287,259,780,414,849,411,212,583,87,164]


π”¬ Encoder Diversity (iter 28150):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 43/100] [Batch 62/669 (9.3%)] [Iter 28160] Loss: 1.1790 (freq: 0.4503, raw: 0.7278, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[648,87,690,614,780,182,489,287,165,898,322,806,822,48,872]


π”¬ Encoder Diversity (iter 28160):
  Avg similarity: 0.0342 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 43/100] [Batch 72/669 (10.8%)] [Iter 28170] Loss: 0.6732 (freq: 0.2161, raw: 0.4563, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[690,729,696,960,648,426,661,450,838,977,337,140,411,182,489]


π”¬ Encoder Diversity (iter 28170):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 43/100] [Batch 82/669 (12.3%)] [Iter 28180] Loss: 1.0522 (freq: 0.3809, raw: 0.6703, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[450,648,71,705,729,423,774,411,182,583,151,849,968,36,614]


π”¬ Encoder Diversity (iter 28180):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 43/100] [Batch 92/669 (13.8%)] [Iter 28190] Loss: 0.8934 (freq: 0.3007, raw: 0.5918, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[705,696,212,729,780,275,614,423,550,411,36,648,872,698,164]


π”¬ Encoder Diversity (iter 28190):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 43/100] [Batch 102/669 (15.2%)] [Iter 28200] Loss: 1.0214 (freq: 0.3603, raw: 0.6602, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[696,690,705,977,552,841,942,729,385,423,87,182,550,780,212]


π”¬ Encoder Diversity (iter 28200):
  Avg similarity: 0.0284 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 43/100] [Batch 112/669 (16.7%)] [Iter 28210] Loss: 1.0584 (freq: 0.3734, raw: 0.6841, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 927/1024 (90.5%) Top5:[705,696,729,43,212,872,164,841,450,163,905,578,74,7,287]


π”¬ Encoder Diversity (iter 28210):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 43/100] [Batch 122/669 (18.2%)] [Iter 28220] Loss: 0.9414 (freq: 0.3459, raw: 0.5945, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 919/1024 (89.7%) Top5:[489,696,450,780,729,182,332,7,872,614,977,552,424,648,36]


π”¬ Encoder Diversity (iter 28220):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 43/100] [Batch 132/669 (19.7%)] [Iter 28230] Loss: 1.1131 (freq: 0.4084, raw: 0.7037, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[705,905,488,583,357,690,648,775,332,783,495,614,137,126,578]


π”¬ Encoder Diversity (iter 28230):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 43/100] [Batch 142/669 (21.2%)] [Iter 28240] Loss: 1.2361 (freq: 0.4416, raw: 0.7936, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[696,898,705,212,774,383,273,414,322,211,564,32,729,905,488]


π”¬ Encoder Diversity (iter 28240):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 43/100] [Batch 152/669 (22.7%)] [Iter 28250] Loss: 1.1606 (freq: 0.4141, raw: 0.7455, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[696,705,273,495,942,552,564,905,257,43,843,690,648,729,614]


π”¬ Encoder Diversity (iter 28250):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 43/100] [Batch 162/669 (24.2%)] [Iter 28260] Loss: 1.2007 (freq: 0.4344, raw: 0.7653, quant: 0.0010, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[898,414,705,257,43,696,212,767,322,71,564,690,578,164,493]


π”¬ Encoder Diversity (iter 28260):
  Avg similarity: 0.0555 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 43/100] [Batch 172/669 (25.7%)] [Iter 28270] Loss: 1.0461 (freq: 0.3857, raw: 0.6594, quant: 0.0009, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[705,87,768,614,841,450,696,414,248,71,690,140,347,434,334]


π”¬ Encoder Diversity (iter 28270):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 43/100] [Batch 182/669 (27.2%)] [Iter 28280] Loss: 1.1364 (freq: 0.4126, raw: 0.7227, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[898,705,614,729,551,337,212,104,552,411,81,401,796,780,872]


π”¬ Encoder Diversity (iter 28280):
  Avg similarity: 0.0535 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 43/100] [Batch 192/669 (28.7%)] [Iter 28290] Loss: 1.3049 (freq: 0.5057, raw: 0.7982, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[495,490,696,729,705,648,605,905,423,774,275,656,841,87,81]


π”¬ Encoder Diversity (iter 28290):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 43/100] [Batch 202/669 (30.2%)] [Iter 28300] Loss: 1.2827 (freq: 0.4648, raw: 0.8169, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[103,841,257,614,347,450,782,705,651,977,729,401,297,551,164]


π”¬ Encoder Diversity (iter 28300):
  Avg similarity: 0.0414 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 43/100] [Batch 212/669 (31.7%)] [Iter 28310] Loss: 1.0218 (freq: 0.3736, raw: 0.6472, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 920/1024 (89.8%) Top5:[648,796,705,783,696,729,960,490,411,385,32,450,569,690,74]


π”¬ Encoder Diversity (iter 28310):
  Avg similarity: 0.0327 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 43/100] [Batch 222/669 (33.2%)] [Iter 28320] Loss: 1.1449 (freq: 0.3892, raw: 0.7547, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[768,872,401,87,36,614,443,690,109,729,977,894,79,347,136]


π”¬ Encoder Diversity (iter 28320):
  Avg similarity: 0.0609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)
[Epoch 43/100] [Batch 232/669 (34.7%)] [Iter 28330] Loss: 0.8190 (freq: 0.3000, raw: 0.5180, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[729,696,164,705,275,648,383,818,109,537,322,564,775,690,898]


π”¬ Encoder Diversity (iter 28330):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 43/100] [Batch 242/669 (36.2%)] [Iter 28340] Loss: 1.3095 (freq: 0.4989, raw: 0.8095, quant: 0.0011, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[729,332,818,111,898,872,140,705,560,648,79,32,696,489,753]


π”¬ Encoder Diversity (iter 28340):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 43/100] [Batch 252/669 (37.7%)] [Iter 28350] Loss: 1.0320 (freq: 0.3497, raw: 0.6814, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[729,332,87,517,489,605,927,690,79,977,322,696,673,443,898]


π”¬ Encoder Diversity (iter 28350):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 43/100] [Batch 262/669 (39.2%)] [Iter 28360] Loss: 1.4399 (freq: 0.5612, raw: 0.8776, quant: 0.0011, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 934/1024 (91.2%) Top5:[705,696,257,133,322,898,774,408,818,648,383,32,495,71,36]


π”¬ Encoder Diversity (iter 28360):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 43/100] [Batch 272/669 (40.7%)] [Iter 28370] Loss: 0.9482 (freq: 0.3302, raw: 0.6171, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[696,705,583,87,898,164,648,622,36,414,322,551,673,968,497]


π”¬ Encoder Diversity (iter 28370):
  Avg similarity: 0.0577 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 43/100] [Batch 282/669 (42.2%)] [Iter 28380] Loss: 1.3144 (freq: 0.4945, raw: 0.8189, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[696,898,257,729,133,705,450,145,960,818,493,767,648,111,977]


π”¬ Encoder Diversity (iter 28380):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 43/100] [Batch 292/669 (43.6%)] [Iter 28390] Loss: 1.3619 (freq: 0.4855, raw: 0.8753, quant: 0.0011, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[898,729,614,696,705,768,87,673,589,551,111,841,334,332,894]


π”¬ Encoder Diversity (iter 28390):
  Avg similarity: 0.0496 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 43/100] [Batch 302/669 (45.1%)] [Iter 28400] Loss: 1.2820 (freq: 0.4599, raw: 0.8211, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[696,898,111,257,408,729,332,423,71,564,232,450,560,334,720]


π”¬ Encoder Diversity (iter 28400):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 43/100] [Batch 312/669 (46.6%)] [Iter 28410] Loss: 1.1590 (freq: 0.4248, raw: 0.7332, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[231,942,696,768,232,334,841,780,729,489,690,648,614,622,87]


π”¬ Encoder Diversity (iter 28410):
  Avg similarity: 0.0213 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9775 (0.0=collapsed)
[Epoch 43/100] [Batch 322/669 (48.1%)] [Iter 28420] Loss: 1.0345 (freq: 0.3804, raw: 0.6532, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[383,705,257,275,818,648,898,774,414,564,450,232,164,696,605]


π”¬ Encoder Diversity (iter 28420):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 43/100] [Batch 332/669 (49.6%)] [Iter 28430] Loss: 1.0708 (freq: 0.4019, raw: 0.6679, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[383,898,564,729,411,605,696,705,87,489,71,818,905,332,79]


π”¬ Encoder Diversity (iter 28430):
  Avg similarity: 0.0454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 43/100] [Batch 342/669 (51.1%)] [Iter 28440] Loss: 0.9828 (freq: 0.3739, raw: 0.6079, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[87,673,614,690,489,648,334,164,898,818,696,780,551,372,634]


π”¬ Encoder Diversity (iter 28440):
  Avg similarity: 0.0297 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 43/100] [Batch 352/669 (52.6%)] [Iter 28450] Loss: 1.0803 (freq: 0.3702, raw: 0.7091, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[164,79,133,696,774,257,818,450,383,841,889,898,705,589,332]


π”¬ Encoder Diversity (iter 28450):
  Avg similarity: 0.0509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 43/100] [Batch 362/669 (54.1%)] [Iter 28460] Loss: 1.1804 (freq: 0.4543, raw: 0.7251, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[818,705,898,332,411,605,383,450,275,774,220,551,870,628,257]


π”¬ Encoder Diversity (iter 28460):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 43/100] [Batch 372/669 (55.6%)] [Iter 28470] Loss: 0.9948 (freq: 0.3468, raw: 0.6471, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[87,589,782,614,104,342,257,231,347,942,690,180,140,651,673]


π”¬ Encoder Diversity (iter 28470):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 43/100] [Batch 382/669 (57.1%)] [Iter 28480] Loss: 1.1423 (freq: 0.3979, raw: 0.7434, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[232,411,257,818,722,651,332,258,314,133,898,560,583,71,605]


π”¬ Encoder Diversity (iter 28480):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 43/100] [Batch 392/669 (58.6%)] [Iter 28490] Loss: 0.8697 (freq: 0.2722, raw: 0.5965, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[690,740,30,416,705,552,942,180,307,729,491,551,589,314,140]


π”¬ Encoder Diversity (iter 28490):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 43/100] [Batch 402/669 (60.1%)] [Iter 28500] Loss: 1.1076 (freq: 0.3728, raw: 0.7338, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[332,729,583,350,818,450,696,783,164,43,257,357,705,689,796]


π”¬ Encoder Diversity (iter 28500):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 43/100] [Batch 412/669 (61.6%)] [Iter 28510] Loss: 1.1707 (freq: 0.4506, raw: 0.7191, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[332,583,589,489,818,490,696,322,372,334,450,258,257,739,140]


π”¬ Encoder Diversity (iter 28510):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 43/100] [Batch 422/669 (63.1%)] [Iter 28520] Loss: 1.2210 (freq: 0.4655, raw: 0.7544, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[614,648,489,450,372,347,332,696,218,524,589,232,307,350,334]


π”¬ Encoder Diversity (iter 28520):
  Avg similarity: 0.0497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 43/100] [Batch 432/669 (64.6%)] [Iter 28530] Loss: 1.1847 (freq: 0.4375, raw: 0.7462, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[517,739,696,416,347,372,740,589,79,729,334,491,411,818,489]


π”¬ Encoder Diversity (iter 28530):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 43/100] [Batch 442/669 (66.1%)] [Iter 28540] Loss: 1.0383 (freq: 0.3711, raw: 0.6662, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[740,739,257,180,411,696,334,589,164,811,705,79,489,517,314]


π”¬ Encoder Diversity (iter 28540):
  Avg similarity: 0.0249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 43/100] [Batch 452/669 (67.6%)] [Iter 28550] Loss: 1.2469 (freq: 0.4487, raw: 0.7972, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[489,898,651,818,984,524,175,970,43,1023,234,145,983,849,450]


π”¬ Encoder Diversity (iter 28550):
  Avg similarity: 0.0339 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 43/100] [Batch 462/669 (69.1%)] [Iter 28560] Loss: 1.0370 (freq: 0.3672, raw: 0.6688, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[123,79,818,841,314,332,605,36,651,705,257,450,648,729,85]


π”¬ Encoder Diversity (iter 28560):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 43/100] [Batch 472/669 (70.6%)] [Iter 28570] Loss: 1.1186 (freq: 0.3914, raw: 0.7262, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[729,1023,605,651,234,628,334,740,705,396,780,87,232,450,257]


π”¬ Encoder Diversity (iter 28570):
  Avg similarity: 0.0327 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 43/100] [Batch 482/669 (72.0%)] [Iter 28580] Loss: 1.0323 (freq: 0.3457, raw: 0.6856, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[450,257,729,705,234,232,782,977,614,1023,768,673,140,334,123]


π”¬ Encoder Diversity (iter 28580):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 43/100] [Batch 492/669 (73.5%)] [Iter 28590] Loss: 1.1340 (freq: 0.4169, raw: 0.7161, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[383,191,997,872,414,696,450,175,648,583,322,416,783,234,600]


π”¬ Encoder Diversity (iter 28590):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 43/100] [Batch 502/669 (75.0%)] [Iter 28600] Loss: 1.0081 (freq: 0.3474, raw: 0.6598, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[673,551,432,768,87,690,193,450,977,983,780,622,614,796,231]


π”¬ Encoder Diversity (iter 28600):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 43/100] [Batch 512/669 (76.5%)] [Iter 28610] Loss: 0.7494 (freq: 0.2550, raw: 0.4935, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[589,673,605,648,614,231,818,489,653,935,218,87,583,432,898]


π”¬ Encoder Diversity (iter 28610):
  Avg similarity: 0.0788 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 43/100] [Batch 522/669 (78.0%)] [Iter 28620] Loss: 1.2200 (freq: 0.4283, raw: 0.7906, quant: 0.0011, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[898,383,729,696,564,175,818,257,705,651,997,164,322,133,450]


π”¬ Encoder Diversity (iter 28620):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 43/100] [Batch 532/669 (79.5%)] [Iter 28630] Loss: 0.7426 (freq: 0.2423, raw: 0.4994, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[589,564,768,651,729,383,983,140,257,673,656,551,491,79,977]


π”¬ Encoder Diversity (iter 28630):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 43/100] [Batch 542/669 (81.0%)] [Iter 28640] Loss: 1.1018 (freq: 0.3571, raw: 0.7437, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[729,898,257,648,942,87,872,410,696,1023,774,133,36,738,450]


π”¬ Encoder Diversity (iter 28640):
  Avg similarity: 0.0301 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 43/100] [Batch 552/669 (82.5%)] [Iter 28650] Loss: 1.1224 (freq: 0.3655, raw: 0.7559, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 918/1024 (89.6%) Top5:[123,1023,696,564,347,414,410,680,332,977,79,350,583,841,218]


π”¬ Encoder Diversity (iter 28650):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 43/100] [Batch 562/669 (84.0%)] [Iter 28660] Loss: 0.8972 (freq: 0.2952, raw: 0.6010, quant: 0.0010, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[334,483,696,218,954,589,783,87,423,79,614,690,729,977,383]


π”¬ Encoder Diversity (iter 28660):
  Avg similarity: 0.0262 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 43/100] [Batch 572/669 (85.5%)] [Iter 28670] Loss: 0.9385 (freq: 0.3236, raw: 0.6140, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[818,257,605,583,680,729,411,984,696,598,723,614,935,373,234]


π”¬ Encoder Diversity (iter 28670):
  Avg similarity: 0.0265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 43/100] [Batch 582/669 (87.0%)] [Iter 28680] Loss: 0.9744 (freq: 0.3286, raw: 0.6449, quant: 0.0009, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[79,489,690,614,974,87,334,651,589,401,673,696,954,85,656]


π”¬ Encoder Diversity (iter 28680):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 43/100] [Batch 592/669 (88.5%)] [Iter 28690] Loss: 1.2688 (freq: 0.4960, raw: 0.7718, quant: 0.0011, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[729,898,164,275,257,133,583,648,140,696,234,334,774,450,605]


π”¬ Encoder Diversity (iter 28690):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 43/100] [Batch 602/669 (90.0%)] [Iter 28700] Loss: 0.8644 (freq: 0.3143, raw: 0.5491, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[970,583,729,614,257,556,218,193,145,334,275,551,423,648,401]


π”¬ Encoder Diversity (iter 28700):
  Avg similarity: 0.0242 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 43/100] [Batch 612/669 (91.5%)] [Iter 28710] Loss: 1.1324 (freq: 0.3899, raw: 0.7415, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[729,648,696,383,79,411,738,780,491,191,334,450,1023,977,234]


π”¬ Encoder Diversity (iter 28710):
  Avg similarity: 0.0361 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 43/100] [Batch 622/669 (93.0%)] [Iter 28720] Loss: 0.7935 (freq: 0.2665, raw: 0.5261, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[347,977,729,696,411,401,818,334,164,140,614,274,997,589,79]


π”¬ Encoder Diversity (iter 28720):
  Avg similarity: 0.0591 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 43/100] [Batch 632/669 (94.5%)] [Iter 28730] Loss: 0.9573 (freq: 0.3172, raw: 0.6391, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[450,79,729,583,739,614,690,648,489,218,87,347,954,977,696]


π”¬ Encoder Diversity (iter 28730):
  Avg similarity: 0.0488 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 43/100] [Batch 642/669 (96.0%)] [Iter 28740] Loss: 0.9748 (freq: 0.3359, raw: 0.6379, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[411,729,898,696,164,234,583,490,10,489,1003,332,564,383,178]


π”¬ Encoder Diversity (iter 28740):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 43/100] [Batch 652/669 (97.5%)] [Iter 28750] Loss: 0.9058 (freq: 0.3307, raw: 0.5742, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[696,464,583,191,164,489,450,347,218,729,334,983,780,392,274]


π”¬ Encoder Diversity (iter 28750):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 43/100] [Batch 662/669 (99.0%)] [Iter 28760] Loss: 0.7784 (freq: 0.2410, raw: 0.5366, quant: 0.0008, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[729,564,696,464,347,411,977,334,551,321,244,690,782,898,231]


π”¬ Encoder Diversity (iter 28760):
  Avg similarity: 0.0401 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)

================================================================================
[Epoch 43] Validation Results:
  Total Loss: 0.5571
  Freq Loss:  0.1627
  Raw Loss:   0.3934
  Quant Loss: 0.0009
  π“ Codebook Usage: 497/1024 (48.5%)
  π“ Codebook Entropy: 4.7998 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28501 (21.9%)
  Top 10 most used codes:
    1. Code 491: 3443 times (2.64%)
    2. Code 622: 3259 times (2.50%)
    3. Code 982: 2988 times (2.29%)
    4. Code 974: 2854 times (2.19%)
    5. Code 79: 2840 times (2.18%)
    6. Code 347: 2800 times (2.15%)
    7. Code 307: 2698 times (2.07%)
    8. Code 935: 2559 times (1.97%)
    9. Code 651: 2541 times (1.95%)
    10. Code 372: 2519 times (1.93%)
  Bottom 5 least used codes (among used):
    1. Code 471: 1 times (0.00%)
    2. Code 324: 1 times (0.00%)
    3. Code 532: 1 times (0.00%)
    4. Code 779: 1 times (0.00%)
    5. Code 436: 3 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 44/100] [Batch 3/669 (0.4%)] [Iter 28770] Loss: 1.1936 (freq: 0.4940, raw: 0.6984, quant: 0.0012, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 998/1024 (97.5%) Top5:[489,690,347,334,464,983,218,401,79,977,564,244,651,414,898]


π”¬ Encoder Diversity (iter 28770):
  Avg similarity: 0.0580 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 44/100] [Batch 13/669 (1.9%)] [Iter 28780] Loss: 1.0918 (freq: 0.4133, raw: 0.6774, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 953/1024 (93.1%) Top5:[79,589,489,334,401,231,690,983,550,685,365,347,622,483,10]


π”¬ Encoder Diversity (iter 28780):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 44/100] [Batch 23/669 (3.4%)] [Iter 28790] Loss: 1.0115 (freq: 0.3358, raw: 0.6747, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[937,334,87,279,658,245,1020,974,849,922,719,673,367,954,321]


π”¬ Encoder Diversity (iter 28790):
  Avg similarity: 0.0272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9770 (0.0=collapsed)
[Epoch 44/100] [Batch 33/669 (4.9%)] [Iter 28800] Loss: 1.1060 (freq: 0.3731, raw: 0.7319, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[417,1020,982,977,916,505,93,668,79,902,550,54,279,124,65]


π”¬ Encoder Diversity (iter 28800):
  Avg similarity: 0.0424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 44/100] [Batch 43/669 (6.4%)] [Iter 28810] Loss: 0.9033 (freq: 0.3268, raw: 0.5755, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[64,79,1020,963,367,566,738,417,589,392,65,781,10,1008,849]


π”¬ Encoder Diversity (iter 28810):
  Avg similarity: 0.0691 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9511 (0.0=collapsed)
[Epoch 44/100] [Batch 53/669 (7.9%)] [Iter 28820] Loss: 1.0814 (freq: 0.3792, raw: 0.7012, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[457,218,54,738,339,434,589,851,79,392,719,526,937,383,347]


π”¬ Encoder Diversity (iter 28820):
  Avg similarity: 0.0319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9774 (0.0=collapsed)
[Epoch 44/100] [Batch 63/669 (9.4%)] [Iter 28830] Loss: 0.5824 (freq: 0.1607, raw: 0.4208, quant: 0.0008, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[589,279,513,719,963,668,782,489,422,744,244,140,1020,79,632]


π”¬ Encoder Diversity (iter 28830):
  Avg similarity: 0.0259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9769 (0.0=collapsed)
[Epoch 44/100] [Batch 73/669 (10.9%)] [Iter 28840] Loss: 1.1462 (freq: 0.3993, raw: 0.7459, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[274,79,553,589,668,489,954,841,422,513,218,483,392,279,658]


π”¬ Encoder Diversity (iter 28840):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 44/100] [Batch 83/669 (12.4%)] [Iter 28850] Loss: 1.3090 (freq: 0.5149, raw: 0.7931, quant: 0.0011, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[526,422,140,937,589,916,367,738,505,982,279,668,1020,744,107]


π”¬ Encoder Diversity (iter 28850):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9794 (0.0=collapsed)
[Epoch 44/100] [Batch 93/669 (13.9%)] [Iter 28860] Loss: 0.7460 (freq: 0.2671, raw: 0.4781, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[279,977,347,846,738,33,244,551,922,589,550,685,116,849,417]


π”¬ Encoder Diversity (iter 28860):
  Avg similarity: 0.0598 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 44/100] [Batch 103/669 (15.4%)] [Iter 28870] Loss: 1.1243 (freq: 0.4158, raw: 0.7074, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[658,1020,279,937,116,367,422,916,69,65,668,145,486,169,483]


π”¬ Encoder Diversity (iter 28870):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 44/100] [Batch 113/669 (16.9%)] [Iter 28880] Loss: 1.0013 (freq: 0.3418, raw: 0.6586, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 927/1024 (90.5%) Top5:[916,977,279,668,658,526,33,244,651,486,920,334,942,968,30]


π”¬ Encoder Diversity (iter 28880):
  Avg similarity: 0.0204 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 44/100] [Batch 123/669 (18.4%)] [Iter 28890] Loss: 0.9336 (freq: 0.3306, raw: 0.6021, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[279,937,658,392,245,367,987,922,685,145,869,668,526,982,69]


π”¬ Encoder Diversity (iter 28890):
  Avg similarity: 0.0352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9790 (0.0=collapsed)
[Epoch 44/100] [Batch 133/669 (19.9%)] [Iter 28900] Loss: 1.1674 (freq: 0.4298, raw: 0.7366, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[279,658,668,589,30,489,401,690,347,794,140,902,928,651,550]


π”¬ Encoder Diversity (iter 28900):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 44/100] [Batch 143/669 (21.4%)] [Iter 28910] Loss: 1.1319 (freq: 0.3969, raw: 0.7340, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[658,738,367,282,937,279,744,566,469,417,632,330,916,540,422]


π”¬ Encoder Diversity (iter 28910):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 44/100] [Batch 153/669 (22.9%)] [Iter 28920] Loss: 1.2674 (freq: 0.4802, raw: 0.7861, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[279,658,668,417,1020,632,879,469,69,367,916,635,937,902,526]


π”¬ Encoder Diversity (iter 28920):
  Avg similarity: 0.0399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 44/100] [Batch 163/669 (24.4%)] [Iter 28930] Loss: 0.9440 (freq: 0.3199, raw: 0.6231, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[977,651,589,968,954,307,140,401,658,916,489,282,279,417,69]


π”¬ Encoder Diversity (iter 28930):
  Avg similarity: 0.0514 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 44/100] [Batch 173/669 (25.9%)] [Iter 28940] Loss: 0.8540 (freq: 0.2872, raw: 0.5659, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[489,968,658,589,401,572,977,79,937,151,744,270,793,244,942]


π”¬ Encoder Diversity (iter 28940):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 44/100] [Batch 183/669 (27.4%)] [Iter 28950] Loss: 0.7975 (freq: 0.2948, raw: 0.5018, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[33,392,116,977,151,942,347,916,601,124,982,793,658,578,130]


π”¬ Encoder Diversity (iter 28950):
  Avg similarity: 0.0175 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9786 (0.0=collapsed)
[Epoch 44/100] [Batch 193/669 (28.8%)] [Iter 28960] Loss: 1.0976 (freq: 0.3830, raw: 0.7137, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[658,937,279,977,967,589,738,72,611,801,116,145,334,834,244]


π”¬ Encoder Diversity (iter 28960):
  Avg similarity: 0.0144 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9778 (0.0=collapsed)
[Epoch 44/100] [Batch 203/669 (30.3%)] [Iter 28970] Loss: 1.0207 (freq: 0.3633, raw: 0.6565, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[513,244,151,392,307,968,334,589,160,305,651,782,516,976,79]


π”¬ Encoder Diversity (iter 28970):
  Avg similarity: 0.0388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 44/100] [Batch 213/669 (31.8%)] [Iter 28980] Loss: 0.9341 (freq: 0.3330, raw: 0.6001, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[668,72,980,516,279,553,201,685,505,651,145,968,937,916,65]


π”¬ Encoder Diversity (iter 28980):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 44/100] [Batch 223/669 (33.3%)] [Iter 28990] Loss: 1.1691 (freq: 0.4619, raw: 0.7062, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[668,279,937,980,201,632,130,65,658,834,1020,916,744,685,123]


π”¬ Encoder Diversity (iter 28990):
  Avg similarity: 0.0388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 44/100] [Batch 233/669 (34.8%)] [Iter 29000] Loss: 0.9213 (freq: 0.2880, raw: 0.6324, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[658,279,116,417,1008,469,201,516,123,93,553,801,690,145,111]


π”¬ Encoder Diversity (iter 29000):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 44/100] [Batch 243/669 (36.3%)] [Iter 29010] Loss: 0.9063 (freq: 0.3055, raw: 0.5998, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[658,668,111,145,201,1008,690,841,279,422,72,392,806,124,65]


π”¬ Encoder Diversity (iter 29010):
  Avg similarity: 0.0536 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 44/100] [Batch 253/669 (37.8%)] [Iter 29020] Loss: 0.9045 (freq: 0.2995, raw: 0.6041, quant: 0.0009, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[489,668,969,417,244,69,738,937,186,589,595,801,846,651,282]


π”¬ Encoder Diversity (iter 29020):
  Avg similarity: 0.0620 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 44/100] [Batch 263/669 (39.3%)] [Iter 29030] Loss: 1.2599 (freq: 0.4622, raw: 0.7966, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[668,367,1020,658,72,806,145,417,116,69,304,566,937,486,303]


π”¬ Encoder Diversity (iter 29030):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 44/100] [Batch 273/669 (40.8%)] [Iter 29040] Loss: 1.1721 (freq: 0.4373, raw: 0.7337, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[93,244,367,668,782,937,550,589,611,304,874,516,690,841,72]


π”¬ Encoder Diversity (iter 29040):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 44/100] [Batch 283/669 (42.3%)] [Iter 29050] Loss: 1.1599 (freq: 0.4060, raw: 0.7530, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[658,367,611,668,116,782,738,145,201,834,93,54,486,589,916]


π”¬ Encoder Diversity (iter 29050):
  Avg similarity: 0.0235 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 44/100] [Batch 293/669 (43.8%)] [Iter 29060] Loss: 1.2694 (freq: 0.4799, raw: 0.7885, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[116,69,937,668,1020,201,834,390,469,1014,983,688,550,279,651]


π”¬ Encoder Diversity (iter 29060):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 44/100] [Batch 303/669 (45.3%)] [Iter 29070] Loss: 1.1353 (freq: 0.4007, raw: 0.7335, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[489,690,658,846,782,668,916,486,401,65,688,566,111,695,10]


π”¬ Encoder Diversity (iter 29070):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 44/100] [Batch 313/669 (46.8%)] [Iter 29080] Loss: 1.0710 (freq: 0.3937, raw: 0.6763, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[937,658,116,738,123,690,130,982,566,201,417,186,10,468,69]


π”¬ Encoder Diversity (iter 29080):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 44/100] [Batch 323/669 (48.3%)] [Iter 29090] Loss: 1.1414 (freq: 0.4146, raw: 0.7258, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[658,469,111,668,122,244,651,688,513,611,685,173,130,489,738]


π”¬ Encoder Diversity (iter 29090):
  Avg similarity: 0.0316 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 44/100] [Batch 333/669 (49.8%)] [Iter 29100] Loss: 1.0201 (freq: 0.3628, raw: 0.6562, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[658,834,130,54,685,668,611,72,1003,937,367,87,219,201,186]


π”¬ Encoder Diversity (iter 29100):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 44/100] [Batch 343/669 (51.3%)] [Iter 29110] Loss: 0.9667 (freq: 0.3633, raw: 0.6025, quant: 0.0010, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[668,658,553,943,651,338,130,550,8,145,591,611,186,834,599]


π”¬ Encoder Diversity (iter 29110):
  Avg similarity: 0.0201 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9762 (0.0=collapsed)
[Epoch 44/100] [Batch 353/669 (52.8%)] [Iter 29120] Loss: 0.9928 (freq: 0.3426, raw: 0.6492, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[599,668,658,553,338,513,834,957,8,591,937,367,401,841,201]


π”¬ Encoder Diversity (iter 29120):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 44/100] [Batch 363/669 (54.3%)] [Iter 29130] Loss: 1.0338 (freq: 0.3731, raw: 0.6598, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[937,685,566,668,130,367,553,505,982,65,201,842,874,69,240]


π”¬ Encoder Diversity (iter 29130):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 44/100] [Batch 373/669 (55.8%)] [Iter 29140] Loss: 0.9858 (freq: 0.3139, raw: 0.6710, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[401,589,968,956,651,690,957,999,338,8,201,500,186,130,937]


π”¬ Encoder Diversity (iter 29140):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9776 (0.0=collapsed)
[Epoch 44/100] [Batch 383/669 (57.2%)] [Iter 29150] Loss: 1.1535 (freq: 0.3971, raw: 0.7554, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[690,201,668,390,943,69,367,489,956,130,244,589,658,505,380]


π”¬ Encoder Diversity (iter 29150):
  Avg similarity: 0.0296 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 44/100] [Batch 393/669 (58.7%)] [Iter 29160] Loss: 1.0536 (freq: 0.3694, raw: 0.6832, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[937,668,658,201,367,500,539,971,10,806,800,55,834,617,479]


π”¬ Encoder Diversity (iter 29160):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 44/100] [Batch 403/669 (60.2%)] [Iter 29170] Loss: 1.0873 (freq: 0.3803, raw: 0.7061, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[668,611,937,658,367,69,65,338,643,946,685,130,595,617,390]


π”¬ Encoder Diversity (iter 29170):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 44/100] [Batch 413/669 (61.7%)] [Iter 29180] Loss: 1.0743 (freq: 0.3794, raw: 0.6939, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[937,658,338,201,130,668,69,800,489,417,957,651,367,539,282]


π”¬ Encoder Diversity (iter 29180):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 44/100] [Batch 423/669 (63.2%)] [Iter 29190] Loss: 1.1372 (freq: 0.3928, raw: 0.7435, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[668,957,338,151,183,611,79,478,643,489,479,916,971,401,651]


π”¬ Encoder Diversity (iter 29190):
  Avg similarity: 0.0251 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 44/100] [Batch 433/669 (64.7%)] [Iter 29200] Loss: 1.0022 (freq: 0.3549, raw: 0.6463, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[319,539,244,489,806,478,295,686,957,367,500,55,801,186,151]


π”¬ Encoder Diversity (iter 29200):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 44/100] [Batch 443/669 (66.2%)] [Iter 29210] Loss: 1.0361 (freq: 0.3477, raw: 0.6875, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[244,201,186,834,916,130,658,685,660,65,338,219,588,937,240]


π”¬ Encoder Diversity (iter 29210):
  Avg similarity: 0.0462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 44/100] [Batch 453/669 (67.7%)] [Iter 29220] Loss: 1.1025 (freq: 0.3972, raw: 0.7044, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[201,668,643,806,69,367,937,1020,658,505,304,79,834,588,219]


π”¬ Encoder Diversity (iter 29220):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 44/100] [Batch 463/669 (69.2%)] [Iter 29230] Loss: 1.1424 (freq: 0.4288, raw: 0.7126, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[937,668,130,489,401,738,319,999,885,479,69,173,841,500,244]


π”¬ Encoder Diversity (iter 29230):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 44/100] [Batch 473/669 (70.7%)] [Iter 29240] Loss: 0.8562 (freq: 0.2702, raw: 0.5851, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[338,417,69,539,937,806,651,401,489,834,244,79,971,916,800]


π”¬ Encoder Diversity (iter 29240):
  Avg similarity: 0.0249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 44/100] [Batch 483/669 (72.2%)] [Iter 29250] Loss: 1.0163 (freq: 0.3504, raw: 0.6649, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[806,489,367,801,380,668,158,956,643,658,69,505,971,800,130]


π”¬ Encoder Diversity (iter 29250):
  Avg similarity: 0.0687 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9577 (0.0=collapsed)
[Epoch 44/100] [Batch 493/669 (73.7%)] [Iter 29260] Loss: 0.9157 (freq: 0.3137, raw: 0.6010, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[69,937,834,658,611,1020,806,588,295,367,916,946,201,505,566]


π”¬ Encoder Diversity (iter 29260):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 44/100] [Batch 503/669 (75.2%)] [Iter 29270] Loss: 0.8216 (freq: 0.2947, raw: 0.5261, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[957,970,651,759,960,999,734,800,728,801,841,489,173,572,501]


π”¬ Encoder Diversity (iter 29270):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 44/100] [Batch 513/669 (76.7%)] [Iter 29280] Loss: 0.7943 (freq: 0.2582, raw: 0.5351, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[806,937,338,734,960,539,997,775,489,553,769,65,811,801,902]


π”¬ Encoder Diversity (iter 29280):
  Avg similarity: 0.0222 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9787 (0.0=collapsed)
[Epoch 44/100] [Batch 523/669 (78.2%)] [Iter 29290] Loss: 0.8358 (freq: 0.2821, raw: 0.5527, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[740,173,801,885,734,617,668,775,652,401,553,728,968,782,186]


π”¬ Encoder Diversity (iter 29290):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 44/100] [Batch 533/669 (79.7%)] [Iter 29300] Loss: 1.1305 (freq: 0.4084, raw: 0.7211, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[69,611,937,175,417,219,588,956,282,295,344,842,469,130,902]


π”¬ Encoder Diversity (iter 29300):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 44/100] [Batch 543/669 (81.2%)] [Iter 29310] Loss: 0.9237 (freq: 0.3116, raw: 0.6111, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[611,240,937,201,295,69,130,588,96,367,683,175,189,995,469]


π”¬ Encoder Diversity (iter 29310):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 44/100] [Batch 553/669 (82.7%)] [Iter 29320] Loss: 1.1488 (freq: 0.3873, raw: 0.7604, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 920/1024 (89.8%) Top5:[806,588,240,96,946,1020,595,380,1003,834,660,960,401,192,734]


π”¬ Encoder Diversity (iter 29320):
  Avg similarity: 0.0191 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 44/100] [Batch 563/669 (84.2%)] [Iter 29330] Loss: 1.1624 (freq: 0.4229, raw: 0.7386, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[489,229,800,501,572,79,652,960,401,201,841,254,971,734,539]


π”¬ Encoder Diversity (iter 29330):
  Avg similarity: 0.0314 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 44/100] [Batch 573/669 (85.7%)] [Iter 29340] Loss: 0.8016 (freq: 0.2875, raw: 0.5132, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[201,130,738,617,175,69,937,668,611,957,685,968,769,489,295]


π”¬ Encoder Diversity (iter 29340):
  Avg similarity: 0.0631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 44/100] [Batch 583/669 (87.1%)] [Iter 29350] Loss: 1.1578 (freq: 0.4341, raw: 0.7227, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 915/1024 (89.4%) Top5:[916,937,201,611,806,987,96,834,842,668,995,579,566,588,130]


π”¬ Encoder Diversity (iter 29350):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9782 (0.0=collapsed)
[Epoch 44/100] [Batch 593/669 (88.6%)] [Iter 29360] Loss: 1.0044 (freq: 0.3285, raw: 0.6750, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[130,588,651,886,960,219,937,801,759,740,806,229,500,690,971]


π”¬ Encoder Diversity (iter 29360):
  Avg similarity: 0.0576 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 44/100] [Batch 603/669 (90.1%)] [Iter 29370] Loss: 0.9861 (freq: 0.3297, raw: 0.6555, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[201,588,611,660,995,806,683,869,479,381,957,295,503,937,971]


π”¬ Encoder Diversity (iter 29370):
  Avg similarity: 0.0724 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 44/100] [Batch 613/669 (91.6%)] [Iter 29380] Loss: 1.1556 (freq: 0.4320, raw: 0.7226, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[937,570,201,611,69,995,295,902,380,806,219,16,738,578,96]


π”¬ Encoder Diversity (iter 29380):
  Avg similarity: 0.0225 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9769 (0.0=collapsed)
[Epoch 44/100] [Batch 623/669 (93.1%)] [Iter 29390] Loss: 1.1202 (freq: 0.4013, raw: 0.7179, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[344,69,489,886,16,367,957,130,660,588,801,968,937,995,240]


π”¬ Encoder Diversity (iter 29390):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 44/100] [Batch 633/669 (94.6%)] [Iter 29400] Loss: 1.1472 (freq: 0.4130, raw: 0.7332, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[668,937,201,588,806,738,367,946,69,611,971,348,130,501,295]


π”¬ Encoder Diversity (iter 29400):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 44/100] [Batch 643/669 (96.1%)] [Iter 29410] Loss: 0.9067 (freq: 0.2934, raw: 0.6124, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[539,702,971,960,489,677,957,683,968,69,168,593,886,513,79]


π”¬ Encoder Diversity (iter 29410):
  Avg similarity: 0.0456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 44/100] [Batch 653/669 (97.6%)] [Iter 29420] Loss: 0.9253 (freq: 0.3252, raw: 0.5992, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[937,130,462,72,469,254,344,806,880,201,69,750,611,295,145]


π”¬ Encoder Diversity (iter 29420):
  Avg similarity: 0.0641 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 44/100] [Batch 663/669 (99.1%)] [Iter 29430] Loss: 1.0679 (freq: 0.3856, raw: 0.6813, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[77,69,660,651,834,201,734,489,229,886,800,885,462,960,380]


π”¬ Encoder Diversity (iter 29430):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)

================================================================================
[Epoch 44] Validation Results:
  Total Loss: 0.5385
  Freq Loss:  0.1581
  Raw Loss:   0.3795
  Quant Loss: 0.0009
  π“ Codebook Usage: 704/1024 (68.8%)
  π“ Codebook Entropy: 5.4683 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 19169 (14.7%)
  Top 10 most used codes:
    1. Code 617: 2078 times (1.60%)
    2. Code 728: 2040 times (1.57%)
    3. Code 79: 2012 times (1.55%)
    4. Code 168: 2004 times (1.54%)
    5. Code 186: 1930 times (1.48%)
    6. Code 392: 1922 times (1.48%)
    7. Code 683: 1866 times (1.43%)
    8. Code 539: 1814 times (1.39%)
    9. Code 503: 1759 times (1.35%)
    10. Code 501: 1744 times (1.34%)
  Bottom 5 least used codes (among used):
    1. Code 343: 1 times (0.00%)
    2. Code 316: 1 times (0.00%)
    3. Code 643: 1 times (0.00%)
    4. Code 805: 1 times (0.00%)
    5. Code 111: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 3/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 45/100] [Batch 4/669 (0.6%)] [Iter 29440] Loss: 1.0476 (freq: 0.3862, raw: 0.6604, quant: 0.0011, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 1012/1024 (98.8%) Top5:[734,756,489,957,916,501,229,801,188,944,401,841,738,902,186]


π”¬ Encoder Diversity (iter 29440):
  Avg similarity: 0.0580 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 45/100] [Batch 14/669 (2.1%)] [Iter 29450] Loss: 1.1502 (freq: 0.3958, raw: 0.7534, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 943/1024 (92.1%) Top5:[220,549,996,971,364,1023,424,229,801,928,561,651,916,489,254]


π”¬ Encoder Diversity (iter 29450):
  Avg similarity: 0.0334 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 45/100] [Batch 24/669 (3.6%)] [Iter 29460] Loss: 1.0638 (freq: 0.3733, raw: 0.6894, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[631,304,916,561,651,571,995,549,436,996,983,408,960,656,761]


π”¬ Encoder Diversity (iter 29460):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 45/100] [Batch 34/669 (5.1%)] [Iter 29470] Loss: 0.9316 (freq: 0.3459, raw: 0.5848, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[304,916,996,651,50,186,986,116,677,631,501,254,922,168,76]


π”¬ Encoder Diversity (iter 29470):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 45/100] [Batch 44/669 (6.6%)] [Iter 29480] Loss: 1.1679 (freq: 0.4505, raw: 0.7164, quant: 0.0011, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[651,652,538,549,494,489,928,501,801,448,968,561,944,971,539]


π”¬ Encoder Diversity (iter 29480):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 45/100] [Batch 54/669 (8.1%)] [Iter 29490] Loss: 1.2886 (freq: 0.4839, raw: 0.8037, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 931/1024 (90.9%) Top5:[549,561,18,651,711,461,436,267,780,922,304,986,76,382,408]


π”¬ Encoder Diversity (iter 29490):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 45/100] [Batch 64/669 (9.6%)] [Iter 29500] Loss: 1.3831 (freq: 0.5081, raw: 0.8740, quant: 0.0011, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[944,971,431,886,307,916,738,53,637,841,269,501,776,561,155]


π”¬ Encoder Diversity (iter 29500):
  Avg similarity: 0.0364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 45/100] [Batch 74/669 (11.1%)] [Iter 29510] Loss: 0.8564 (freq: 0.2942, raw: 0.5613, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[651,304,561,971,916,267,944,541,801,738,885,549,803,928,173]


π”¬ Encoder Diversity (iter 29510):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 45/100] [Batch 84/669 (12.6%)] [Iter 29520] Loss: 1.0998 (freq: 0.4257, raw: 0.6731, quant: 0.0010, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[801,803,823,254,431,995,824,944,146,886,909,239,224,651,407]


π”¬ Encoder Diversity (iter 29520):
  Avg similarity: 0.0333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 45/100] [Batch 94/669 (14.1%)] [Iter 29530] Loss: 0.8294 (freq: 0.2841, raw: 0.5444, quant: 0.0009, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[944,254,651,824,971,986,186,728,886,431,734,803,960,968,489]


π”¬ Encoder Diversity (iter 29530):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 45/100] [Batch 104/669 (15.5%)] [Iter 29540] Loss: 0.9826 (freq: 0.3380, raw: 0.6436, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[561,146,609,803,2,823,973,819,651,407,986,461,382,50,652]


π”¬ Encoder Diversity (iter 29540):
  Avg similarity: 0.0664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 45/100] [Batch 114/669 (17.0%)] [Iter 29550] Loss: 1.0395 (freq: 0.3804, raw: 0.6582, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[971,734,146,651,50,986,304,295,478,549,968,916,388,239,477]


π”¬ Encoder Diversity (iter 29550):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 45/100] [Batch 124/669 (18.5%)] [Iter 29560] Loss: 1.1886 (freq: 0.4696, raw: 0.7179, quant: 0.0011, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[1006,388,711,922,549,738,613,461,986,331,220,146,780,478,112]


π”¬ Encoder Diversity (iter 29560):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 45/100] [Batch 134/669 (20.0%)] [Iter 29570] Loss: 0.9847 (freq: 0.3646, raw: 0.6191, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[986,561,971,304,714,1006,823,53,388,48,431,734,916,18,402]


π”¬ Encoder Diversity (iter 29570):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 45/100] [Batch 144/669 (21.5%)] [Iter 29580] Loss: 1.0649 (freq: 0.3864, raw: 0.6775, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 917/1024 (89.6%) Top5:[1006,801,761,922,491,738,971,996,983,461,711,295,803,163,968]


π”¬ Encoder Diversity (iter 29580):
  Avg similarity: 0.0836 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9519 (0.0=collapsed)
[Epoch 45/100] [Batch 154/669 (23.0%)] [Iter 29590] Loss: 1.3010 (freq: 0.4761, raw: 0.8239, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[549,986,801,971,968,922,711,916,561,407,652,18,491,388,819]


π”¬ Encoder Diversity (iter 29590):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 45/100] [Batch 164/669 (24.5%)] [Iter 29600] Loss: 0.7130 (freq: 0.2070, raw: 0.5050, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[968,801,734,960,824,327,431,971,677,651,613,224,392,489,186]


π”¬ Encoder Diversity (iter 29600):
  Avg similarity: 0.0338 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9762 (0.0=collapsed)
[Epoch 45/100] [Batch 174/669 (26.0%)] [Iter 29610] Loss: 0.9692 (freq: 0.3153, raw: 0.6530, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[968,267,306,971,734,303,407,541,986,738,461,996,478,390,823]


π”¬ Encoder Diversity (iter 29610):
  Avg similarity: 0.0269 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 45/100] [Batch 184/669 (27.5%)] [Iter 29620] Loss: 0.8114 (freq: 0.2795, raw: 0.5310, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[971,652,968,886,734,541,957,761,824,478,728,431,840,944,677]


π”¬ Encoder Diversity (iter 29620):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 45/100] [Batch 194/669 (29.0%)] [Iter 29630] Loss: 0.9722 (freq: 0.3617, raw: 0.6095, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[971,431,478,501,304,1006,617,734,503,801,738,325,968,823,561]


π”¬ Encoder Diversity (iter 29630):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 45/100] [Batch 204/669 (30.5%)] [Iter 29640] Loss: 1.2525 (freq: 0.4453, raw: 0.8062, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[186,651,886,541,501,971,823,957,561,407,986,803,431,734,478]


π”¬ Encoder Diversity (iter 29640):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 45/100] [Batch 214/669 (32.0%)] [Iter 29650] Loss: 1.1617 (freq: 0.4218, raw: 0.7389, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[407,823,112,267,304,77,498,922,549,916,738,1006,48,526,388]


π”¬ Encoder Diversity (iter 29650):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 45/100] [Batch 224/669 (33.5%)] [Iter 29660] Loss: 1.1746 (freq: 0.4200, raw: 0.7536, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 929/1024 (90.7%) Top5:[267,986,407,738,823,304,501,711,549,740,498,4,48,651,163]


π”¬ Encoder Diversity (iter 29660):
  Avg similarity: 0.0520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 45/100] [Batch 234/669 (35.0%)] [Iter 29670] Loss: 1.1164 (freq: 0.3959, raw: 0.7194, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[971,44,597,738,542,710,501,801,407,740,431,538,761,4,79]


π”¬ Encoder Diversity (iter 29670):
  Avg similarity: 0.0286 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 45/100] [Batch 244/669 (36.5%)] [Iter 29680] Loss: 1.2568 (freq: 0.4594, raw: 0.7965, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 917/1024 (89.6%) Top5:[986,304,819,652,927,840,431,916,407,1019,968,803,390,224,48]


π”¬ Encoder Diversity (iter 29680):
  Avg similarity: 0.0388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 45/100] [Batch 254/669 (38.0%)] [Iter 29690] Loss: 0.9846 (freq: 0.3397, raw: 0.6439, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 941/1024 (91.9%) Top5:[304,819,381,705,613,390,44,922,303,48,498,407,823,549,431]


π”¬ Encoder Diversity (iter 29690):
  Avg similarity: 0.0281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 45/100] [Batch 264/669 (39.5%)] [Iter 29700] Loss: 0.8196 (freq: 0.2913, raw: 0.5274, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[916,734,944,986,541,304,971,561,407,3,927,327,723,303,267]


π”¬ Encoder Diversity (iter 29700):
  Avg similarity: 0.0483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 45/100] [Batch 274/669 (41.0%)] [Iter 29710] Loss: 1.1758 (freq: 0.4283, raw: 0.7466, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[304,491,407,561,986,303,267,823,597,1006,112,3,549,526,381]


π”¬ Encoder Diversity (iter 29710):
  Avg similarity: 0.0497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 45/100] [Batch 284/669 (42.5%)] [Iter 29720] Loss: 0.8869 (freq: 0.2907, raw: 0.5952, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[304,986,824,186,431,407,971,734,801,348,489,651,939,970,652]


π”¬ Encoder Diversity (iter 29720):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 45/100] [Batch 294/669 (43.9%)] [Iter 29730] Loss: 1.2484 (freq: 0.4272, raw: 0.8202, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[685,986,761,304,407,823,971,267,303,561,491,819,498,999,112]


π”¬ Encoder Diversity (iter 29730):
  Avg similarity: 0.0280 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 45/100] [Batch 304/669 (45.4%)] [Iter 29740] Loss: 1.0651 (freq: 0.3492, raw: 0.7150, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[986,407,304,823,541,561,734,916,944,267,771,912,960,443,478]


π”¬ Encoder Diversity (iter 29740):
  Avg similarity: 0.0281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9741 (0.0=collapsed)
[Epoch 45/100] [Batch 314/669 (46.9%)] [Iter 29750] Loss: 1.1021 (freq: 0.3533, raw: 0.7477, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 923/1024 (90.1%) Top5:[971,819,267,986,916,186,823,76,407,304,985,801,146,48,303]


π”¬ Encoder Diversity (iter 29750):
  Avg similarity: 0.0310 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 45/100] [Batch 324/669 (48.4%)] [Iter 29760] Loss: 1.1622 (freq: 0.4266, raw: 0.7346, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[617,677,968,986,541,916,267,960,734,304,448,186,971,431,303]


π”¬ Encoder Diversity (iter 29760):
  Avg similarity: 0.0186 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 45/100] [Batch 334/669 (49.9%)] [Iter 29770] Loss: 1.1689 (freq: 0.4168, raw: 0.7511, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[986,916,985,561,267,840,407,740,823,597,971,431,420,335,44]


π”¬ Encoder Diversity (iter 29770):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 45/100] [Batch 344/669 (51.4%)] [Iter 29780] Loss: 0.8693 (freq: 0.3177, raw: 0.5506, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[734,723,503,348,186,304,960,968,561,489,729,886,677,840,803]


π”¬ Encoder Diversity (iter 29780):
  Avg similarity: 0.0215 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9766 (0.0=collapsed)
[Epoch 45/100] [Batch 354/669 (52.9%)] [Iter 29790] Loss: 0.8577 (freq: 0.2549, raw: 0.6018, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 924/1024 (90.2%) Top5:[677,971,968,944,121,734,986,723,541,918,801,503,302,823,498]


π”¬ Encoder Diversity (iter 29790):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 45/100] [Batch 364/669 (54.4%)] [Iter 29800] Loss: 1.1501 (freq: 0.4003, raw: 0.7488, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[304,986,971,819,968,48,501,388,146,407,734,69,740,561,461]


π”¬ Encoder Diversity (iter 29800):
  Avg similarity: 0.0220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9769 (0.0=collapsed)
[Epoch 45/100] [Batch 374/669 (55.9%)] [Iter 29810] Loss: 0.9358 (freq: 0.3555, raw: 0.5793, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[968,727,971,734,348,420,501,884,524,380,390,928,840,431,231]


π”¬ Encoder Diversity (iter 29810):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9760 (0.0=collapsed)
[Epoch 45/100] [Batch 384/669 (57.4%)] [Iter 29820] Loss: 0.7144 (freq: 0.2301, raw: 0.4834, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 853/1024 (83.3%) Top5:[971,541,960,681,840,968,928,462,168,478,734,790,677,543,335]


π”¬ Encoder Diversity (iter 29820):
  Avg similarity: 0.0304 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 45/100] [Batch 394/669 (58.9%)] [Iter 29830] Loss: 0.8980 (freq: 0.3080, raw: 0.5891, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[304,541,734,626,677,916,911,48,77,44,478,431,407,698,381]


π”¬ Encoder Diversity (iter 29830):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 45/100] [Batch 404/669 (60.4%)] [Iter 29840] Loss: 1.3536 (freq: 0.4905, raw: 0.8621, quant: 0.0011, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 920/1024 (89.8%) Top5:[331,986,48,407,287,381,388,884,729,819,304,267,498,738,823]


π”¬ Encoder Diversity (iter 29840):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 45/100] [Batch 414/669 (61.9%)] [Iter 29850] Loss: 1.2350 (freq: 0.4070, raw: 0.8270, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[407,34,381,267,304,561,462,734,431,819,498,478,986,440,12]


π”¬ Encoder Diversity (iter 29850):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 45/100] [Batch 424/669 (63.4%)] [Iter 29860] Loss: 0.9741 (freq: 0.3264, raw: 0.6467, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 932/1024 (91.0%) Top5:[407,48,986,884,613,303,823,245,711,381,193,304,549,526,561]


π”¬ Encoder Diversity (iter 29860):
  Avg similarity: 0.0419 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 45/100] [Batch 434/669 (64.9%)] [Iter 29870] Loss: 1.2704 (freq: 0.4870, raw: 0.7824, quant: 0.0011, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[407,986,819,304,823,526,381,561,729,303,48,734,76,112,44]


π”¬ Encoder Diversity (iter 29870):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 45/100] [Batch 444/669 (66.4%)] [Iter 29880] Loss: 1.1786 (freq: 0.4366, raw: 0.7409, quant: 0.0011, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[541,971,591,18,734,957,729,677,381,304,561,292,968,823,801]


π”¬ Encoder Diversity (iter 29880):
  Avg similarity: 0.0390 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 45/100] [Batch 454/669 (67.9%)] [Iter 29890] Loss: 0.8905 (freq: 0.2949, raw: 0.5947, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[541,971,968,734,986,677,651,267,304,231,478,431,928,292,522]


π”¬ Encoder Diversity (iter 29890):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 45/100] [Batch 464/669 (69.4%)] [Iter 29900] Loss: 1.2497 (freq: 0.4652, raw: 0.7835, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[407,819,381,561,541,267,823,934,986,388,498,303,18,501,417]


π”¬ Encoder Diversity (iter 29900):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 45/100] [Batch 474/669 (70.9%)] [Iter 29910] Loss: 1.0738 (freq: 0.3884, raw: 0.6844, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[304,986,823,926,971,819,292,48,287,408,781,245,381,407,541]


π”¬ Encoder Diversity (iter 29910):
  Avg similarity: 0.0211 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9762 (0.0=collapsed)
[Epoch 45/100] [Batch 484/669 (72.3%)] [Iter 29920] Loss: 1.0855 (freq: 0.3441, raw: 0.7405, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[968,986,18,541,478,381,524,91,819,549,971,431,498,874,269]


π”¬ Encoder Diversity (iter 29920):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 45/100] [Batch 494/669 (73.8%)] [Iter 29930] Loss: 0.9867 (freq: 0.3201, raw: 0.6657, quant: 0.0009, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[407,381,487,957,823,292,846,549,331,53,524,287,761,363,48]


π”¬ Encoder Diversity (iter 29930):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 45/100] [Batch 504/669 (75.3%)] [Iter 29940] Loss: 1.1933 (freq: 0.4491, raw: 0.7432, quant: 0.0010, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[971,968,766,986,79,874,407,801,652,561,944,478,823,392,781]


π”¬ Encoder Diversity (iter 29940):
  Avg similarity: 0.0170 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 45/100] [Batch 514/669 (76.8%)] [Iter 29950] Loss: 1.3751 (freq: 0.5143, raw: 0.8597, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[381,971,498,705,549,677,303,986,267,331,985,44,968,874,48]


π”¬ Encoder Diversity (iter 29950):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 45/100] [Batch 524/669 (78.3%)] [Iter 29960] Loss: 0.9469 (freq: 0.3415, raw: 0.6044, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[381,304,491,916,76,48,926,971,388,766,66,729,541,193,408]


π”¬ Encoder Diversity (iter 29960):
  Avg similarity: 0.0260 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9782 (0.0=collapsed)
[Epoch 45/100] [Batch 534/669 (79.8%)] [Iter 29970] Loss: 1.2925 (freq: 0.4790, raw: 0.8124, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[986,971,810,407,478,431,916,819,886,968,944,524,48,18,498]


π”¬ Encoder Diversity (iter 29970):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 45/100] [Batch 544/669 (81.3%)] [Iter 29980] Loss: 0.8681 (freq: 0.2946, raw: 0.5726, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[431,815,846,781,506,304,203,491,48,44,269,363,986,526,381]


π”¬ Encoder Diversity (iter 29980):
  Avg similarity: 0.0366 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 45/100] [Batch 554/669 (82.8%)] [Iter 29990] Loss: 1.3330 (freq: 0.5390, raw: 0.7930, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[561,292,874,381,366,546,971,677,304,986,431,819,66,408,327]


π”¬ Encoder Diversity (iter 29990):
  Avg similarity: 0.0258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 45/100] [Batch 564/669 (84.3%)] [Iter 30000] Loss: 1.1905 (freq: 0.4024, raw: 0.7871, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[819,986,433,381,613,304,934,48,407,526,267,53,823,275,146]


π”¬ Encoder Diversity (iter 30000):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 45/100] [Batch 574/669 (85.8%)] [Iter 30010] Loss: 1.1885 (freq: 0.4312, raw: 0.7562, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[304,541,431,971,48,823,819,770,287,526,944,18,968,912,366]


π”¬ Encoder Diversity (iter 30010):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 45/100] [Batch 584/669 (87.3%)] [Iter 30020] Loss: 1.0787 (freq: 0.3763, raw: 0.7015, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[986,381,203,781,303,912,18,549,55,269,66,1,801,304,734]


π”¬ Encoder Diversity (iter 30020):
  Avg similarity: 0.0554 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 45/100] [Batch 594/669 (88.8%)] [Iter 30030] Loss: 0.9684 (freq: 0.3196, raw: 0.6477, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[381,275,267,912,823,641,498,819,528,363,549,934,705,985,971]


π”¬ Encoder Diversity (iter 30030):
  Avg similarity: 0.0218 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 45/100] [Batch 604/669 (90.3%)] [Iter 30040] Loss: 0.7887 (freq: 0.2928, raw: 0.4951, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[48,455,541,381,526,801,985,803,478,781,203,626,971,944,677]


π”¬ Encoder Diversity (iter 30040):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9766 (0.0=collapsed)
[Epoch 45/100] [Batch 614/669 (91.8%)] [Iter 30050] Loss: 1.0178 (freq: 0.3401, raw: 0.6767, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[381,819,48,912,267,823,884,613,455,985,303,102,986,193,549]


π”¬ Encoder Diversity (iter 30050):
  Avg similarity: 0.0458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 45/100] [Batch 624/669 (93.3%)] [Iter 30060] Loss: 0.9241 (freq: 0.3103, raw: 0.6129, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[912,381,561,267,613,823,455,303,193,819,874,971,597,48,957]


π”¬ Encoder Diversity (iter 30060):
  Avg similarity: 0.0219 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9780 (0.0=collapsed)
[Epoch 45/100] [Batch 634/669 (94.8%)] [Iter 30070] Loss: 0.5945 (freq: 0.1868, raw: 0.4068, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[944,971,478,652,541,360,498,957,489,193,431,1,882,381,335]


π”¬ Encoder Diversity (iter 30070):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 45/100] [Batch 644/669 (96.3%)] [Iter 30080] Loss: 0.8664 (freq: 0.3163, raw: 0.5491, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[971,823,267,801,874,381,304,986,819,884,957,894,781,269,944]


π”¬ Encoder Diversity (iter 30080):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9781 (0.0=collapsed)
[Epoch 45/100] [Batch 654/669 (97.8%)] [Iter 30090] Loss: 1.2042 (freq: 0.4258, raw: 0.7772, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[541,819,404,986,971,957,1013,431,524,121,597,874,1,912,498]


π”¬ Encoder Diversity (iter 30090):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 45/100] [Batch 664/669 (99.3%)] [Iter 30100] Loss: 1.1733 (freq: 0.4666, raw: 0.7057, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[433,146,641,971,819,985,986,884,526,193,823,53,48,910,18]


π”¬ Encoder Diversity (iter 30100):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)

================================================================================
[Epoch 45] Validation Results:
  Total Loss: 0.5442
  Freq Loss:  0.1606
  Raw Loss:   0.3826
  Quant Loss: 0.0009
  π“ Codebook Usage: 709/1024 (69.2%)
  π“ Codebook Entropy: 5.4471 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 20648 (15.9%)
  Top 10 most used codes:
    1. Code 294: 2412 times (1.85%)
    2. Code 404: 2254 times (1.73%)
    3. Code 971: 2239 times (1.72%)
    4. Code 541: 2136 times (1.64%)
    5. Code 491: 2110 times (1.62%)
    6. Code 389: 2082 times (1.60%)
    7. Code 766: 2032 times (1.56%)
    8. Code 651: 1920 times (1.47%)
    9. Code 63: 1736 times (1.33%)
    10. Code 524: 1727 times (1.33%)
  Bottom 5 least used codes (among used):
    1. Code 450: 1 times (0.00%)
    2. Code 411: 1 times (0.00%)
    3. Code 540: 1 times (0.00%)
    4. Code 913: 1 times (0.00%)
    5. Code 543: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 4/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 46/100] [Batch 5/669 (0.7%)] [Iter 30110] Loss: 0.9465 (freq: 0.3605, raw: 0.5849, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 1013/1024 (98.9%) Top5:[498,524,404,944,75,957,289,269,506,968,652,491,551,799,79]


π”¬ Encoder Diversity (iter 30110):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 46/100] [Batch 15/669 (2.2%)] [Iter 30120] Loss: 0.9170 (freq: 0.3088, raw: 0.6072, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 969/1024 (94.6%) Top5:[304,971,161,894,697,491,677,153,803,179,1,801,957,828,524]


π”¬ Encoder Diversity (iter 30120):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 46/100] [Batch 25/669 (3.7%)] [Iter 30130] Loss: 1.1368 (freq: 0.4188, raw: 0.7170, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[971,18,944,874,215,610,551,389,978,360,2,489,304,75,498]


π”¬ Encoder Diversity (iter 30130):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 46/100] [Batch 35/669 (5.2%)] [Iter 30140] Loss: 0.9776 (freq: 0.3516, raw: 0.6249, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[215,623,304,1,692,461,847,75,161,1015,919,370,957,671,766]


π”¬ Encoder Diversity (iter 30140):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 46/100] [Batch 45/669 (6.7%)] [Iter 30150] Loss: 0.9654 (freq: 0.3321, raw: 0.6323, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[88,461,431,804,304,697,610,18,894,145,489,269,541,294,652]


π”¬ Encoder Diversity (iter 30150):
  Avg similarity: 0.0463 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 46/100] [Batch 55/669 (8.2%)] [Iter 30160] Loss: 1.2195 (freq: 0.4450, raw: 0.7734, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[847,541,88,697,161,804,971,874,610,351,294,209,192,461,307]


π”¬ Encoder Diversity (iter 30160):
  Avg similarity: 0.0293 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 46/100] [Batch 65/669 (9.7%)] [Iter 30170] Loss: 0.9868 (freq: 0.3303, raw: 0.6555, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[404,968,971,478,734,18,896,841,652,88,389,63,847,335,677]


π”¬ Encoder Diversity (iter 30170):
  Avg similarity: 0.0877 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 46/100] [Batch 75/669 (11.2%)] [Iter 30180] Loss: 1.1911 (freq: 0.4552, raw: 0.7349, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[215,161,623,610,209,847,362,692,88,351,51,471,697,235,131]


π”¬ Encoder Diversity (iter 30180):
  Avg similarity: 0.0223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 46/100] [Batch 85/669 (12.7%)] [Iter 30190] Loss: 0.9574 (freq: 0.3093, raw: 0.6471, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 918/1024 (89.6%) Top5:[88,235,489,215,898,294,404,1015,48,478,116,161,734,362,360]


π”¬ Encoder Diversity (iter 30190):
  Avg similarity: 0.0340 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 46/100] [Batch 95/669 (14.2%)] [Iter 30200] Loss: 1.3132 (freq: 0.4678, raw: 0.8443, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[847,362,215,161,610,594,461,235,51,404,88,874,697,781,692]


π”¬ Encoder Diversity (iter 30200):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 46/100] [Batch 105/669 (15.7%)] [Iter 30210] Loss: 1.1374 (freq: 0.4173, raw: 0.7191, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[431,215,269,610,461,847,623,828,351,88,235,51,968,539,462]


π”¬ Encoder Diversity (iter 30210):
  Avg similarity: 0.0365 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9725 (0.0=collapsed)
[Epoch 46/100] [Batch 115/669 (17.2%)] [Iter 30220] Loss: 0.9623 (freq: 0.3600, raw: 0.6013, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[116,88,801,971,351,697,781,48,161,431,968,461,828,910,14]


π”¬ Encoder Diversity (iter 30220):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 46/100] [Batch 125/669 (18.7%)] [Iter 30230] Loss: 0.9967 (freq: 0.3580, raw: 0.6377, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[461,541,489,957,478,910,48,971,766,88,203,351,804,161,18]


π”¬ Encoder Diversity (iter 30230):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 46/100] [Batch 135/669 (20.2%)] [Iter 30240] Loss: 1.2694 (freq: 0.4745, raw: 0.7938, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 921/1024 (89.9%) Top5:[894,905,847,1013,88,978,304,176,203,854,1015,541,351,439,610]


π”¬ Encoder Diversity (iter 30240):
  Avg similarity: 0.0447 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 46/100] [Batch 145/669 (21.7%)] [Iter 30250] Loss: 0.7252 (freq: 0.2268, raw: 0.4976, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[75,692,971,894,18,874,432,801,269,131,898,371,278,88,307]


π”¬ Encoder Diversity (iter 30250):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 46/100] [Batch 155/669 (23.2%)] [Iter 30260] Loss: 0.8934 (freq: 0.3030, raw: 0.5894, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[161,569,459,801,594,369,407,489,804,371,351,910,471,697,766]


π”¬ Encoder Diversity (iter 30260):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 46/100] [Batch 165/669 (24.7%)] [Iter 30270] Loss: 0.9651 (freq: 0.3119, raw: 0.6523, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[847,828,161,369,88,124,971,278,116,841,51,215,524,304,489]


π”¬ Encoder Diversity (iter 30270):
  Avg similarity: 0.0265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9766 (0.0=collapsed)
[Epoch 46/100] [Batch 175/669 (26.2%)] [Iter 30280] Loss: 1.2091 (freq: 0.4379, raw: 0.7701, quant: 0.0011, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[847,828,351,88,161,697,215,569,692,801,461,304,145,131,14]


π”¬ Encoder Diversity (iter 30280):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 46/100] [Batch 185/669 (27.7%)] [Iter 30290] Loss: 0.9194 (freq: 0.3347, raw: 0.5838, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[215,304,847,968,161,431,896,404,478,766,545,389,39,489,14]


π”¬ Encoder Diversity (iter 30290):
  Avg similarity: 0.0320 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 46/100] [Batch 195/669 (29.1%)] [Iter 30300] Loss: 0.7968 (freq: 0.2473, raw: 0.5485, quant: 0.0009, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[766,847,404,478,351,677,898,734,968,382,304,294,161,489,1]


π”¬ Encoder Diversity (iter 30300):
  Avg similarity: 0.0540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 46/100] [Batch 205/669 (30.6%)] [Iter 30310] Loss: 1.0014 (freq: 0.3684, raw: 0.6320, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[351,51,161,610,215,828,461,905,124,369,697,360,978,545,131]


π”¬ Encoder Diversity (iter 30310):
  Avg similarity: 0.0305 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 46/100] [Batch 215/669 (32.1%)] [Iter 30320] Loss: 0.9771 (freq: 0.3280, raw: 0.6482, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[847,697,51,524,828,404,461,489,335,369,478,255,734,794,272]


π”¬ Encoder Diversity (iter 30320):
  Avg similarity: 0.0263 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 46/100] [Batch 225/669 (33.6%)] [Iter 30330] Loss: 0.9403 (freq: 0.3106, raw: 0.6287, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[847,283,255,131,51,161,461,552,971,371,734,351,88,304,307]


π”¬ Encoder Diversity (iter 30330):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 46/100] [Batch 235/669 (35.1%)] [Iter 30340] Loss: 1.1000 (freq: 0.3929, raw: 0.7061, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[847,88,215,161,351,489,18,594,124,781,575,360,692,75,131]


π”¬ Encoder Diversity (iter 30340):
  Avg similarity: 0.0233 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 46/100] [Batch 245/669 (36.6%)] [Iter 30350] Loss: 1.1545 (freq: 0.3792, raw: 0.7743, quant: 0.0010, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[75,269,18,874,781,734,153,847,404,272,677,835,552,351,957]


π”¬ Encoder Diversity (iter 30350):
  Avg similarity: 0.0509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 46/100] [Batch 255/669 (38.1%)] [Iter 30360] Loss: 1.1184 (freq: 0.4165, raw: 0.7009, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 917/1024 (89.6%) Top5:[351,623,88,894,506,766,971,269,215,781,462,266,910,335,3]


π”¬ Encoder Diversity (iter 30360):
  Avg similarity: 0.0713 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 46/100] [Batch 265/669 (39.6%)] [Iter 30370] Loss: 1.0553 (freq: 0.3948, raw: 0.6595, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[215,697,847,909,88,192,828,116,360,161,478,594,968,801,369]


π”¬ Encoder Diversity (iter 30370):
  Avg similarity: 0.0738 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 46/100] [Batch 275/669 (41.1%)] [Iter 30380] Loss: 1.1436 (freq: 0.4212, raw: 0.7214, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 921/1024 (89.9%) Top5:[905,51,192,841,847,116,461,161,489,828,500,594,978,552,131]


π”¬ Encoder Diversity (iter 30380):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 46/100] [Batch 285/669 (42.6%)] [Iter 30390] Loss: 1.2135 (freq: 0.3920, raw: 0.8205, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[847,351,88,51,1,489,116,478,75,461,131,971,626,278,255]


π”¬ Encoder Diversity (iter 30390):
  Avg similarity: 0.0322 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 46/100] [Batch 295/669 (44.1%)] [Iter 30400] Loss: 0.8299 (freq: 0.2735, raw: 0.5555, quant: 0.0009, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[18,679,351,971,88,465,1,801,506,766,116,39,968,404,489]


π”¬ Encoder Diversity (iter 30400):
  Avg similarity: 0.0262 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9753 (0.0=collapsed)
[Epoch 46/100] [Batch 305/669 (45.6%)] [Iter 30410] Loss: 1.1027 (freq: 0.3787, raw: 0.7231, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[161,18,766,135,351,478,489,905,52,1,294,432,971,461,335]


π”¬ Encoder Diversity (iter 30410):
  Avg similarity: 0.0295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 46/100] [Batch 315/669 (47.1%)] [Iter 30420] Loss: 1.0445 (freq: 0.3907, raw: 0.6527, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[801,215,971,905,677,623,909,302,478,14,489,294,978,577,269]


π”¬ Encoder Diversity (iter 30420):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 46/100] [Batch 325/669 (48.6%)] [Iter 30430] Loss: 1.2429 (freq: 0.4393, raw: 0.8026, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[828,936,552,488,292,18,88,161,971,580,176,278,351,116,14]


π”¬ Encoder Diversity (iter 30430):
  Avg similarity: 0.0465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 46/100] [Batch 335/669 (50.1%)] [Iter 30440] Loss: 1.0792 (freq: 0.3460, raw: 0.7322, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[461,478,335,51,135,278,441,131,161,403,58,127,575,269,116]


π”¬ Encoder Diversity (iter 30440):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 46/100] [Batch 345/669 (51.6%)] [Iter 30450] Loss: 1.1654 (freq: 0.4336, raw: 0.7308, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[478,781,971,677,828,75,432,626,335,489,433,307,506,524,52]


π”¬ Encoder Diversity (iter 30450):
  Avg similarity: 0.0190 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9784 (0.0=collapsed)
[Epoch 46/100] [Batch 355/669 (53.1%)] [Iter 30460] Loss: 1.0223 (freq: 0.3593, raw: 0.6620, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[461,161,88,51,539,968,569,801,906,828,610,664,905,459,971]


π”¬ Encoder Diversity (iter 30460):
  Avg similarity: 0.0302 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9772 (0.0=collapsed)
[Epoch 46/100] [Batch 365/669 (54.6%)] [Iter 30470] Loss: 0.9451 (freq: 0.3190, raw: 0.6252, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 919/1024 (89.7%) Top5:[801,905,577,957,679,489,459,971,39,810,238,116,734,664,828]


π”¬ Encoder Diversity (iter 30470):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 46/100] [Batch 375/669 (56.1%)] [Iter 30480] Loss: 1.0429 (freq: 0.3971, raw: 0.6448, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[161,906,968,539,828,215,116,697,255,610,159,48,75,403,801]


π”¬ Encoder Diversity (iter 30480):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 46/100] [Batch 385/669 (57.5%)] [Iter 30490] Loss: 0.8603 (freq: 0.2964, raw: 0.5629, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[161,847,355,841,74,905,1021,278,135,628,459,131,369,116,489]


π”¬ Encoder Diversity (iter 30490):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 46/100] [Batch 395/669 (59.0%)] [Iter 30500] Loss: 1.2676 (freq: 0.4718, raw: 0.7948, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[161,116,968,278,215,269,847,524,431,88,908,403,506,51,176]


π”¬ Encoder Diversity (iter 30500):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 46/100] [Batch 405/669 (60.5%)] [Iter 30510] Loss: 1.2449 (freq: 0.4462, raw: 0.7977, quant: 0.0011, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[957,161,968,478,552,677,489,781,304,431,766,828,337,278,369]


π”¬ Encoder Diversity (iter 30510):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 46/100] [Batch 415/669 (62.0%)] [Iter 30520] Loss: 0.8219 (freq: 0.2522, raw: 0.5688, quant: 0.0009, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[116,161,524,278,88,781,968,949,610,957,971,659,489,74,369]


π”¬ Encoder Diversity (iter 30520):
  Avg similarity: 0.0492 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 46/100] [Batch 425/669 (63.5%)] [Iter 30530] Loss: 1.1692 (freq: 0.4561, raw: 0.7120, quant: 0.0011, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[828,949,677,905,610,513,131,978,209,116,1021,761,489,524,292]


π”¬ Encoder Diversity (iter 30530):
  Avg similarity: 0.0391 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 46/100] [Batch 435/669 (65.0%)] [Iter 30540] Loss: 0.9316 (freq: 0.3212, raw: 0.6095, quant: 0.0009, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[161,116,461,278,39,489,826,369,612,664,623,828,131,459,18]


π”¬ Encoder Diversity (iter 30540):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)
[Epoch 46/100] [Batch 445/669 (66.5%)] [Iter 30550] Loss: 1.1237 (freq: 0.3700, raw: 0.7527, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 932/1024 (91.0%) Top5:[847,369,161,304,215,461,801,679,248,459,664,278,610,905,131]


π”¬ Encoder Diversity (iter 30550):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 46/100] [Batch 455/669 (68.0%)] [Iter 30560] Loss: 1.2238 (freq: 0.4518, raw: 0.7709, quant: 0.0011, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[304,551,677,461,524,847,215,971,178,74,459,307,664,697,116]


π”¬ Encoder Diversity (iter 30560):
  Avg similarity: 0.0256 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 46/100] [Batch 465/669 (69.5%)] [Iter 30570] Loss: 0.6747 (freq: 0.2131, raw: 0.4607, quant: 0.0009, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[971,178,677,269,679,909,968,457,369,478,18,957,766,506,161]


π”¬ Encoder Diversity (iter 30570):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 46/100] [Batch 475/669 (71.0%)] [Iter 30580] Loss: 1.2007 (freq: 0.3960, raw: 0.8037, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 924/1024 (90.2%) Top5:[161,116,248,278,697,610,889,304,51,131,828,14,512,135,432]


π”¬ Encoder Diversity (iter 30580):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 46/100] [Batch 485/669 (72.5%)] [Iter 30590] Loss: 0.9609 (freq: 0.3206, raw: 0.6393, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 918/1024 (89.6%) Top5:[847,278,161,369,610,524,459,697,506,461,905,841,176,248,209]


π”¬ Encoder Diversity (iter 30590):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 46/100] [Batch 495/669 (74.0%)] [Iter 30600] Loss: 0.9614 (freq: 0.3350, raw: 0.6255, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 934/1024 (91.2%) Top5:[369,334,489,506,75,74,551,894,360,161,176,462,248,116,697]


π”¬ Encoder Diversity (iter 30600):
  Avg similarity: 0.0587 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 46/100] [Batch 505/669 (75.5%)] [Iter 30610] Loss: 0.9682 (freq: 0.3301, raw: 0.6371, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 917/1024 (89.6%) Top5:[610,461,161,278,269,462,561,248,971,478,957,294,793,697,431]


π”¬ Encoder Diversity (iter 30610):
  Avg similarity: 0.0321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 46/100] [Batch 515/669 (77.0%)] [Iter 30620] Loss: 1.0923 (freq: 0.3802, raw: 0.7110, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[971,610,697,161,461,369,248,936,304,793,230,847,569,897,803]


π”¬ Encoder Diversity (iter 30620):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 46/100] [Batch 525/669 (78.5%)] [Iter 30630] Loss: 1.3071 (freq: 0.5019, raw: 0.8042, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[116,905,664,135,432,278,512,612,610,697,360,144,462,461,906]


π”¬ Encoder Diversity (iter 30630):
  Avg similarity: 0.0719 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 46/100] [Batch 535/669 (80.0%)] [Iter 30640] Loss: 1.2439 (freq: 0.4598, raw: 0.7831, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 918/1024 (89.6%) Top5:[161,178,402,355,610,897,664,459,461,248,389,18,697,292,116]


π”¬ Encoder Diversity (iter 30640):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 46/100] [Batch 545/669 (81.5%)] [Iter 30650] Loss: 1.1427 (freq: 0.3892, raw: 0.7525, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[971,909,432,431,385,178,161,965,51,828,54,776,756,341,176]


π”¬ Encoder Diversity (iter 30650):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 46/100] [Batch 555/669 (83.0%)] [Iter 30660] Loss: 1.2897 (freq: 0.4789, raw: 0.8098, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[278,610,461,389,135,161,512,178,494,897,847,51,965,612,431]


π”¬ Encoder Diversity (iter 30660):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 46/100] [Batch 565/669 (84.5%)] [Iter 30670] Loss: 0.9439 (freq: 0.3476, raw: 0.5953, quant: 0.0009, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[178,461,185,131,54,635,971,957,909,369,610,341,973,75,547]


π”¬ Encoder Diversity (iter 30670):
  Avg similarity: 0.0133 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9787 (0.0=collapsed)
[Epoch 46/100] [Batch 575/669 (85.9%)] [Iter 30680] Loss: 1.3059 (freq: 0.5185, raw: 0.7863, quant: 0.0011, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[278,369,161,178,461,957,341,697,513,267,18,610,304,74,402]


π”¬ Encoder Diversity (iter 30680):
  Avg similarity: 0.0291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 46/100] [Batch 585/669 (87.4%)] [Iter 30690] Loss: 1.3191 (freq: 0.4460, raw: 0.8721, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[432,278,248,135,461,828,459,441,462,897,116,131,965,664,610]


π”¬ Encoder Diversity (iter 30690):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 46/100] [Batch 595/669 (88.9%)] [Iter 30700] Loss: 1.1548 (freq: 0.4284, raw: 0.7254, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[489,213,178,135,304,635,358,654,161,278,461,75,679,506,131]


π”¬ Encoder Diversity (iter 30700):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 46/100] [Batch 605/669 (90.4%)] [Iter 30710] Loss: 1.0093 (freq: 0.3637, raw: 0.6446, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[161,547,957,278,334,18,178,436,737,244,54,269,478,459,513]


π”¬ Encoder Diversity (iter 30710):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 46/100] [Batch 615/669 (91.9%)] [Iter 30720] Loss: 0.7590 (freq: 0.2419, raw: 0.5162, quant: 0.0009, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[116,610,909,957,847,948,243,431,161,269,506,185,176,278,18]


π”¬ Encoder Diversity (iter 30720):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 46/100] [Batch 625/669 (93.4%)] [Iter 30730] Loss: 1.1890 (freq: 0.4252, raw: 0.7628, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[278,116,18,478,27,551,506,74,948,748,436,971,547,489,957]


π”¬ Encoder Diversity (iter 30730):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 46/100] [Batch 635/669 (94.9%)] [Iter 30740] Loss: 1.0564 (freq: 0.3776, raw: 0.6778, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[610,157,664,828,369,461,116,909,161,906,278,552,697,897,438]


π”¬ Encoder Diversity (iter 30740):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 46/100] [Batch 645/669 (96.4%)] [Iter 30750] Loss: 1.0198 (freq: 0.3848, raw: 0.6340, quant: 0.0010, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[178,18,278,369,679,585,74,635,213,1,2,269,431,583,547]


π”¬ Encoder Diversity (iter 30750):
  Avg similarity: 0.0293 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 46/100] [Batch 655/669 (97.9%)] [Iter 30760] Loss: 1.0380 (freq: 0.3778, raw: 0.6593, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[161,957,635,278,261,178,74,551,135,18,489,461,506,478,1]


π”¬ Encoder Diversity (iter 30760):
  Avg similarity: 0.0313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 46/100] [Batch 665/669 (99.4%)] [Iter 30770] Loss: 1.1958 (freq: 0.4167, raw: 0.7781, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[161,461,808,905,131,583,358,278,175,369,828,965,889,890,18]


π”¬ Encoder Diversity (iter 30770):
  Avg similarity: 0.0244 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9791 (0.0=collapsed)

================================================================================
[Epoch 46] Validation Results:
  Total Loss: 0.5610
  Freq Loss:  0.1657
  Raw Loss:   0.3944
  Quant Loss: 0.0009
  π“ Codebook Usage: 465/1024 (45.4%)
  π“ Codebook Entropy: 4.6785 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 25525 (19.6%)
  Top 10 most used codes:
    1. Code 213: 2890 times (2.22%)
    2. Code 75: 2888 times (2.22%)
    3. Code 118: 2698 times (2.07%)
    4. Code 489: 2627 times (2.02%)
    5. Code 938: 2513 times (1.93%)
    6. Code 909: 2495 times (1.92%)
    7. Code 894: 2493 times (1.91%)
    8. Code 995: 2336 times (1.79%)
    9. Code 2: 2312 times (1.78%)
    10. Code 585: 2273 times (1.75%)
  Bottom 5 least used codes (among used):
    1. Code 91: 1 times (0.00%)
    2. Code 76: 1 times (0.00%)
    3. Code 125: 1 times (0.00%)
    4. Code 499: 1 times (0.00%)
    5. Code 198: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 5/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 47/100] [Batch 6/669 (0.9%)] [Iter 30780] Loss: 0.8688 (freq: 0.2792, raw: 0.5886, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 1024/1024 (100.0%) Top5:[870,431,325,551,748,436,306,176,679,835,894,957,519,358,175]


π”¬ Encoder Diversity (iter 30780):
  Avg similarity: 0.0430 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 47/100] [Batch 16/669 (2.4%)] [Iter 30790] Loss: 1.0894 (freq: 0.4133, raw: 0.6751, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 949/1024 (92.7%) Top5:[752,854,749,884,358,225,429,178,462,650,890,957,952,478,202]


π”¬ Encoder Diversity (iter 30790):
  Avg similarity: 0.0654 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 47/100] [Batch 26/669 (3.9%)] [Iter 30800] Loss: 0.9206 (freq: 0.3222, raw: 0.5974, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[202,462,79,650,429,1015,478,884,793,919,160,466,755,751,852]


π”¬ Encoder Diversity (iter 30800):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 47/100] [Batch 36/669 (5.4%)] [Iter 30810] Loss: 0.8985 (freq: 0.3272, raw: 0.5703, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[731,957,752,75,74,431,489,18,909,202,225,216,358,213,412]


π”¬ Encoder Diversity (iter 30810):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9630 (0.0=collapsed)
[Epoch 47/100] [Batch 46/669 (6.9%)] [Iter 30820] Loss: 1.0237 (freq: 0.3462, raw: 0.6766, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[957,909,431,74,756,506,731,1015,75,870,358,216,178,489,884]


π”¬ Encoder Diversity (iter 30820):
  Avg similarity: 0.0253 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 47/100] [Batch 56/669 (8.4%)] [Iter 30830] Loss: 1.3184 (freq: 0.5001, raw: 0.8172, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[1015,793,885,752,202,1018,884,831,79,836,160,412,428,772,347]


π”¬ Encoder Diversity (iter 30830):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 47/100] [Batch 66/669 (9.9%)] [Iter 30840] Loss: 1.0448 (freq: 0.3833, raw: 0.6605, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[751,429,752,1015,247,201,79,909,801,412,156,713,852,551,101]


π”¬ Encoder Diversity (iter 30840):
  Avg similarity: 0.0649 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 47/100] [Batch 76/669 (11.4%)] [Iter 30850] Loss: 1.2428 (freq: 0.4200, raw: 0.8218, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 836/1024 (81.6%) Top5:[1015,752,247,431,412,489,731,175,216,957,909,691,904,817,79]


π”¬ Encoder Diversity (iter 30850):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9760 (0.0=collapsed)
[Epoch 47/100] [Batch 86/669 (12.9%)] [Iter 30860] Loss: 0.7361 (freq: 0.2112, raw: 0.5241, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[247,1015,766,101,412,731,431,478,429,909,216,870,506,957,178]


π”¬ Encoder Diversity (iter 30860):
  Avg similarity: 0.0364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 47/100] [Batch 96/669 (14.3%)] [Iter 30870] Loss: 0.9398 (freq: 0.2926, raw: 0.6462, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 916/1024 (89.5%) Top5:[412,269,178,957,731,1015,247,325,752,478,909,749,870,216,18]


π”¬ Encoder Diversity (iter 30870):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 47/100] [Batch 106/669 (15.8%)] [Iter 30880] Loss: 0.9152 (freq: 0.3047, raw: 0.6095, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[1015,478,178,752,909,158,269,412,123,466,731,884,120,18,101]


π”¬ Encoder Diversity (iter 30880):
  Avg similarity: 0.0474 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9567 (0.0=collapsed)
[Epoch 47/100] [Batch 116/669 (17.3%)] [Iter 30890] Loss: 1.1138 (freq: 0.3976, raw: 0.7152, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[412,752,1015,71,852,158,793,404,138,101,160,405,885,831,313]


π”¬ Encoder Diversity (iter 30890):
  Avg similarity: 0.0318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 47/100] [Batch 126/669 (18.8%)] [Iter 30900] Loss: 0.9357 (freq: 0.3108, raw: 0.6238, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 918/1024 (89.6%) Top5:[1015,412,890,158,225,32,793,247,553,405,749,144,822,488,466]


π”¬ Encoder Diversity (iter 30900):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 47/100] [Batch 136/669 (20.3%)] [Iter 30910] Loss: 0.7174 (freq: 0.2023, raw: 0.5142, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 913/1024 (89.2%) Top5:[755,909,247,1015,101,158,178,269,466,156,325,138,436,553,429]


π”¬ Encoder Diversity (iter 30910):
  Avg similarity: 0.0262 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 47/100] [Batch 146/669 (21.8%)] [Iter 30920] Loss: 0.8143 (freq: 0.2759, raw: 0.5375, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[412,957,1015,751,178,120,731,436,547,325,247,605,894,809,138]


π”¬ Encoder Diversity (iter 30920):
  Avg similarity: 0.0476 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 47/100] [Batch 156/669 (23.3%)] [Iter 30930] Loss: 1.0138 (freq: 0.3472, raw: 0.6656, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[178,1015,587,160,731,325,679,909,269,101,466,361,751,755,562]


π”¬ Encoder Diversity (iter 30930):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 47/100] [Batch 166/669 (24.8%)] [Iter 30940] Loss: 1.0594 (freq: 0.3799, raw: 0.6786, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[361,562,547,178,539,922,1015,478,412,404,247,106,877,870,587]


π”¬ Encoder Diversity (iter 30940):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 47/100] [Batch 176/669 (26.3%)] [Iter 30950] Loss: 1.1379 (freq: 0.3917, raw: 0.7452, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 915/1024 (89.4%) Top5:[798,1015,412,755,725,247,156,101,404,325,436,230,178,731,138]


π”¬ Encoder Diversity (iter 30950):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 47/100] [Batch 186/669 (27.8%)] [Iter 30960] Loss: 1.1195 (freq: 0.4021, raw: 0.7164, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[1015,412,247,296,101,666,852,404,587,79,328,437,910,178,71]


π”¬ Encoder Diversity (iter 30960):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 47/100] [Batch 196/669 (29.3%)] [Iter 30970] Loss: 0.8622 (freq: 0.2811, raw: 0.5802, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[547,957,1015,731,877,178,120,691,361,562,506,325,269,393,152]


π”¬ Encoder Diversity (iter 30970):
  Avg similarity: 0.0266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9766 (0.0=collapsed)
[Epoch 47/100] [Batch 206/669 (30.8%)] [Iter 30980] Loss: 1.0295 (freq: 0.3938, raw: 0.6348, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[120,957,412,691,101,1015,178,562,404,431,247,354,269,325,752]


π”¬ Encoder Diversity (iter 30980):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 47/100] [Batch 216/669 (32.3%)] [Iter 30990] Loss: 1.1750 (freq: 0.4602, raw: 0.7137, quant: 0.0011, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[729,412,296,160,101,752,247,755,404,144,909,466,852,293,801]


π”¬ Encoder Diversity (iter 30990):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 47/100] [Batch 226/669 (33.8%)] [Iter 31000] Loss: 1.0056 (freq: 0.3196, raw: 0.6850, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[101,412,296,755,325,178,752,160,691,297,1015,71,863,725,547]


π”¬ Encoder Diversity (iter 31000):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 47/100] [Batch 236/669 (35.3%)] [Iter 31010] Loss: 0.9919 (freq: 0.3784, raw: 0.6125, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[562,101,547,957,536,888,297,877,431,994,325,785,178,870,144]


π”¬ Encoder Diversity (iter 31010):
  Avg similarity: 0.0219 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 47/100] [Batch 246/669 (36.8%)] [Iter 31020] Loss: 0.7617 (freq: 0.2505, raw: 0.5103, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[404,1015,296,731,101,755,160,349,293,326,999,178,71,247,156]


π”¬ Encoder Diversity (iter 31020):
  Avg similarity: 0.0240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9765 (0.0=collapsed)
[Epoch 47/100] [Batch 256/669 (38.3%)] [Iter 31030] Loss: 1.1121 (freq: 0.3742, raw: 0.7369, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[404,1015,412,752,160,247,786,725,331,197,909,562,101,296,137]


π”¬ Encoder Diversity (iter 31030):
  Avg similarity: 0.0280 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 47/100] [Batch 266/669 (39.8%)] [Iter 31040] Loss: 1.0220 (freq: 0.3645, raw: 0.6566, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[785,118,994,752,943,178,1015,691,297,18,46,918,922,547,412]


π”¬ Encoder Diversity (iter 31040):
  Avg similarity: 0.0223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 47/100] [Batch 276/669 (41.3%)] [Iter 31050] Loss: 1.2658 (freq: 0.4540, raw: 0.8107, quant: 0.0011, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[325,1015,101,752,755,562,160,250,79,203,293,112,269,297,18]


π”¬ Encoder Diversity (iter 31050):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 47/100] [Batch 286/669 (42.8%)] [Iter 31060] Loss: 1.0535 (freq: 0.3821, raw: 0.6704, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[329,247,144,250,1015,156,809,755,101,890,297,547,349,299,785]


π”¬ Encoder Diversity (iter 31060):
  Avg similarity: 0.0474 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 47/100] [Batch 296/669 (44.2%)] [Iter 31070] Loss: 0.8968 (freq: 0.2888, raw: 0.6070, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[283,1015,478,755,741,547,101,536,326,349,587,909,250,22,637]


π”¬ Encoder Diversity (iter 31070):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 47/100] [Batch 306/669 (45.7%)] [Iter 31080] Loss: 0.9544 (freq: 0.3354, raw: 0.6180, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[283,79,1015,957,225,691,297,793,158,769,101,752,755,553,247]


π”¬ Encoder Diversity (iter 31080):
  Avg similarity: 0.0341 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 47/100] [Batch 316/669 (47.2%)] [Iter 31090] Loss: 1.2182 (freq: 0.4283, raw: 0.7889, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[1015,751,259,890,178,943,160,814,156,547,614,536,101,429,293]


π”¬ Encoder Diversity (iter 31090):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 47/100] [Batch 326/669 (48.7%)] [Iter 31100] Loss: 1.0260 (freq: 0.3498, raw: 0.6752, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[156,1015,247,431,764,293,767,178,250,79,957,18,691,766,158]


π”¬ Encoder Diversity (iter 31100):
  Avg similarity: 0.0352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 47/100] [Batch 336/669 (50.2%)] [Iter 31110] Loss: 1.0627 (freq: 0.3740, raw: 0.6878, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[156,888,79,101,751,666,1015,863,158,18,589,812,536,429,269]


π”¬ Encoder Diversity (iter 31110):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 47/100] [Batch 346/669 (51.7%)] [Iter 31120] Loss: 1.1740 (freq: 0.4235, raw: 0.7496, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[1015,890,539,404,32,587,752,785,118,197,138,79,247,878,588]


π”¬ Encoder Diversity (iter 31120):
  Avg similarity: 0.0223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 47/100] [Batch 356/669 (53.2%)] [Iter 31130] Loss: 1.2032 (freq: 0.4131, raw: 0.7891, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[752,798,1015,795,737,138,160,79,329,259,614,247,957,101,297]


π”¬ Encoder Diversity (iter 31130):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 47/100] [Batch 366/669 (54.7%)] [Iter 31140] Loss: 0.8926 (freq: 0.3069, raw: 0.5847, quant: 0.0009, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[178,691,785,1011,524,18,614,752,297,888,130,478,731,870,329]


π”¬ Encoder Diversity (iter 31140):
  Avg similarity: 0.0194 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9785 (0.0=collapsed)
[Epoch 47/100] [Batch 376/669 (56.2%)] [Iter 31150] Loss: 1.1685 (freq: 0.4361, raw: 0.7314, quant: 0.0010, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[1015,869,910,755,247,160,943,18,588,769,5,488,56,296,79]


π”¬ Encoder Diversity (iter 31150):
  Avg similarity: 0.0418 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 47/100] [Batch 386/669 (57.7%)] [Iter 31160] Loss: 1.2260 (freq: 0.4448, raw: 0.7802, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[539,1015,793,160,764,178,587,247,144,101,138,637,293,349,63]


π”¬ Encoder Diversity (iter 31160):
  Avg similarity: 0.0215 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 47/100] [Batch 396/669 (59.2%)] [Iter 31170] Loss: 1.0606 (freq: 0.3614, raw: 0.6981, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[101,752,1015,329,431,614,71,293,587,160,812,79,178,994,299]


π”¬ Encoder Diversity (iter 31170):
  Avg similarity: 0.0223 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9782 (0.0=collapsed)
[Epoch 47/100] [Batch 406/669 (60.7%)] [Iter 31180] Loss: 1.2915 (freq: 0.4490, raw: 0.8415, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[752,247,101,994,1015,478,767,71,329,178,156,915,943,441,144]


π”¬ Encoder Diversity (iter 31180):
  Avg similarity: 0.0449 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 47/100] [Batch 416/669 (62.2%)] [Iter 31190] Loss: 0.9671 (freq: 0.3377, raw: 0.6284, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[297,506,101,731,431,296,18,614,478,1015,691,79,244,130,589]


π”¬ Encoder Diversity (iter 31190):
  Avg similarity: 0.0288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 47/100] [Batch 426/669 (63.7%)] [Iter 31200] Loss: 0.9175 (freq: 0.3256, raw: 0.5909, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[752,1015,588,101,160,138,767,354,156,793,299,970,870,539,79]


π”¬ Encoder Diversity (iter 31200):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9682 (0.0=collapsed)
[Epoch 47/100] [Batch 436/669 (65.2%)] [Iter 31210] Loss: 0.8856 (freq: 0.2944, raw: 0.5902, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[296,1015,588,752,160,101,755,506,404,247,731,79,589,130,478]


π”¬ Encoder Diversity (iter 31210):
  Avg similarity: 0.0467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 47/100] [Batch 446/669 (66.7%)] [Iter 31220] Loss: 1.3436 (freq: 0.5272, raw: 0.8154, quant: 0.0011, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[1015,160,156,101,588,296,56,7,81,130,943,637,587,404,79]


π”¬ Encoder Diversity (iter 31220):
  Avg similarity: 0.0202 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9780 (0.0=collapsed)
[Epoch 47/100] [Batch 456/669 (68.2%)] [Iter 31230] Loss: 1.0790 (freq: 0.3802, raw: 0.6978, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[160,1015,299,296,329,412,587,536,326,156,539,890,888,661,436]


π”¬ Encoder Diversity (iter 31230):
  Avg similarity: 0.0364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 47/100] [Batch 466/669 (69.7%)] [Iter 31240] Loss: 0.9195 (freq: 0.3155, raw: 0.6030, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[769,506,547,766,326,785,330,101,767,297,915,888,614,137,994]


π”¬ Encoder Diversity (iter 31240):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 47/100] [Batch 476/669 (71.2%)] [Iter 31250] Loss: 1.1600 (freq: 0.4376, raw: 0.7213, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[1015,247,506,293,412,752,588,466,101,79,785,22,614,296,456]


π”¬ Encoder Diversity (iter 31250):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 47/100] [Batch 486/669 (72.6%)] [Iter 31260] Loss: 1.0032 (freq: 0.3410, raw: 0.6611, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[731,910,614,539,247,638,466,732,178,752,299,870,1015,63,589]


π”¬ Encoder Diversity (iter 31260):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 47/100] [Batch 496/669 (74.1%)] [Iter 31270] Loss: 1.0170 (freq: 0.3518, raw: 0.6642, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[767,1015,247,101,666,329,752,7,729,176,456,614,466,852,539]


π”¬ Encoder Diversity (iter 31270):
  Avg similarity: 0.0264 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 47/100] [Batch 506/669 (75.6%)] [Iter 31280] Loss: 0.6507 (freq: 0.2082, raw: 0.4416, quant: 0.0009, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[101,329,247,614,296,766,160,588,71,539,1015,330,870,638,283]


π”¬ Encoder Diversity (iter 31280):
  Avg similarity: 0.0250 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9774 (0.0=collapsed)
[Epoch 47/100] [Batch 516/669 (77.1%)] [Iter 31290] Loss: 0.8958 (freq: 0.3052, raw: 0.5896, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[638,614,870,943,732,793,554,752,731,32,250,259,293,247,160]


π”¬ Encoder Diversity (iter 31290):
  Avg similarity: 0.0265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9771 (0.0=collapsed)
[Epoch 47/100] [Batch 526/669 (78.6%)] [Iter 31300] Loss: 1.1241 (freq: 0.4120, raw: 0.7110, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[101,766,769,466,250,160,539,994,1015,917,910,588,506,178,793]


π”¬ Encoder Diversity (iter 31300):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 47/100] [Batch 536/669 (80.1%)] [Iter 31310] Loss: 1.2407 (freq: 0.4447, raw: 0.7950, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[752,1015,588,247,101,283,160,466,441,296,539,325,329,299,150]


π”¬ Encoder Diversity (iter 31310):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 47/100] [Batch 546/669 (81.6%)] [Iter 31320] Loss: 1.0557 (freq: 0.3739, raw: 0.6808, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[533,247,614,766,767,178,539,232,297,364,156,431,1015,488,439]


π”¬ Encoder Diversity (iter 31320):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9703 (0.0=collapsed)
[Epoch 47/100] [Batch 556/669 (83.1%)] [Iter 31330] Loss: 0.6319 (freq: 0.2002, raw: 0.4308, quant: 0.0009, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 916/1024 (89.5%) Top5:[755,431,101,160,297,589,156,539,533,1015,259,910,752,888,466]


π”¬ Encoder Diversity (iter 31330):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 47/100] [Batch 566/669 (84.6%)] [Iter 31340] Loss: 1.2726 (freq: 0.4852, raw: 0.7864, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[1015,466,588,729,910,431,225,752,160,349,429,156,686,888,293]


π”¬ Encoder Diversity (iter 31340):
  Avg similarity: 0.0454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 47/100] [Batch 576/669 (86.1%)] [Iter 31350] Loss: 0.8672 (freq: 0.2731, raw: 0.5932, quant: 0.0009, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[888,653,247,785,589,614,766,638,71,178,539,478,732,637,293]


π”¬ Encoder Diversity (iter 31350):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 47/100] [Batch 586/669 (87.6%)] [Iter 31360] Loss: 0.9818 (freq: 0.3479, raw: 0.6329, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[178,466,101,794,767,653,232,752,19,732,637,297,18,539,379]


π”¬ Encoder Diversity (iter 31360):
  Avg similarity: 0.0231 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9782 (0.0=collapsed)
[Epoch 47/100] [Batch 596/669 (89.1%)] [Iter 31370] Loss: 1.0165 (freq: 0.3753, raw: 0.6402, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[178,752,653,101,21,156,160,614,71,18,554,466,297,488,296]


π”¬ Encoder Diversity (iter 31370):
  Avg similarity: 0.0266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9780 (0.0=collapsed)
[Epoch 47/100] [Batch 606/669 (90.6%)] [Iter 31380] Loss: 1.0207 (freq: 0.3514, raw: 0.6682, quant: 0.0011, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[247,160,21,273,156,101,844,832,293,588,296,943,441,769,63]


π”¬ Encoder Diversity (iter 31380):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9778 (0.0=collapsed)
[Epoch 47/100] [Batch 616/669 (92.1%)] [Iter 31390] Loss: 0.9646 (freq: 0.3165, raw: 0.6471, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[752,156,247,293,101,755,1015,299,626,791,844,71,869,512,160]


π”¬ Encoder Diversity (iter 31390):
  Avg similarity: 0.0250 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9741 (0.0=collapsed)
[Epoch 47/100] [Batch 626/669 (93.6%)] [Iter 31400] Loss: 1.1069 (freq: 0.3679, raw: 0.7380, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[79,160,293,156,9,587,653,758,101,637,250,18,794,1015,294]


π”¬ Encoder Diversity (iter 31400):
  Avg similarity: 0.0203 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9777 (0.0=collapsed)
[Epoch 47/100] [Batch 636/669 (95.1%)] [Iter 31410] Loss: 1.0357 (freq: 0.3534, raw: 0.6813, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[731,247,766,794,539,669,994,637,178,422,726,7,620,588,758]


π”¬ Encoder Diversity (iter 31410):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 47/100] [Batch 646/669 (96.6%)] [Iter 31420] Loss: 1.1754 (freq: 0.4265, raw: 0.7478, quant: 0.0011, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[752,431,1011,250,294,247,794,767,848,293,326,1015,844,691,273]


π”¬ Encoder Diversity (iter 31420):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 47/100] [Batch 656/669 (98.1%)] [Iter 31430] Loss: 1.0440 (freq: 0.3582, raw: 0.6847, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[293,170,755,422,431,191,9,588,533,614,299,250,18,269,90]


π”¬ Encoder Diversity (iter 31430):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 47/100] [Batch 666/669 (99.6%)] [Iter 31440] Loss: 0.8900 (freq: 0.2867, raw: 0.6023, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[247,293,7,726,170,614,71,637,18,349,439,250,466,620,729]


π”¬ Encoder Diversity (iter 31440):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)

================================================================================
[Epoch 47] Validation Results:
  Total Loss: 0.5404
  Freq Loss:  0.1622
  Raw Loss:   0.3773
  Quant Loss: 0.0009
  π“ Codebook Usage: 613/1024 (59.9%)
  π“ Codebook Entropy: 5.2632 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 20838 (16.0%)
  Top 10 most used codes:
    1. Code 785: 2472 times (1.90%)
    2. Code 118: 2321 times (1.78%)
    3. Code 994: 2294 times (1.76%)
    4. Code 294: 2157 times (1.66%)
    5. Code 620: 2002 times (1.54%)
    6. Code 669: 1964 times (1.51%)
    7. Code 978: 1946 times (1.49%)
    8. Code 307: 1930 times (1.48%)
    9. Code 794: 1914 times (1.47%)
    10. Code 614: 1838 times (1.41%)
  Bottom 5 least used codes (among used):
    1. Code 469: 1 times (0.00%)
    2. Code 72: 1 times (0.00%)
    3. Code 624: 1 times (0.00%)
    4. Code 665: 1 times (0.00%)
    5. Code 635: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 6/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 48/100] [Batch 7/669 (1.0%)] [Iter 31450] Loss: 0.8225 (freq: 0.2987, raw: 0.5228, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[726,620,18,766,731,589,506,614,307,965,478,794,910,17,978]


π”¬ Encoder Diversity (iter 31450):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 48/100] [Batch 17/669 (2.5%)] [Iter 31460] Loss: 0.7933 (freq: 0.2703, raw: 0.5221, quant: 0.0009, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 929/1024 (90.7%) Top5:[18,170,637,158,614,726,761,620,830,870,382,322,848,269,723]


π”¬ Encoder Diversity (iter 31460):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 48/100] [Batch 27/669 (4.0%)] [Iter 31470] Loss: 0.9033 (freq: 0.3314, raw: 0.5709, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 871/1024 (85.1%) Top5:[976,912,511,1008,140,614,164,769,191,104,761,794,232,653,300]


π”¬ Encoder Diversity (iter 31470):
  Avg similarity: 0.0524 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 48/100] [Batch 37/669 (5.5%)] [Iter 31480] Loss: 1.0924 (freq: 0.3746, raw: 0.7169, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[382,1008,158,769,759,938,300,976,271,723,21,69,855,912,848]


π”¬ Encoder Diversity (iter 31480):
  Avg similarity: 0.0802 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 48/100] [Batch 47/669 (7.0%)] [Iter 31490] Loss: 1.2516 (freq: 0.4616, raw: 0.7890, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[158,848,1008,726,761,723,382,731,978,178,18,511,637,616,976]


π”¬ Encoder Diversity (iter 31490):
  Avg similarity: 0.0391 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 48/100] [Batch 57/669 (8.5%)] [Iter 31500] Loss: 1.0427 (freq: 0.3832, raw: 0.6584, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[1008,158,938,468,511,855,769,759,382,940,753,149,271,396,31]


π”¬ Encoder Diversity (iter 31500):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 48/100] [Batch 67/669 (10.0%)] [Iter 31510] Loss: 0.9405 (freq: 0.3227, raw: 0.6168, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[938,158,1008,511,396,104,382,364,300,773,348,326,855,271,437]


π”¬ Encoder Diversity (iter 31510):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 48/100] [Batch 77/669 (11.5%)] [Iter 31520] Loss: 1.2195 (freq: 0.4426, raw: 0.7759, quant: 0.0011, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[158,938,1008,870,178,653,773,561,761,269,614,382,759,437,456]


π”¬ Encoder Diversity (iter 31520):
  Avg similarity: 0.0224 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 48/100] [Batch 87/669 (13.0%)] [Iter 31530] Loss: 1.0282 (freq: 0.3589, raw: 0.6683, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[1008,938,18,723,614,30,271,382,511,149,675,158,976,297,5]


π”¬ Encoder Diversity (iter 31530):
  Avg similarity: 0.0301 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 48/100] [Batch 97/669 (14.5%)] [Iter 31540] Loss: 1.0219 (freq: 0.3502, raw: 0.6707, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[158,938,1008,761,191,396,382,300,104,199,692,511,669,870,589]


π”¬ Encoder Diversity (iter 31540):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 48/100] [Batch 107/669 (16.0%)] [Iter 31550] Loss: 0.9833 (freq: 0.3392, raw: 0.6431, quant: 0.0010, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[938,1008,158,104,300,946,382,567,456,383,976,468,910,769,396]


π”¬ Encoder Diversity (iter 31550):
  Avg similarity: 0.0211 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9774 (0.0=collapsed)
[Epoch 48/100] [Batch 117/669 (17.5%)] [Iter 31560] Loss: 1.3133 (freq: 0.4445, raw: 0.8677, quant: 0.0011, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[300,769,938,1008,158,382,773,589,466,539,199,164,848,830,170]


π”¬ Encoder Diversity (iter 31560):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 48/100] [Batch 127/669 (19.0%)] [Iter 31570] Loss: 0.7316 (freq: 0.2296, raw: 0.5010, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[589,382,557,178,158,761,1008,30,18,614,769,191,723,595,726]


π”¬ Encoder Diversity (iter 31570):
  Avg similarity: 0.0249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 48/100] [Batch 137/669 (20.5%)] [Iter 31580] Loss: 0.9957 (freq: 0.3579, raw: 0.6369, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[653,660,595,456,870,616,191,18,140,589,383,158,672,178,232]


π”¬ Encoder Diversity (iter 31580):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9674 (0.0=collapsed)
[Epoch 48/100] [Batch 147/669 (22.0%)] [Iter 31590] Loss: 1.2529 (freq: 0.4548, raw: 0.7971, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[723,976,104,863,614,561,797,769,322,297,660,830,726,637,191]


π”¬ Encoder Diversity (iter 31590):
  Avg similarity: 0.0161 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9802 (0.0=collapsed)
[Epoch 48/100] [Batch 157/669 (23.5%)] [Iter 31600] Loss: 1.1287 (freq: 0.3877, raw: 0.7401, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[158,382,270,1008,396,104,910,511,821,191,437,506,769,692,657]


π”¬ Encoder Diversity (iter 31600):
  Avg similarity: 0.0267 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9766 (0.0=collapsed)
[Epoch 48/100] [Batch 167/669 (25.0%)] [Iter 31610] Loss: 1.3842 (freq: 0.5185, raw: 0.8646, quant: 0.0011, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[364,104,382,769,723,211,1008,300,511,690,759,158,773,396,270]


π”¬ Encoder Diversity (iter 31610):
  Avg similarity: 0.0351 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 48/100] [Batch 177/669 (26.5%)] [Iter 31620] Loss: 0.9660 (freq: 0.2958, raw: 0.6692, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[672,468,383,382,723,158,18,1008,406,191,614,595,482,33,297]


π”¬ Encoder Diversity (iter 31620):
  Avg similarity: 0.0311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 48/100] [Batch 187/669 (28.0%)] [Iter 31630] Loss: 1.2204 (freq: 0.4484, raw: 0.7709, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[364,158,1008,330,382,437,719,270,383,690,511,149,907,567,69]


π”¬ Encoder Diversity (iter 31630):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 48/100] [Batch 197/669 (29.4%)] [Iter 31640] Loss: 0.8803 (freq: 0.3191, raw: 0.5602, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[158,383,157,692,769,345,466,1008,18,502,297,797,595,511,761]


π”¬ Encoder Diversity (iter 31640):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 48/100] [Batch 207/669 (30.9%)] [Iter 31650] Loss: 0.9146 (freq: 0.2955, raw: 0.6181, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[595,18,976,158,383,322,637,1008,104,406,653,557,589,614,482]


π”¬ Encoder Diversity (iter 31650):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 48/100] [Batch 217/669 (32.4%)] [Iter 31660] Loss: 0.6062 (freq: 0.1851, raw: 0.4201, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[104,178,250,938,158,1008,723,719,511,769,157,269,5,348,383]


π”¬ Encoder Diversity (iter 31660):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 48/100] [Batch 227/669 (33.9%)] [Iter 31670] Loss: 1.0073 (freq: 0.3503, raw: 0.6560, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[1008,382,723,567,769,511,158,118,719,164,761,348,657,506,912]


π”¬ Encoder Diversity (iter 31670):
  Avg similarity: 0.0281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9770 (0.0=collapsed)
[Epoch 48/100] [Batch 237/669 (35.4%)] [Iter 31680] Loss: 0.9823 (freq: 0.3565, raw: 0.6247, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[511,769,479,938,30,348,595,18,178,723,297,614,482,396,158]


π”¬ Encoder Diversity (iter 31680):
  Avg similarity: 0.0819 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 48/100] [Batch 247/669 (36.9%)] [Iter 31690] Loss: 0.9454 (freq: 0.2891, raw: 0.6553, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[690,614,511,157,396,938,158,270,466,773,199,766,30,589,382]


π”¬ Encoder Diversity (iter 31690):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 48/100] [Batch 257/669 (38.4%)] [Iter 31700] Loss: 1.2782 (freq: 0.5032, raw: 0.7740, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[33,773,158,595,322,18,637,959,79,405,660,653,502,468,925]


π”¬ Encoder Diversity (iter 31700):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 48/100] [Batch 267/669 (39.9%)] [Iter 31710] Loss: 1.0378 (freq: 0.3916, raw: 0.6452, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[30,18,637,479,158,907,178,821,1008,744,297,191,595,5,322]


π”¬ Encoder Diversity (iter 31710):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9741 (0.0=collapsed)
[Epoch 48/100] [Batch 277/669 (41.4%)] [Iter 31720] Loss: 1.1494 (freq: 0.4334, raw: 0.7150, quant: 0.0011, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[158,348,382,723,1008,61,759,769,322,250,157,345,486,539,456]


π”¬ Encoder Diversity (iter 31720):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9688 (0.0=collapsed)
[Epoch 48/100] [Batch 287/669 (42.9%)] [Iter 31730] Loss: 1.1105 (freq: 0.3716, raw: 0.7380, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[383,158,178,255,18,589,769,335,637,672,406,502,959,456,348]


π”¬ Encoder Diversity (iter 31730):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 48/100] [Batch 297/669 (44.4%)] [Iter 31740] Loss: 1.1381 (freq: 0.4108, raw: 0.7263, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[539,104,1008,158,898,87,994,726,118,797,761,557,250,723,178]


π”¬ Encoder Diversity (iter 31740):
  Avg similarity: 0.0130 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9802 (0.0=collapsed)
[Epoch 48/100] [Batch 307/669 (45.9%)] [Iter 31750] Loss: 0.6241 (freq: 0.1897, raw: 0.4336, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[406,178,706,322,769,191,335,589,33,744,456,660,105,297,18]


π”¬ Encoder Diversity (iter 31750):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 48/100] [Batch 317/669 (47.4%)] [Iter 31760] Loss: 0.9844 (freq: 0.3483, raw: 0.6351, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[382,821,104,158,1008,506,191,595,87,726,269,345,511,561,486]


π”¬ Encoder Diversity (iter 31760):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 48/100] [Batch 327/669 (48.9%)] [Iter 31770] Loss: 1.1076 (freq: 0.3502, raw: 0.7564, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[158,769,18,396,668,322,456,912,938,178,994,614,104,345,872]


π”¬ Encoder Diversity (iter 31770):
  Avg similarity: 0.0497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 48/100] [Batch 337/669 (50.4%)] [Iter 31780] Loss: 0.9771 (freq: 0.3314, raw: 0.6447, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[269,769,105,614,297,30,589,479,557,821,87,345,561,910,539]


π”¬ Encoder Diversity (iter 31780):
  Avg similarity: 0.0350 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 48/100] [Batch 347/669 (51.9%)] [Iter 31790] Loss: 0.8578 (freq: 0.2750, raw: 0.5819, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[178,759,912,104,910,589,723,597,938,157,595,382,994,561,211]


π”¬ Encoder Diversity (iter 31790):
  Avg similarity: 0.0412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 48/100] [Batch 357/669 (53.4%)] [Iter 31800] Loss: 1.1280 (freq: 0.3933, raw: 0.7336, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[769,668,345,383,270,1008,976,104,67,938,614,663,87,595,191]


π”¬ Encoder Diversity (iter 31800):
  Avg similarity: 0.0571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9660 (0.0=collapsed)
[Epoch 48/100] [Batch 367/669 (54.9%)] [Iter 31810] Loss: 0.7372 (freq: 0.2252, raw: 0.5112, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[668,759,104,511,157,637,769,191,539,118,723,797,1008,736,589]


π”¬ Encoder Diversity (iter 31810):
  Avg similarity: 0.0240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9787 (0.0=collapsed)
[Epoch 48/100] [Batch 377/669 (56.4%)] [Iter 31820] Loss: 0.6182 (freq: 0.2009, raw: 0.4165, quant: 0.0008, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[539,614,172,250,383,511,759,766,736,191,348,178,744,907,5]


π”¬ Encoder Diversity (iter 31820):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 48/100] [Batch 387/669 (57.8%)] [Iter 31830] Loss: 1.1123 (freq: 0.3859, raw: 0.7253, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 923/1024 (90.1%) Top5:[511,364,912,1008,466,663,976,269,157,938,76,590,759,348,239]


π”¬ Encoder Diversity (iter 31830):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 48/100] [Batch 397/669 (59.3%)] [Iter 31840] Loss: 1.1573 (freq: 0.4202, raw: 0.7360, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 930/1024 (90.8%) Top5:[1008,511,976,614,87,239,576,590,104,61,67,376,589,539,335]


π”¬ Encoder Diversity (iter 31840):
  Avg similarity: 0.0169 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9780 (0.0=collapsed)
[Epoch 48/100] [Batch 407/669 (60.8%)] [Iter 31850] Loss: 1.1702 (freq: 0.4276, raw: 0.7415, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 916/1024 (89.5%) Top5:[456,87,637,959,769,479,614,151,910,663,870,211,767,382,723]


π”¬ Encoder Diversity (iter 31850):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 48/100] [Batch 417/669 (62.3%)] [Iter 31860] Loss: 0.8607 (freq: 0.3058, raw: 0.5540, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[479,382,510,797,614,18,67,5,376,767,191,766,589,663,876]


π”¬ Encoder Diversity (iter 31860):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 48/100] [Batch 427/669 (63.8%)] [Iter 31870] Loss: 0.9046 (freq: 0.3044, raw: 0.5993, quant: 0.0009, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[614,322,797,672,959,532,239,663,870,151,561,590,178,539,378]


π”¬ Encoder Diversity (iter 31870):
  Avg similarity: 0.0237 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 48/100] [Batch 437/669 (65.3%)] [Iter 31880] Loss: 1.3113 (freq: 0.4931, raw: 0.8171, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[614,511,876,959,672,1008,539,300,532,382,105,322,406,769,653]


π”¬ Encoder Diversity (iter 31880):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9738 (0.0=collapsed)
[Epoch 48/100] [Batch 447/669 (66.8%)] [Iter 31890] Loss: 1.1565 (freq: 0.3972, raw: 0.7583, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[769,539,668,590,959,135,158,511,466,672,1008,191,478,178,870]


π”¬ Encoder Diversity (iter 31890):
  Avg similarity: 0.0376 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9719 (0.0=collapsed)
[Epoch 48/100] [Batch 457/669 (68.3%)] [Iter 31900] Loss: 1.0031 (freq: 0.3490, raw: 0.6531, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[157,511,104,539,67,348,135,1008,158,468,270,576,555,668,151]


π”¬ Encoder Diversity (iter 31900):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 48/100] [Batch 467/669 (69.8%)] [Iter 31910] Loss: 1.0814 (freq: 0.4001, raw: 0.6803, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[779,672,539,383,635,677,797,345,300,382,870,380,907,348,1008]


π”¬ Encoder Diversity (iter 31910):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 48/100] [Batch 477/669 (71.3%)] [Iter 31920] Loss: 1.0566 (freq: 0.3906, raw: 0.6651, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[104,382,87,157,511,637,348,1008,761,355,759,418,769,576,164]


π”¬ Encoder Diversity (iter 31920):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9730 (0.0=collapsed)
[Epoch 48/100] [Batch 487/669 (72.8%)] [Iter 31930] Loss: 1.0954 (freq: 0.3953, raw: 0.6991, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[382,769,983,1008,672,104,187,348,478,876,158,121,456,785,191]


π”¬ Encoder Diversity (iter 31930):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 48/100] [Batch 497/669 (74.3%)] [Iter 31940] Loss: 1.1001 (freq: 0.3799, raw: 0.7192, quant: 0.0010, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[1008,769,595,590,511,821,677,876,151,466,5,797,907,348,478]


π”¬ Encoder Diversity (iter 31940):
  Avg similarity: 0.0476 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 48/100] [Batch 507/669 (75.8%)] [Iter 31950] Loss: 1.0995 (freq: 0.3907, raw: 0.7078, quant: 0.0011, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[769,590,348,158,539,1008,511,620,668,178,532,752,785,382,543]


π”¬ Encoder Diversity (iter 31950):
  Avg similarity: 0.0391 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 48/100] [Batch 517/669 (77.3%)] [Iter 31960] Loss: 1.1581 (freq: 0.4327, raw: 0.7243, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[511,910,590,668,157,120,543,663,659,307,67,345,994,979,164]


π”¬ Encoder Diversity (iter 31960):
  Avg similarity: 0.0180 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9783 (0.0=collapsed)
[Epoch 48/100] [Batch 527/669 (78.8%)] [Iter 31970] Loss: 1.3878 (freq: 0.5205, raw: 0.8663, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[348,668,158,104,269,590,769,364,876,87,151,511,653,148,61]


π”¬ Encoder Diversity (iter 31970):
  Avg similarity: 0.0107 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9803 (0.0=collapsed)
[Epoch 48/100] [Batch 537/669 (80.3%)] [Iter 31980] Loss: 1.0940 (freq: 0.3796, raw: 0.7133, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[590,983,76,769,157,468,87,158,478,382,761,453,910,794,994]


π”¬ Encoder Diversity (iter 31980):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 48/100] [Batch 547/669 (81.8%)] [Iter 31990] Loss: 0.9502 (freq: 0.3172, raw: 0.6320, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[769,614,158,532,380,87,67,590,178,511,300,668,539,13,239]


π”¬ Encoder Diversity (iter 31990):
  Avg similarity: 0.0483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 48/100] [Batch 557/669 (83.3%)] [Iter 32000] Loss: 1.1817 (freq: 0.4477, raw: 0.7329, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[590,668,539,769,151,872,794,532,752,118,104,907,983,963,418]


π”¬ Encoder Diversity (iter 32000):
  Avg similarity: 0.0487 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 48/100] [Batch 567/669 (84.8%)] [Iter 32010] Loss: 0.9080 (freq: 0.3060, raw: 0.6011, quant: 0.0009, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[532,797,1019,539,13,635,126,653,468,73,135,111,392,178,660]


π”¬ Encoder Diversity (iter 32010):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 48/100] [Batch 577/669 (86.2%)] [Iter 32020] Loss: 1.0044 (freq: 0.3219, raw: 0.6815, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[118,1008,590,663,270,348,300,468,135,543,882,162,769,330,239]


π”¬ Encoder Diversity (iter 32020):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9707 (0.0=collapsed)
[Epoch 48/100] [Batch 587/669 (87.7%)] [Iter 32030] Loss: 0.9132 (freq: 0.3227, raw: 0.5896, quant: 0.0009, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[366,223,769,1008,590,87,761,905,783,663,307,348,581,382,67]


π”¬ Encoder Diversity (iter 32030):
  Avg similarity: 0.0467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 48/100] [Batch 597/669 (89.2%)] [Iter 32040] Loss: 0.8885 (freq: 0.2985, raw: 0.5891, quant: 0.0009, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[590,67,83,307,383,876,135,332,104,1008,111,178,668,158,810]


π”¬ Encoder Diversity (iter 32040):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9672 (0.0=collapsed)
[Epoch 48/100] [Batch 607/669 (90.7%)] [Iter 32050] Loss: 1.1466 (freq: 0.4182, raw: 0.7273, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[332,668,761,590,382,663,104,157,383,826,175,910,742,1008,452]


π”¬ Encoder Diversity (iter 32050):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 48/100] [Batch 617/669 (92.2%)] [Iter 32060] Loss: 0.7685 (freq: 0.2467, raw: 0.5208, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[590,104,532,158,466,318,178,67,510,13,769,876,478,438,653]


π”¬ Encoder Diversity (iter 32060):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 48/100] [Batch 627/669 (93.7%)] [Iter 32070] Loss: 1.1877 (freq: 0.3946, raw: 0.7921, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[1008,590,332,668,158,577,87,649,104,348,614,330,769,61,382]


π”¬ Encoder Diversity (iter 32070):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 48/100] [Batch 637/669 (95.2%)] [Iter 32080] Loss: 1.1163 (freq: 0.4230, raw: 0.6923, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[510,653,876,663,13,175,974,752,614,532,579,332,383,330,348]


π”¬ Encoder Diversity (iter 32080):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 48/100] [Batch 647/669 (96.7%)] [Iter 32090] Loss: 1.0831 (freq: 0.3943, raw: 0.6878, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[348,634,158,668,1008,511,382,239,104,767,120,330,590,307,510]


π”¬ Encoder Diversity (iter 32090):
  Avg similarity: 0.0294 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 48/100] [Batch 657/669 (98.2%)] [Iter 32100] Loss: 1.1202 (freq: 0.3934, raw: 0.7257, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[1008,126,348,191,590,223,979,668,634,511,971,677,162,158,61]


π”¬ Encoder Diversity (iter 32100):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 48/100] [Batch 667/669 (99.7%)] [Iter 32110] Loss: 1.1114 (freq: 0.4131, raw: 0.6972, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[158,348,905,511,104,769,979,1008,223,971,590,876,871,378,13]


π”¬ Encoder Diversity (iter 32110):
  Avg similarity: 0.0238 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9741 (0.0=collapsed)

================================================================================
[Epoch 48] Validation Results:
  Total Loss: 0.5725
  Freq Loss:  0.1659
  Raw Loss:   0.4056
  Quant Loss: 0.0010
  π“ Codebook Usage: 419/1024 (40.9%)
  π“ Codebook Entropy: 4.6144 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 30731 (23.6%)
  Top 10 most used codes:
    1. Code 191: 4203 times (3.23%)
    2. Code 126: 3339 times (2.56%)
    3. Code 767: 3031 times (2.33%)
    4. Code 844: 3020 times (2.32%)
    5. Code 876: 2968 times (2.28%)
    6. Code 380: 2940 times (2.26%)
    7. Code 872: 2939 times (2.26%)
    8. Code 634: 2799 times (2.15%)
    9. Code 178: 2747 times (2.11%)
    10. Code 414: 2745 times (2.11%)
  Bottom 5 least used codes (among used):
    1. Code 898: 1 times (0.00%)
    2. Code 633: 1 times (0.00%)
    3. Code 241: 1 times (0.00%)
    4. Code 655: 2 times (0.00%)
    5. Code 923: 3 times (0.00%)
================================================================================

[EarlyStopping] Patience 7/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 49/100] [Batch 8/669 (1.2%)] [Iter 32120] Loss: 0.9235 (freq: 0.3301, raw: 0.5922, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[382,13,539,871,520,135,532,614,414,178,752,672,126,330,18]


π”¬ Encoder Diversity (iter 32120):
  Avg similarity: 0.0217 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9785 (0.0=collapsed)
[Epoch 49/100] [Batch 18/669 (2.7%)] [Iter 32130] Loss: 0.8233 (freq: 0.2709, raw: 0.5514, quant: 0.0009, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 926/1024 (90.4%) Top5:[134,227,13,748,844,614,318,178,677,269,532,520,89,430,330]


π”¬ Encoder Diversity (iter 32130):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 49/100] [Batch 28/669 (4.2%)] [Iter 32140] Loss: 0.7361 (freq: 0.2511, raw: 0.4839, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[811,49,539,338,1019,752,227,383,432,544,223,134,89,329,188]


π”¬ Encoder Diversity (iter 32140):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 49/100] [Batch 38/669 (5.7%)] [Iter 32150] Loss: 0.9585 (freq: 0.3050, raw: 0.6525, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[0,811,134,630,227,312,748,864,89,805,108,936,293,382,49]


π”¬ Encoder Diversity (iter 32150):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 49/100] [Batch 48/669 (7.2%)] [Iter 32160] Loss: 0.9775 (freq: 0.3430, raw: 0.6335, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[811,89,936,748,0,890,227,49,134,51,319,952,805,188,491]


π”¬ Encoder Diversity (iter 32160):
  Avg similarity: 0.0621 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 49/100] [Batch 58/669 (8.7%)] [Iter 32170] Loss: 1.0194 (freq: 0.3565, raw: 0.6620, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[614,468,134,227,876,936,813,579,178,49,581,844,597,126,330]


π”¬ Encoder Diversity (iter 32170):
  Avg similarity: 0.0272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 49/100] [Batch 68/669 (10.2%)] [Iter 32180] Loss: 1.2307 (freq: 0.4314, raw: 0.7982, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[745,936,0,597,660,3,876,748,468,18,223,227,844,872,89]


π”¬ Encoder Diversity (iter 32180):
  Avg similarity: 0.0369 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 49/100] [Batch 78/669 (11.7%)] [Iter 32190] Loss: 0.9643 (freq: 0.3242, raw: 0.6390, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[0,748,811,630,319,404,227,752,383,614,457,49,432,72,872]


π”¬ Encoder Diversity (iter 32190):
  Avg similarity: 0.0333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 49/100] [Batch 88/669 (13.2%)] [Iter 32200] Loss: 1.1408 (freq: 0.4419, raw: 0.6979, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[319,653,330,614,579,178,191,13,723,49,864,752,1006,539,118]


π”¬ Encoder Diversity (iter 32200):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 49/100] [Batch 98/669 (14.6%)] [Iter 32210] Loss: 1.2734 (freq: 0.4534, raw: 0.8189, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[745,0,72,936,678,630,748,319,178,150,805,49,952,811,140]


π”¬ Encoder Diversity (iter 32210):
  Avg similarity: 0.0664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 49/100] [Batch 108/669 (16.1%)] [Iter 32220] Loss: 1.2126 (freq: 0.4245, raw: 0.7870, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[811,72,134,227,319,952,223,745,49,24,3,890,810,383,0]


π”¬ Encoder Diversity (iter 32220):
  Avg similarity: 0.0283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9773 (0.0=collapsed)
[Epoch 49/100] [Batch 118/669 (17.6%)] [Iter 32230] Loss: 1.3120 (freq: 0.4565, raw: 0.8544, quant: 0.0011, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[614,3,319,579,677,18,723,1006,178,737,330,227,581,196,13]


π”¬ Encoder Diversity (iter 32230):
  Avg similarity: 0.0276 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 49/100] [Batch 128/669 (19.1%)] [Iter 32240] Loss: 1.2344 (freq: 0.4423, raw: 0.7910, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[382,227,614,936,660,330,1017,748,319,3,952,672,89,383,432]


π”¬ Encoder Diversity (iter 32240):
  Avg similarity: 0.0661 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 49/100] [Batch 138/669 (20.6%)] [Iter 32250] Loss: 1.0101 (freq: 0.3505, raw: 0.6586, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 925/1024 (90.3%) Top5:[319,0,227,89,134,748,1017,810,293,1014,597,765,752,532,614]


π”¬ Encoder Diversity (iter 32250):
  Avg similarity: 0.0261 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 49/100] [Batch 148/669 (22.1%)] [Iter 32260] Loss: 1.2325 (freq: 0.4409, raw: 0.7905, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[727,745,532,748,319,721,653,579,383,630,876,982,614,581,382]


π”¬ Encoder Diversity (iter 32260):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 49/100] [Batch 158/669 (23.6%)] [Iter 32270] Loss: 1.0381 (freq: 0.3866, raw: 0.6505, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[0,227,319,150,936,89,24,890,312,711,352,283,952,811,293]


π”¬ Encoder Diversity (iter 32270):
  Avg similarity: 0.0248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9770 (0.0=collapsed)
[Epoch 49/100] [Batch 168/669 (25.1%)] [Iter 32280] Loss: 0.8715 (freq: 0.2685, raw: 0.6020, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[227,711,811,748,3,319,630,805,579,0,890,1014,150,952,819]


π”¬ Encoder Diversity (iter 32280):
  Avg similarity: 0.0476 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 49/100] [Batch 178/669 (26.6%)] [Iter 32290] Loss: 1.0129 (freq: 0.3212, raw: 0.6907, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[0,227,811,89,748,319,711,13,330,630,452,382,355,579,24]


π”¬ Encoder Diversity (iter 32290):
  Avg similarity: 0.0246 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 49/100] [Batch 188/669 (28.1%)] [Iter 32300] Loss: 0.6265 (freq: 0.2016, raw: 0.4240, quant: 0.0009, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[89,811,745,581,13,998,630,936,132,890,178,49,727,748,3]


π”¬ Encoder Diversity (iter 32300):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 49/100] [Batch 198/669 (29.6%)] [Iter 32310] Loss: 1.0809 (freq: 0.3687, raw: 0.7112, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[0,178,936,614,330,813,438,748,952,404,33,971,183,619,72]


π”¬ Encoder Diversity (iter 32310):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 49/100] [Batch 208/669 (31.1%)] [Iter 32320] Loss: 1.1206 (freq: 0.3578, raw: 0.7618, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[178,0,727,811,1014,890,417,227,150,49,630,330,532,89,936]


π”¬ Encoder Diversity (iter 32320):
  Avg similarity: 0.0245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 49/100] [Batch 218/669 (32.6%)] [Iter 32330] Loss: 1.0614 (freq: 0.3562, raw: 0.7041, quant: 0.0010, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[721,72,227,952,811,319,711,885,614,1019,468,748,936,810,587]


π”¬ Encoder Diversity (iter 32330):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 49/100] [Batch 228/669 (34.1%)] [Iter 32340] Loss: 0.9048 (freq: 0.3386, raw: 0.5653, quant: 0.0009, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[936,708,614,532,115,0,579,587,319,383,415,178,49,196,90]


π”¬ Encoder Diversity (iter 32340):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 49/100] [Batch 238/669 (35.6%)] [Iter 32350] Loss: 1.1002 (freq: 0.3798, raw: 0.7194, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[227,178,13,614,672,150,318,575,330,404,721,0,532,544,520]


π”¬ Encoder Diversity (iter 32350):
  Avg similarity: 0.0241 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9776 (0.0=collapsed)
[Epoch 49/100] [Batch 248/669 (37.1%)] [Iter 32360] Loss: 1.0275 (freq: 0.3789, raw: 0.6476, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[227,848,260,501,819,319,92,234,3,179,727,802,598,293,72]


π”¬ Encoder Diversity (iter 32360):
  Avg similarity: 0.0274 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 49/100] [Batch 258/669 (38.6%)] [Iter 32370] Loss: 0.8495 (freq: 0.2823, raw: 0.5662, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 920/1024 (89.8%) Top5:[676,936,0,150,811,1014,24,1019,227,890,579,575,926,711,355]


π”¬ Encoder Diversity (iter 32370):
  Avg similarity: 0.0289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9797 (0.0=collapsed)
[Epoch 49/100] [Batch 268/669 (40.1%)] [Iter 32380] Loss: 1.1909 (freq: 0.4524, raw: 0.7374, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[936,227,0,438,3,811,196,614,427,982,876,72,1014,597,24]


π”¬ Encoder Diversity (iter 32380):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 49/100] [Batch 278/669 (41.6%)] [Iter 32390] Loss: 0.8737 (freq: 0.2761, raw: 0.5966, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[736,355,544,330,558,532,752,745,711,748,676,948,876,178,0]


π”¬ Encoder Diversity (iter 32390):
  Avg similarity: 0.0199 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 49/100] [Batch 288/669 (43.0%)] [Iter 32400] Loss: 1.3359 (freq: 0.4656, raw: 0.8692, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[936,0,727,355,908,442,994,672,989,404,600,919,656,575,532]


π”¬ Encoder Diversity (iter 32400):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 49/100] [Batch 298/669 (44.5%)] [Iter 32410] Loss: 1.0101 (freq: 0.3556, raw: 0.6536, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[532,178,579,819,296,708,430,429,115,415,614,6,318,587,520]


π”¬ Encoder Diversity (iter 32410):
  Avg similarity: 0.0534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 49/100] [Batch 308/669 (46.0%)] [Iter 32420] Loss: 1.2069 (freq: 0.4383, raw: 0.7675, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 919/1024 (89.7%) Top5:[848,293,179,0,3,721,227,810,952,711,150,260,827,72,528]


π”¬ Encoder Diversity (iter 32420):
  Avg similarity: 0.0347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 49/100] [Batch 318/669 (47.5%)] [Iter 32430] Loss: 1.0779 (freq: 0.3611, raw: 0.7158, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[936,0,89,179,227,614,890,805,319,355,721,279,630,811,727]


π”¬ Encoder Diversity (iter 32430):
  Avg similarity: 0.0388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9710 (0.0=collapsed)
[Epoch 49/100] [Batch 328/669 (49.0%)] [Iter 32440] Loss: 0.7715 (freq: 0.2586, raw: 0.5120, quant: 0.0009, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[579,660,614,296,115,383,121,532,813,736,558,16,88,811,179]


π”¬ Encoder Diversity (iter 32440):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 49/100] [Batch 338/669 (50.5%)] [Iter 32450] Loss: 0.9082 (freq: 0.3288, raw: 0.5785, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[115,88,675,936,179,579,412,1019,383,355,544,1006,187,1014,189]


π”¬ Encoder Diversity (iter 32450):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9670 (0.0=collapsed)
[Epoch 49/100] [Batch 348/669 (52.0%)] [Iter 32460] Loss: 1.1930 (freq: 0.4458, raw: 0.7462, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[811,721,0,433,1017,179,745,293,164,457,581,24,150,355,805]


π”¬ Encoder Diversity (iter 32460):
  Avg similarity: 0.0218 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 49/100] [Batch 358/669 (53.5%)] [Iter 32470] Loss: 1.1217 (freq: 0.3749, raw: 0.7459, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[811,318,589,142,24,0,989,355,748,614,250,244,805,468,121]


π”¬ Encoder Diversity (iter 32470):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 49/100] [Batch 368/669 (55.0%)] [Iter 32480] Loss: 1.0263 (freq: 0.3674, raw: 0.6580, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[227,318,811,178,330,890,801,319,179,948,355,579,115,805,630]


π”¬ Encoder Diversity (iter 32480):
  Avg similarity: 0.0347 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 49/100] [Batch 378/669 (56.5%)] [Iter 32490] Loss: 1.1433 (freq: 0.4194, raw: 0.7228, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[811,227,319,822,355,532,89,0,643,890,936,24,819,433,279]


π”¬ Encoder Diversity (iter 32490):
  Avg similarity: 0.0300 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 49/100] [Batch 388/669 (58.0%)] [Iter 32500] Loss: 1.2436 (freq: 0.4315, raw: 0.8110, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[179,711,0,811,319,952,576,727,355,89,150,227,864,890,748]


π”¬ Encoder Diversity (iter 32500):
  Avg similarity: 0.0260 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 49/100] [Batch 398/669 (59.5%)] [Iter 32510] Loss: 0.8854 (freq: 0.2951, raw: 0.5893, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 923/1024 (90.1%) Top5:[721,811,89,956,576,227,150,319,952,378,178,318,948,376,142]


π”¬ Encoder Diversity (iter 32510):
  Avg similarity: 0.0279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 49/100] [Batch 408/669 (61.0%)] [Iter 32520] Loss: 1.0016 (freq: 0.3757, raw: 0.6249, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[643,908,178,989,438,318,88,433,558,250,821,412,931,614,296]


π”¬ Encoder Diversity (iter 32520):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 49/100] [Batch 418/669 (62.5%)] [Iter 32530] Loss: 1.0285 (freq: 0.3490, raw: 0.6785, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[179,24,355,811,576,293,164,614,227,219,711,178,936,931,0]


π”¬ Encoder Diversity (iter 32530):
  Avg similarity: 0.0613 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 49/100] [Batch 428/669 (64.0%)] [Iter 32540] Loss: 0.7653 (freq: 0.2363, raw: 0.5280, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[178,811,0,614,931,438,908,355,558,1019,596,727,864,150,24]


π”¬ Encoder Diversity (iter 32540):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 49/100] [Batch 438/669 (65.5%)] [Iter 32550] Loss: 1.0925 (freq: 0.3890, raw: 0.7025, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[576,952,293,0,805,426,319,936,776,227,589,355,1019,811,253]


π”¬ Encoder Diversity (iter 32550):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 49/100] [Batch 448/669 (67.0%)] [Iter 32560] Loss: 1.3521 (freq: 0.4773, raw: 0.8737, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 913/1024 (89.2%) Top5:[727,0,811,319,179,293,936,589,721,576,534,355,186,72,227]


π”¬ Encoder Diversity (iter 32560):
  Avg similarity: 0.0266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9743 (0.0=collapsed)
[Epoch 49/100] [Batch 458/669 (68.5%)] [Iter 32570] Loss: 0.7522 (freq: 0.2369, raw: 0.5143, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[576,184,989,390,811,61,868,727,319,232,227,89,318,72,355]


π”¬ Encoder Diversity (iter 32570):
  Avg similarity: 0.0206 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 49/100] [Batch 468/669 (70.0%)] [Iter 32580] Loss: 0.8017 (freq: 0.2576, raw: 0.5432, quant: 0.0009, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 900/1024 (87.9%) Top5:[0,973,383,576,989,126,227,931,811,736,1019,179,936,597,187]


π”¬ Encoder Diversity (iter 32580):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 49/100] [Batch 478/669 (71.4%)] [Iter 32590] Loss: 1.0077 (freq: 0.3609, raw: 0.6458, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[178,643,383,908,705,296,596,438,597,319,989,931,805,736,936]


π”¬ Encoder Diversity (iter 32590):
  Avg similarity: 0.0396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9692 (0.0=collapsed)
[Epoch 49/100] [Batch 488/669 (72.9%)] [Iter 32600] Loss: 0.9880 (freq: 0.3431, raw: 0.6439, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[578,908,296,150,178,885,614,412,1019,489,748,184,390,811,0]


π”¬ Encoder Diversity (iter 32600):
  Avg similarity: 0.0327 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 49/100] [Batch 498/669 (74.4%)] [Iter 32610] Loss: 1.1010 (freq: 0.4047, raw: 0.6952, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[811,985,319,908,805,227,355,982,0,150,1017,997,278,956,534]


π”¬ Encoder Diversity (iter 32610):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 49/100] [Batch 508/669 (75.9%)] [Iter 32620] Loss: 1.1065 (freq: 0.3484, raw: 0.7571, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 928/1024 (90.6%) Top5:[576,985,822,939,247,727,227,179,89,0,72,711,1017,1014,150]


π”¬ Encoder Diversity (iter 32620):
  Avg similarity: 0.0361 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 49/100] [Batch 518/669 (77.4%)] [Iter 32630] Loss: 1.1226 (freq: 0.3881, raw: 0.7335, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[811,247,448,931,956,705,1000,318,989,0,150,589,1014,805,184]


π”¬ Encoder Diversity (iter 32630):
  Avg similarity: 0.0353 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 49/100] [Batch 528/669 (78.9%)] [Iter 32640] Loss: 1.0558 (freq: 0.3921, raw: 0.6626, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 911/1024 (89.0%) Top5:[532,936,0,178,596,126,348,705,468,579,448,811,1017,597,897]


π”¬ Encoder Diversity (iter 32640):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 49/100] [Batch 538/669 (80.4%)] [Iter 32650] Loss: 0.7907 (freq: 0.2619, raw: 0.5279, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[589,811,0,805,576,939,727,982,150,985,690,735,319,929,630]


π”¬ Encoder Diversity (iter 32650):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9741 (0.0=collapsed)
[Epoch 49/100] [Batch 548/669 (81.9%)] [Iter 32660] Loss: 0.8503 (freq: 0.2930, raw: 0.5563, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[576,0,597,997,908,931,589,184,989,412,705,819,630,956,448]


π”¬ Encoder Diversity (iter 32660):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 49/100] [Batch 558/669 (83.4%)] [Iter 32670] Loss: 0.9617 (freq: 0.3415, raw: 0.6191, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[811,0,805,630,54,745,589,847,985,319,89,126,1014,390,523]


π”¬ Encoder Diversity (iter 32670):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 49/100] [Batch 568/669 (84.9%)] [Iter 32680] Loss: 0.9697 (freq: 0.3166, raw: 0.6522, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[811,745,1014,727,576,89,908,278,532,589,318,319,868,0,805]


π”¬ Encoder Diversity (iter 32680):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 49/100] [Batch 578/669 (86.4%)] [Iter 32690] Loss: 0.7664 (freq: 0.2544, raw: 0.5109, quant: 0.0011, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[727,589,576,805,247,956,319,811,3,985,897,24,0,150,278]


π”¬ Encoder Diversity (iter 32690):
  Avg similarity: 0.0546 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9700 (0.0=collapsed)
[Epoch 49/100] [Batch 588/669 (87.9%)] [Iter 32700] Loss: 0.9551 (freq: 0.3012, raw: 0.6529, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[811,805,247,150,319,630,253,1014,528,985,576,589,705,939,89]


π”¬ Encoder Diversity (iter 32700):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 49/100] [Batch 598/669 (89.4%)] [Iter 32710] Loss: 0.9858 (freq: 0.3230, raw: 0.6618, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[727,939,805,908,705,208,126,614,811,253,567,956,931,319,6]


π”¬ Encoder Diversity (iter 32710):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9752 (0.0=collapsed)
[Epoch 49/100] [Batch 608/669 (90.9%)] [Iter 32720] Loss: 1.0647 (freq: 0.3543, raw: 0.7093, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[614,390,727,956,985,705,579,908,690,489,924,457,13,0,899]


π”¬ Encoder Diversity (iter 32720):
  Avg similarity: 0.0159 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9788 (0.0=collapsed)
[Epoch 49/100] [Batch 618/669 (92.4%)] [Iter 32730] Loss: 1.0201 (freq: 0.3631, raw: 0.6561, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[705,579,589,727,528,576,184,897,6,1014,714,247,0,448,232]


π”¬ Encoder Diversity (iter 32730):
  Avg similarity: 0.0332 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9759 (0.0=collapsed)
[Epoch 49/100] [Batch 628/669 (93.9%)] [Iter 32740] Loss: 0.8694 (freq: 0.2854, raw: 0.5831, quant: 0.0010, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[705,178,802,579,908,897,931,597,296,318,448,184,614,126,79]


π”¬ Encoder Diversity (iter 32740):
  Avg similarity: 0.0303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 49/100] [Batch 638/669 (95.4%)] [Iter 32750] Loss: 0.9618 (freq: 0.3192, raw: 0.6416, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[576,0,3,614,908,247,253,630,956,597,690,278,705,558,178]


π”¬ Encoder Diversity (iter 32750):
  Avg similarity: 0.0424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9735 (0.0=collapsed)
[Epoch 49/100] [Batch 648/669 (96.9%)] [Iter 32760] Loss: 1.0893 (freq: 0.3701, raw: 0.7181, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[897,227,576,727,597,178,908,532,151,939,705,589,680,630,3]


π”¬ Encoder Diversity (iter 32760):
  Avg similarity: 0.0423 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9718 (0.0=collapsed)
[Epoch 49/100] [Batch 658/669 (98.4%)] [Iter 32770] Loss: 1.0139 (freq: 0.3458, raw: 0.6671, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[805,319,1014,247,376,338,985,908,680,576,589,866,727,711,253]


π”¬ Encoder Diversity (iter 32770):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 49/100] [Batch 668/669 (99.9%)] [Iter 32780] Loss: 0.8622 (freq: 0.2715, raw: 0.5897, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[805,597,614,451,208,705,227,908,624,247,576,538,178,79,579]


π”¬ Encoder Diversity (iter 32780):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)

================================================================================
[Epoch 49] Validation Results:
  Total Loss: 0.5479
  Freq Loss:  0.1621
  Raw Loss:   0.3848
  Quant Loss: 0.0009
  π“ Codebook Usage: 483/1024 (47.2%)
  π“ Codebook Entropy: 4.8678 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 24471 (18.8%)
  Top 10 most used codes:
    1. Code 614: 3079 times (2.36%)
    2. Code 296: 2615 times (2.01%)
    3. Code 601: 2525 times (1.94%)
    4. Code 802: 2501 times (1.92%)
    5. Code 736: 2493 times (1.91%)
    6. Code 178: 2352 times (1.81%)
    7. Code 456: 2345 times (1.80%)
    8. Code 448: 2252 times (1.73%)
    9. Code 597: 2175 times (1.67%)
    10. Code 451: 2134 times (1.64%)
  Bottom 5 least used codes (among used):
    1. Code 951: 1 times (0.00%)
    2. Code 634: 1 times (0.00%)
    3. Code 428: 1 times (0.00%)
    4. Code 155: 2 times (0.00%)
    5. Code 95: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 8/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 50/100] [Batch 9/669 (1.3%)] [Iter 32790] Loss: 1.1644 (freq: 0.3941, raw: 0.7691, quant: 0.0012, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[278,178,601,705,318,24,184,597,448,567,353,286,847,579,293]


π”¬ Encoder Diversity (iter 32790):
  Avg similarity: 0.0231 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 50/100] [Batch 19/669 (2.8%)] [Iter 32800] Loss: 1.0606 (freq: 0.3371, raw: 0.7224, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[94,490,278,421,149,843,671,693,603,142,286,18,178,269,712]


π”¬ Encoder Diversity (iter 32800):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 50/100] [Batch 29/669 (4.3%)] [Iter 32810] Loss: 1.3233 (freq: 0.4508, raw: 0.8714, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[278,421,286,843,490,241,149,196,721,712,693,459,597,150,671]


π”¬ Encoder Diversity (iter 32810):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 50/100] [Batch 39/669 (5.8%)] [Iter 32820] Loss: 1.0925 (freq: 0.3628, raw: 0.7286, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 914/1024 (89.3%) Top5:[421,490,196,178,199,286,1017,711,705,868,184,503,241,187,597]


π”¬ Encoder Diversity (iter 32820):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 50/100] [Batch 49/669 (7.3%)] [Iter 32830] Loss: 1.1871 (freq: 0.3950, raw: 0.7911, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[421,286,199,705,490,91,149,531,601,241,142,269,721,603,187]


π”¬ Encoder Diversity (iter 32830):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9740 (0.0=collapsed)
[Epoch 50/100] [Batch 59/669 (8.8%)] [Iter 32840] Loss: 1.3692 (freq: 0.4971, raw: 0.8711, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 917/1024 (89.6%) Top5:[286,603,279,269,241,94,909,531,153,421,1018,208,868,624,142]


π”¬ Encoder Diversity (iter 32840):
  Avg similarity: 0.0342 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 50/100] [Batch 69/669 (10.3%)] [Iter 32850] Loss: 0.9287 (freq: 0.3225, raw: 0.6052, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 893/1024 (87.2%) Top5:[286,597,149,91,451,705,88,269,908,897,199,178,279,126,421]


π”¬ Encoder Diversity (iter 32850):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 50/100] [Batch 79/669 (11.8%)] [Iter 32860] Loss: 0.9138 (freq: 0.2775, raw: 0.6352, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[149,196,142,199,721,897,596,279,286,337,579,603,490,73,712]


π”¬ Encoder Diversity (iter 32860):
  Avg similarity: 0.0313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 50/100] [Batch 89/669 (13.3%)] [Iter 32870] Loss: 1.2722 (freq: 0.4800, raw: 0.7911, quant: 0.0012, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 922/1024 (90.0%) Top5:[178,897,614,596,579,908,711,705,318,603,597,269,286,532,149]


π”¬ Encoder Diversity (iter 32870):
  Avg similarity: 0.0237 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 50/100] [Batch 99/669 (14.8%)] [Iter 32880] Loss: 1.1433 (freq: 0.4495, raw: 0.6927, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[286,199,278,603,196,490,149,421,543,1017,357,318,705,336,150]


π”¬ Encoder Diversity (iter 32880):
  Avg similarity: 0.0208 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 50/100] [Batch 109/669 (16.3%)] [Iter 32890] Loss: 0.8999 (freq: 0.3205, raw: 0.5784, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[196,802,120,597,705,451,448,691,269,837,149,459,897,721,170]


π”¬ Encoder Diversity (iter 32890):
  Avg similarity: 0.0220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9779 (0.0=collapsed)
[Epoch 50/100] [Batch 119/669 (17.8%)] [Iter 32900] Loss: 1.1334 (freq: 0.4182, raw: 0.7141, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 913/1024 (89.2%) Top5:[490,603,196,421,149,597,245,286,94,142,241,624,557,150,712]


π”¬ Encoder Diversity (iter 32900):
  Avg similarity: 0.0540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 50/100] [Batch 129/669 (19.3%)] [Iter 32910] Loss: 1.1852 (freq: 0.4407, raw: 0.7435, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[286,149,421,196,712,691,241,490,697,843,269,153,399,365,77]


π”¬ Encoder Diversity (iter 32910):
  Avg similarity: 0.0197 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9733 (0.0=collapsed)
[Epoch 50/100] [Batch 139/669 (20.8%)] [Iter 32920] Loss: 1.0219 (freq: 0.3830, raw: 0.6378, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[286,490,256,712,149,532,196,150,199,1018,178,827,614,597,835]


π”¬ Encoder Diversity (iter 32920):
  Avg similarity: 0.0355 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 50/100] [Batch 149/669 (22.3%)] [Iter 32930] Loss: 1.4030 (freq: 0.5350, raw: 0.8669, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[712,278,811,286,421,241,490,603,843,269,827,245,721,697,336]


π”¬ Encoder Diversity (iter 32930):
  Avg similarity: 0.0234 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9745 (0.0=collapsed)
[Epoch 50/100] [Batch 159/669 (23.8%)] [Iter 32940] Loss: 1.0426 (freq: 0.3687, raw: 0.6730, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[597,532,711,705,196,269,579,73,908,178,843,999,490,446,451]


π”¬ Encoder Diversity (iter 32940):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9761 (0.0=collapsed)
[Epoch 50/100] [Batch 169/669 (25.3%)] [Iter 32950] Loss: 0.9851 (freq: 0.3476, raw: 0.6365, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 897/1024 (87.6%) Top5:[196,149,737,199,490,597,286,451,705,579,8,296,603,557,241]


π”¬ Encoder Diversity (iter 32950):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 50/100] [Batch 179/669 (26.8%)] [Iter 32960] Loss: 1.0209 (freq: 0.3507, raw: 0.6692, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[199,149,286,697,153,151,597,196,79,917,954,184,490,1000,931]


π”¬ Encoder Diversity (iter 32960):
  Avg similarity: 0.0166 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9798 (0.0=collapsed)
[Epoch 50/100] [Batch 189/669 (28.3%)] [Iter 32970] Loss: 0.9185 (freq: 0.3018, raw: 0.6157, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[286,490,603,225,149,897,1017,717,578,269,178,931,241,196,365]


π”¬ Encoder Diversity (iter 32970):
  Avg similarity: 0.0460 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9711 (0.0=collapsed)
[Epoch 50/100] [Batch 199/669 (29.7%)] [Iter 32980] Loss: 1.2129 (freq: 0.4266, raw: 0.7852, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[278,279,490,199,286,811,149,421,319,721,711,269,868,446,603]


π”¬ Encoder Diversity (iter 32980):
  Avg similarity: 0.0271 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9716 (0.0=collapsed)
[Epoch 50/100] [Batch 209/669 (31.2%)] [Iter 32990] Loss: 1.0837 (freq: 0.3787, raw: 0.7040, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 902/1024 (88.1%) Top5:[490,802,421,603,973,225,318,717,962,393,448,712,721,279,835]


π”¬ Encoder Diversity (iter 32990):
  Avg similarity: 0.0420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 50/100] [Batch 219/669 (32.7%)] [Iter 33000] Loss: 1.0728 (freq: 0.4201, raw: 0.6517, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 934/1024 (91.2%) Top5:[532,286,490,365,597,711,603,421,643,79,507,931,579,296,802]


π”¬ Encoder Diversity (iter 33000):
  Avg similarity: 0.0227 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9764 (0.0=collapsed)
[Epoch 50/100] [Batch 229/669 (34.2%)] [Iter 33010] Loss: 1.2045 (freq: 0.4180, raw: 0.7854, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[286,603,908,196,490,357,94,897,451,1018,225,929,241,954,96]


π”¬ Encoder Diversity (iter 33010):
  Avg similarity: 0.0243 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9755 (0.0=collapsed)
[Epoch 50/100] [Batch 239/669 (35.7%)] [Iter 33020] Loss: 1.0423 (freq: 0.3765, raw: 0.6648, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[451,603,196,286,711,897,421,543,279,532,149,643,644,211,31]


π”¬ Encoder Diversity (iter 33020):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 50/100] [Batch 249/669 (37.2%)] [Iter 33030] Loss: 0.9146 (freq: 0.3260, raw: 0.5876, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[225,562,711,827,245,278,149,532,286,428,448,578,603,543,196]


π”¬ Encoder Diversity (iter 33030):
  Avg similarity: 0.0220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9760 (0.0=collapsed)
[Epoch 50/100] [Batch 259/669 (38.7%)] [Iter 33040] Loss: 1.2616 (freq: 0.4576, raw: 0.8029, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[286,196,393,603,6,532,279,597,120,94,278,178,431,711,653]


π”¬ Encoder Diversity (iter 33040):
  Avg similarity: 0.0295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 50/100] [Batch 269/669 (40.2%)] [Iter 33050] Loss: 1.1709 (freq: 0.4306, raw: 0.7392, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[149,1007,286,241,278,269,199,603,225,196,790,717,153,256,208]


π”¬ Encoder Diversity (iter 33050):
  Avg similarity: 0.0429 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9632 (0.0=collapsed)
[Epoch 50/100] [Batch 279/669 (41.7%)] [Iter 33060] Loss: 1.0887 (freq: 0.3676, raw: 0.7201, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 935/1024 (91.3%) Top5:[603,149,421,925,532,705,225,843,279,223,208,178,811,269,94]


π”¬ Encoder Diversity (iter 33060):
  Avg similarity: 0.0369 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 50/100] [Batch 289/669 (43.2%)] [Iter 33070] Loss: 1.1222 (freq: 0.4180, raw: 0.7032, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[597,196,908,711,705,178,241,278,223,142,425,931,532,451,495]


π”¬ Encoder Diversity (iter 33070):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 50/100] [Batch 299/669 (44.7%)] [Iter 33080] Loss: 0.8750 (freq: 0.2808, raw: 0.5932, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[196,241,279,286,931,278,149,811,142,135,737,790,6,537,318]


π”¬ Encoder Diversity (iter 33080):
  Avg similarity: 0.0315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 50/100] [Batch 309/669 (46.2%)] [Iter 33090] Loss: 1.0477 (freq: 0.3491, raw: 0.6975, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[286,603,296,446,745,466,597,897,241,484,365,451,931,318,164]


π”¬ Encoder Diversity (iter 33090):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 50/100] [Batch 319/669 (47.7%)] [Iter 33100] Loss: 1.0200 (freq: 0.3298, raw: 0.6891, quant: 0.0010, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 891/1024 (87.0%) Top5:[196,603,597,279,225,451,60,296,286,507,737,466,269,897,256]


π”¬ Encoder Diversity (iter 33100):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9797 (0.0=collapsed)
[Epoch 50/100] [Batch 329/669 (49.2%)] [Iter 33110] Loss: 1.1455 (freq: 0.4326, raw: 0.7118, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[931,296,448,223,164,1007,802,914,532,543,6,357,579,578,833]


π”¬ Encoder Diversity (iter 33110):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9747 (0.0=collapsed)
[Epoch 50/100] [Batch 339/669 (50.7%)] [Iter 33120] Loss: 1.1683 (freq: 0.4080, raw: 0.7592, quant: 0.0011, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[597,196,579,296,225,120,897,931,421,278,269,532,178,280,79]


π”¬ Encoder Diversity (iter 33120):
  Avg similarity: 0.0666 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 50/100] [Batch 349/669 (52.2%)] [Iter 33130] Loss: 0.9348 (freq: 0.3132, raw: 0.6206, quant: 0.0009, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 910/1024 (88.9%) Top5:[811,286,466,279,862,225,149,164,269,973,196,296,579,697,543]


π”¬ Encoder Diversity (iter 33130):
  Avg similarity: 0.0252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 50/100] [Batch 359/669 (53.7%)] [Iter 33140] Loss: 1.2445 (freq: 0.4841, raw: 0.7594, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 919/1024 (89.7%) Top5:[286,196,697,223,827,11,279,811,37,357,225,734,269,421,199]


π”¬ Encoder Diversity (iter 33140):
  Avg similarity: 0.0142 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9798 (0.0=collapsed)
[Epoch 50/100] [Batch 369/669 (55.2%)] [Iter 33150] Loss: 1.0877 (freq: 0.3999, raw: 0.6867, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[811,286,168,365,597,279,225,434,142,199,94,897,603,318,241]


π”¬ Encoder Diversity (iter 33150):
  Avg similarity: 0.0575 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 50/100] [Batch 379/669 (56.7%)] [Iter 33160] Loss: 1.1855 (freq: 0.4013, raw: 0.7833, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[269,946,908,168,120,737,490,135,597,745,448,705,532,1007,279]


π”¬ Encoder Diversity (iter 33160):
  Avg similarity: 0.0188 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9777 (0.0=collapsed)
[Epoch 50/100] [Batch 389/669 (58.1%)] [Iter 33170] Loss: 1.0401 (freq: 0.3539, raw: 0.6852, quant: 0.0009, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 908/1024 (88.7%) Top5:[269,279,286,241,278,225,11,317,811,265,190,126,717,490,745]


π”¬ Encoder Diversity (iter 33170):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 50/100] [Batch 399/669 (59.6%)] [Iter 33180] Loss: 0.9543 (freq: 0.3352, raw: 0.6181, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 928/1024 (90.6%) Top5:[269,135,434,451,31,966,946,286,712,734,11,862,1018,6,357]


π”¬ Encoder Diversity (iter 33180):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 50/100] [Batch 409/669 (61.1%)] [Iter 33190] Loss: 0.8950 (freq: 0.2967, raw: 0.5973, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 952/1024 (93.0%) Top5:[790,269,425,603,196,1014,490,1007,286,164,448,94,717,199,745]


π”¬ Encoder Diversity (iter 33190):
  Avg similarity: 0.0272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9787 (0.0=collapsed)
[Epoch 50/100] [Batch 419/669 (62.6%)] [Iter 33200] Loss: 0.5635 (freq: 0.1653, raw: 0.3972, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 926/1024 (90.4%) Top5:[434,490,734,745,448,603,597,279,269,1000,721,286,1014,601,265]


π”¬ Encoder Diversity (iter 33200):
  Avg similarity: 0.0285 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 50/100] [Batch 429/669 (64.1%)] [Iter 33210] Loss: 1.1165 (freq: 0.4080, raw: 0.7075, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[241,721,286,597,745,982,60,846,562,319,466,1000,606,434,929]


π”¬ Encoder Diversity (iter 33210):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 50/100] [Batch 439/669 (65.6%)] [Iter 33220] Loss: 0.8273 (freq: 0.2523, raw: 0.5741, quant: 0.0009, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[931,286,603,597,278,843,11,973,434,908,296,532,946,543,241]


π”¬ Encoder Diversity (iter 33220):
  Avg similarity: 0.0194 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9798 (0.0=collapsed)
[Epoch 50/100] [Batch 449/669 (67.1%)] [Iter 33230] Loss: 1.1229 (freq: 0.4064, raw: 0.7155, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[278,636,319,811,31,734,241,644,914,519,800,286,357,973,833]


π”¬ Encoder Diversity (iter 33230):
  Avg similarity: 0.0295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9739 (0.0=collapsed)
[Epoch 50/100] [Batch 459/669 (68.6%)] [Iter 33240] Loss: 1.0311 (freq: 0.3446, raw: 0.6855, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[225,811,269,286,317,434,697,931,164,31,953,393,490,790,318]


π”¬ Encoder Diversity (iter 33240):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 50/100] [Batch 469/669 (70.1%)] [Iter 33250] Loss: 1.1337 (freq: 0.4346, raw: 0.6981, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[269,434,278,1007,79,811,286,241,71,196,458,843,603,532,745]


π”¬ Encoder Diversity (iter 33250):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 50/100] [Batch 479/669 (71.6%)] [Iter 33260] Loss: 0.9633 (freq: 0.3305, raw: 0.6318, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[532,929,269,597,319,265,196,37,606,908,931,178,636,434,286]


π”¬ Encoder Diversity (iter 33260):
  Avg similarity: 0.0376 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9728 (0.0=collapsed)
[Epoch 50/100] [Batch 489/669 (73.1%)] [Iter 33270] Loss: 0.9553 (freq: 0.3238, raw: 0.6305, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[269,603,94,286,606,47,280,811,225,317,800,278,451,695,79]


π”¬ Encoder Diversity (iter 33270):
  Avg similarity: 0.0292 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 50/100] [Batch 499/669 (74.6%)] [Iter 33280] Loss: 0.9185 (freq: 0.3050, raw: 0.6125, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 886/1024 (86.5%) Top5:[269,811,225,606,286,1018,279,783,597,697,196,79,734,278,241]


π”¬ Encoder Diversity (iter 33280):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9754 (0.0=collapsed)
[Epoch 50/100] [Batch 509/669 (76.1%)] [Iter 33290] Loss: 1.0118 (freq: 0.3532, raw: 0.6576, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[225,135,286,597,269,451,490,734,745,318,636,299,697,458,82]


π”¬ Encoder Diversity (iter 33290):
  Avg similarity: 0.0439 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9768 (0.0=collapsed)
[Epoch 50/100] [Batch 519/669 (77.6%)] [Iter 33300] Loss: 1.0505 (freq: 0.3470, raw: 0.7024, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[225,490,269,286,278,357,873,31,811,340,337,241,717,135,636]


π”¬ Encoder Diversity (iter 33300):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 50/100] [Batch 529/669 (79.1%)] [Iter 33310] Loss: 1.0870 (freq: 0.3722, raw: 0.7138, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[790,357,490,269,953,225,925,597,37,241,31,717,178,417,265]


π”¬ Encoder Diversity (iter 33310):
  Avg similarity: 0.0336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9729 (0.0=collapsed)
[Epoch 50/100] [Batch 539/669 (80.6%)] [Iter 33320] Loss: 1.1175 (freq: 0.3986, raw: 0.7179, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 864/1024 (84.4%) Top5:[269,887,532,318,40,434,603,908,843,279,241,490,337,543,519]


π”¬ Encoder Diversity (iter 33320):
  Avg similarity: 0.0270 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 50/100] [Batch 549/669 (82.1%)] [Iter 33330] Loss: 1.3017 (freq: 0.4681, raw: 0.8325, quant: 0.0011, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[811,269,286,11,279,265,929,717,537,199,178,887,780,697,597]


π”¬ Encoder Diversity (iter 33330):
  Avg similarity: 0.0329 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 50/100] [Batch 559/669 (83.6%)] [Iter 33340] Loss: 0.9491 (freq: 0.3448, raw: 0.6034, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[269,225,811,241,929,603,196,160,199,178,490,1001,833,800,564]


π”¬ Encoder Diversity (iter 33340):
  Avg similarity: 0.0247 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9770 (0.0=collapsed)
[Epoch 50/100] [Batch 569/669 (85.1%)] [Iter 33350] Loss: 0.9295 (freq: 0.2943, raw: 0.6342, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[269,286,811,1007,451,225,164,190,142,241,403,914,490,900,695]


π”¬ Encoder Diversity (iter 33350):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 50/100] [Batch 579/669 (86.5%)] [Iter 33360] Loss: 1.1557 (freq: 0.4245, raw: 0.7302, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[269,223,417,403,142,811,82,1014,278,925,721,199,1007,164,597]


π”¬ Encoder Diversity (iter 33360):
  Avg similarity: 0.0379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 50/100] [Batch 589/669 (88.0%)] [Iter 33370] Loss: 0.7619 (freq: 0.2605, raw: 0.5004, quant: 0.0009, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[451,532,434,199,458,603,925,745,318,721,1000,811,908,241,196]


π”¬ Encoder Diversity (iter 33370):
  Avg similarity: 0.0559 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 50/100] [Batch 599/669 (89.5%)] [Iter 33380] Loss: 0.9734 (freq: 0.3249, raw: 0.6474, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 892/1024 (87.1%) Top5:[225,603,269,31,811,286,520,597,577,490,666,497,1007,223,278]


π”¬ Encoder Diversity (iter 33380):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 50/100] [Batch 609/669 (91.0%)] [Iter 33390] Loss: 1.2502 (freq: 0.4432, raw: 0.8059, quant: 0.0011, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 878/1024 (85.7%) Top5:[811,490,697,269,458,914,578,1003,451,199,695,532,929,543,337]


π”¬ Encoder Diversity (iter 33390):
  Avg similarity: 0.0272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9726 (0.0=collapsed)
[Epoch 50/100] [Batch 619/669 (92.5%)] [Iter 33400] Loss: 1.0203 (freq: 0.3538, raw: 0.6654, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[241,490,811,697,867,721,278,603,434,270,256,199,225,863,269]


π”¬ Encoder Diversity (iter 33400):
  Avg similarity: 0.0482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 50/100] [Batch 629/669 (94.0%)] [Iter 33410] Loss: 1.1638 (freq: 0.4372, raw: 0.7255, quant: 0.0011, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 862/1024 (84.2%) Top5:[225,269,241,603,811,178,532,31,490,79,897,357,1000,717,697]


π”¬ Encoder Diversity (iter 33410):
  Avg similarity: 0.0234 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 50/100] [Batch 639/669 (95.5%)] [Iter 33420] Loss: 0.8923 (freq: 0.2722, raw: 0.6191, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[931,269,178,225,241,434,833,897,265,519,597,532,1001,160,490]


π”¬ Encoder Diversity (iter 33420):
  Avg similarity: 0.0257 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9737 (0.0=collapsed)
[Epoch 50/100] [Batch 649/669 (97.0%)] [Iter 33430] Loss: 0.9392 (freq: 0.3347, raw: 0.6035, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[597,178,225,458,897,265,278,745,434,1000,603,160,1001,269,811]


π”¬ Encoder Diversity (iter 33430):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9722 (0.0=collapsed)
[Epoch 50/100] [Batch 659/669 (98.5%)] [Iter 33440] Loss: 1.2481 (freq: 0.4359, raw: 0.8111, quant: 0.0011, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 907/1024 (88.6%) Top5:[269,603,225,490,811,606,82,520,543,790,278,213,897,178,94]


π”¬ Encoder Diversity (iter 33440):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 50/100] [Batch 669/669 (100.0%)] [Iter 33450] Loss: 0.9959 (freq: 0.3519, raw: 0.6429, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[434,269,721,79,54,931,929,811,610,790,451,3,178,543,914]


================================================================================
[Epoch 50] Validation Results:
  Total Loss: 0.5445
  Freq Loss:  0.1653
  Raw Loss:   0.3784
  Quant Loss: 0.0009
  π“ Codebook Usage: 553/1024 (54.0%)
  π“ Codebook Entropy: 4.9588 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 23683 (18.2%)
  Top 10 most used codes:
    1. Code 3: 2920 times (2.24%)
    2. Code 60: 2654 times (2.04%)
    3. Code 86: 2412 times (1.85%)
    4. Code 610: 2365 times (1.82%)
    5. Code 519: 2269 times (1.74%)
    6. Code 597: 2256 times (1.73%)
    7. Code 221: 2239 times (1.72%)
    8. Code 213: 2202 times (1.69%)
    9. Code 686: 2195 times (1.69%)
    10. Code 248: 2171 times (1.67%)
  Bottom 5 least used codes (among used):
    1. Code 590: 1 times (0.00%)
    2. Code 566: 1 times (0.00%)
    3. Code 844: 1 times (0.00%)
    4. Code 864: 1 times (0.00%)
    5. Code 20: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 9/10
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 49 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 33450):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 51/100] [Batch 10/669 (1.5%)] [Iter 33460] Loss: 1.1728 (freq: 0.4174, raw: 0.7542, quant: 0.0011, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 1024/1024 (100.0%) Top5:[451,434,178,721,717,897,929,610,685,512,564,532,931,633,543]


π”¬ Encoder Diversity (iter 33460):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9771 (0.0=collapsed)
[Epoch 51/100] [Batch 20/669 (3.0%)] [Iter 33470] Loss: 1.0537 (freq: 0.3942, raw: 0.6585, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 925/1024 (90.3%) Top5:[434,211,365,638,745,54,695,914,577,178,64,113,929,812,143]


π”¬ Encoder Diversity (iter 33470):
  Avg similarity: 0.0232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9775 (0.0=collapsed)
[Epoch 51/100] [Batch 30/669 (4.5%)] [Iter 33480] Loss: 0.9728 (freq: 0.3401, raw: 0.6316, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[214,64,819,135,749,434,318,777,908,661,72,745,633,914,451]


π”¬ Encoder Diversity (iter 33480):
  Avg similarity: 0.0378 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9712 (0.0=collapsed)
[Epoch 51/100] [Batch 40/669 (6.0%)] [Iter 33490] Loss: 1.0183 (freq: 0.3565, raw: 0.6608, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[463,633,135,371,908,214,721,1016,423,69,638,113,926,434,99]


π”¬ Encoder Diversity (iter 33490):
  Avg similarity: 0.0197 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9784 (0.0=collapsed)
[Epoch 51/100] [Batch 50/669 (7.5%)] [Iter 33500] Loss: 1.0622 (freq: 0.3373, raw: 0.7239, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[749,633,214,211,64,135,616,57,434,142,379,305,661,747,178]


π”¬ Encoder Diversity (iter 33500):
  Avg similarity: 0.0428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9734 (0.0=collapsed)
[Epoch 51/100] [Batch 60/669 (9.0%)] [Iter 33510] Loss: 1.0147 (freq: 0.3816, raw: 0.6321, quant: 0.0010, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[72,800,142,897,434,135,214,160,184,638,299,633,65,211,64]


π”¬ Encoder Diversity (iter 33510):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9720 (0.0=collapsed)
[Epoch 51/100] [Batch 70/669 (10.5%)] [Iter 33520] Loss: 0.7324 (freq: 0.2329, raw: 0.4986, quant: 0.0009, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 894/1024 (87.3%) Top5:[178,747,64,214,57,135,633,616,931,265,434,211,749,638,305]


π”¬ Encoder Diversity (iter 33520):
  Avg similarity: 0.0272 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 51/100] [Batch 80/669 (12.0%)] [Iter 33530] Loss: 1.1627 (freq: 0.4465, raw: 0.7152, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[565,434,135,64,747,214,305,749,616,319,425,597,184,57,49]


π”¬ Encoder Diversity (iter 33530):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9704 (0.0=collapsed)
[Epoch 51/100] [Batch 90/669 (13.5%)] [Iter 33540] Loss: 0.8423 (freq: 0.3148, raw: 0.5265, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[451,434,135,931,749,610,800,221,833,299,425,288,745,178,113]


π”¬ Encoder Diversity (iter 33540):
  Avg similarity: 0.0416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9727 (0.0=collapsed)
[Epoch 51/100] [Batch 100/669 (14.9%)] [Iter 33550] Loss: 0.9733 (freq: 0.3292, raw: 0.6432, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[635,135,214,1016,379,88,444,633,252,72,427,242,565,841,582]


π”¬ Encoder Diversity (iter 33550):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 51/100] [Batch 110/669 (16.4%)] [Iter 33560] Loss: 0.5055 (freq: 0.1373, raw: 0.3672, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[745,451,79,931,242,929,434,597,425,810,458,610,812,577,214]


π”¬ Encoder Diversity (iter 33560):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9742 (0.0=collapsed)
[Epoch 51/100] [Batch 120/669 (17.9%)] [Iter 33570] Loss: 0.9705 (freq: 0.3356, raw: 0.6339, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[931,749,887,597,434,214,451,777,577,721,929,113,985,897,610]


π”¬ Encoder Diversity (iter 33570):
  Avg similarity: 0.0226 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 51/100] [Batch 130/669 (19.4%)] [Iter 33580] Loss: 1.0909 (freq: 0.3853, raw: 0.7046, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 866/1024 (84.6%) Top5:[214,135,54,747,638,749,87,931,801,800,929,444,314,458,305]


π”¬ Encoder Diversity (iter 33580):
  Avg similarity: 0.0287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9768 (0.0=collapsed)
[Epoch 51/100] [Batch 140/669 (20.9%)] [Iter 33590] Loss: 1.0364 (freq: 0.3962, raw: 0.6392, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[434,12,265,742,721,745,800,801,288,810,214,929,761,319,135]


π”¬ Encoder Diversity (iter 33590):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9757 (0.0=collapsed)
[Epoch 51/100] [Batch 150/669 (22.4%)] [Iter 33600] Loss: 1.4113 (freq: 0.5471, raw: 0.8631, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[1016,460,214,401,64,379,747,749,211,57,29,444,616,633,319]


π”¬ Encoder Diversity (iter 33600):
  Avg similarity: 0.0454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 51/100] [Batch 160/669 (23.9%)] [Iter 33610] Loss: 1.2248 (freq: 0.4415, raw: 0.7823, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[749,897,135,460,319,168,214,72,64,463,305,57,747,242,800]


π”¬ Encoder Diversity (iter 33610):
  Avg similarity: 0.0264 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 51/100] [Batch 170/669 (25.4%)] [Iter 33620] Loss: 1.0625 (freq: 0.3557, raw: 0.7058, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[747,305,749,491,64,711,214,369,302,136,460,72,975,310,89]


π”¬ Encoder Diversity (iter 33620):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9762 (0.0=collapsed)
[Epoch 51/100] [Batch 180/669 (26.9%)] [Iter 33630] Loss: 0.9279 (freq: 0.3167, raw: 0.6103, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 874/1024 (85.4%) Top5:[135,72,305,577,99,64,401,29,749,60,319,214,379,491,434]


π”¬ Encoder Diversity (iter 33630):
  Avg similarity: 0.0436 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 51/100] [Batch 190/669 (28.4%)] [Iter 33640] Loss: 1.0286 (freq: 0.3627, raw: 0.6649, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[749,747,135,305,801,434,64,507,451,72,742,482,800,87,1003]


π”¬ Encoder Diversity (iter 33640):
  Avg similarity: 0.0291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 51/100] [Batch 200/669 (29.9%)] [Iter 33650] Loss: 0.9070 (freq: 0.3046, raw: 0.6014, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 851/1024 (83.1%) Top5:[749,135,72,305,64,777,1016,577,242,168,393,74,711,491,214]


π”¬ Encoder Diversity (iter 33650):
  Avg similarity: 0.0308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9736 (0.0=collapsed)
[Epoch 51/100] [Batch 210/669 (31.4%)] [Iter 33660] Loss: 1.2305 (freq: 0.4263, raw: 0.8032, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[319,749,64,135,57,143,460,142,463,633,29,711,638,429,871]


π”¬ Encoder Diversity (iter 33660):
  Avg similarity: 0.0337 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 51/100] [Batch 220/669 (32.9%)] [Iter 33670] Loss: 1.1377 (freq: 0.4203, raw: 0.7165, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[135,800,803,214,638,451,142,265,319,434,242,160,425,401,38]


π”¬ Encoder Diversity (iter 33670):
  Avg similarity: 0.0281 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9807 (0.0=collapsed)
[Epoch 51/100] [Batch 230/669 (34.4%)] [Iter 33680] Loss: 0.9490 (freq: 0.3032, raw: 0.6448, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 916/1024 (89.5%) Top5:[214,64,749,460,319,136,897,610,463,966,135,305,768,259,19]


π”¬ Encoder Diversity (iter 33680):
  Avg similarity: 0.0261 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9750 (0.0=collapsed)
[Epoch 51/100] [Batch 240/669 (35.9%)] [Iter 33690] Loss: 0.9478 (freq: 0.3020, raw: 0.6449, quant: 0.0009, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[749,319,135,801,214,451,87,12,19,800,458,310,926,916,72]


π”¬ Encoder Diversity (iter 33690):
  Avg similarity: 0.0294 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 51/100] [Batch 250/669 (37.4%)] [Iter 33700] Loss: 0.7974 (freq: 0.2593, raw: 0.5371, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[926,143,929,242,800,319,801,72,749,434,135,460,966,178,89]


π”¬ Encoder Diversity (iter 33700):
  Avg similarity: 0.0340 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 51/100] [Batch 260/669 (38.9%)] [Iter 33710] Loss: 1.1139 (freq: 0.3881, raw: 0.7247, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[749,135,444,64,491,214,966,319,1001,803,800,425,768,565,369]


π”¬ Encoder Diversity (iter 33710):
  Avg similarity: 0.0427 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 51/100] [Batch 270/669 (40.4%)] [Iter 33720] Loss: 0.8781 (freq: 0.3095, raw: 0.5677, quant: 0.0009, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[800,628,374,416,644,178,368,288,801,916,564,451,427,299,12]


π”¬ Encoder Diversity (iter 33720):
  Avg similarity: 0.0725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 51/100] [Batch 280/669 (41.9%)] [Iter 33730] Loss: 1.0800 (freq: 0.3695, raw: 0.7094, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 872/1024 (85.2%) Top5:[214,966,990,749,64,565,610,444,635,368,89,426,369,310,57]


π”¬ Encoder Diversity (iter 33730):
  Avg similarity: 0.0395 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 51/100] [Batch 290/669 (43.3%)] [Iter 33740] Loss: 1.1152 (freq: 0.3645, raw: 0.7497, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[242,168,711,369,135,434,749,975,541,801,214,800,747,745,19]


π”¬ Encoder Diversity (iter 33740):
  Avg similarity: 0.0309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 51/100] [Batch 300/669 (44.8%)] [Iter 33750] Loss: 0.8227 (freq: 0.2671, raw: 0.5546, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[801,434,299,1001,926,800,125,990,135,507,458,286,745,749,60]


π”¬ Encoder Diversity (iter 33750):
  Avg similarity: 0.0405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 51/100] [Batch 310/669 (46.3%)] [Iter 33760] Loss: 1.0423 (freq: 0.3892, raw: 0.6520, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[214,749,136,451,72,69,616,64,146,1016,135,369,1001,57,319]


π”¬ Encoder Diversity (iter 33760):
  Avg similarity: 0.0326 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9751 (0.0=collapsed)
[Epoch 51/100] [Batch 320/669 (47.8%)] [Iter 33770] Loss: 0.9004 (freq: 0.3328, raw: 0.5666, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 940/1024 (91.8%) Top5:[87,926,800,12,299,451,972,427,929,72,801,214,833,793,242]


π”¬ Encoder Diversity (iter 33770):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 51/100] [Batch 330/669 (49.3%)] [Iter 33780] Loss: 0.8434 (freq: 0.2786, raw: 0.5639, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 929/1024 (90.7%) Top5:[214,747,64,849,966,302,72,616,143,310,460,11,319,451,142]


π”¬ Encoder Diversity (iter 33780):
  Avg similarity: 0.0299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9763 (0.0=collapsed)
[Epoch 51/100] [Batch 340/669 (50.8%)] [Iter 33790] Loss: 0.8717 (freq: 0.2899, raw: 0.5807, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[135,747,638,214,859,507,749,616,168,491,125,72,305,401,451]


π”¬ Encoder Diversity (iter 33790):
  Avg similarity: 0.0182 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9805 (0.0=collapsed)
[Epoch 51/100] [Batch 350/669 (52.3%)] [Iter 33800] Loss: 0.9455 (freq: 0.3285, raw: 0.6160, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[64,135,214,966,616,451,491,926,473,747,972,801,638,633,379]


π”¬ Encoder Diversity (iter 33800):
  Avg similarity: 0.0290 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9782 (0.0=collapsed)
[Epoch 51/100] [Batch 360/669 (53.8%)] [Iter 33810] Loss: 1.2007 (freq: 0.4202, raw: 0.7795, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[135,800,72,633,214,616,747,305,972,57,527,580,801,460,64]


π”¬ Encoder Diversity (iter 33810):
  Avg similarity: 0.0387 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 51/100] [Batch 370/669 (55.3%)] [Iter 33820] Loss: 1.2048 (freq: 0.4320, raw: 0.7717, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 927/1024 (90.5%) Top5:[214,859,143,142,633,972,690,638,430,747,168,64,369,310,463]


π”¬ Encoder Diversity (iter 33820):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 51/100] [Batch 380/669 (56.8%)] [Iter 33830] Loss: 0.9576 (freq: 0.3256, raw: 0.6310, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[801,451,11,747,12,800,833,299,966,897,214,213,1001,726,425]


π”¬ Encoder Diversity (iter 33830):
  Avg similarity: 0.0371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9713 (0.0=collapsed)
[Epoch 51/100] [Batch 390/669 (58.3%)] [Iter 33840] Loss: 0.8670 (freq: 0.3028, raw: 0.5633, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 880/1024 (85.9%) Top5:[64,747,214,72,168,135,451,801,633,833,136,616,460,638,12]


π”¬ Encoder Diversity (iter 33840):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9731 (0.0=collapsed)
[Epoch 51/100] [Batch 400/669 (59.8%)] [Iter 33850] Loss: 0.9562 (freq: 0.3084, raw: 0.6468, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 906/1024 (88.5%) Top5:[214,64,463,135,616,972,460,778,800,11,491,168,136,633,57]


π”¬ Encoder Diversity (iter 33850):
  Avg similarity: 0.0530 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 51/100] [Batch 410/669 (61.3%)] [Iter 33860] Loss: 1.2665 (freq: 0.4680, raw: 0.7974, quant: 0.0011, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 849/1024 (82.9%) Top5:[747,451,800,214,57,616,135,711,305,11,260,136,966,610,69]


π”¬ Encoder Diversity (iter 33860):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 51/100] [Batch 420/669 (62.8%)] [Iter 33870] Loss: 1.0260 (freq: 0.3562, raw: 0.6688, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 887/1024 (86.6%) Top5:[616,214,11,778,136,135,926,168,79,897,972,747,487,633,31]


π”¬ Encoder Diversity (iter 33870):
  Avg similarity: 0.0255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 51/100] [Batch 430/669 (64.3%)] [Iter 33880] Loss: 0.9994 (freq: 0.3311, raw: 0.6673, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 903/1024 (88.2%) Top5:[305,460,616,135,136,319,633,747,1001,800,972,143,29,638,398]


π”¬ Encoder Diversity (iter 33880):
  Avg similarity: 0.0330 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 51/100] [Batch 440/669 (65.8%)] [Iter 33890] Loss: 1.2341 (freq: 0.4553, raw: 0.7777, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[135,616,454,168,959,214,747,793,64,398,789,319,358,79,433]


π”¬ Encoder Diversity (iter 33890):
  Avg similarity: 0.0453 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9691 (0.0=collapsed)
[Epoch 51/100] [Batch 450/669 (67.3%)] [Iter 33900] Loss: 0.9869 (freq: 0.3502, raw: 0.6357, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[135,72,1001,616,398,801,800,214,168,11,432,650,64,426,213]


π”¬ Encoder Diversity (iter 33900):
  Avg similarity: 0.0312 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9723 (0.0=collapsed)
[Epoch 51/100] [Batch 460/669 (68.8%)] [Iter 33910] Loss: 0.7247 (freq: 0.2385, raw: 0.4852, quant: 0.0010, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[135,747,507,214,711,451,616,328,726,64,633,57,610,11,959]


π”¬ Encoder Diversity (iter 33910):
  Avg similarity: 0.0278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9756 (0.0=collapsed)
[Epoch 51/100] [Batch 470/669 (70.3%)] [Iter 33920] Loss: 1.0292 (freq: 0.3477, raw: 0.6806, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 873/1024 (85.3%) Top5:[507,800,214,747,616,650,711,168,451,79,768,891,64,789,57]


π”¬ Encoder Diversity (iter 33920):
  Avg similarity: 0.0499 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 51/100] [Batch 480/669 (71.7%)] [Iter 33930] Loss: 1.0025 (freq: 0.3442, raw: 0.6572, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[451,800,768,833,146,610,650,715,135,64,299,633,810,95,72]


π”¬ Encoder Diversity (iter 33930):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 51/100] [Batch 490/669 (73.2%)] [Iter 33940] Loss: 1.2163 (freq: 0.4202, raw: 0.7951, quant: 0.0011, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[214,64,168,747,136,213,650,616,335,451,135,473,310,493,57]


π”¬ Encoder Diversity (iter 33940):
  Avg similarity: 0.0231 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 51/100] [Batch 500/669 (74.7%)] [Iter 33950] Loss: 1.0918 (freq: 0.3696, raw: 0.7212, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[135,451,64,168,57,800,959,610,299,778,747,213,136,356,257]


π”¬ Encoder Diversity (iter 33950):
  Avg similarity: 0.0316 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9749 (0.0=collapsed)
[Epoch 51/100] [Batch 510/669 (76.2%)] [Iter 33960] Loss: 1.1776 (freq: 0.4620, raw: 0.7145, quant: 0.0011, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[214,135,64,616,747,168,57,959,213,633,310,29,257,163,374]


π”¬ Encoder Diversity (iter 33960):
  Avg similarity: 0.0177 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9767 (0.0=collapsed)
[Epoch 51/100] [Batch 520/669 (77.7%)] [Iter 33970] Loss: 0.9866 (freq: 0.3224, raw: 0.6632, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 885/1024 (86.4%) Top5:[214,747,57,168,64,800,491,616,310,358,610,371,778,379,1001]


π”¬ Encoder Diversity (iter 33970):
  Avg similarity: 0.0275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9744 (0.0=collapsed)
[Epoch 51/100] [Batch 530/669 (79.2%)] [Iter 33980] Loss: 0.7869 (freq: 0.2860, raw: 0.5000, quant: 0.0009, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 901/1024 (88.0%) Top5:[204,214,135,64,966,319,857,747,446,1009,829,849,19,356,72]


π”¬ Encoder Diversity (iter 33980):
  Avg similarity: 0.0179 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9806 (0.0=collapsed)
[Epoch 51/100] [Batch 540/669 (80.7%)] [Iter 33990] Loss: 1.0327 (freq: 0.3670, raw: 0.6647, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 905/1024 (88.4%) Top5:[328,524,371,610,135,621,168,427,451,1001,64,676,739,356,89]


π”¬ Encoder Diversity (iter 33990):
  Avg similarity: 0.0264 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 51/100] [Batch 550/669 (82.2%)] [Iter 34000] Loss: 1.1402 (freq: 0.3822, raw: 0.7569, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 904/1024 (88.3%) Top5:[214,135,64,747,257,213,972,358,650,136,72,305,0,959,966]


π”¬ Encoder Diversity (iter 34000):
  Avg similarity: 0.0160 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9805 (0.0=collapsed)
[Epoch 51/100] [Batch 560/669 (83.7%)] [Iter 34010] Loss: 0.9867 (freq: 0.3385, raw: 0.6472, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 935/1024 (91.3%) Top5:[214,135,29,747,64,213,310,755,37,358,633,72,257,57,305]


π”¬ Encoder Diversity (iter 34010):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9746 (0.0=collapsed)
[Epoch 51/100] [Batch 570/669 (85.2%)] [Iter 34020] Loss: 1.0533 (freq: 0.3858, raw: 0.6665, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 930/1024 (90.8%) Top5:[214,747,64,305,257,739,1016,143,168,454,135,859,29,711,451]


π”¬ Encoder Diversity (iter 34020):
  Avg similarity: 0.0216 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9773 (0.0=collapsed)
[Epoch 51/100] [Batch 580/669 (86.7%)] [Iter 34030] Loss: 0.9187 (freq: 0.2874, raw: 0.6303, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[800,64,909,1016,801,747,125,214,168,299,305,213,135,711,328]


π”¬ Encoder Diversity (iter 34030):
  Avg similarity: 0.0378 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9709 (0.0=collapsed)
[Epoch 51/100] [Batch 590/669 (88.2%)] [Iter 34040] Loss: 0.7836 (freq: 0.2429, raw: 0.5397, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 912/1024 (89.1%) Top5:[214,747,64,257,358,491,168,430,310,135,683,463,357,305,29]


π”¬ Encoder Diversity (iter 34040):
  Avg similarity: 0.0294 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9708 (0.0=collapsed)
[Epoch 51/100] [Batch 600/669 (89.7%)] [Iter 34050] Loss: 0.8651 (freq: 0.2670, raw: 0.5971, quant: 0.0009, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[789,435,125,214,1016,739,557,872,11,289,58,95,683,801,80]


π”¬ Encoder Diversity (iter 34050):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9724 (0.0=collapsed)
[Epoch 51/100] [Batch 610/669 (91.2%)] [Iter 34060] Loss: 1.1299 (freq: 0.4214, raw: 0.7075, quant: 0.0011, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 909/1024 (88.8%) Top5:[64,168,29,257,143,491,734,463,136,57,739,214,747,451,69]


π”¬ Encoder Diversity (iter 34060):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9776 (0.0=collapsed)
[Epoch 51/100] [Batch 620/669 (92.7%)] [Iter 34070] Loss: 1.0882 (freq: 0.4148, raw: 0.6724, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 896/1024 (87.5%) Top5:[800,789,451,328,610,497,1016,238,58,739,557,378,734,204,214]


π”¬ Encoder Diversity (iter 34070):
  Avg similarity: 0.0377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9748 (0.0=collapsed)
[Epoch 51/100] [Batch 630/669 (94.2%)] [Iter 34080] Loss: 1.1052 (freq: 0.3954, raw: 0.7088, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 884/1024 (86.3%) Top5:[257,214,543,829,661,734,633,168,143,135,610,29,789,620,310]


π”¬ Encoder Diversity (iter 34080):
  Avg similarity: 0.0414 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9758 (0.0=collapsed)
[Epoch 51/100] [Batch 640/669 (95.7%)] [Iter 34090] Loss: 1.0862 (freq: 0.3815, raw: 0.7036, quant: 0.0011, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[310,168,734,583,829,64,319,214,143,93,680,493,136,57,590]


π”¬ Encoder Diversity (iter 34090):
  Avg similarity: 0.0265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 51/100] [Batch 650/669 (97.2%)] [Iter 34100] Loss: 0.7274 (freq: 0.2307, raw: 0.4958, quant: 0.0009, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 915/1024 (89.4%) Top5:[800,892,257,610,168,557,692,64,778,693,683,358,620,0,11]


π”¬ Encoder Diversity (iter 34100):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 51/100] [Batch 660/669 (98.7%)] [Iter 34110] Loss: 1.0031 (freq: 0.3121, raw: 0.6900, quant: 0.0010, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 898/1024 (87.7%) Top5:[257,734,214,168,80,590,64,93,242,358,747,72,341,379,463]


π”¬ Encoder Diversity (iter 34110):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)

================================================================================
[Epoch 51] Validation Results:
  Total Loss: 0.5703
  Freq Loss:  0.1619
  Raw Loss:   0.4074
  Quant Loss: 0.0010
  π“ Codebook Usage: 615/1024 (60.1%)
  π“ Codebook Entropy: 5.1965 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 26951 (20.7%)
  Top 10 most used codes:
    1. Code 409: 3362 times (2.58%)
    2. Code 435: 3034 times (2.33%)
    3. Code 956: 2756 times (2.12%)
    4. Code 58: 2721 times (2.09%)
    5. Code 238: 2702 times (2.08%)
    6. Code 512: 2679 times (2.06%)
    7. Code 0: 2534 times (1.95%)
    8. Code 425: 2432 times (1.87%)
    9. Code 451: 2401 times (1.84%)
    10. Code 11: 2330 times (1.79%)
  Bottom 5 least used codes (among used):
    1. Code 313: 1 times (0.00%)
    2. Code 160: 1 times (0.00%)
    3. Code 381: 1 times (0.00%)
    4. Code 961: 1 times (0.00%)
    5. Code 466: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 10/10
[EarlyStopping] Stop training at epoch 51
