prepare dataloader...
finished!
Initializing a new model from scratch
{'decoder_out_dim': 200}
Final encoder config NTConfig(block_size=200, patch_size=200, sample_size=40000, num_classes=0, in_chans=1, out_chans=16, use_mean_pooling=True, init_scale=0.001, n_layer=12, n_head=12, n_embd=768, dropout=0.0, bias=False)
Final decoder config NTConfig(block_size=200, patch_size=200, sample_size=40000, num_classes=0, in_chans=128, out_chans=16, use_mean_pooling=True, init_scale=0.001, n_layer=4, n_head=12, n_embd=768, dropout=0.0, bias=False)
num decayed parameter tensors: 100, with 144,821,744 parameters
num non-decayed parameter tensors: 66, with 40,766 parameters
using fused AdamW: True
Set warmup steps = 6690
Performing Kemans init for codebook

π”¬ Encoder Diversity (iter 0):
  Avg similarity: 0.6639 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5760 (0.0=collapsed)
[Epoch 1/100] [Batch 10/669 (1.5%)] [Iter 10] Loss: 2.1498 (freq: 1.0927, raw: 1.0566, quant: 0.0005, domain: 0.0000) LR: 2.69e-08 
π“ Codebook: 1001/1024 (97.8%) Top5:[163,807,722,752,653,574,859,929,147,364,112,17,181,614,560]


π”¬ Encoder Diversity (iter 10):
  Avg similarity: 0.6412 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5854 (0.0=collapsed)
[Epoch 1/100] [Batch 20/669 (3.0%)] [Iter 20] Loss: 2.1777 (freq: 1.1229, raw: 1.0543, quant: 0.0004, domain: 0.0000) LR: 5.68e-08 
π“ Codebook: 479/1024 (46.8%) Top5:[17,163,929,33,807,136,364,614,806,290,147,112,566,752,98]


π”¬ Encoder Diversity (iter 20):
  Avg similarity: 0.6554 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5847 (0.0=collapsed)
[Epoch 1/100] [Batch 30/669 (4.5%)] [Iter 30] Loss: 2.1835 (freq: 1.1302, raw: 1.0529, quant: 0.0004, domain: 0.0000) LR: 8.67e-08 
π“ Codebook: 425/1024 (41.5%) Top5:[163,789,807,136,17,98,566,929,973,614,364,694,186,653,197]


π”¬ Encoder Diversity (iter 30):
  Avg similarity: 0.6733 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5791 (0.0=collapsed)
[Epoch 1/100] [Batch 40/669 (6.0%)] [Iter 40] Loss: 2.1507 (freq: 1.0960, raw: 1.0543, quant: 0.0004, domain: 0.0000) LR: 1.17e-07 
π“ Codebook: 365/1024 (35.6%) Top5:[136,807,163,98,566,33,973,929,197,789,186,653,574,412,722]


π”¬ Encoder Diversity (iter 40):
  Avg similarity: 0.6968 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5419 (0.0=collapsed)
[Epoch 1/100] [Batch 50/669 (7.5%)] [Iter 50] Loss: 2.1685 (freq: 1.1147, raw: 1.0533, quant: 0.0004, domain: 0.0000) LR: 1.47e-07 
π“ Codebook: 375/1024 (36.6%) Top5:[136,807,789,566,163,98,574,477,929,973,653,722,186,614,197]


π”¬ Encoder Diversity (iter 50):
  Avg similarity: 0.6948 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5616 (0.0=collapsed)
[Epoch 1/100] [Batch 60/669 (9.0%)] [Iter 60] Loss: 2.1296 (freq: 1.0765, raw: 1.0527, quant: 0.0004, domain: 0.0000) LR: 1.76e-07 
π“ Codebook: 364/1024 (35.5%) Top5:[136,973,566,98,807,929,17,163,694,722,859,574,789,477,653]


π”¬ Encoder Diversity (iter 60):
  Avg similarity: 0.6736 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5750 (0.0=collapsed)
[Epoch 1/100] [Batch 70/669 (10.5%)] [Iter 70] Loss: 2.1432 (freq: 1.0927, raw: 1.0502, quant: 0.0004, domain: 0.0000) LR: 2.06e-07 
π“ Codebook: 375/1024 (36.6%) Top5:[566,17,136,789,807,973,722,98,906,33,197,477,694,929,614]


π”¬ Encoder Diversity (iter 70):
  Avg similarity: 0.6982 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5502 (0.0=collapsed)
[Epoch 1/100] [Batch 80/669 (12.0%)] [Iter 80] Loss: 2.1584 (freq: 1.1095, raw: 1.0484, quant: 0.0005, domain: 0.0000) LR: 2.36e-07 
π“ Codebook: 378/1024 (36.9%) Top5:[17,566,136,973,412,163,807,574,859,789,290,722,98,929,477]


π”¬ Encoder Diversity (iter 80):
  Avg similarity: 0.6827 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5581 (0.0=collapsed)
[Epoch 1/100] [Batch 90/669 (13.5%)] [Iter 90] Loss: 2.1651 (freq: 1.1184, raw: 1.0462, quant: 0.0005, domain: 0.0000) LR: 2.66e-07 
π“ Codebook: 389/1024 (38.0%) Top5:[789,136,17,566,973,722,694,477,929,98,334,614,807,364,412]


π”¬ Encoder Diversity (iter 90):
  Avg similarity: 0.6610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5738 (0.0=collapsed)
[Epoch 1/100] [Batch 100/669 (14.9%)] [Iter 100] Loss: 2.0987 (freq: 1.0550, raw: 1.0432, quant: 0.0005, domain: 0.0000) LR: 2.96e-07 
π“ Codebook: 359/1024 (35.1%) Top5:[17,136,566,973,789,197,929,98,477,364,807,412,614,574,722]


π”¬ Encoder Diversity (iter 100):
  Avg similarity: 0.6711 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5829 (0.0=collapsed)
[Epoch 1/100] [Batch 110/669 (16.4%)] [Iter 110] Loss: 2.0796 (freq: 1.0342, raw: 1.0449, quant: 0.0004, domain: 0.0000) LR: 3.26e-07 
π“ Codebook: 301/1024 (29.4%) Top5:[17,973,566,136,334,929,807,789,412,614,574,290,722,98,163]


π”¬ Encoder Diversity (iter 110):
  Avg similarity: 0.6753 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5694 (0.0=collapsed)
[Epoch 1/100] [Batch 120/669 (17.9%)] [Iter 120] Loss: 2.1306 (freq: 1.0884, raw: 1.0418, quant: 0.0005, domain: 0.0000) LR: 3.56e-07 
π“ Codebook: 310/1024 (30.3%) Top5:[17,566,973,136,334,197,645,477,181,364,33,929,574,789,722]


π”¬ Encoder Diversity (iter 120):
  Avg similarity: 0.6728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5661 (0.0=collapsed)
[Epoch 1/100] [Batch 130/669 (19.4%)] [Iter 130] Loss: 2.0744 (freq: 1.0328, raw: 1.0412, quant: 0.0004, domain: 0.0000) LR: 3.86e-07 
π“ Codebook: 285/1024 (27.8%) Top5:[17,973,136,645,789,566,334,197,482,722,364,98,412,186,694]


π”¬ Encoder Diversity (iter 130):
  Avg similarity: 0.6979 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5464 (0.0=collapsed)
[Epoch 1/100] [Batch 140/669 (20.9%)] [Iter 140] Loss: 2.0541 (freq: 1.0174, raw: 1.0362, quant: 0.0004, domain: 0.0000) LR: 4.16e-07 
π“ Codebook: 275/1024 (26.9%) Top5:[17,136,645,482,574,157,722,364,973,929,98,614,807,859,845]


π”¬ Encoder Diversity (iter 140):
  Avg similarity: 0.6603 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5758 (0.0=collapsed)
[Epoch 1/100] [Batch 150/669 (22.4%)] [Iter 150] Loss: 2.0361 (freq: 1.0015, raw: 1.0342, quant: 0.0005, domain: 0.0000) LR: 4.46e-07 
π“ Codebook: 250/1024 (24.4%) Top5:[973,17,645,136,789,157,482,181,574,722,364,859,694,807,929]


π”¬ Encoder Diversity (iter 150):
  Avg similarity: 0.6784 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5607 (0.0=collapsed)
[Epoch 1/100] [Batch 160/669 (23.9%)] [Iter 160] Loss: 1.9661 (freq: 0.9310, raw: 1.0347, quant: 0.0005, domain: 0.0000) LR: 4.75e-07 
π“ Codebook: 258/1024 (25.2%) Top5:[17,645,973,136,482,789,722,157,574,334,614,694,181,352,364]


π”¬ Encoder Diversity (iter 160):
  Avg similarity: 0.6710 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5659 (0.0=collapsed)
[Epoch 1/100] [Batch 170/669 (25.4%)] [Iter 170] Loss: 2.0408 (freq: 1.0083, raw: 1.0320, quant: 0.0005, domain: 0.0000) LR: 5.05e-07 
π“ Codebook: 226/1024 (22.1%) Top5:[973,645,789,17,566,181,136,82,334,482,197,917,157,694,352]


π”¬ Encoder Diversity (iter 170):
  Avg similarity: 0.6705 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5765 (0.0=collapsed)
[Epoch 1/100] [Batch 180/669 (26.9%)] [Iter 180] Loss: 2.0510 (freq: 1.0178, raw: 1.0328, quant: 0.0005, domain: 0.0000) LR: 5.35e-07 
π“ Codebook: 198/1024 (19.3%) Top5:[645,973,136,17,482,789,694,722,334,157,614,574,364,181,412]


π”¬ Encoder Diversity (iter 180):
  Avg similarity: 0.7191 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5388 (0.0=collapsed)
[Epoch 1/100] [Batch 190/669 (28.4%)] [Iter 190] Loss: 2.0087 (freq: 0.9760, raw: 1.0323, quant: 0.0004, domain: 0.0000) LR: 5.65e-07 
π“ Codebook: 202/1024 (19.7%) Top5:[973,645,17,136,482,722,197,614,566,789,574,364,157,694,929]


π”¬ Encoder Diversity (iter 190):
  Avg similarity: 0.6892 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5620 (0.0=collapsed)
[Epoch 1/100] [Batch 200/669 (29.9%)] [Iter 200] Loss: 1.9371 (freq: 0.9065, raw: 1.0302, quant: 0.0004, domain: 0.0000) LR: 5.95e-07 
π“ Codebook: 170/1024 (16.6%) Top5:[136,17,694,973,789,614,566,722,482,645,364,412,574,929,334]


π”¬ Encoder Diversity (iter 200):
  Avg similarity: 0.6932 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5521 (0.0=collapsed)
[Epoch 1/100] [Batch 210/669 (31.4%)] [Iter 210] Loss: 1.9801 (freq: 0.9524, raw: 1.0273, quant: 0.0005, domain: 0.0000) LR: 6.25e-07 
π“ Codebook: 174/1024 (17.0%) Top5:[789,17,566,477,973,136,412,197,290,339,352,614,645,544,364]


π”¬ Encoder Diversity (iter 210):
  Avg similarity: 0.7167 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5462 (0.0=collapsed)
[Epoch 1/100] [Batch 220/669 (32.9%)] [Iter 220] Loss: 1.9516 (freq: 0.9233, raw: 1.0278, quant: 0.0004, domain: 0.0000) LR: 6.55e-07 
π“ Codebook: 185/1024 (18.1%) Top5:[789,566,136,17,973,694,722,477,412,482,614,364,163,574,197]


π”¬ Encoder Diversity (iter 220):
  Avg similarity: 0.6722 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5832 (0.0=collapsed)
[Epoch 1/100] [Batch 230/669 (34.4%)] [Iter 230] Loss: 1.9633 (freq: 0.9384, raw: 1.0245, quant: 0.0004, domain: 0.0000) LR: 6.85e-07 
π“ Codebook: 196/1024 (19.1%) Top5:[566,789,412,197,477,973,339,136,290,499,544,906,352,905,33]


π”¬ Encoder Diversity (iter 230):
  Avg similarity: 0.6636 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5662 (0.0=collapsed)
[Epoch 1/100] [Batch 240/669 (35.9%)] [Iter 240] Loss: 1.9573 (freq: 0.9318, raw: 1.0252, quant: 0.0004, domain: 0.0000) LR: 7.15e-07 
π“ Codebook: 159/1024 (15.5%) Top5:[566,17,412,789,136,339,973,477,694,499,290,197,722,614,352]


π”¬ Encoder Diversity (iter 240):
  Avg similarity: 0.7096 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5443 (0.0=collapsed)
[Epoch 1/100] [Batch 250/669 (37.4%)] [Iter 250] Loss: 1.9293 (freq: 0.9076, raw: 1.0213, quant: 0.0004, domain: 0.0000) LR: 7.45e-07 
π“ Codebook: 147/1024 (14.4%) Top5:[566,136,789,973,412,477,722,694,339,807,197,290,17,574,364]


π”¬ Encoder Diversity (iter 250):
  Avg similarity: 0.7172 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5416 (0.0=collapsed)
[Epoch 1/100] [Batch 260/669 (38.9%)] [Iter 260] Loss: 1.9077 (freq: 0.8875, raw: 1.0198, quant: 0.0004, domain: 0.0000) LR: 7.74e-07 
π“ Codebook: 167/1024 (16.3%) Top5:[789,412,566,973,17,136,694,334,339,197,722,290,482,352,906]


π”¬ Encoder Diversity (iter 260):
  Avg similarity: 0.6864 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5598 (0.0=collapsed)
[Epoch 1/100] [Batch 270/669 (40.4%)] [Iter 270] Loss: 1.8712 (freq: 0.8505, raw: 1.0203, quant: 0.0004, domain: 0.0000) LR: 8.04e-07 
π“ Codebook: 142/1024 (13.9%) Top5:[17,566,789,973,136,645,412,340,793,334,157,807,752,364,339]


π”¬ Encoder Diversity (iter 270):
  Avg similarity: 0.6916 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5580 (0.0=collapsed)
[Epoch 1/100] [Batch 280/669 (41.9%)] [Iter 280] Loss: 1.8364 (freq: 0.8186, raw: 1.0175, quant: 0.0003, domain: 0.0000) LR: 8.34e-07 
π“ Codebook: 136/1024 (13.3%) Top5:[17,973,789,482,645,136,566,340,157,334,722,807,186,694,412]


π”¬ Encoder Diversity (iter 280):
  Avg similarity: 0.6991 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5498 (0.0=collapsed)
[Epoch 1/100] [Batch 290/669 (43.3%)] [Iter 290] Loss: 1.9200 (freq: 0.9065, raw: 1.0131, quant: 0.0004, domain: 0.0000) LR: 8.64e-07 
π“ Codebook: 129/1024 (12.6%) Top5:[17,789,973,566,136,340,412,334,645,694,157,482,807,793,614]


π”¬ Encoder Diversity (iter 290):
  Avg similarity: 0.7017 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5490 (0.0=collapsed)
[Epoch 1/100] [Batch 300/669 (44.8%)] [Iter 300] Loss: 1.9763 (freq: 0.9631, raw: 1.0128, quant: 0.0004, domain: 0.0000) LR: 8.94e-07 
π“ Codebook: 153/1024 (14.9%) Top5:[789,566,17,973,412,477,339,334,197,352,906,784,645,136,290]


π”¬ Encoder Diversity (iter 300):
  Avg similarity: 0.6702 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5514 (0.0=collapsed)
[Epoch 1/100] [Batch 310/669 (46.3%)] [Iter 310] Loss: 1.9153 (freq: 0.9010, raw: 1.0139, quant: 0.0004, domain: 0.0000) LR: 9.24e-07 
π“ Codebook: 134/1024 (13.1%) Top5:[789,412,566,197,973,477,339,722,98,290,499,334,906,136,694]


π”¬ Encoder Diversity (iter 310):
  Avg similarity: 0.6901 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5531 (0.0=collapsed)
[Epoch 1/100] [Batch 320/669 (47.8%)] [Iter 320] Loss: 1.8899 (freq: 0.8779, raw: 1.0117, quant: 0.0003, domain: 0.0000) LR: 9.54e-07 
π“ Codebook: 131/1024 (12.8%) Top5:[789,477,973,412,339,566,728,197,499,722,694,906,98,334,290]


π”¬ Encoder Diversity (iter 320):
  Avg similarity: 0.7087 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5461 (0.0=collapsed)
[Epoch 1/100] [Batch 330/669 (49.3%)] [Iter 330] Loss: 2.0004 (freq: 0.9900, raw: 1.0101, quant: 0.0004, domain: 0.0000) LR: 9.84e-07 
π“ Codebook: 97/1024 (9.5%) Top5:[789,566,339,412,477,728,973,197,17,290,334,906,136,619,784]


π”¬ Encoder Diversity (iter 330):
  Avg similarity: 0.6889 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5498 (0.0=collapsed)
[Epoch 1/100] [Batch 340/669 (50.8%)] [Iter 340] Loss: 1.8833 (freq: 0.8734, raw: 1.0095, quant: 0.0003, domain: 0.0000) LR: 1.01e-06 
π“ Codebook: 121/1024 (11.8%) Top5:[789,566,412,17,334,973,136,477,339,784,694,906,722,728,482]


π”¬ Encoder Diversity (iter 340):
  Avg similarity: 0.6925 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5540 (0.0=collapsed)
[Epoch 1/100] [Batch 350/669 (52.3%)] [Iter 350] Loss: 1.9122 (freq: 0.9030, raw: 1.0088, quant: 0.0003, domain: 0.0000) LR: 1.04e-06 
π“ Codebook: 109/1024 (10.6%) Top5:[973,566,17,789,334,645,412,136,482,477,906,499,728,784,339]


π”¬ Encoder Diversity (iter 350):
  Avg similarity: 0.7019 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5422 (0.0=collapsed)
[Epoch 1/100] [Batch 360/669 (53.8%)] [Iter 360] Loss: 1.9535 (freq: 0.9458, raw: 1.0073, quant: 0.0004, domain: 0.0000) LR: 1.07e-06 
π“ Codebook: 117/1024 (11.4%) Top5:[973,17,566,482,645,789,334,694,906,412,186,157,784,807,722]


π”¬ Encoder Diversity (iter 360):
  Avg similarity: 0.6971 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5528 (0.0=collapsed)
[Epoch 1/100] [Batch 370/669 (55.3%)] [Iter 370] Loss: 1.8387 (freq: 0.8314, raw: 1.0070, quant: 0.0003, domain: 0.0000) LR: 1.10e-06 
π“ Codebook: 99/1024 (9.7%) Top5:[17,973,566,645,789,334,482,412,784,136,157,808,906,680,340]


π”¬ Encoder Diversity (iter 370):
  Avg similarity: 0.6749 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5612 (0.0=collapsed)
[Epoch 1/100] [Batch 380/669 (56.8%)] [Iter 380] Loss: 1.9713 (freq: 0.9658, raw: 1.0051, quant: 0.0004, domain: 0.0000) LR: 1.13e-06 
π“ Codebook: 113/1024 (11.0%) Top5:[789,566,973,412,339,784,17,477,290,334,728,694,136,499,906]


π”¬ Encoder Diversity (iter 380):
  Avg similarity: 0.6963 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5481 (0.0=collapsed)
[Epoch 1/100] [Batch 390/669 (58.3%)] [Iter 390] Loss: 1.7329 (freq: 0.7262, raw: 1.0063, quant: 0.0003, domain: 0.0000) LR: 1.16e-06 
π“ Codebook: 95/1024 (9.3%) Top5:[789,339,566,412,98,136,477,728,680,694,334,290,807,364,499]


π”¬ Encoder Diversity (iter 390):
  Avg similarity: 0.7255 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5224 (0.0=collapsed)
[Epoch 1/100] [Batch 400/669 (59.8%)] [Iter 400] Loss: 1.7857 (freq: 0.7786, raw: 1.0068, quant: 0.0003, domain: 0.0000) LR: 1.19e-06 
π“ Codebook: 81/1024 (7.9%) Top5:[789,339,412,973,98,728,477,694,566,136,163,334,499,364,784]


π”¬ Encoder Diversity (iter 400):
  Avg similarity: 0.7501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.4995 (0.0=collapsed)
[Epoch 1/100] [Batch 410/669 (61.3%)] [Iter 410] Loss: 1.9373 (freq: 0.9326, raw: 1.0044, quant: 0.0003, domain: 0.0000) LR: 1.22e-06 
π“ Codebook: 98/1024 (9.6%) Top5:[566,789,973,339,694,412,98,477,136,334,728,859,163,364,784]


π”¬ Encoder Diversity (iter 410):
  Avg similarity: 0.7066 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5402 (0.0=collapsed)
[Epoch 1/100] [Batch 420/669 (62.8%)] [Iter 420] Loss: 1.8176 (freq: 0.8139, raw: 1.0034, quant: 0.0003, domain: 0.0000) LR: 1.25e-06 
π“ Codebook: 114/1024 (11.1%) Top5:[973,566,789,412,339,477,334,784,17,694,136,906,728,808,680]


π”¬ Encoder Diversity (iter 420):
  Avg similarity: 0.7101 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5429 (0.0=collapsed)
[Epoch 1/100] [Batch 430/669 (64.3%)] [Iter 430] Loss: 1.8815 (freq: 0.8781, raw: 1.0030, quant: 0.0003, domain: 0.0000) LR: 1.28e-06 
π“ Codebook: 107/1024 (10.4%) Top5:[973,17,334,566,789,157,412,136,482,906,339,645,340,574,808]


π”¬ Encoder Diversity (iter 430):
  Avg similarity: 0.6994 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5536 (0.0=collapsed)
[Epoch 1/100] [Batch 440/669 (65.8%)] [Iter 440] Loss: 1.7589 (freq: 0.7536, raw: 1.0050, quant: 0.0004, domain: 0.0000) LR: 1.31e-06 
π“ Codebook: 119/1024 (11.6%) Top5:[973,157,334,17,482,340,645,136,793,694,680,98,574,186,722]


π”¬ Encoder Diversity (iter 440):
  Avg similarity: 0.7104 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5477 (0.0=collapsed)
[Epoch 1/100] [Batch 450/669 (67.3%)] [Iter 450] Loss: 1.7003 (freq: 0.6964, raw: 1.0036, quant: 0.0003, domain: 0.0000) LR: 1.34e-06 
π“ Codebook: 114/1024 (11.1%) Top5:[973,566,789,334,412,17,645,339,98,906,477,352,694,136,482]


π”¬ Encoder Diversity (iter 450):
  Avg similarity: 0.7245 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5329 (0.0=collapsed)
[Epoch 1/100] [Batch 460/669 (68.8%)] [Iter 460] Loss: 1.5825 (freq: 0.5787, raw: 1.0035, quant: 0.0003, domain: 0.0000) LR: 1.37e-06 
π“ Codebook: 87/1024 (8.5%) Top5:[566,98,339,789,412,136,973,364,680,163,694,807,722,859,574]


π”¬ Encoder Diversity (iter 460):
  Avg similarity: 0.6918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5456 (0.0=collapsed)
[Epoch 1/100] [Batch 470/669 (70.3%)] [Iter 470] Loss: 1.8653 (freq: 0.8634, raw: 1.0016, quant: 0.0003, domain: 0.0000) LR: 1.40e-06 
π“ Codebook: 90/1024 (8.8%) Top5:[566,339,789,412,136,98,728,859,163,680,807,619,973,477,364]


π”¬ Encoder Diversity (iter 470):
  Avg similarity: 0.6905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5445 (0.0=collapsed)
[Epoch 1/100] [Batch 480/669 (71.7%)] [Iter 480] Loss: 1.8940 (freq: 0.8909, raw: 1.0028, quant: 0.0003, domain: 0.0000) LR: 1.43e-06 
π“ Codebook: 96/1024 (9.4%) Top5:[789,566,339,412,728,973,784,136,619,477,806,98,680,859,694]


π”¬ Encoder Diversity (iter 480):
  Avg similarity: 0.6877 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5580 (0.0=collapsed)
[Epoch 1/100] [Batch 490/669 (73.2%)] [Iter 490] Loss: 1.8520 (freq: 0.8500, raw: 1.0016, quant: 0.0004, domain: 0.0000) LR: 1.46e-06 
π“ Codebook: 92/1024 (9.0%) Top5:[789,973,566,412,694,339,136,98,680,728,807,364,477,784,722]


π”¬ Encoder Diversity (iter 490):
  Avg similarity: 0.7033 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5491 (0.0=collapsed)
[Epoch 1/100] [Batch 500/669 (74.7%)] [Iter 500] Loss: 1.8126 (freq: 0.8090, raw: 1.0033, quant: 0.0003, domain: 0.0000) LR: 1.49e-06 
π“ Codebook: 124/1024 (12.1%) Top5:[973,566,789,412,334,17,482,339,680,477,784,728,157,136,906]


π”¬ Encoder Diversity (iter 500):
  Avg similarity: 0.6936 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5413 (0.0=collapsed)
[Epoch 1/100] [Batch 510/669 (76.2%)] [Iter 510] Loss: 1.7594 (freq: 0.7567, raw: 1.0023, quant: 0.0004, domain: 0.0000) LR: 1.52e-06 
π“ Codebook: 129/1024 (12.6%) Top5:[973,334,789,412,157,566,482,17,694,784,186,906,807,477,340]


π”¬ Encoder Diversity (iter 510):
  Avg similarity: 0.7053 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5380 (0.0=collapsed)
[Epoch 1/100] [Batch 520/669 (77.7%)] [Iter 520] Loss: 1.9862 (freq: 0.9821, raw: 1.0036, quant: 0.0004, domain: 0.0000) LR: 1.55e-06 
π“ Codebook: 150/1024 (14.6%) Top5:[973,334,566,784,412,157,477,482,694,17,789,906,186,339,340]


π”¬ Encoder Diversity (iter 520):
  Avg similarity: 0.6914 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5600 (0.0=collapsed)
[Epoch 1/100] [Batch 530/669 (79.2%)] [Iter 530] Loss: 1.7816 (freq: 0.7795, raw: 1.0019, quant: 0.0003, domain: 0.0000) LR: 1.58e-06 
π“ Codebook: 108/1024 (10.5%) Top5:[973,566,412,334,339,789,694,784,136,157,98,728,807,17,477]


π”¬ Encoder Diversity (iter 530):
  Avg similarity: 0.6721 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5616 (0.0=collapsed)
[Epoch 1/100] [Batch 540/669 (80.7%)] [Iter 540] Loss: 1.7200 (freq: 0.7169, raw: 1.0028, quant: 0.0003, domain: 0.0000) LR: 1.61e-06 
π“ Codebook: 103/1024 (10.1%) Top5:[566,339,973,694,412,789,728,98,722,477,136,807,163,619,499]


π”¬ Encoder Diversity (iter 540):
  Avg similarity: 0.7075 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5636 (0.0=collapsed)
[Epoch 1/100] [Batch 550/669 (82.2%)] [Iter 550] Loss: 1.7791 (freq: 0.7760, raw: 1.0028, quant: 0.0003, domain: 0.0000) LR: 1.64e-06 
π“ Codebook: 109/1024 (10.6%) Top5:[566,339,789,412,98,728,136,807,973,694,722,680,499,163,619]


π”¬ Encoder Diversity (iter 550):
  Avg similarity: 0.6762 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5669 (0.0=collapsed)
[Epoch 1/100] [Batch 560/669 (83.7%)] [Iter 560] Loss: 1.6329 (freq: 0.6296, raw: 1.0030, quant: 0.0003, domain: 0.0000) LR: 1.67e-06 
π“ Codebook: 137/1024 (13.4%) Top5:[339,566,412,789,728,694,98,477,499,807,619,722,973,784,806]


π”¬ Encoder Diversity (iter 560):
  Avg similarity: 0.6698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5682 (0.0=collapsed)
[Epoch 1/100] [Batch 570/669 (85.2%)] [Iter 570] Loss: 1.7046 (freq: 0.7013, raw: 1.0029, quant: 0.0003, domain: 0.0000) LR: 1.70e-06 
π“ Codebook: 139/1024 (13.6%) Top5:[566,412,339,973,789,728,477,694,619,722,499,807,784,98,136]


π”¬ Encoder Diversity (iter 570):
  Avg similarity: 0.6790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5548 (0.0=collapsed)
[Epoch 1/100] [Batch 580/669 (86.7%)] [Iter 580] Loss: 1.8319 (freq: 0.8288, raw: 1.0027, quant: 0.0004, domain: 0.0000) LR: 1.73e-06 
π“ Codebook: 127/1024 (12.4%) Top5:[973,566,412,186,789,339,694,482,807,722,728,334,136,574,98]


π”¬ Encoder Diversity (iter 580):
  Avg similarity: 0.6322 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5777 (0.0=collapsed)
[Epoch 1/100] [Batch 590/669 (88.2%)] [Iter 590] Loss: 1.7868 (freq: 0.7841, raw: 1.0023, quant: 0.0004, domain: 0.0000) LR: 1.76e-06 
π“ Codebook: 152/1024 (14.8%) Top5:[973,334,784,412,566,186,482,789,340,477,216,793,17,352,807]


π”¬ Encoder Diversity (iter 590):
  Avg similarity: 0.6715 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5710 (0.0=collapsed)
[Epoch 1/100] [Batch 600/669 (89.7%)] [Iter 600] Loss: 1.7156 (freq: 0.7116, raw: 1.0037, quant: 0.0003, domain: 0.0000) LR: 1.79e-06 
π“ Codebook: 178/1024 (17.4%) Top5:[973,334,566,789,784,412,186,477,482,17,905,397,352,339,181]


π”¬ Encoder Diversity (iter 600):
  Avg similarity: 0.6729 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5686 (0.0=collapsed)
[Epoch 1/100] [Batch 610/669 (91.2%)] [Iter 610] Loss: 1.7497 (freq: 0.7477, raw: 1.0016, quant: 0.0004, domain: 0.0000) LR: 1.82e-06 
π“ Codebook: 155/1024 (15.1%) Top5:[973,566,784,412,339,334,789,482,477,694,186,728,499,150,722]


π”¬ Encoder Diversity (iter 610):
  Avg similarity: 0.6785 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5692 (0.0=collapsed)
[Epoch 1/100] [Batch 620/669 (92.7%)] [Iter 620] Loss: 1.7141 (freq: 0.7108, raw: 1.0030, quant: 0.0004, domain: 0.0000) LR: 1.85e-06 
π“ Codebook: 143/1024 (14.0%) Top5:[566,789,973,339,412,784,728,694,722,98,807,499,136,859,364]


π”¬ Encoder Diversity (iter 620):
  Avg similarity: 0.7218 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5349 (0.0=collapsed)
[Epoch 1/100] [Batch 630/669 (94.2%)] [Iter 630] Loss: 1.7794 (freq: 0.7761, raw: 1.0030, quant: 0.0003, domain: 0.0000) LR: 1.88e-06 
π“ Codebook: 176/1024 (17.2%) Top5:[339,566,789,728,499,859,412,807,98,694,136,722,364,680,619]


π”¬ Encoder Diversity (iter 630):
  Avg similarity: 0.6814 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5600 (0.0=collapsed)
[Epoch 1/100] [Batch 640/669 (95.7%)] [Iter 640] Loss: 1.7680 (freq: 0.7671, raw: 1.0006, quant: 0.0003, domain: 0.0000) LR: 1.91e-06 
π“ Codebook: 161/1024 (15.7%) Top5:[566,339,789,728,499,412,859,98,619,694,807,806,722,136,112]


π”¬ Encoder Diversity (iter 640):
  Avg similarity: 0.6618 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5736 (0.0=collapsed)
[Epoch 1/100] [Batch 650/669 (97.2%)] [Iter 650] Loss: 1.9195 (freq: 0.9164, raw: 1.0028, quant: 0.0004, domain: 0.0000) LR: 1.94e-06 
π“ Codebook: 142/1024 (13.9%) Top5:[566,339,789,728,412,499,98,807,619,694,973,722,859,136,806]


π”¬ Encoder Diversity (iter 650):
  Avg similarity: 0.6679 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5718 (0.0=collapsed)
[Epoch 1/100] [Batch 660/669 (98.7%)] [Iter 660] Loss: 1.7729 (freq: 0.7707, raw: 1.0019, quant: 0.0003, domain: 0.0000) LR: 1.97e-06 
π“ Codebook: 128/1024 (12.5%) Top5:[566,789,339,412,973,728,499,694,722,807,98,619,806,136,784]


π”¬ Encoder Diversity (iter 660):
  Avg similarity: 0.6604 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5772 (0.0=collapsed)

================================================================================
[Epoch 1] Validation Results:
  Total Loss: 1.4354
  Freq Loss:  0.4325
  Raw Loss:   1.0025
  Quant Loss: 0.0003
  π“ Codebook Usage: 47/1024 (4.6%)
  π“ Codebook Entropy: 2.9873 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 85941 (66.0%)
  Top 10 most used codes:
    1. Code 694: 16126 times (12.39%)
    2. Code 722: 10414 times (8.00%)
    3. Code 519: 9664 times (7.42%)
    4. Code 807: 9613 times (7.38%)
    5. Code 98: 7781 times (5.98%)
    6. Code 680: 6859 times (5.27%)
    7. Code 574: 6800 times (5.22%)
    8. Code 845: 6280 times (4.82%)
    9. Code 136: 6259 times (4.81%)
    10. Code 653: 6145 times (4.72%)
  Bottom 5 least used codes (among used):
    1. Code 566: 41 times (0.03%)
    2. Code 55: 44 times (0.03%)
    3. Code 334: 59 times (0.05%)
    4. Code 974: 63 times (0.05%)
    5. Code 906: 70 times (0.05%)
================================================================================

[EarlyStopping] Best model saved at epoch 1
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 2/100] [Batch 1/669 (0.1%)] [Iter 670] Loss: 1.8857 (freq: 0.8834, raw: 1.0020, quant: 0.0003, domain: 0.0000) LR: 2.00e-06 
π“ Codebook: 179/1024 (17.5%) Top5:[566,973,789,412,499,784,339,728,694,722,807,98,619,519,653]


π”¬ Encoder Diversity (iter 670):
  Avg similarity: 0.6722 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5672 (0.0=collapsed)
[Epoch 2/100] [Batch 11/669 (1.6%)] [Iter 680] Loss: 1.7615 (freq: 0.7584, raw: 1.0028, quant: 0.0004, domain: 0.0000) LR: 2.03e-06 
π“ Codebook: 877/1024 (85.6%) Top5:[973,789,339,566,499,412,784,728,694,806,619,2,859,807,290]


π”¬ Encoder Diversity (iter 680):
  Avg similarity: 0.6646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5788 (0.0=collapsed)
[Epoch 2/100] [Batch 21/669 (3.1%)] [Iter 690] Loss: 1.7350 (freq: 0.7321, raw: 1.0027, quant: 0.0003, domain: 0.0000) LR: 2.06e-06 
π“ Codebook: 752/1024 (73.4%) Top5:[973,784,566,789,339,694,499,412,807,519,728,722,2,290,619]


π”¬ Encoder Diversity (iter 690):
  Avg similarity: 0.6571 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5796 (0.0=collapsed)
[Epoch 2/100] [Batch 31/669 (4.6%)] [Iter 700] Loss: 1.6091 (freq: 0.6053, raw: 1.0034, quant: 0.0003, domain: 0.0000) LR: 2.09e-06 
π“ Codebook: 557/1024 (54.4%) Top5:[973,784,566,412,789,339,694,499,807,340,216,482,614,793,136]


π”¬ Encoder Diversity (iter 700):
  Avg similarity: 0.6534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5768 (0.0=collapsed)
[Epoch 2/100] [Batch 41/669 (6.1%)] [Iter 710] Loss: 1.5967 (freq: 0.5935, raw: 1.0028, quant: 0.0003, domain: 0.0000) LR: 2.12e-06 
π“ Codebook: 508/1024 (49.6%) Top5:[973,566,339,789,784,412,499,694,728,807,707,290,614,136,806]


π”¬ Encoder Diversity (iter 710):
  Avg similarity: 0.6591 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5774 (0.0=collapsed)
[Epoch 2/100] [Batch 51/669 (7.6%)] [Iter 720] Loss: 1.8253 (freq: 0.8226, raw: 1.0024, quant: 0.0004, domain: 0.0000) LR: 2.15e-06 
π“ Codebook: 410/1024 (40.0%) Top5:[566,339,412,789,973,728,784,499,290,806,807,2,619,694,707]


π”¬ Encoder Diversity (iter 720):
  Avg similarity: 0.6595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5868 (0.0=collapsed)
[Epoch 2/100] [Batch 61/669 (9.1%)] [Iter 730] Loss: 1.7997 (freq: 0.7975, raw: 1.0019, quant: 0.0003, domain: 0.0000) LR: 2.18e-06 
π“ Codebook: 407/1024 (39.7%) Top5:[566,339,412,789,728,807,499,973,98,694,290,619,2,806,722]


π”¬ Encoder Diversity (iter 730):
  Avg similarity: 0.6563 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5794 (0.0=collapsed)
[Epoch 2/100] [Batch 71/669 (10.6%)] [Iter 740] Loss: 1.9473 (freq: 0.9444, raw: 1.0025, quant: 0.0004, domain: 0.0000) LR: 2.21e-06 
π“ Codebook: 330/1024 (32.2%) Top5:[566,339,412,728,789,499,807,619,364,694,98,722,2,163,859]


π”¬ Encoder Diversity (iter 740):
  Avg similarity: 0.6716 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5785 (0.0=collapsed)
[Epoch 2/100] [Batch 81/669 (12.1%)] [Iter 750] Loss: 1.7589 (freq: 0.7570, raw: 1.0015, quant: 0.0003, domain: 0.0000) LR: 2.24e-06 
π“ Codebook: 228/1024 (22.3%) Top5:[566,789,339,412,728,807,694,499,98,722,136,653,163,619,2]


π”¬ Encoder Diversity (iter 750):
  Avg similarity: 0.6620 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5783 (0.0=collapsed)
[Epoch 2/100] [Batch 91/669 (13.6%)] [Iter 760] Loss: 1.8884 (freq: 0.8867, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 2.27e-06 
π“ Codebook: 284/1024 (27.7%) Top5:[566,412,339,789,728,499,619,2,859,290,845,806,973,793,807]


π”¬ Encoder Diversity (iter 760):
  Avg similarity: 0.6671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5800 (0.0=collapsed)
[Epoch 2/100] [Batch 101/669 (15.1%)] [Iter 770] Loss: 1.5894 (freq: 0.5859, raw: 1.0033, quant: 0.0003, domain: 0.0000) LR: 2.30e-06 
π“ Codebook: 207/1024 (20.2%) Top5:[566,789,339,412,728,973,499,807,722,98,694,2,680,806,793]


π”¬ Encoder Diversity (iter 770):
  Avg similarity: 0.6478 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5643 (0.0=collapsed)
[Epoch 2/100] [Batch 111/669 (16.6%)] [Iter 780] Loss: 1.6063 (freq: 0.6038, raw: 1.0022, quant: 0.0003, domain: 0.0000) LR: 2.33e-06 
π“ Codebook: 184/1024 (18.0%) Top5:[566,412,789,728,339,807,845,98,793,973,2,722,499,694,574]


π”¬ Encoder Diversity (iter 780):
  Avg similarity: 0.6628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5699 (0.0=collapsed)
[Epoch 2/100] [Batch 121/669 (18.1%)] [Iter 790] Loss: 1.7399 (freq: 0.7389, raw: 1.0007, quant: 0.0003, domain: 0.0000) LR: 2.36e-06 
π“ Codebook: 124/1024 (12.1%) Top5:[566,339,728,98,789,694,807,412,722,519,973,2,793,136,574]


π”¬ Encoder Diversity (iter 790):
  Avg similarity: 0.6456 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5757 (0.0=collapsed)
[Epoch 2/100] [Batch 131/669 (19.6%)] [Iter 800] Loss: 1.7610 (freq: 0.7603, raw: 1.0003, quant: 0.0003, domain: 0.0000) LR: 2.39e-06 
π“ Codebook: 179/1024 (17.5%) Top5:[566,412,789,339,973,728,793,807,98,2,694,216,680,845,614]


π”¬ Encoder Diversity (iter 800):
  Avg similarity: 0.6658 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5806 (0.0=collapsed)
[Epoch 2/100] [Batch 141/669 (21.1%)] [Iter 810] Loss: 1.6280 (freq: 0.6263, raw: 1.0014, quant: 0.0003, domain: 0.0000) LR: 2.42e-06 
π“ Codebook: 174/1024 (17.0%) Top5:[566,789,412,728,973,339,98,2,845,694,807,290,793,1011,722]


π”¬ Encoder Diversity (iter 810):
  Avg similarity: 0.6371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5929 (0.0=collapsed)
[Epoch 2/100] [Batch 151/669 (22.6%)] [Iter 820] Loss: 1.5249 (freq: 0.5228, raw: 1.0018, quant: 0.0003, domain: 0.0000) LR: 2.45e-06 
π“ Codebook: 234/1024 (22.9%) Top5:[566,412,789,339,728,973,98,807,845,2,929,793,722,614,364]


π”¬ Encoder Diversity (iter 820):
  Avg similarity: 0.6578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5820 (0.0=collapsed)
[Epoch 2/100] [Batch 161/669 (24.1%)] [Iter 830] Loss: 1.6636 (freq: 0.6620, raw: 1.0014, quant: 0.0003, domain: 0.0000) LR: 2.48e-06 
π“ Codebook: 189/1024 (18.5%) Top5:[566,412,789,339,728,98,973,694,722,807,845,2,793,929,614]


π”¬ Encoder Diversity (iter 830):
  Avg similarity: 0.6315 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5842 (0.0=collapsed)
[Epoch 2/100] [Batch 171/669 (25.6%)] [Iter 840] Loss: 1.9228 (freq: 0.9205, raw: 1.0020, quant: 0.0003, domain: 0.0000) LR: 2.51e-06 
π“ Codebook: 174/1024 (17.0%) Top5:[566,789,412,973,339,728,98,793,807,722,694,364,499,2,136]


π”¬ Encoder Diversity (iter 840):
  Avg similarity: 0.6676 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5668 (0.0=collapsed)
[Epoch 2/100] [Batch 181/669 (27.1%)] [Iter 850] Loss: 1.8132 (freq: 0.8124, raw: 1.0004, quant: 0.0004, domain: 0.0000) LR: 2.54e-06 
π“ Codebook: 186/1024 (18.2%) Top5:[566,789,973,339,98,412,728,694,793,807,722,364,614,216,136]


π”¬ Encoder Diversity (iter 850):
  Avg similarity: 0.6420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5966 (0.0=collapsed)
[Epoch 2/100] [Batch 191/669 (28.6%)] [Iter 860] Loss: 1.8283 (freq: 0.8258, raw: 1.0022, quant: 0.0003, domain: 0.0000) LR: 2.57e-06 
π“ Codebook: 186/1024 (18.2%) Top5:[566,789,973,339,412,98,728,694,807,793,364,722,499,216,519]


π”¬ Encoder Diversity (iter 860):
  Avg similarity: 0.6741 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5583 (0.0=collapsed)
[Epoch 2/100] [Batch 201/669 (30.0%)] [Iter 870] Loss: 1.8151 (freq: 0.8129, raw: 1.0018, quant: 0.0003, domain: 0.0000) LR: 2.60e-06 
π“ Codebook: 185/1024 (18.1%) Top5:[566,339,412,789,728,973,793,98,364,845,694,216,614,619,807]


π”¬ Encoder Diversity (iter 870):
  Avg similarity: 0.6467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5834 (0.0=collapsed)
[Epoch 2/100] [Batch 211/669 (31.5%)] [Iter 880] Loss: 1.6649 (freq: 0.6627, raw: 1.0019, quant: 0.0003, domain: 0.0000) LR: 2.63e-06 
π“ Codebook: 150/1024 (14.6%) Top5:[566,412,339,728,973,789,845,98,694,290,619,807,793,806,216]


π”¬ Encoder Diversity (iter 880):
  Avg similarity: 0.6656 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5670 (0.0=collapsed)
[Epoch 2/100] [Batch 221/669 (33.0%)] [Iter 890] Loss: 1.9560 (freq: 0.9547, raw: 1.0010, quant: 0.0003, domain: 0.0000) LR: 2.66e-06 
π“ Codebook: 125/1024 (12.2%) Top5:[566,339,789,412,973,728,98,694,807,722,364,793,845,136,614]


π”¬ Encoder Diversity (iter 890):
  Avg similarity: 0.6612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5841 (0.0=collapsed)
[Epoch 2/100] [Batch 231/669 (34.5%)] [Iter 900] Loss: 1.7446 (freq: 0.7440, raw: 1.0004, quant: 0.0003, domain: 0.0000) LR: 2.69e-06 
π“ Codebook: 116/1024 (11.3%) Top5:[566,789,973,98,728,339,694,412,807,722,614,519,136,364,216]


π”¬ Encoder Diversity (iter 900):
  Avg similarity: 0.6938 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5617 (0.0=collapsed)
[Epoch 2/100] [Batch 241/669 (36.0%)] [Iter 910] Loss: 1.6439 (freq: 0.6412, raw: 1.0024, quant: 0.0003, domain: 0.0000) LR: 2.72e-06 
π“ Codebook: 120/1024 (11.7%) Top5:[566,412,973,339,728,789,98,694,807,519,722,653,845,136,2]


π”¬ Encoder Diversity (iter 910):
  Avg similarity: 0.6491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5742 (0.0=collapsed)
[Epoch 2/100] [Batch 251/669 (37.5%)] [Iter 920] Loss: 1.8918 (freq: 0.8894, raw: 1.0021, quant: 0.0003, domain: 0.0000) LR: 2.75e-06 
π“ Codebook: 152/1024 (14.8%) Top5:[566,973,339,728,789,412,98,2,619,694,784,818,845,499,1011]


π”¬ Encoder Diversity (iter 920):
  Avg similarity: 0.6692 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5711 (0.0=collapsed)
[Epoch 2/100] [Batch 261/669 (39.0%)] [Iter 930] Loss: 1.8130 (freq: 0.8107, raw: 1.0020, quant: 0.0003, domain: 0.0000) LR: 2.78e-06 
π“ Codebook: 121/1024 (11.8%) Top5:[566,412,339,789,728,973,2,98,694,807,619,653,290,784,845]


π”¬ Encoder Diversity (iter 930):
  Avg similarity: 0.6558 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5835 (0.0=collapsed)
[Epoch 2/100] [Batch 271/669 (40.5%)] [Iter 940] Loss: 1.7269 (freq: 0.7275, raw: 0.9992, quant: 0.0003, domain: 0.0000) LR: 2.81e-06 
π“ Codebook: 132/1024 (12.9%) Top5:[566,973,339,412,789,728,694,2,807,98,845,619,653,722,290]


π”¬ Encoder Diversity (iter 940):
  Avg similarity: 0.6557 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5869 (0.0=collapsed)
[Epoch 2/100] [Batch 281/669 (42.0%)] [Iter 950] Loss: 1.9415 (freq: 0.9400, raw: 1.0012, quant: 0.0004, domain: 0.0000) LR: 2.84e-06 
π“ Codebook: 153/1024 (14.9%) Top5:[566,339,973,412,789,807,694,728,98,653,2,136,519,929,619]


π”¬ Encoder Diversity (iter 950):
  Avg similarity: 0.6877 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5573 (0.0=collapsed)
[Epoch 2/100] [Batch 291/669 (43.5%)] [Iter 960] Loss: 1.7900 (freq: 0.7898, raw: 0.9999, quant: 0.0004, domain: 0.0000) LR: 2.87e-06 
π“ Codebook: 146/1024 (14.3%) Top5:[566,339,412,973,728,789,574,807,216,98,680,929,614,694,793]


π”¬ Encoder Diversity (iter 960):
  Avg similarity: 0.6545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5915 (0.0=collapsed)
[Epoch 2/100] [Batch 301/669 (45.0%)] [Iter 970] Loss: 1.7225 (freq: 0.7208, raw: 1.0014, quant: 0.0003, domain: 0.0000) LR: 2.90e-06 
π“ Codebook: 114/1024 (11.1%) Top5:[566,973,339,789,412,728,98,694,807,574,290,2,364,653,680]


π”¬ Encoder Diversity (iter 970):
  Avg similarity: 0.6460 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5952 (0.0=collapsed)
[Epoch 2/100] [Batch 311/669 (46.5%)] [Iter 980] Loss: 1.5691 (freq: 0.5666, raw: 1.0022, quant: 0.0003, domain: 0.0000) LR: 2.93e-06 
π“ Codebook: 107/1024 (10.4%) Top5:[566,973,789,339,412,574,694,728,98,680,807,216,793,614,290]


π”¬ Encoder Diversity (iter 980):
  Avg similarity: 0.6444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5902 (0.0=collapsed)
[Epoch 2/100] [Batch 321/669 (48.0%)] [Iter 990] Loss: 1.8926 (freq: 0.8896, raw: 1.0027, quant: 0.0003, domain: 0.0000) LR: 2.96e-06 
π“ Codebook: 154/1024 (15.0%) Top5:[566,973,789,339,412,574,728,98,680,694,707,216,793,614,807]


π”¬ Encoder Diversity (iter 990):
  Avg similarity: 0.6318 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6015 (0.0=collapsed)
[Epoch 2/100] [Batch 331/669 (49.5%)] [Iter 1000] Loss: 1.8145 (freq: 0.8127, raw: 1.0014, quant: 0.0003, domain: 0.0000) LR: 2.99e-06 
π“ Codebook: 154/1024 (15.0%) Top5:[566,412,789,973,339,728,98,574,694,793,680,614,340,216,807]


π”¬ Encoder Diversity (iter 1000):
  Avg similarity: 0.6259 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6007 (0.0=collapsed)
[Epoch 2/100] [Batch 341/669 (51.0%)] [Iter 1010] Loss: 1.7228 (freq: 0.7220, raw: 1.0005, quant: 0.0003, domain: 0.0000) LR: 3.02e-06 
π“ Codebook: 131/1024 (12.8%) Top5:[566,412,973,339,789,728,98,694,364,574,680,340,807,793,614]


π”¬ Encoder Diversity (iter 1010):
  Avg similarity: 0.6320 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5931 (0.0=collapsed)
[Epoch 2/100] [Batch 351/669 (52.5%)] [Iter 1020] Loss: 1.5710 (freq: 0.5698, raw: 1.0009, quant: 0.0003, domain: 0.0000) LR: 3.05e-06 
π“ Codebook: 119/1024 (11.6%) Top5:[566,339,412,973,728,694,789,98,653,807,364,340,574,793,722]


π”¬ Encoder Diversity (iter 1020):
  Avg similarity: 0.6400 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5880 (0.0=collapsed)
[Epoch 2/100] [Batch 361/669 (54.0%)] [Iter 1030] Loss: 1.6876 (freq: 0.6860, raw: 1.0013, quant: 0.0003, domain: 0.0000) LR: 3.08e-06 
π“ Codebook: 148/1024 (14.5%) Top5:[339,566,412,789,728,364,973,98,694,653,807,2,290,614,340]


π”¬ Encoder Diversity (iter 1030):
  Avg similarity: 0.6233 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6156 (0.0=collapsed)
[Epoch 2/100] [Batch 371/669 (55.5%)] [Iter 1040] Loss: 1.7914 (freq: 0.7893, raw: 1.0018, quant: 0.0003, domain: 0.0000) LR: 3.11e-06 
π“ Codebook: 150/1024 (14.6%) Top5:[566,339,973,789,728,412,653,364,694,807,290,98,614,2,680]


π”¬ Encoder Diversity (iter 1040):
  Avg similarity: 0.6361 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5953 (0.0=collapsed)
[Epoch 2/100] [Batch 381/669 (57.0%)] [Iter 1050] Loss: 1.8884 (freq: 0.8866, raw: 1.0015, quant: 0.0003, domain: 0.0000) LR: 3.14e-06 
π“ Codebook: 130/1024 (12.7%) Top5:[566,339,973,789,728,98,653,694,807,412,574,364,614,2,680]


π”¬ Encoder Diversity (iter 1050):
  Avg similarity: 0.6101 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6066 (0.0=collapsed)
[Epoch 2/100] [Batch 391/669 (58.4%)] [Iter 1060] Loss: 1.8288 (freq: 0.8267, raw: 1.0017, quant: 0.0003, domain: 0.0000) LR: 3.17e-06 
π“ Codebook: 86/1024 (8.4%) Top5:[566,339,789,973,728,412,98,2,574,694,807,653,364,614,680]


π”¬ Encoder Diversity (iter 1060):
  Avg similarity: 0.6615 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5898 (0.0=collapsed)
[Epoch 2/100] [Batch 401/669 (59.9%)] [Iter 1070] Loss: 1.7093 (freq: 0.7068, raw: 1.0022, quant: 0.0003, domain: 0.0000) LR: 3.20e-06 
π“ Codebook: 137/1024 (13.4%) Top5:[566,339,412,789,728,694,807,98,2,653,973,364,722,290,614]


π”¬ Encoder Diversity (iter 1070):
  Avg similarity: 0.5946 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6289 (0.0=collapsed)
[Epoch 2/100] [Batch 411/669 (61.4%)] [Iter 1080] Loss: 1.7123 (freq: 0.7103, raw: 1.0017, quant: 0.0003, domain: 0.0000) LR: 3.23e-06 
π“ Codebook: 120/1024 (11.7%) Top5:[412,789,566,339,728,2,694,973,364,845,807,519,98,680,818]


π”¬ Encoder Diversity (iter 1080):
  Avg similarity: 0.6311 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5967 (0.0=collapsed)
[Epoch 2/100] [Batch 421/669 (62.9%)] [Iter 1090] Loss: 1.7866 (freq: 0.7847, raw: 1.0016, quant: 0.0003, domain: 0.0000) LR: 3.26e-06 
π“ Codebook: 142/1024 (13.9%) Top5:[412,339,789,566,694,2,728,519,807,98,973,722,680,845,653]


π”¬ Encoder Diversity (iter 1090):
  Avg similarity: 0.6216 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6033 (0.0=collapsed)
[Epoch 2/100] [Batch 431/669 (64.4%)] [Iter 1100] Loss: 1.6251 (freq: 0.6232, raw: 1.0016, quant: 0.0003, domain: 0.0000) LR: 3.29e-06 
π“ Codebook: 121/1024 (11.8%) Top5:[339,566,412,789,728,2,680,519,364,929,694,793,614,973,216]


π”¬ Encoder Diversity (iter 1100):
  Avg similarity: 0.6269 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6063 (0.0=collapsed)
[Epoch 2/100] [Batch 441/669 (65.9%)] [Iter 1110] Loss: 1.8023 (freq: 0.7997, raw: 1.0022, quant: 0.0003, domain: 0.0000) LR: 3.32e-06 
π“ Codebook: 111/1024 (10.8%) Top5:[566,339,412,973,789,364,728,2,694,807,98,653,722,680,290]


π”¬ Encoder Diversity (iter 1110):
  Avg similarity: 0.6299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6110 (0.0=collapsed)
[Epoch 2/100] [Batch 451/669 (67.4%)] [Iter 1120] Loss: 1.6079 (freq: 0.6061, raw: 1.0015, quant: 0.0003, domain: 0.0000) LR: 3.35e-06 
π“ Codebook: 104/1024 (10.2%) Top5:[339,566,364,728,789,2,412,973,216,574,290,807,793,98,680]


π”¬ Encoder Diversity (iter 1120):
  Avg similarity: 0.6110 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6215 (0.0=collapsed)
[Epoch 2/100] [Batch 461/669 (68.9%)] [Iter 1130] Loss: 1.7461 (freq: 0.7437, raw: 1.0020, quant: 0.0003, domain: 0.0000) LR: 3.38e-06 
π“ Codebook: 87/1024 (8.5%) Top5:[566,339,973,789,216,364,728,412,807,574,98,680,793,614,694]


π”¬ Encoder Diversity (iter 1130):
  Avg similarity: 0.5708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6433 (0.0=collapsed)
[Epoch 2/100] [Batch 471/669 (70.4%)] [Iter 1140] Loss: 1.6379 (freq: 0.6350, raw: 1.0026, quant: 0.0003, domain: 0.0000) LR: 3.41e-06 
π“ Codebook: 105/1024 (10.3%) Top5:[566,339,789,364,973,728,412,216,680,574,694,2,807,793,98]


π”¬ Encoder Diversity (iter 1140):
  Avg similarity: 0.6202 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6126 (0.0=collapsed)
[Epoch 2/100] [Batch 481/669 (71.9%)] [Iter 1150] Loss: 1.8555 (freq: 0.8532, raw: 1.0018, quant: 0.0005, domain: 0.0000) LR: 3.44e-06 
π“ Codebook: 106/1024 (10.4%) Top5:[339,566,412,728,364,973,789,216,929,2,694,680,574,519,793]


π”¬ Encoder Diversity (iter 1150):
  Avg similarity: 0.5895 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6264 (0.0=collapsed)
[Epoch 2/100] [Batch 491/669 (73.4%)] [Iter 1160] Loss: 1.7326 (freq: 0.7309, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 3.47e-06 
π“ Codebook: 145/1024 (14.2%) Top5:[566,694,412,789,339,973,722,728,98,653,807,364,2,929,707]


π”¬ Encoder Diversity (iter 1160):
  Avg similarity: 0.5846 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6426 (0.0=collapsed)
[Epoch 2/100] [Batch 501/669 (74.9%)] [Iter 1170] Loss: 1.8201 (freq: 0.8193, raw: 1.0003, quant: 0.0004, domain: 0.0000) LR: 3.50e-06 
π“ Codebook: 148/1024 (14.5%) Top5:[566,412,339,728,694,789,722,2,807,364,793,519,614,680,136]


π”¬ Encoder Diversity (iter 1170):
  Avg similarity: 0.6075 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6163 (0.0=collapsed)
[Epoch 2/100] [Batch 511/669 (76.4%)] [Iter 1180] Loss: 1.7759 (freq: 0.7752, raw: 1.0003, quant: 0.0004, domain: 0.0000) LR: 3.53e-06 
π“ Codebook: 116/1024 (11.3%) Top5:[566,728,789,412,339,694,2,722,364,973,619,98,653,290,793]


π”¬ Encoder Diversity (iter 1180):
  Avg similarity: 0.5887 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6364 (0.0=collapsed)
[Epoch 2/100] [Batch 521/669 (77.9%)] [Iter 1190] Loss: 1.6100 (freq: 0.6090, raw: 1.0006, quant: 0.0004, domain: 0.0000) LR: 3.56e-06 
π“ Codebook: 120/1024 (11.7%) Top5:[566,789,339,728,364,412,2,973,614,793,680,859,574,619,929]


π”¬ Encoder Diversity (iter 1190):
  Avg similarity: 0.5925 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6361 (0.0=collapsed)
[Epoch 2/100] [Batch 531/669 (79.4%)] [Iter 1200] Loss: 1.6123 (freq: 0.6106, raw: 1.0014, quant: 0.0003, domain: 0.0000) LR: 3.58e-06 
π“ Codebook: 103/1024 (10.1%) Top5:[728,339,566,364,789,412,98,614,2,793,290,574,694,680,973]


π”¬ Encoder Diversity (iter 1200):
  Avg similarity: 0.6096 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6161 (0.0=collapsed)
[Epoch 2/100] [Batch 541/669 (80.9%)] [Iter 1210] Loss: 1.9096 (freq: 0.9083, raw: 1.0010, quant: 0.0003, domain: 0.0000) LR: 3.61e-06 
π“ Codebook: 85/1024 (8.3%) Top5:[566,789,728,364,339,973,98,290,694,653,722,793,574,859,614]


π”¬ Encoder Diversity (iter 1210):
  Avg similarity: 0.5976 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6357 (0.0=collapsed)
[Epoch 2/100] [Batch 551/669 (82.4%)] [Iter 1220] Loss: 1.9489 (freq: 0.9482, raw: 1.0003, quant: 0.0003, domain: 0.0000) LR: 3.64e-06 
π“ Codebook: 70/1024 (6.8%) Top5:[339,566,728,789,364,973,290,2,412,619,98,859,574,680,793]


π”¬ Encoder Diversity (iter 1220):
  Avg similarity: 0.5885 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6343 (0.0=collapsed)
[Epoch 2/100] [Batch 561/669 (83.9%)] [Iter 1230] Loss: 1.7843 (freq: 0.7821, raw: 1.0019, quant: 0.0003, domain: 0.0000) LR: 3.67e-06 
π“ Codebook: 75/1024 (7.3%) Top5:[566,789,339,728,364,973,412,574,680,859,793,290,98,694,929]


π”¬ Encoder Diversity (iter 1230):
  Avg similarity: 0.6301 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6178 (0.0=collapsed)
[Epoch 2/100] [Batch 571/669 (85.4%)] [Iter 1240] Loss: 1.7876 (freq: 0.7874, raw: 0.9998, quant: 0.0004, domain: 0.0000) LR: 3.70e-06 
π“ Codebook: 90/1024 (8.8%) Top5:[566,789,412,339,973,364,728,859,2,619,694,722,929,680,807]


π”¬ Encoder Diversity (iter 1240):
  Avg similarity: 0.6067 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6340 (0.0=collapsed)
[Epoch 2/100] [Batch 581/669 (86.8%)] [Iter 1250] Loss: 1.6812 (freq: 0.6811, raw: 0.9998, quant: 0.0003, domain: 0.0000) LR: 3.73e-06 
π“ Codebook: 100/1024 (9.8%) Top5:[412,566,694,339,789,722,619,728,364,2,653,807,519,98,859]


π”¬ Encoder Diversity (iter 1250):
  Avg similarity: 0.6124 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6192 (0.0=collapsed)
[Epoch 2/100] [Batch 591/669 (88.3%)] [Iter 1260] Loss: 1.7827 (freq: 0.7814, raw: 1.0009, quant: 0.0003, domain: 0.0000) LR: 3.76e-06 
π“ Codebook: 97/1024 (9.5%) Top5:[566,412,789,694,339,722,619,2,364,859,728,973,807,519,163]


π”¬ Encoder Diversity (iter 1260):
  Avg similarity: 0.6274 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.5970 (0.0=collapsed)
[Epoch 2/100] [Batch 601/669 (89.8%)] [Iter 1270] Loss: 1.8182 (freq: 0.8177, raw: 1.0001, quant: 0.0003, domain: 0.0000) LR: 3.79e-06 
π“ Codebook: 78/1024 (7.6%) Top5:[566,412,789,694,722,339,619,98,859,2,728,653,519,807,364]


π”¬ Encoder Diversity (iter 1270):
  Avg similarity: 0.5922 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6444 (0.0=collapsed)
[Epoch 2/100] [Batch 611/669 (91.3%)] [Iter 1280] Loss: 1.7350 (freq: 0.7337, raw: 1.0010, quant: 0.0003, domain: 0.0000) LR: 3.82e-06 
π“ Codebook: 79/1024 (7.7%) Top5:[566,789,339,694,722,412,364,973,728,859,98,619,653,2,929]


π”¬ Encoder Diversity (iter 1280):
  Avg similarity: 0.5454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6579 (0.0=collapsed)
[Epoch 2/100] [Batch 621/669 (92.8%)] [Iter 1290] Loss: 1.6683 (freq: 0.6676, raw: 1.0005, quant: 0.0003, domain: 0.0000) LR: 3.85e-06 
π“ Codebook: 67/1024 (6.5%) Top5:[566,339,789,722,694,728,364,98,412,973,929,859,653,619,574]


π”¬ Encoder Diversity (iter 1290):
  Avg similarity: 0.5617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6470 (0.0=collapsed)
[Epoch 2/100] [Batch 631/669 (94.3%)] [Iter 1300] Loss: 1.4185 (freq: 0.4173, raw: 1.0010, quant: 0.0002, domain: 0.0000) LR: 3.88e-06 
π“ Codebook: 71/1024 (6.9%) Top5:[339,566,364,789,98,722,728,694,973,653,412,859,290,619,929]


π”¬ Encoder Diversity (iter 1300):
  Avg similarity: 0.5797 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6483 (0.0=collapsed)
[Epoch 2/100] [Batch 641/669 (95.8%)] [Iter 1310] Loss: 1.8937 (freq: 0.8929, raw: 1.0004, quant: 0.0003, domain: 0.0000) LR: 3.91e-06 
π“ Codebook: 66/1024 (6.4%) Top5:[566,789,364,339,973,728,929,859,290,98,614,793,340,574,722]


π”¬ Encoder Diversity (iter 1310):
  Avg similarity: 0.5894 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6306 (0.0=collapsed)
[Epoch 2/100] [Batch 651/669 (97.3%)] [Iter 1320] Loss: 1.7264 (freq: 0.7258, raw: 1.0002, quant: 0.0003, domain: 0.0000) LR: 3.94e-06 
π“ Codebook: 55/1024 (5.4%) Top5:[339,364,566,789,973,728,290,619,574,412,614,793,929,722,859]


π”¬ Encoder Diversity (iter 1320):
  Avg similarity: 0.5882 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6248 (0.0=collapsed)
[Epoch 2/100] [Batch 661/669 (98.8%)] [Iter 1330] Loss: 1.5436 (freq: 0.5425, raw: 1.0009, quant: 0.0003, domain: 0.0000) LR: 3.97e-06 
π“ Codebook: 57/1024 (5.6%) Top5:[364,789,694,98,566,722,519,728,339,619,653,807,574,973,680]


π”¬ Encoder Diversity (iter 1330):
  Avg similarity: 0.5671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6474 (0.0=collapsed)

================================================================================
[Epoch 2] Validation Results:
  Total Loss: 1.3510
  Freq Loss:  0.3497
  Raw Loss:   1.0010
  Quant Loss: 0.0002
  π“ Codebook Usage: 29/1024 (2.8%)
  π“ Codebook Entropy: 2.7331 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 101845 (78.2%)
  Top 10 most used codes:
    1. Code 694: 13399 times (10.29%)
    2. Code 519: 12417 times (9.54%)
    3. Code 574: 10941 times (8.40%)
    4. Code 680: 10888 times (8.36%)
    5. Code 98: 10834 times (8.32%)
    6. Code 722: 10121 times (7.77%)
    7. Code 807: 9132 times (7.01%)
    8. Code 793: 8511 times (6.54%)
    9. Code 929: 8112 times (6.23%)
    10. Code 136: 7490 times (5.75%)
  Bottom 5 least used codes (among used):
    1. Code 707: 7 times (0.01%)
    2. Code 859: 14 times (0.01%)
    3. Code 784: 14 times (0.01%)
    4. Code 818: 14 times (0.01%)
    5. Code 806: 35 times (0.03%)
================================================================================

[EarlyStopping] Best model saved at epoch 2
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 3/100] [Batch 2/669 (0.3%)] [Iter 1340] Loss: 1.6962 (freq: 0.6939, raw: 1.0020, quant: 0.0003, domain: 0.0000) LR: 4.00e-06 
π“ Codebook: 291/1024 (28.4%) Top5:[566,619,789,728,364,574,680,339,929,793,412,614,694,340,722]


π”¬ Encoder Diversity (iter 1340):
  Avg similarity: 0.5941 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6411 (0.0=collapsed)
[Epoch 3/100] [Batch 12/669 (1.8%)] [Iter 1350] Loss: 1.5236 (freq: 0.5224, raw: 1.0009, quant: 0.0003, domain: 0.0000) LR: 4.03e-06 
π“ Codebook: 816/1024 (79.7%) Top5:[566,619,364,339,694,728,2,722,290,98,574,519,653,136,680]


π”¬ Encoder Diversity (iter 1350):
  Avg similarity: 0.5897 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6287 (0.0=collapsed)
[Epoch 3/100] [Batch 22/669 (3.3%)] [Iter 1360] Loss: 1.5331 (freq: 0.5324, raw: 1.0004, quant: 0.0003, domain: 0.0000) LR: 4.06e-06 
π“ Codebook: 601/1024 (58.7%) Top5:[566,619,728,339,364,290,694,2,98,519,574,722,163,680,807]


π”¬ Encoder Diversity (iter 1360):
  Avg similarity: 0.5641 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6450 (0.0=collapsed)
[Epoch 3/100] [Batch 32/669 (4.8%)] [Iter 1370] Loss: 1.6894 (freq: 0.6900, raw: 0.9990, quant: 0.0003, domain: 0.0000) LR: 4.09e-06 
π“ Codebook: 479/1024 (46.8%) Top5:[566,619,728,364,339,694,574,2,929,680,163,653,614,290,793]


π”¬ Encoder Diversity (iter 1370):
  Avg similarity: 0.5823 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6455 (0.0=collapsed)
[Epoch 3/100] [Batch 42/669 (6.3%)] [Iter 1380] Loss: 1.4734 (freq: 0.4730, raw: 1.0001, quant: 0.0003, domain: 0.0000) LR: 4.12e-06 
π“ Codebook: 591/1024 (57.7%) Top5:[566,339,728,653,290,694,364,619,168,2,98,929,574,519,680]


π”¬ Encoder Diversity (iter 1380):
  Avg similarity: 0.5673 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6600 (0.0=collapsed)
[Epoch 3/100] [Batch 52/669 (7.8%)] [Iter 1390] Loss: 1.5528 (freq: 0.5515, raw: 1.0010, quant: 0.0003, domain: 0.0000) LR: 4.15e-06 
π“ Codebook: 462/1024 (45.1%) Top5:[566,339,728,653,364,694,290,619,2,929,680,168,614,574,793]


π”¬ Encoder Diversity (iter 1390):
  Avg similarity: 0.5799 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6512 (0.0=collapsed)
[Epoch 3/100] [Batch 62/669 (9.3%)] [Iter 1400] Loss: 1.9450 (freq: 0.9432, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 4.18e-06 
π“ Codebook: 450/1024 (43.9%) Top5:[566,339,728,290,653,364,694,2,619,168,735,929,722,574,138]


π”¬ Encoder Diversity (iter 1400):
  Avg similarity: 0.5368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6676 (0.0=collapsed)
[Epoch 3/100] [Batch 72/669 (10.8%)] [Iter 1410] Loss: 1.8763 (freq: 0.8769, raw: 0.9990, quant: 0.0004, domain: 0.0000) LR: 4.21e-06 
π“ Codebook: 295/1024 (28.8%) Top5:[566,339,728,929,290,364,574,653,2,680,722,807,793,694,614]


π”¬ Encoder Diversity (iter 1410):
  Avg similarity: 0.5503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6619 (0.0=collapsed)
[Epoch 3/100] [Batch 82/669 (12.3%)] [Iter 1420] Loss: 1.6921 (freq: 0.6914, raw: 1.0004, quant: 0.0003, domain: 0.0000) LR: 4.24e-06 
π“ Codebook: 216/1024 (21.1%) Top5:[566,339,364,290,722,728,653,2,168,619,694,929,735,807,574]


π”¬ Encoder Diversity (iter 1420):
  Avg similarity: 0.6171 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6288 (0.0=collapsed)
[Epoch 3/100] [Batch 92/669 (13.8%)] [Iter 1430] Loss: 1.8059 (freq: 0.8051, raw: 1.0005, quant: 0.0003, domain: 0.0000) LR: 4.27e-06 
π“ Codebook: 238/1024 (23.2%) Top5:[566,339,364,728,290,619,2,168,680,807,722,929,735,163,614]


π”¬ Encoder Diversity (iter 1430):
  Avg similarity: 0.5999 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6324 (0.0=collapsed)
[Epoch 3/100] [Batch 102/669 (15.2%)] [Iter 1440] Loss: 1.6961 (freq: 0.6952, raw: 1.0006, quant: 0.0003, domain: 0.0000) LR: 4.30e-06 
π“ Codebook: 243/1024 (23.7%) Top5:[566,364,168,339,619,728,290,2,722,694,136,98,653,735,229]


π”¬ Encoder Diversity (iter 1440):
  Avg similarity: 0.5606 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6513 (0.0=collapsed)
[Epoch 3/100] [Batch 112/669 (16.7%)] [Iter 1450] Loss: 1.7885 (freq: 0.7889, raw: 0.9992, quant: 0.0004, domain: 0.0000) LR: 4.33e-06 
π“ Codebook: 217/1024 (21.2%) Top5:[566,364,339,694,168,619,728,136,290,722,2,653,680,98,519]


π”¬ Encoder Diversity (iter 1450):
  Avg similarity: 0.5425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6774 (0.0=collapsed)
[Epoch 3/100] [Batch 122/669 (18.2%)] [Iter 1460] Loss: 1.7734 (freq: 0.7724, raw: 1.0007, quant: 0.0004, domain: 0.0000) LR: 4.36e-06 
π“ Codebook: 227/1024 (22.2%) Top5:[566,728,619,364,168,339,290,694,2,519,680,340,574,722,929]


π”¬ Encoder Diversity (iter 1460):
  Avg similarity: 0.5400 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6698 (0.0=collapsed)
[Epoch 3/100] [Batch 132/669 (19.7%)] [Iter 1470] Loss: 1.7684 (freq: 0.7661, raw: 1.0020, quant: 0.0004, domain: 0.0000) LR: 4.39e-06 
π“ Codebook: 208/1024 (20.3%) Top5:[566,728,339,694,619,168,364,290,722,136,98,2,929,680,340]


π”¬ Encoder Diversity (iter 1470):
  Avg similarity: 0.5367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6765 (0.0=collapsed)
[Epoch 3/100] [Batch 142/669 (21.2%)] [Iter 1480] Loss: 1.6099 (freq: 0.6102, raw: 0.9993, quant: 0.0003, domain: 0.0000) LR: 4.42e-06 
π“ Codebook: 202/1024 (19.7%) Top5:[566,728,339,168,619,929,364,574,2,694,680,614,290,519,793]


π”¬ Encoder Diversity (iter 1480):
  Avg similarity: 0.5040 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6942 (0.0=collapsed)
[Epoch 3/100] [Batch 152/669 (22.7%)] [Iter 1490] Loss: 1.7065 (freq: 0.7059, raw: 1.0003, quant: 0.0004, domain: 0.0000) LR: 4.45e-06 
π“ Codebook: 224/1024 (21.9%) Top5:[566,339,728,694,290,722,929,619,364,98,168,2,653,574,680]


π”¬ Encoder Diversity (iter 1490):
  Avg similarity: 0.5244 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6707 (0.0=collapsed)
[Epoch 3/100] [Batch 162/669 (24.2%)] [Iter 1500] Loss: 1.6026 (freq: 0.6007, raw: 1.0015, quant: 0.0003, domain: 0.0000) LR: 4.48e-06 
π“ Codebook: 195/1024 (19.0%) Top5:[566,339,728,290,364,619,694,2,722,168,929,98,340,574,653]


π”¬ Encoder Diversity (iter 1500):
  Avg similarity: 0.4948 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7046 (0.0=collapsed)
[Epoch 3/100] [Batch 172/669 (25.7%)] [Iter 1510] Loss: 1.6130 (freq: 0.6120, raw: 1.0007, quant: 0.0003, domain: 0.0000) LR: 4.51e-06 
π“ Codebook: 245/1024 (23.9%) Top5:[566,339,364,619,728,168,929,2,290,694,574,680,340,722,163]


π”¬ Encoder Diversity (iter 1510):
  Avg similarity: 0.5167 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6807 (0.0=collapsed)
[Epoch 3/100] [Batch 182/669 (27.2%)] [Iter 1520] Loss: 1.8403 (freq: 0.8386, raw: 1.0013, quant: 0.0004, domain: 0.0000) LR: 4.54e-06 
π“ Codebook: 235/1024 (22.9%) Top5:[566,339,364,619,694,728,722,653,340,98,2,136,290,168,929]


π”¬ Encoder Diversity (iter 1520):
  Avg similarity: 0.5336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6732 (0.0=collapsed)
[Epoch 3/100] [Batch 192/669 (28.7%)] [Iter 1530] Loss: 1.7415 (freq: 0.7410, raw: 1.0002, quant: 0.0003, domain: 0.0000) LR: 4.57e-06 
π“ Codebook: 241/1024 (23.5%) Top5:[566,364,619,339,728,168,340,694,98,722,2,136,574,653,680]


π”¬ Encoder Diversity (iter 1530):
  Avg similarity: 0.5080 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6950 (0.0=collapsed)
[Epoch 3/100] [Batch 202/669 (30.2%)] [Iter 1540] Loss: 1.7908 (freq: 0.7901, raw: 1.0003, quant: 0.0004, domain: 0.0000) LR: 4.60e-06 
π“ Codebook: 210/1024 (20.5%) Top5:[566,619,728,339,364,168,694,136,340,98,722,653,138,680,574]


π”¬ Encoder Diversity (iter 1540):
  Avg similarity: 0.5142 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6916 (0.0=collapsed)
[Epoch 3/100] [Batch 212/669 (31.7%)] [Iter 1550] Loss: 1.8717 (freq: 0.8708, raw: 1.0005, quant: 0.0004, domain: 0.0000) LR: 4.63e-06 
π“ Codebook: 143/1024 (14.0%) Top5:[566,619,339,728,364,168,722,98,694,136,340,2,653,574,138]


π”¬ Encoder Diversity (iter 1550):
  Avg similarity: 0.4967 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7096 (0.0=collapsed)
[Epoch 3/100] [Batch 222/669 (33.2%)] [Iter 1560] Loss: 1.4216 (freq: 0.4201, raw: 1.0013, quant: 0.0003, domain: 0.0000) LR: 4.66e-06 
π“ Codebook: 139/1024 (13.6%) Top5:[566,339,728,619,364,574,929,98,168,2,722,340,680,793,694]


π”¬ Encoder Diversity (iter 1560):
  Avg similarity: 0.5035 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6969 (0.0=collapsed)
[Epoch 3/100] [Batch 232/669 (34.7%)] [Iter 1570] Loss: 1.7658 (freq: 0.7634, raw: 1.0021, quant: 0.0004, domain: 0.0000) LR: 4.69e-06 
π“ Codebook: 173/1024 (16.9%) Top5:[566,339,168,728,619,722,98,694,364,136,735,290,340,138,2]


π”¬ Encoder Diversity (iter 1570):
  Avg similarity: 0.4575 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7253 (0.0=collapsed)
[Epoch 3/100] [Batch 242/669 (36.2%)] [Iter 1580] Loss: 1.6823 (freq: 0.6814, raw: 1.0005, quant: 0.0004, domain: 0.0000) LR: 4.72e-06 
π“ Codebook: 156/1024 (15.2%) Top5:[566,339,364,728,619,98,168,694,929,722,340,574,2,136,163]


π”¬ Encoder Diversity (iter 1580):
  Avg similarity: 0.4555 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7243 (0.0=collapsed)
[Epoch 3/100] [Batch 252/669 (37.7%)] [Iter 1590] Loss: 1.6856 (freq: 0.6838, raw: 1.0013, quant: 0.0004, domain: 0.0000) LR: 4.75e-06 
π“ Codebook: 166/1024 (16.2%) Top5:[566,339,364,619,728,168,98,694,722,340,2,136,929,653,229]


π”¬ Encoder Diversity (iter 1590):
  Avg similarity: 0.4585 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7315 (0.0=collapsed)
[Epoch 3/100] [Batch 262/669 (39.2%)] [Iter 1600] Loss: 1.6821 (freq: 0.6809, raw: 1.0008, quant: 0.0004, domain: 0.0000) LR: 4.78e-06 
π“ Codebook: 212/1024 (20.7%) Top5:[566,339,364,98,619,929,168,163,574,728,694,340,519,680,229]


π”¬ Encoder Diversity (iter 1600):
  Avg similarity: 0.4707 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7324 (0.0=collapsed)
[Epoch 3/100] [Batch 272/669 (40.7%)] [Iter 1610] Loss: 1.4369 (freq: 0.4364, raw: 1.0002, quant: 0.0003, domain: 0.0000) LR: 4.81e-06 
π“ Codebook: 193/1024 (18.8%) Top5:[566,339,364,619,98,340,694,728,929,163,168,2,574,229,519]


π”¬ Encoder Diversity (iter 1610):
  Avg similarity: 0.4249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7519 (0.0=collapsed)
[Epoch 3/100] [Batch 282/669 (42.2%)] [Iter 1620] Loss: 1.8118 (freq: 0.8100, raw: 1.0013, quant: 0.0005, domain: 0.0000) LR: 4.84e-06 
π“ Codebook: 191/1024 (18.7%) Top5:[566,339,728,98,364,694,619,340,2,168,229,653,929,163,136]


π”¬ Encoder Diversity (iter 1620):
  Avg similarity: 0.3999 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7509 (0.0=collapsed)
[Epoch 3/100] [Batch 292/669 (43.6%)] [Iter 1630] Loss: 1.7034 (freq: 0.7024, raw: 1.0005, quant: 0.0004, domain: 0.0000) LR: 4.87e-06 
π“ Codebook: 209/1024 (20.4%) Top5:[566,653,339,136,694,728,98,229,722,168,929,163,735,793,519]


π”¬ Encoder Diversity (iter 1630):
  Avg similarity: 0.4775 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7182 (0.0=collapsed)
[Epoch 3/100] [Batch 302/669 (45.1%)] [Iter 1640] Loss: 1.8289 (freq: 0.8256, raw: 1.0028, quant: 0.0005, domain: 0.0000) LR: 4.90e-06 
π“ Codebook: 202/1024 (19.7%) Top5:[566,339,728,340,619,2,229,168,848,722,364,929,163,735,136]


π”¬ Encoder Diversity (iter 1640):
  Avg similarity: 0.3892 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7609 (0.0=collapsed)
[Epoch 3/100] [Batch 312/669 (46.6%)] [Iter 1650] Loss: 1.4260 (freq: 0.4245, raw: 1.0012, quant: 0.0004, domain: 0.0000) LR: 4.93e-06 
π“ Codebook: 249/1024 (24.3%) Top5:[566,339,728,619,340,364,2,793,722,614,136,229,848,929,163]


π”¬ Encoder Diversity (iter 1650):
  Avg similarity: 0.4435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7363 (0.0=collapsed)
[Epoch 3/100] [Batch 322/669 (48.1%)] [Iter 1660] Loss: 1.4017 (freq: 0.4013, raw: 0.9999, quant: 0.0004, domain: 0.0000) LR: 4.96e-06 
π“ Codebook: 257/1024 (25.1%) Top5:[566,339,229,929,728,619,722,98,136,519,574,340,163,168,364]


π”¬ Encoder Diversity (iter 1660):
  Avg similarity: 0.3784 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7813 (0.0=collapsed)
[Epoch 3/100] [Batch 332/669 (49.6%)] [Iter 1670] Loss: 1.4638 (freq: 0.4607, raw: 1.0026, quant: 0.0004, domain: 0.0000) LR: 4.99e-06 
π“ Codebook: 307/1024 (30.0%) Top5:[566,339,136,229,653,619,98,364,722,168,340,728,694,848,735]


π”¬ Encoder Diversity (iter 1670):
  Avg similarity: 0.3904 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7710 (0.0=collapsed)
[Epoch 3/100] [Batch 342/669 (51.1%)] [Iter 1680] Loss: 1.6653 (freq: 0.6636, raw: 1.0012, quant: 0.0005, domain: 0.0000) LR: 5.02e-06 
π“ Codebook: 268/1024 (26.2%) Top5:[566,339,364,619,653,229,340,519,574,929,168,848,136,728,680]


π”¬ Encoder Diversity (iter 1680):
  Avg similarity: 0.4104 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7639 (0.0=collapsed)
[Epoch 3/100] [Batch 352/669 (52.6%)] [Iter 1690] Loss: 1.6190 (freq: 0.6167, raw: 1.0018, quant: 0.0005, domain: 0.0000) LR: 5.05e-06 
π“ Codebook: 285/1024 (27.8%) Top5:[566,339,364,168,229,619,653,340,929,136,722,848,574,519,735]


π”¬ Encoder Diversity (iter 1690):
  Avg similarity: 0.4050 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7601 (0.0=collapsed)
[Epoch 3/100] [Batch 362/669 (54.1%)] [Iter 1700] Loss: 1.5202 (freq: 0.5178, raw: 1.0020, quant: 0.0004, domain: 0.0000) LR: 5.08e-06 
π“ Codebook: 252/1024 (24.6%) Top5:[566,653,339,364,722,929,136,619,574,168,519,229,340,848,694]


π”¬ Encoder Diversity (iter 1700):
  Avg similarity: 0.4528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7467 (0.0=collapsed)
[Epoch 3/100] [Batch 372/669 (55.6%)] [Iter 1710] Loss: 1.6628 (freq: 0.6595, raw: 1.0028, quant: 0.0004, domain: 0.0000) LR: 5.11e-06 
π“ Codebook: 244/1024 (23.8%) Top5:[566,339,364,168,619,229,929,574,340,728,519,848,98,163,735]


π”¬ Encoder Diversity (iter 1710):
  Avg similarity: 0.4010 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7636 (0.0=collapsed)
[Epoch 3/100] [Batch 382/669 (57.1%)] [Iter 1720] Loss: 1.6244 (freq: 0.6208, raw: 1.0032, quant: 0.0004, domain: 0.0000) LR: 5.14e-06 
π“ Codebook: 241/1024 (23.5%) Top5:[566,339,722,364,653,136,168,728,574,619,929,229,848,2,340]


π”¬ Encoder Diversity (iter 1720):
  Avg similarity: 0.3857 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7741 (0.0=collapsed)
[Epoch 3/100] [Batch 392/669 (58.6%)] [Iter 1730] Loss: 1.5578 (freq: 0.5560, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 5.17e-06 
π“ Codebook: 218/1024 (21.3%) Top5:[566,339,722,364,728,168,136,653,229,848,2,929,619,735,694]


π”¬ Encoder Diversity (iter 1730):
  Avg similarity: 0.3751 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7786 (0.0=collapsed)
[Epoch 3/100] [Batch 402/669 (60.1%)] [Iter 1740] Loss: 1.5206 (freq: 0.5240, raw: 0.9963, quant: 0.0004, domain: 0.0000) LR: 5.20e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[566,339,364,722,728,136,168,653,229,163,574,848,619,694,929]


π”¬ Encoder Diversity (iter 1740):
  Avg similarity: 0.4349 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7388 (0.0=collapsed)
[Epoch 3/100] [Batch 412/669 (61.6%)] [Iter 1750] Loss: 1.6192 (freq: 0.6179, raw: 1.0010, quant: 0.0003, domain: 0.0000) LR: 5.23e-06 
π“ Codebook: 197/1024 (19.2%) Top5:[566,364,728,339,619,136,653,722,2,163,574,848,694,793,614]


π”¬ Encoder Diversity (iter 1750):
  Avg similarity: 0.4154 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7504 (0.0=collapsed)
[Epoch 3/100] [Batch 422/669 (63.1%)] [Iter 1760] Loss: 1.8084 (freq: 0.8068, raw: 1.0012, quant: 0.0004, domain: 0.0000) LR: 5.26e-06 
π“ Codebook: 181/1024 (17.7%) Top5:[566,364,339,728,653,619,168,848,229,136,2,340,722,694,679]


π”¬ Encoder Diversity (iter 1760):
  Avg similarity: 0.4482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7366 (0.0=collapsed)
[Epoch 3/100] [Batch 432/669 (64.6%)] [Iter 1770] Loss: 1.6680 (freq: 0.6671, raw: 1.0005, quant: 0.0004, domain: 0.0000) LR: 5.29e-06 
π“ Codebook: 267/1024 (26.1%) Top5:[566,364,339,728,653,619,168,340,722,848,136,679,519,574,694]


π”¬ Encoder Diversity (iter 1770):
  Avg similarity: 0.4247 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7612 (0.0=collapsed)
[Epoch 3/100] [Batch 442/669 (66.1%)] [Iter 1780] Loss: 1.5473 (freq: 0.5466, raw: 1.0004, quant: 0.0004, domain: 0.0000) LR: 5.32e-06 
π“ Codebook: 221/1024 (21.6%) Top5:[566,339,364,653,728,619,168,340,722,848,679,694,229,98,163]


π”¬ Encoder Diversity (iter 1780):
  Avg similarity: 0.4022 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7716 (0.0=collapsed)
[Epoch 3/100] [Batch 452/669 (67.6%)] [Iter 1790] Loss: 1.6361 (freq: 0.6354, raw: 1.0003, quant: 0.0004, domain: 0.0000) LR: 5.35e-06 
π“ Codebook: 199/1024 (19.4%) Top5:[566,653,339,364,168,728,574,722,619,136,98,929,163,680,679]


π”¬ Encoder Diversity (iter 1790):
  Avg similarity: 0.4002 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7582 (0.0=collapsed)
[Epoch 3/100] [Batch 462/669 (69.1%)] [Iter 1800] Loss: 1.6959 (freq: 0.6948, raw: 1.0008, quant: 0.0003, domain: 0.0000) LR: 5.38e-06 
π“ Codebook: 217/1024 (21.2%) Top5:[566,339,364,653,728,722,168,136,574,929,619,98,163,229,848]


π”¬ Encoder Diversity (iter 1800):
  Avg similarity: 0.3602 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7860 (0.0=collapsed)
[Epoch 3/100] [Batch 472/669 (70.6%)] [Iter 1810] Loss: 1.7013 (freq: 0.6991, raw: 1.0018, quant: 0.0004, domain: 0.0000) LR: 5.41e-06 
π“ Codebook: 222/1024 (21.7%) Top5:[566,339,364,728,722,653,929,168,136,574,163,619,98,614,694]


π”¬ Encoder Diversity (iter 1810):
  Avg similarity: 0.3863 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7728 (0.0=collapsed)
[Epoch 3/100] [Batch 482/669 (72.0%)] [Iter 1820] Loss: 1.5038 (freq: 0.5033, raw: 1.0002, quant: 0.0003, domain: 0.0000) LR: 5.44e-06 
π“ Codebook: 214/1024 (20.9%) Top5:[566,364,339,728,168,619,2,722,136,229,848,163,929,574,653]


π”¬ Encoder Diversity (iter 1820):
  Avg similarity: 0.4150 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7422 (0.0=collapsed)
[Epoch 3/100] [Batch 492/669 (73.5%)] [Iter 1830] Loss: 1.6666 (freq: 0.6645, raw: 1.0018, quant: 0.0004, domain: 0.0000) LR: 5.47e-06 
π“ Codebook: 205/1024 (20.0%) Top5:[566,364,728,168,339,619,229,929,793,614,163,519,2,574,735]


π”¬ Encoder Diversity (iter 1830):
  Avg similarity: 0.4189 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7485 (0.0=collapsed)
[Epoch 3/100] [Batch 502/669 (75.0%)] [Iter 1840] Loss: 1.7529 (freq: 0.7542, raw: 0.9984, quant: 0.0003, domain: 0.0000) LR: 5.50e-06 
π“ Codebook: 163/1024 (15.9%) Top5:[566,728,364,619,168,136,339,229,848,340,653,694,2,679,722]


π”¬ Encoder Diversity (iter 1840):
  Avg similarity: 0.4370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7369 (0.0=collapsed)
[Epoch 3/100] [Batch 512/669 (76.5%)] [Iter 1850] Loss: 1.7036 (freq: 0.7025, raw: 1.0007, quant: 0.0004, domain: 0.0000) LR: 5.53e-06 
π“ Codebook: 160/1024 (15.6%) Top5:[566,728,364,619,168,339,340,679,229,848,138,653,519,793,680]


π”¬ Encoder Diversity (iter 1850):
  Avg similarity: 0.4295 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7434 (0.0=collapsed)
[Epoch 3/100] [Batch 522/669 (78.0%)] [Iter 1860] Loss: 1.6044 (freq: 0.6080, raw: 0.9960, quant: 0.0004, domain: 0.0000) LR: 5.56e-06 
π“ Codebook: 146/1024 (14.3%) Top5:[566,364,728,619,339,340,653,168,680,848,574,163,793,519,679]


π”¬ Encoder Diversity (iter 1860):
  Avg similarity: 0.3993 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7800 (0.0=collapsed)
[Epoch 3/100] [Batch 532/669 (79.5%)] [Iter 1870] Loss: 1.7226 (freq: 0.7216, raw: 1.0006, quant: 0.0003, domain: 0.0000) LR: 5.59e-06 
π“ Codebook: 152/1024 (14.8%) Top5:[566,653,339,364,728,619,168,679,722,340,848,680,138,229,98]


π”¬ Encoder Diversity (iter 1870):
  Avg similarity: 0.3760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7689 (0.0=collapsed)
[Epoch 3/100] [Batch 542/669 (81.0%)] [Iter 1880] Loss: 1.6250 (freq: 0.6249, raw: 0.9997, quant: 0.0004, domain: 0.0000) LR: 5.62e-06 
π“ Codebook: 138/1024 (13.5%) Top5:[653,566,339,364,722,728,619,679,168,340,574,98,163,848,793]


π”¬ Encoder Diversity (iter 1880):
  Avg similarity: 0.4096 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7591 (0.0=collapsed)
[Epoch 3/100] [Batch 552/669 (82.5%)] [Iter 1890] Loss: 1.3405 (freq: 0.3400, raw: 1.0002, quant: 0.0003, domain: 0.0000) LR: 5.65e-06 
π“ Codebook: 183/1024 (17.9%) Top5:[566,653,339,722,364,168,679,619,728,98,574,929,340,229,163]


π”¬ Encoder Diversity (iter 1890):
  Avg similarity: 0.3586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7844 (0.0=collapsed)
[Epoch 3/100] [Batch 562/669 (84.0%)] [Iter 1900] Loss: 1.7768 (freq: 0.7749, raw: 1.0015, quant: 0.0004, domain: 0.0000) LR: 5.68e-06 
π“ Codebook: 163/1024 (15.9%) Top5:[339,566,364,653,728,619,722,168,929,340,848,679,574,2,98]


π”¬ Encoder Diversity (iter 1900):
  Avg similarity: 0.3691 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7801 (0.0=collapsed)
[Epoch 3/100] [Batch 572/669 (85.5%)] [Iter 1910] Loss: 1.7711 (freq: 0.7704, raw: 1.0003, quant: 0.0004, domain: 0.0000) LR: 5.71e-06 
π“ Codebook: 152/1024 (14.8%) Top5:[566,339,364,653,722,728,168,619,679,2,848,229,138,340,929]


π”¬ Encoder Diversity (iter 1910):
  Avg similarity: 0.4149 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7613 (0.0=collapsed)
[Epoch 3/100] [Batch 582/669 (87.0%)] [Iter 1920] Loss: 1.5928 (freq: 0.5928, raw: 0.9997, quant: 0.0003, domain: 0.0000) LR: 5.74e-06 
π“ Codebook: 164/1024 (16.0%) Top5:[566,168,364,339,722,653,728,679,619,929,229,163,574,614,138]


π”¬ Encoder Diversity (iter 1920):
  Avg similarity: 0.3713 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7594 (0.0=collapsed)
[Epoch 3/100] [Batch 592/669 (88.5%)] [Iter 1930] Loss: 1.5743 (freq: 0.5743, raw: 0.9997, quant: 0.0003, domain: 0.0000) LR: 5.77e-06 
π“ Codebook: 155/1024 (15.1%) Top5:[566,728,364,653,722,168,339,619,2,614,694,679,574,929,163]


π”¬ Encoder Diversity (iter 1930):
  Avg similarity: 0.4188 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7480 (0.0=collapsed)
[Epoch 3/100] [Batch 602/669 (90.0%)] [Iter 1940] Loss: 1.5326 (freq: 0.5317, raw: 1.0006, quant: 0.0003, domain: 0.0000) LR: 5.80e-06 
π“ Codebook: 103/1024 (10.1%) Top5:[653,722,566,364,728,339,614,168,694,163,619,574,793,929,2]


π”¬ Encoder Diversity (iter 1940):
  Avg similarity: 0.4150 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7420 (0.0=collapsed)
[Epoch 3/100] [Batch 612/669 (91.5%)] [Iter 1950] Loss: 1.7267 (freq: 0.7250, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 5.83e-06 
π“ Codebook: 165/1024 (16.1%) Top5:[566,728,653,364,619,168,2,339,694,722,679,848,138,229,340]


π”¬ Encoder Diversity (iter 1950):
  Avg similarity: 0.4332 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7458 (0.0=collapsed)
[Epoch 3/100] [Batch 622/669 (93.0%)] [Iter 1960] Loss: 1.5849 (freq: 0.5847, raw: 0.9998, quant: 0.0004, domain: 0.0000) LR: 5.86e-06 
π“ Codebook: 213/1024 (20.8%) Top5:[566,728,364,619,339,2,653,168,340,848,679,138,229,793,163]


π”¬ Encoder Diversity (iter 1960):
  Avg similarity: 0.4194 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7597 (0.0=collapsed)
[Epoch 3/100] [Batch 632/669 (94.5%)] [Iter 1970] Loss: 1.7187 (freq: 0.7173, raw: 1.0010, quant: 0.0004, domain: 0.0000) LR: 5.89e-06 
π“ Codebook: 216/1024 (21.1%) Top5:[566,653,168,364,339,679,728,619,694,138,229,340,848,722,2]


π”¬ Encoder Diversity (iter 1970):
  Avg similarity: 0.5140 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.6954 (0.0=collapsed)
[Epoch 3/100] [Batch 642/669 (96.0%)] [Iter 1980] Loss: 1.6882 (freq: 0.6872, raw: 1.0005, quant: 0.0004, domain: 0.0000) LR: 5.92e-06 
π“ Codebook: 243/1024 (23.7%) Top5:[566,339,364,728,653,168,679,619,340,848,2,722,229,138,290]


π”¬ Encoder Diversity (iter 1980):
  Avg similarity: 0.3822 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7812 (0.0=collapsed)
[Epoch 3/100] [Batch 652/669 (97.5%)] [Iter 1990] Loss: 1.5476 (freq: 0.5474, raw: 0.9999, quant: 0.0004, domain: 0.0000) LR: 5.95e-06 
π“ Codebook: 223/1024 (21.8%) Top5:[566,653,339,364,168,722,728,679,619,694,136,680,340,929,98]


π”¬ Encoder Diversity (iter 1990):
  Avg similarity: 0.3529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8000 (0.0=collapsed)
[Epoch 3/100] [Batch 662/669 (99.0%)] [Iter 2000] Loss: 1.4898 (freq: 0.4921, raw: 0.9972, quant: 0.0005, domain: 0.0000) LR: 5.98e-06 
π“ Codebook: 221/1024 (21.6%) Top5:[566,653,339,364,168,722,679,728,619,136,138,229,163,574,680]


π”¬ Encoder Diversity (iter 2000):
  Avg similarity: 0.3291 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7745 (0.0=collapsed)

================================================================================
[Epoch 3] Validation Results:
  Total Loss: 1.2792
  Freq Loss:  0.2783
  Raw Loss:   1.0006
  Quant Loss: 0.0003
  π“ Codebook Usage: 23/1024 (2.2%)
  π“ Codebook Entropy: 2.4799 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 117143 (90.0%)
  Top 10 most used codes:
    1. Code 653: 24594 times (18.89%)
    2. Code 722: 23412 times (17.98%)
    3. Code 136: 10788 times (8.29%)
    4. Code 574: 10036 times (7.71%)
    5. Code 694: 9821 times (7.54%)
    6. Code 929: 9327 times (7.16%)
    7. Code 680: 8978 times (6.90%)
    8. Code 98: 8589 times (6.60%)
    9. Code 163: 6738 times (5.18%)
    10. Code 519: 4860 times (3.73%)
  Bottom 5 least used codes (among used):
    1. Code 229: 21 times (0.02%)
    2. Code 735: 27 times (0.02%)
    3. Code 679: 77 times (0.06%)
    4. Code 340: 246 times (0.19%)
    5. Code 2: 300 times (0.23%)
================================================================================

[EarlyStopping] Best model saved at epoch 3
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 4/100] [Batch 3/669 (0.4%)] [Iter 2010] Loss: 1.7337 (freq: 0.7312, raw: 1.0021, quant: 0.0004, domain: 0.0000) LR: 6.01e-06 
π“ Codebook: 595/1024 (58.1%) Top5:[566,653,364,168,722,728,339,679,619,929,2,848,694,340,574]


π”¬ Encoder Diversity (iter 2010):
  Avg similarity: 0.3618 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7921 (0.0=collapsed)
[Epoch 4/100] [Batch 13/669 (1.9%)] [Iter 2020] Loss: 1.4082 (freq: 0.4065, raw: 1.0014, quant: 0.0003, domain: 0.0000) LR: 6.04e-06 
π“ Codebook: 853/1024 (83.3%) Top5:[566,364,339,653,722,728,168,679,619,694,848,2,340,163,929]


π”¬ Encoder Diversity (iter 2020):
  Avg similarity: 0.3713 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7841 (0.0=collapsed)
[Epoch 4/100] [Batch 23/669 (3.4%)] [Iter 2030] Loss: 1.4921 (freq: 0.4977, raw: 0.9940, quant: 0.0004, domain: 0.0000) LR: 6.07e-06 
π“ Codebook: 567/1024 (55.4%) Top5:[566,364,339,722,728,168,653,679,619,929,163,2,340,574,848]


π”¬ Encoder Diversity (iter 2030):
  Avg similarity: 0.3283 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8059 (0.0=collapsed)
[Epoch 4/100] [Batch 33/669 (4.9%)] [Iter 2040] Loss: 1.5673 (freq: 0.5661, raw: 1.0008, quant: 0.0003, domain: 0.0000) LR: 6.10e-06 
π“ Codebook: 418/1024 (40.8%) Top5:[566,722,168,679,653,364,728,694,339,163,894,619,574,614,700]


π”¬ Encoder Diversity (iter 2040):
  Avg similarity: 0.3490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7999 (0.0=collapsed)
[Epoch 4/100] [Batch 43/669 (6.4%)] [Iter 2050] Loss: 1.6232 (freq: 0.6223, raw: 1.0005, quant: 0.0003, domain: 0.0000) LR: 6.13e-06 
π“ Codebook: 377/1024 (36.8%) Top5:[566,722,653,694,168,679,364,339,728,619,2,848,163,340,574]


π”¬ Encoder Diversity (iter 2050):
  Avg similarity: 0.3371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7934 (0.0=collapsed)
[Epoch 4/100] [Batch 53/669 (7.9%)] [Iter 2060] Loss: 1.7024 (freq: 0.7005, raw: 1.0014, quant: 0.0004, domain: 0.0000) LR: 6.16e-06 
π“ Codebook: 331/1024 (32.3%) Top5:[566,728,364,722,694,653,339,619,168,679,340,2,848,700,894]


π”¬ Encoder Diversity (iter 2060):
  Avg similarity: 0.3761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7681 (0.0=collapsed)
[Epoch 4/100] [Batch 63/669 (9.4%)] [Iter 2070] Loss: 1.5298 (freq: 0.5294, raw: 1.0001, quant: 0.0003, domain: 0.0000) LR: 6.19e-06 
π“ Codebook: 272/1024 (26.6%) Top5:[566,364,728,653,619,722,694,339,340,168,679,136,848,680,793]


π”¬ Encoder Diversity (iter 2070):
  Avg similarity: 0.3175 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8022 (0.0=collapsed)
[Epoch 4/100] [Batch 73/669 (10.9%)] [Iter 2080] Loss: 1.7073 (freq: 0.7077, raw: 0.9993, quant: 0.0004, domain: 0.0000) LR: 6.22e-06 
π“ Codebook: 296/1024 (28.9%) Top5:[566,364,728,339,619,168,340,2,848,653,679,722,700,694,514]


π”¬ Encoder Diversity (iter 2080):
  Avg similarity: 0.3288 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8002 (0.0=collapsed)
[Epoch 4/100] [Batch 83/669 (12.4%)] [Iter 2090] Loss: 1.6475 (freq: 0.6481, raw: 0.9990, quant: 0.0004, domain: 0.0000) LR: 6.25e-06 
π“ Codebook: 246/1024 (24.0%) Top5:[566,364,653,728,339,722,168,619,340,694,679,2,136,848,793]


π”¬ Encoder Diversity (iter 2090):
  Avg similarity: 0.3219 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8000 (0.0=collapsed)
[Epoch 4/100] [Batch 93/669 (13.9%)] [Iter 2100] Loss: 1.6046 (freq: 0.6066, raw: 0.9974, quant: 0.0006, domain: 0.0000) LR: 6.28e-06 
π“ Codebook: 250/1024 (24.4%) Top5:[566,364,339,168,728,653,679,722,619,2,340,694,894,848,700]


π”¬ Encoder Diversity (iter 2100):
  Avg similarity: 0.3482 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7821 (0.0=collapsed)
[Epoch 4/100] [Batch 103/669 (15.4%)] [Iter 2110] Loss: 1.5691 (freq: 0.5692, raw: 0.9995, quant: 0.0005, domain: 0.0000) LR: 6.31e-06 
π“ Codebook: 230/1024 (22.5%) Top5:[566,722,168,653,364,679,339,694,728,894,163,619,929,793,700]


π”¬ Encoder Diversity (iter 2110):
  Avg similarity: 0.3364 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8010 (0.0=collapsed)
[Epoch 4/100] [Batch 113/669 (16.9%)] [Iter 2120] Loss: 1.6204 (freq: 0.6281, raw: 0.9918, quant: 0.0005, domain: 0.0000) LR: 6.34e-06 
π“ Codebook: 271/1024 (26.5%) Top5:[364,566,728,722,653,339,168,2,679,619,694,340,848,929,894]


π”¬ Encoder Diversity (iter 2120):
  Avg similarity: 0.3156 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8025 (0.0=collapsed)
[Epoch 4/100] [Batch 123/669 (18.4%)] [Iter 2130] Loss: 1.5941 (freq: 0.5929, raw: 1.0008, quant: 0.0004, domain: 0.0000) LR: 6.37e-06 
π“ Codebook: 191/1024 (18.7%) Top5:[566,168,364,653,722,728,574,700,679,339,163,929,619,136,98]


π”¬ Encoder Diversity (iter 2130):
  Avg similarity: 0.3133 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7987 (0.0=collapsed)
[Epoch 4/100] [Batch 133/669 (19.9%)] [Iter 2140] Loss: 1.6802 (freq: 0.6785, raw: 1.0012, quant: 0.0004, domain: 0.0000) LR: 6.40e-06 
π“ Codebook: 187/1024 (18.3%) Top5:[566,364,653,339,722,728,168,619,679,694,2,340,700,163,136]


π”¬ Encoder Diversity (iter 2140):
  Avg similarity: 0.3225 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8001 (0.0=collapsed)
[Epoch 4/100] [Batch 143/669 (21.4%)] [Iter 2150] Loss: 1.6650 (freq: 0.6638, raw: 1.0008, quant: 0.0005, domain: 0.0000) LR: 6.43e-06 
π“ Codebook: 175/1024 (17.1%) Top5:[566,339,364,653,168,722,728,679,619,694,340,2,700,848,793]


π”¬ Encoder Diversity (iter 2150):
  Avg similarity: 0.3335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8116 (0.0=collapsed)
[Epoch 4/100] [Batch 153/669 (22.9%)] [Iter 2160] Loss: 1.5388 (freq: 0.5399, raw: 0.9985, quant: 0.0004, domain: 0.0000) LR: 6.46e-06 
π“ Codebook: 172/1024 (16.8%) Top5:[566,339,364,653,722,728,679,168,619,694,340,574,136,848,163]


π”¬ Encoder Diversity (iter 2160):
  Avg similarity: 0.3663 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7704 (0.0=collapsed)
[Epoch 4/100] [Batch 163/669 (24.4%)] [Iter 2170] Loss: 1.7598 (freq: 0.7607, raw: 0.9983, quant: 0.0008, domain: 0.0000) LR: 6.49e-06 
π“ Codebook: 196/1024 (19.1%) Top5:[566,339,364,168,728,679,619,574,653,163,136,722,340,793,2]


π”¬ Encoder Diversity (iter 2170):
  Avg similarity: 0.3132 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8158 (0.0=collapsed)
[Epoch 4/100] [Batch 173/669 (25.9%)] [Iter 2180] Loss: 1.4289 (freq: 0.4294, raw: 0.9990, quant: 0.0004, domain: 0.0000) LR: 6.52e-06 
π“ Codebook: 277/1024 (27.1%) Top5:[566,339,653,722,364,728,619,168,163,2,679,340,574,614,793]


π”¬ Encoder Diversity (iter 2180):
  Avg similarity: 0.3018 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8105 (0.0=collapsed)
[Epoch 4/100] [Batch 183/669 (27.4%)] [Iter 2190] Loss: 1.6093 (freq: 0.6080, raw: 1.0008, quant: 0.0005, domain: 0.0000) LR: 6.55e-06 
π“ Codebook: 243/1024 (23.7%) Top5:[566,653,722,364,339,168,728,619,694,679,163,340,574,793,136]


π”¬ Encoder Diversity (iter 2190):
  Avg similarity: 0.2882 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8250 (0.0=collapsed)
[Epoch 4/100] [Batch 193/669 (28.8%)] [Iter 2200] Loss: 1.6453 (freq: 0.6463, raw: 0.9985, quant: 0.0005, domain: 0.0000) LR: 6.57e-06 
π“ Codebook: 246/1024 (24.0%) Top5:[566,728,339,364,653,168,619,2,722,793,340,136,163,574,679]


π”¬ Encoder Diversity (iter 2200):
  Avg similarity: 0.3458 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8027 (0.0=collapsed)
[Epoch 4/100] [Batch 203/669 (30.3%)] [Iter 2210] Loss: 1.5381 (freq: 0.5427, raw: 0.9949, quant: 0.0004, domain: 0.0000) LR: 6.60e-06 
π“ Codebook: 219/1024 (21.4%) Top5:[566,653,722,168,364,619,728,339,2,679,694,340,700,793,848]


π”¬ Encoder Diversity (iter 2210):
  Avg similarity: 0.3034 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8210 (0.0=collapsed)
[Epoch 4/100] [Batch 213/669 (31.8%)] [Iter 2220] Loss: 1.6417 (freq: 0.6420, raw: 0.9993, quant: 0.0004, domain: 0.0000) LR: 6.63e-06 
π“ Codebook: 256/1024 (25.0%) Top5:[566,168,364,339,653,722,574,679,728,619,700,163,136,614,793]


π”¬ Encoder Diversity (iter 2220):
  Avg similarity: 0.2898 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8225 (0.0=collapsed)
[Epoch 4/100] [Batch 223/669 (33.3%)] [Iter 2230] Loss: 1.7273 (freq: 0.7252, raw: 1.0015, quant: 0.0006, domain: 0.0000) LR: 6.66e-06 
π“ Codebook: 255/1024 (24.9%) Top5:[566,339,364,728,168,653,722,679,619,2,340,700,848,574,894]


π”¬ Encoder Diversity (iter 2230):
  Avg similarity: 0.3725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7731 (0.0=collapsed)
[Epoch 4/100] [Batch 233/669 (34.8%)] [Iter 2240] Loss: 1.4975 (freq: 0.4987, raw: 0.9983, quant: 0.0005, domain: 0.0000) LR: 6.69e-06 
π“ Codebook: 366/1024 (35.7%) Top5:[566,339,653,364,679,722,168,574,728,619,163,136,793,2,340]


π”¬ Encoder Diversity (iter 2240):
  Avg similarity: 0.2889 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8297 (0.0=collapsed)
[Epoch 4/100] [Batch 243/669 (36.3%)] [Iter 2250] Loss: 1.4123 (freq: 0.4135, raw: 0.9984, quant: 0.0004, domain: 0.0000) LR: 6.72e-06 
π“ Codebook: 302/1024 (29.5%) Top5:[566,653,339,722,364,619,679,168,728,340,694,848,574,136,793]


π”¬ Encoder Diversity (iter 2250):
  Avg similarity: 0.2713 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8411 (0.0=collapsed)
[Epoch 4/100] [Batch 253/669 (37.8%)] [Iter 2260] Loss: 1.6676 (freq: 0.6688, raw: 0.9983, quant: 0.0005, domain: 0.0000) LR: 6.75e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[566,364,339,619,168,653,722,728,340,679,848,700,2,694,514]


π”¬ Encoder Diversity (iter 2260):
  Avg similarity: 0.2977 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8265 (0.0=collapsed)
[Epoch 4/100] [Batch 263/669 (39.3%)] [Iter 2270] Loss: 1.7407 (freq: 0.7412, raw: 0.9990, quant: 0.0005, domain: 0.0000) LR: 6.78e-06 
π“ Codebook: 182/1024 (17.8%) Top5:[364,339,566,619,728,653,340,168,722,2,679,848,694,700,136]


π”¬ Encoder Diversity (iter 2270):
  Avg similarity: 0.3133 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8113 (0.0=collapsed)
[Epoch 4/100] [Batch 273/669 (40.8%)] [Iter 2280] Loss: 1.6926 (freq: 0.6915, raw: 1.0005, quant: 0.0006, domain: 0.0000) LR: 6.81e-06 
π“ Codebook: 180/1024 (17.6%) Top5:[566,339,168,364,653,728,163,793,722,619,679,2,574,136,614]


π”¬ Encoder Diversity (iter 2280):
  Avg similarity: 0.3060 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8203 (0.0=collapsed)
[Epoch 4/100] [Batch 283/669 (42.3%)] [Iter 2290] Loss: 1.6189 (freq: 0.6170, raw: 1.0013, quant: 0.0005, domain: 0.0000) LR: 6.84e-06 
π“ Codebook: 166/1024 (16.2%) Top5:[566,653,339,168,722,728,679,364,2,619,694,700,894,211,848]


π”¬ Encoder Diversity (iter 2290):
  Avg similarity: 0.2816 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8291 (0.0=collapsed)
[Epoch 4/100] [Batch 293/669 (43.8%)] [Iter 2300] Loss: 1.4862 (freq: 0.4828, raw: 1.0028, quant: 0.0006, domain: 0.0000) LR: 6.87e-06 
π“ Codebook: 279/1024 (27.2%) Top5:[653,722,566,339,364,694,679,619,163,168,728,136,574,340,793]


π”¬ Encoder Diversity (iter 2300):
  Avg similarity: 0.3197 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8157 (0.0=collapsed)
[Epoch 4/100] [Batch 303/669 (45.3%)] [Iter 2310] Loss: 1.6362 (freq: 0.6364, raw: 0.9992, quant: 0.0006, domain: 0.0000) LR: 6.90e-06 
π“ Codebook: 197/1024 (19.2%) Top5:[566,339,679,364,168,722,653,619,574,163,728,136,340,793,700]


π”¬ Encoder Diversity (iter 2310):
  Avg similarity: 0.2526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8461 (0.0=collapsed)
[Epoch 4/100] [Batch 313/669 (46.8%)] [Iter 2320] Loss: 1.6502 (freq: 0.6501, raw: 0.9994, quant: 0.0006, domain: 0.0000) LR: 6.93e-06 
π“ Codebook: 171/1024 (16.7%) Top5:[653,566,722,364,619,339,168,340,694,679,700,728,136,848,793]


π”¬ Encoder Diversity (iter 2320):
  Avg similarity: 0.2424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8474 (0.0=collapsed)
[Epoch 4/100] [Batch 323/669 (48.3%)] [Iter 2330] Loss: 1.5739 (freq: 0.5776, raw: 0.9959, quant: 0.0004, domain: 0.0000) LR: 6.96e-06 
π“ Codebook: 192/1024 (18.8%) Top5:[566,339,168,364,619,653,679,340,136,211,163,722,728,574,793]


π”¬ Encoder Diversity (iter 2330):
  Avg similarity: 0.2920 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8370 (0.0=collapsed)
[Epoch 4/100] [Batch 333/669 (49.8%)] [Iter 2340] Loss: 1.5372 (freq: 0.5402, raw: 0.9966, quant: 0.0005, domain: 0.0000) LR: 6.99e-06 
π“ Codebook: 250/1024 (24.4%) Top5:[653,566,339,728,722,364,619,2,679,211,340,168,694,848,793]


π”¬ Encoder Diversity (iter 2340):
  Avg similarity: 0.2848 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8355 (0.0=collapsed)
[Epoch 4/100] [Batch 343/669 (51.3%)] [Iter 2350] Loss: 1.3578 (freq: 0.3694, raw: 0.9880, quant: 0.0004, domain: 0.0000) LR: 7.02e-06 
π“ Codebook: 188/1024 (18.4%) Top5:[566,653,339,364,722,679,619,168,728,2,694,211,793,340,163]


π”¬ Encoder Diversity (iter 2350):
  Avg similarity: 0.3098 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8099 (0.0=collapsed)
[Epoch 4/100] [Batch 353/669 (52.8%)] [Iter 2360] Loss: 1.4787 (freq: 0.4936, raw: 0.9846, quant: 0.0005, domain: 0.0000) LR: 7.05e-06 
π“ Codebook: 197/1024 (19.2%) Top5:[566,653,339,623,963,793,163,722,679,364,574,136,929,614,728]


π”¬ Encoder Diversity (iter 2360):
  Avg similarity: 0.2047 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8775 (0.0=collapsed)
[Epoch 4/100] [Batch 363/669 (54.3%)] [Iter 2370] Loss: 1.6199 (freq: 0.6262, raw: 0.9932, quant: 0.0005, domain: 0.0000) LR: 7.08e-06 
π“ Codebook: 279/1024 (27.2%) Top5:[339,566,364,679,963,653,728,619,2,848,722,340,793,163,136]


π”¬ Encoder Diversity (iter 2370):
  Avg similarity: 0.2716 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8397 (0.0=collapsed)
[Epoch 4/100] [Batch 373/669 (55.8%)] [Iter 2380] Loss: 1.3844 (freq: 0.3936, raw: 0.9903, quant: 0.0004, domain: 0.0000) LR: 7.11e-06 
π“ Codebook: 272/1024 (26.6%) Top5:[653,566,722,339,364,168,679,619,963,694,340,728,700,2,848]


π”¬ Encoder Diversity (iter 2380):
  Avg similarity: 0.2319 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8589 (0.0=collapsed)
[Epoch 4/100] [Batch 383/669 (57.2%)] [Iter 2390] Loss: 1.7111 (freq: 0.7119, raw: 0.9986, quant: 0.0007, domain: 0.0000) LR: 7.14e-06 
π“ Codebook: 235/1024 (22.9%) Top5:[653,722,566,364,339,619,340,963,168,679,694,700,728,2,211]


π”¬ Encoder Diversity (iter 2390):
  Avg similarity: 0.2865 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8302 (0.0=collapsed)
[Epoch 4/100] [Batch 393/669 (58.7%)] [Iter 2400] Loss: 1.4642 (freq: 0.4818, raw: 0.9819, quant: 0.0005, domain: 0.0000) LR: 7.17e-06 
π“ Codebook: 179/1024 (17.5%) Top5:[653,722,566,963,364,679,168,694,623,619,339,136,700,340,514]


π”¬ Encoder Diversity (iter 2400):
  Avg similarity: 0.2465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8566 (0.0=collapsed)
[Epoch 4/100] [Batch 403/669 (60.2%)] [Iter 2410] Loss: 1.4751 (freq: 0.5029, raw: 0.9717, quant: 0.0005, domain: 0.0000) LR: 7.20e-06 
π“ Codebook: 236/1024 (23.0%) Top5:[653,566,722,136,364,619,339,793,574,163,679,340,728,168,623]


π”¬ Encoder Diversity (iter 2410):
  Avg similarity: 0.2666 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8365 (0.0=collapsed)
[Epoch 4/100] [Batch 413/669 (61.7%)] [Iter 2420] Loss: 1.6024 (freq: 0.6234, raw: 0.9786, quant: 0.0004, domain: 0.0000) LR: 7.23e-06 
π“ Codebook: 314/1024 (30.7%) Top5:[566,653,339,963,722,364,623,728,2,619,168,136,340,749,679]


π”¬ Encoder Diversity (iter 2420):
  Avg similarity: 0.2459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8539 (0.0=collapsed)
[Epoch 4/100] [Batch 423/669 (63.2%)] [Iter 2430] Loss: 1.5607 (freq: 0.5871, raw: 0.9730, quant: 0.0006, domain: 0.0000) LR: 7.26e-06 
π“ Codebook: 307/1024 (30.0%) Top5:[566,653,722,339,364,963,728,163,793,619,168,211,2,749,136]


π”¬ Encoder Diversity (iter 2430):
  Avg similarity: 0.2542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8634 (0.0=collapsed)
[Epoch 4/100] [Batch 433/669 (64.7%)] [Iter 2440] Loss: 1.3814 (freq: 0.4572, raw: 0.9235, quant: 0.0006, domain: 0.0000) LR: 7.29e-06 
π“ Codebook: 283/1024 (27.6%) Top5:[566,653,722,963,168,163,793,136,574,679,339,929,364,894,211]


π”¬ Encoder Diversity (iter 2440):
  Avg similarity: 0.2097 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8759 (0.0=collapsed)
[Epoch 4/100] [Batch 443/669 (66.2%)] [Iter 2450] Loss: 1.3818 (freq: 0.4434, raw: 0.9380, quant: 0.0005, domain: 0.0000) LR: 7.32e-06 
π“ Codebook: 348/1024 (34.0%) Top5:[566,963,722,653,339,168,163,136,793,679,364,574,749,894,605]


π”¬ Encoder Diversity (iter 2450):
  Avg similarity: 0.2177 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8685 (0.0=collapsed)
[Epoch 4/100] [Batch 453/669 (67.7%)] [Iter 2460] Loss: 1.3966 (freq: 0.4732, raw: 0.9230, quant: 0.0005, domain: 0.0000) LR: 7.35e-06 
π“ Codebook: 258/1024 (25.2%) Top5:[566,339,168,364,963,722,136,679,619,653,163,340,211,749,728]


π”¬ Encoder Diversity (iter 2460):
  Avg similarity: 0.1912 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8852 (0.0=collapsed)
[Epoch 4/100] [Batch 463/669 (69.2%)] [Iter 2470] Loss: 1.4937 (freq: 0.5660, raw: 0.9272, quant: 0.0005, domain: 0.0000) LR: 7.38e-06 
π“ Codebook: 230/1024 (22.5%) Top5:[566,339,963,364,168,619,722,749,340,2,728,211,679,653,605]


π”¬ Encoder Diversity (iter 2470):
  Avg similarity: 0.1974 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8780 (0.0=collapsed)
[Epoch 4/100] [Batch 473/669 (70.7%)] [Iter 2480] Loss: 1.3886 (freq: 0.4736, raw: 0.9145, quant: 0.0005, domain: 0.0000) LR: 7.41e-06 
π“ Codebook: 324/1024 (31.6%) Top5:[566,339,364,619,728,168,605,340,211,963,894,2,679,749,623]


π”¬ Encoder Diversity (iter 2480):
  Avg similarity: 0.2063 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8741 (0.0=collapsed)
[Epoch 4/100] [Batch 483/669 (72.2%)] [Iter 2490] Loss: 1.4895 (freq: 0.5357, raw: 0.9532, quant: 0.0007, domain: 0.0000) LR: 7.44e-06 
π“ Codebook: 279/1024 (27.2%) Top5:[566,168,722,605,623,700,339,894,364,619,728,679,514,694,340]


π”¬ Encoder Diversity (iter 2490):
  Avg similarity: 0.3099 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8015 (0.0=collapsed)
[Epoch 4/100] [Batch 493/669 (73.7%)] [Iter 2500] Loss: 1.3232 (freq: 0.4466, raw: 0.8761, quant: 0.0005, domain: 0.0000) LR: 7.47e-06 
π“ Codebook: 292/1024 (28.5%) Top5:[566,168,364,339,722,619,623,749,963,211,340,679,728,894,605]


π”¬ Encoder Diversity (iter 2500):
  Avg similarity: 0.1992 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8830 (0.0=collapsed)
[Epoch 4/100] [Batch 503/669 (75.2%)] [Iter 2510] Loss: 1.2328 (freq: 0.3898, raw: 0.8424, quant: 0.0006, domain: 0.0000) LR: 7.50e-06 
π“ Codebook: 338/1024 (33.0%) Top5:[566,722,168,605,623,574,653,364,163,339,679,894,963,700,136]


π”¬ Encoder Diversity (iter 2510):
  Avg similarity: 0.1950 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8796 (0.0=collapsed)
[Epoch 4/100] [Batch 513/669 (76.7%)] [Iter 2520] Loss: 1.4584 (freq: 0.5649, raw: 0.8930, quant: 0.0005, domain: 0.0000) LR: 7.53e-06 
π“ Codebook: 273/1024 (26.7%) Top5:[566,574,339,364,722,163,619,136,2,340,168,728,211,361,605]


π”¬ Encoder Diversity (iter 2520):
  Avg similarity: 0.2428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8481 (0.0=collapsed)
[Epoch 4/100] [Batch 523/669 (78.2%)] [Iter 2530] Loss: 1.3809 (freq: 0.5268, raw: 0.8536, quant: 0.0005, domain: 0.0000) LR: 7.56e-06 
π“ Codebook: 223/1024 (21.8%) Top5:[566,722,619,339,605,168,728,364,2,340,211,679,749,653,894]


π”¬ Encoder Diversity (iter 2530):
  Avg similarity: 0.3090 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8266 (0.0=collapsed)
[Epoch 4/100] [Batch 533/669 (79.7%)] [Iter 2540] Loss: 1.5511 (freq: 0.6311, raw: 0.9193, quant: 0.0007, domain: 0.0000) LR: 7.59e-06 
π“ Codebook: 232/1024 (22.7%) Top5:[566,605,722,619,339,168,364,206,728,70,623,653,574,894,2]


π”¬ Encoder Diversity (iter 2540):
  Avg similarity: 0.1960 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8795 (0.0=collapsed)
[Epoch 4/100] [Batch 543/669 (81.2%)] [Iter 2550] Loss: 1.3250 (freq: 0.4813, raw: 0.8431, quant: 0.0007, domain: 0.0000) LR: 7.62e-06 
π“ Codebook: 272/1024 (26.6%) Top5:[566,168,339,364,619,728,623,211,2,963,340,679,700,749,894]


π”¬ Encoder Diversity (iter 2550):
  Avg similarity: 0.3299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8095 (0.0=collapsed)
[Epoch 4/100] [Batch 553/669 (82.7%)] [Iter 2560] Loss: 1.4595 (freq: 0.5617, raw: 0.8973, quant: 0.0006, domain: 0.0000) LR: 7.65e-06 
π“ Codebook: 211/1024 (20.6%) Top5:[566,963,364,168,339,619,749,679,211,728,722,340,605,623,700]


π”¬ Encoder Diversity (iter 2560):
  Avg similarity: 0.1936 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8832 (0.0=collapsed)
[Epoch 4/100] [Batch 563/669 (84.2%)] [Iter 2570] Loss: 1.4225 (freq: 0.5468, raw: 0.8753, quant: 0.0005, domain: 0.0000) LR: 7.68e-06 
π“ Codebook: 211/1024 (20.6%) Top5:[566,168,963,364,722,339,679,211,574,929,605,375,653,70,749]


π”¬ Encoder Diversity (iter 2570):
  Avg similarity: 0.1917 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8671 (0.0=collapsed)
[Epoch 4/100] [Batch 573/669 (85.7%)] [Iter 2580] Loss: 1.4955 (freq: 0.5720, raw: 0.9230, quant: 0.0005, domain: 0.0000) LR: 7.71e-06 
π“ Codebook: 259/1024 (25.3%) Top5:[566,963,211,364,339,168,749,679,929,574,722,99,375,136,96]


π”¬ Encoder Diversity (iter 2580):
  Avg similarity: 0.2369 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8658 (0.0=collapsed)
[Epoch 4/100] [Batch 583/669 (87.1%)] [Iter 2590] Loss: 1.4883 (freq: 0.6201, raw: 0.8677, quant: 0.0005, domain: 0.0000) LR: 7.74e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[566,168,211,339,364,963,623,679,749,2,375,340,728,619,614]


π”¬ Encoder Diversity (iter 2590):
  Avg similarity: 0.2109 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8829 (0.0=collapsed)
[Epoch 4/100] [Batch 593/669 (88.6%)] [Iter 2600] Loss: 1.4984 (freq: 0.5806, raw: 0.9171, quant: 0.0007, domain: 0.0000) LR: 7.77e-06 
π“ Codebook: 213/1024 (20.8%) Top5:[168,566,211,339,722,364,963,605,623,206,679,749,2,340,70]


π”¬ Encoder Diversity (iter 2600):
  Avg similarity: 0.2352 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8577 (0.0=collapsed)
[Epoch 4/100] [Batch 603/669 (90.1%)] [Iter 2610] Loss: 1.3873 (freq: 0.5303, raw: 0.8565, quant: 0.0005, domain: 0.0000) LR: 7.80e-06 
π“ Codebook: 252/1024 (24.6%) Top5:[566,168,963,339,211,364,679,605,728,2,206,340,185,960,619]


π”¬ Encoder Diversity (iter 2610):
  Avg similarity: 0.3573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.7913 (0.0=collapsed)
[Epoch 4/100] [Batch 613/669 (91.6%)] [Iter 2620] Loss: 1.4818 (freq: 0.5638, raw: 0.9173, quant: 0.0008, domain: 0.0000) LR: 7.83e-06 
π“ Codebook: 213/1024 (20.8%) Top5:[566,168,963,339,364,211,605,619,185,722,749,679,206,623,340]


π”¬ Encoder Diversity (iter 2620):
  Avg similarity: 0.1857 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8942 (0.0=collapsed)
[Epoch 4/100] [Batch 623/669 (93.1%)] [Iter 2630] Loss: 1.5468 (freq: 0.6406, raw: 0.9056, quant: 0.0006, domain: 0.0000) LR: 7.86e-06 
π“ Codebook: 256/1024 (25.0%) Top5:[566,963,364,168,749,185,211,340,339,619,574,614,136,929,361]


π”¬ Encoder Diversity (iter 2630):
  Avg similarity: 0.1609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9042 (0.0=collapsed)
[Epoch 4/100] [Batch 633/669 (94.6%)] [Iter 2640] Loss: 1.5111 (freq: 0.6113, raw: 0.8992, quant: 0.0006, domain: 0.0000) LR: 7.89e-06 
π“ Codebook: 200/1024 (19.5%) Top5:[168,566,364,963,749,340,722,700,185,211,623,679,70,605,619]


π”¬ Encoder Diversity (iter 2640):
  Avg similarity: 0.2054 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8852 (0.0=collapsed)
[Epoch 4/100] [Batch 643/669 (96.1%)] [Iter 2650] Loss: 1.4587 (freq: 0.5428, raw: 0.9152, quant: 0.0007, domain: 0.0000) LR: 7.92e-06 
π“ Codebook: 208/1024 (20.3%) Top5:[566,168,722,364,70,963,211,605,340,749,206,653,445,700,679]


π”¬ Encoder Diversity (iter 2650):
  Avg similarity: 0.1608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8989 (0.0=collapsed)
[Epoch 4/100] [Batch 653/669 (97.6%)] [Iter 2660] Loss: 1.3099 (freq: 0.4803, raw: 0.8291, quant: 0.0005, domain: 0.0000) LR: 7.95e-06 
π“ Codebook: 179/1024 (17.5%) Top5:[168,566,211,623,700,722,605,339,364,206,2,340,963,679,70]


π”¬ Encoder Diversity (iter 2660):
  Avg similarity: 0.1664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9037 (0.0=collapsed)
[Epoch 4/100] [Batch 663/669 (99.1%)] [Iter 2670] Loss: 1.6280 (freq: 0.6850, raw: 0.9421, quant: 0.0009, domain: 0.0000) LR: 7.98e-06 
π“ Codebook: 193/1024 (18.8%) Top5:[566,168,623,339,605,700,206,754,679,722,963,211,375,185,364]


π”¬ Encoder Diversity (iter 2670):
  Avg similarity: 0.2112 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8790 (0.0=collapsed)

================================================================================
[Epoch 4] Validation Results:
  Total Loss: 0.9343
  Freq Loss:  0.2643
  Raw Loss:   0.6696
  Quant Loss: 0.0004
  π“ Codebook Usage: 78/1024 (7.6%)
  π“ Codebook Entropy: 3.2097 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 70649 (54.3%)
  Top 10 most used codes:
    1. Code 605: 9439 times (7.25%)
    2. Code 614: 7715 times (5.93%)
    3. Code 163: 7419 times (5.70%)
    4. Code 361: 7139 times (5.48%)
    5. Code 793: 6986 times (5.37%)
    6. Code 694: 6527 times (5.01%)
    7. Code 96: 6520 times (5.01%)
    8. Code 574: 6409 times (4.92%)
    9. Code 722: 6354 times (4.88%)
    10. Code 653: 6141 times (4.72%)
  Bottom 5 least used codes (among used):
    1. Code 766: 4 times (0.00%)
    2. Code 764: 4 times (0.00%)
    3. Code 700: 6 times (0.00%)
    4. Code 549: 6 times (0.00%)
    5. Code 517: 6 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 4
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 5/100] [Batch 4/669 (0.6%)] [Iter 2680] Loss: 1.3361 (freq: 0.5207, raw: 0.8149, quant: 0.0005, domain: 0.0000) LR: 8.01e-06 
π“ Codebook: 875/1024 (85.4%) Top5:[566,623,339,679,963,211,728,375,894,168,364,2,960,185,619]


π”¬ Encoder Diversity (iter 2680):
  Avg similarity: 0.2465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8580 (0.0=collapsed)
[Epoch 5/100] [Batch 14/669 (2.1%)] [Iter 2690] Loss: 1.4066 (freq: 0.5548, raw: 0.8512, quant: 0.0005, domain: 0.0000) LR: 8.04e-06 
π“ Codebook: 858/1024 (83.8%) Top5:[566,623,963,364,339,679,211,894,375,638,619,728,2,960,174]


π”¬ Encoder Diversity (iter 2690):
  Avg similarity: 0.2464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8577 (0.0=collapsed)
[Epoch 5/100] [Batch 24/669 (3.6%)] [Iter 2700] Loss: 1.1852 (freq: 0.4226, raw: 0.7622, quant: 0.0004, domain: 0.0000) LR: 8.07e-06 
π“ Codebook: 461/1024 (45.0%) Top5:[566,638,963,623,364,679,614,361,185,211,339,749,375,96,2]


π”¬ Encoder Diversity (iter 2700):
  Avg similarity: 0.1668 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8927 (0.0=collapsed)
[Epoch 5/100] [Batch 34/669 (5.1%)] [Iter 2710] Loss: 1.2461 (freq: 0.4471, raw: 0.7986, quant: 0.0004, domain: 0.0000) LR: 8.10e-06 
π“ Codebook: 307/1024 (30.0%) Top5:[566,963,614,638,364,679,623,361,96,574,929,185,98,605,680]


π”¬ Encoder Diversity (iter 2710):
  Avg similarity: 0.1956 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8886 (0.0=collapsed)
[Epoch 5/100] [Batch 44/669 (6.6%)] [Iter 2720] Loss: 1.1671 (freq: 0.4166, raw: 0.7500, quant: 0.0004, domain: 0.0000) LR: 8.13e-06 
π“ Codebook: 276/1024 (27.0%) Top5:[566,614,963,574,638,136,793,96,929,364,361,185,98,722,679]


π”¬ Encoder Diversity (iter 2720):
  Avg similarity: 0.1812 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8941 (0.0=collapsed)
[Epoch 5/100] [Batch 54/669 (8.1%)] [Iter 2730] Loss: 1.5737 (freq: 0.6750, raw: 0.8980, quant: 0.0007, domain: 0.0000) LR: 8.16e-06 
π“ Codebook: 234/1024 (22.9%) Top5:[566,963,638,679,185,605,174,364,749,722,894,614,361,619,623]


π”¬ Encoder Diversity (iter 2730):
  Avg similarity: 0.1608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9036 (0.0=collapsed)
[Epoch 5/100] [Batch 64/669 (9.6%)] [Iter 2740] Loss: 1.4073 (freq: 0.5571, raw: 0.8497, quant: 0.0006, domain: 0.0000) LR: 8.19e-06 
π“ Codebook: 235/1024 (22.9%) Top5:[566,638,963,206,605,463,70,623,445,679,211,364,722,653,185]


π”¬ Encoder Diversity (iter 2740):
  Avg similarity: 0.2878 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8479 (0.0=collapsed)
[Epoch 5/100] [Batch 74/669 (11.1%)] [Iter 2750] Loss: 1.3849 (freq: 0.5458, raw: 0.8386, quant: 0.0005, domain: 0.0000) LR: 8.22e-06 
π“ Codebook: 269/1024 (26.3%) Top5:[566,463,638,963,623,185,211,339,816,679,364,619,174,530,749]


π”¬ Encoder Diversity (iter 2750):
  Avg similarity: 0.1434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9065 (0.0=collapsed)
[Epoch 5/100] [Batch 84/669 (12.6%)] [Iter 2760] Loss: 1.0933 (freq: 0.3821, raw: 0.7107, quant: 0.0005, domain: 0.0000) LR: 8.25e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[206,566,463,605,638,793,530,623,963,445,722,614,211,163,185]


π”¬ Encoder Diversity (iter 2760):
  Avg similarity: 0.2082 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8831 (0.0=collapsed)
[Epoch 5/100] [Batch 94/669 (14.1%)] [Iter 2770] Loss: 1.1059 (freq: 0.3789, raw: 0.7267, quant: 0.0004, domain: 0.0000) LR: 8.28e-06 
π“ Codebook: 215/1024 (21.0%) Top5:[638,566,963,211,463,364,816,679,530,185,339,749,793,2,623]


π”¬ Encoder Diversity (iter 2770):
  Avg similarity: 0.2123 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8833 (0.0=collapsed)
[Epoch 5/100] [Batch 104/669 (15.5%)] [Iter 2780] Loss: 1.6373 (freq: 0.6907, raw: 0.9460, quant: 0.0006, domain: 0.0000) LR: 8.31e-06 
π“ Codebook: 221/1024 (21.6%) Top5:[638,566,211,530,679,364,816,920,2,749,463,206,605,623,188]


π”¬ Encoder Diversity (iter 2780):
  Avg similarity: 0.1864 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8912 (0.0=collapsed)
[Epoch 5/100] [Batch 114/669 (17.0%)] [Iter 2790] Loss: 1.3822 (freq: 0.5521, raw: 0.8296, quant: 0.0005, domain: 0.0000) LR: 8.34e-06 
π“ Codebook: 213/1024 (20.8%) Top5:[638,566,816,364,963,679,211,749,185,530,669,339,619,614,2]


π”¬ Encoder Diversity (iter 2790):
  Avg similarity: 0.2252 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8703 (0.0=collapsed)
[Epoch 5/100] [Batch 124/669 (18.5%)] [Iter 2800] Loss: 1.3236 (freq: 0.4892, raw: 0.8339, quant: 0.0005, domain: 0.0000) LR: 8.37e-06 
π“ Codebook: 180/1024 (17.6%) Top5:[566,963,638,185,920,339,364,206,679,463,211,722,605,70,530]


π”¬ Encoder Diversity (iter 2800):
  Avg similarity: 0.1939 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8831 (0.0=collapsed)
[Epoch 5/100] [Batch 134/669 (20.0%)] [Iter 2810] Loss: 1.1922 (freq: 0.4259, raw: 0.7659, quant: 0.0005, domain: 0.0000) LR: 8.40e-06 
π“ Codebook: 208/1024 (20.3%) Top5:[566,963,463,206,605,679,614,70,339,638,722,929,694,680,793]


π”¬ Encoder Diversity (iter 2810):
  Avg similarity: 0.1964 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8791 (0.0=collapsed)
[Epoch 5/100] [Batch 144/669 (21.5%)] [Iter 2820] Loss: 1.5184 (freq: 0.6236, raw: 0.8941, quant: 0.0007, domain: 0.0000) LR: 8.43e-06 
π“ Codebook: 255/1024 (24.9%) Top5:[566,963,890,463,679,339,894,530,185,638,211,793,614,1018,163]


π”¬ Encoder Diversity (iter 2820):
  Avg similarity: 0.2095 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8795 (0.0=collapsed)
[Epoch 5/100] [Batch 154/669 (23.0%)] [Iter 2830] Loss: 1.2263 (freq: 0.4517, raw: 0.7741, quant: 0.0005, domain: 0.0000) LR: 8.46e-06 
π“ Codebook: 253/1024 (24.7%) Top5:[566,463,638,963,679,339,614,361,530,185,96,211,793,894,574]


π”¬ Encoder Diversity (iter 2830):
  Avg similarity: 0.1486 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9004 (0.0=collapsed)
[Epoch 5/100] [Batch 164/669 (24.5%)] [Iter 2840] Loss: 1.3516 (freq: 0.5131, raw: 0.8380, quant: 0.0005, domain: 0.0000) LR: 8.49e-06 
π“ Codebook: 228/1024 (22.3%) Top5:[463,566,638,361,614,679,963,530,793,98,339,96,574,206,211]


π”¬ Encoder Diversity (iter 2840):
  Avg similarity: 0.2070 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8862 (0.0=collapsed)
[Epoch 5/100] [Batch 174/669 (26.0%)] [Iter 2850] Loss: 1.4846 (freq: 0.6011, raw: 0.8829, quant: 0.0006, domain: 0.0000) LR: 8.52e-06 
π“ Codebook: 227/1024 (22.2%) Top5:[963,463,185,530,211,339,1018,364,890,749,54,206,679,361,96]


π”¬ Encoder Diversity (iter 2850):
  Avg similarity: 0.1440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9077 (0.0=collapsed)
[Epoch 5/100] [Batch 184/669 (27.5%)] [Iter 2860] Loss: 1.4978 (freq: 0.6170, raw: 0.8802, quant: 0.0005, domain: 0.0000) LR: 8.55e-06 
π“ Codebook: 270/1024 (26.4%) Top5:[463,566,638,679,963,623,364,206,722,185,445,530,188,816,894]


π”¬ Encoder Diversity (iter 2860):
  Avg similarity: 0.2431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8763 (0.0=collapsed)
[Epoch 5/100] [Batch 194/669 (29.0%)] [Iter 2870] Loss: 1.5600 (freq: 0.6245, raw: 0.9348, quant: 0.0007, domain: 0.0000) LR: 8.58e-06 
π“ Codebook: 296/1024 (28.9%) Top5:[566,463,963,679,638,1018,364,890,894,185,174,619,530,206,749]


π”¬ Encoder Diversity (iter 2870):
  Avg similarity: 0.1980 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8750 (0.0=collapsed)
[Epoch 5/100] [Batch 204/669 (30.5%)] [Iter 2880] Loss: 1.3805 (freq: 0.5662, raw: 0.8137, quant: 0.0006, domain: 0.0000) LR: 8.61e-06 
π“ Codebook: 300/1024 (29.3%) Top5:[566,963,638,364,890,185,530,679,174,463,894,605,619,793,728]


π”¬ Encoder Diversity (iter 2880):
  Avg similarity: 0.1570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9034 (0.0=collapsed)
[Epoch 5/100] [Batch 214/669 (32.0%)] [Iter 2890] Loss: 1.2857 (freq: 0.5077, raw: 0.7775, quant: 0.0006, domain: 0.0000) LR: 8.64e-06 
π“ Codebook: 245/1024 (23.9%) Top5:[566,638,188,206,694,605,963,793,680,99,96,70,929,679,163]


π”¬ Encoder Diversity (iter 2890):
  Avg similarity: 0.2081 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8807 (0.0=collapsed)
[Epoch 5/100] [Batch 224/669 (33.5%)] [Iter 2900] Loss: 1.5781 (freq: 0.7054, raw: 0.8721, quant: 0.0006, domain: 0.0000) LR: 8.67e-06 
π“ Codebook: 196/1024 (19.1%) Top5:[566,638,530,211,185,1018,963,749,679,2,364,853,206,965,339]


π”¬ Encoder Diversity (iter 2900):
  Avg similarity: 0.1278 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9171 (0.0=collapsed)
[Epoch 5/100] [Batch 234/669 (35.0%)] [Iter 2910] Loss: 1.3291 (freq: 0.5091, raw: 0.8194, quant: 0.0005, domain: 0.0000) LR: 8.70e-06 
π“ Codebook: 252/1024 (24.6%) Top5:[566,638,530,679,623,211,816,853,339,1018,963,185,206,2,364]


π”¬ Encoder Diversity (iter 2910):
  Avg similarity: 0.2569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8581 (0.0=collapsed)
[Epoch 5/100] [Batch 244/669 (36.5%)] [Iter 2920] Loss: 1.4674 (freq: 0.6435, raw: 0.8234, quant: 0.0004, domain: 0.0000) LR: 8.73e-06 
π“ Codebook: 288/1024 (28.1%) Top5:[566,638,463,623,816,679,99,793,361,680,894,163,98,614,929]


π”¬ Encoder Diversity (iter 2920):
  Avg similarity: 0.1905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8863 (0.0=collapsed)
[Epoch 5/100] [Batch 254/669 (38.0%)] [Iter 2930] Loss: 1.3979 (freq: 0.5350, raw: 0.8623, quant: 0.0005, domain: 0.0000) LR: 8.76e-06 
π“ Codebook: 234/1024 (22.9%) Top5:[566,463,638,623,605,206,890,963,530,339,185,188,445,722,801]


π”¬ Encoder Diversity (iter 2930):
  Avg similarity: 0.2698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8616 (0.0=collapsed)
[Epoch 5/100] [Batch 264/669 (39.5%)] [Iter 2940] Loss: 1.6642 (freq: 0.7269, raw: 0.9368, quant: 0.0006, domain: 0.0000) LR: 8.79e-06 
π“ Codebook: 252/1024 (24.6%) Top5:[463,566,890,638,185,623,963,530,339,816,680,679,211,793,163]


π”¬ Encoder Diversity (iter 2940):
  Avg similarity: 0.1907 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8864 (0.0=collapsed)
[Epoch 5/100] [Batch 274/669 (41.0%)] [Iter 2950] Loss: 1.0961 (freq: 0.3887, raw: 0.7069, quant: 0.0004, domain: 0.0000) LR: 8.82e-06 
π“ Codebook: 237/1024 (23.1%) Top5:[566,463,638,623,793,99,816,680,163,929,679,361,98,136,890]


π”¬ Encoder Diversity (iter 2950):
  Avg similarity: 0.1789 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8969 (0.0=collapsed)
[Epoch 5/100] [Batch 284/669 (42.5%)] [Iter 2960] Loss: 1.4852 (freq: 0.6020, raw: 0.8827, quant: 0.0005, domain: 0.0000) LR: 8.85e-06 
π“ Codebook: 187/1024 (18.3%) Top5:[566,463,638,963,530,890,206,188,623,816,185,70,679,605,211]


π”¬ Encoder Diversity (iter 2960):
  Avg similarity: 0.2713 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8585 (0.0=collapsed)
[Epoch 5/100] [Batch 294/669 (43.9%)] [Iter 2970] Loss: 1.3638 (freq: 0.5362, raw: 0.8271, quant: 0.0005, domain: 0.0000) LR: 8.88e-06 
π“ Codebook: 203/1024 (19.8%) Top5:[566,463,638,793,963,574,136,163,99,929,96,680,679,623,361]


π”¬ Encoder Diversity (iter 2970):
  Avg similarity: 0.1540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9050 (0.0=collapsed)
[Epoch 5/100] [Batch 304/669 (45.4%)] [Iter 2980] Loss: 1.1525 (freq: 0.3985, raw: 0.7536, quant: 0.0005, domain: 0.0000) LR: 8.91e-06 
π“ Codebook: 194/1024 (18.9%) Top5:[566,638,963,463,679,530,1018,206,894,364,188,890,722,694,816]


π”¬ Encoder Diversity (iter 2980):
  Avg similarity: 0.2098 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8824 (0.0=collapsed)
[Epoch 5/100] [Batch 314/669 (46.9%)] [Iter 2990] Loss: 1.2688 (freq: 0.4752, raw: 0.7931, quant: 0.0006, domain: 0.0000) LR: 8.94e-06 
π“ Codebook: 266/1024 (26.0%) Top5:[566,963,530,463,638,1009,206,211,679,188,890,1018,998,722,364]


π”¬ Encoder Diversity (iter 2990):
  Avg similarity: 0.1704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9020 (0.0=collapsed)
[Epoch 5/100] [Batch 324/669 (48.4%)] [Iter 3000] Loss: 1.1517 (freq: 0.4350, raw: 0.7163, quant: 0.0005, domain: 0.0000) LR: 8.97e-06 
π“ Codebook: 216/1024 (21.1%) Top5:[566,530,638,963,211,853,339,749,1018,816,679,364,890,185,793]


π”¬ Encoder Diversity (iter 3000):
  Avg similarity: 0.2356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8635 (0.0=collapsed)
[Epoch 5/100] [Batch 334/669 (49.9%)] [Iter 3010] Loss: 1.2984 (freq: 0.4890, raw: 0.8090, quant: 0.0004, domain: 0.0000) LR: 9.00e-06 
π“ Codebook: 179/1024 (17.5%) Top5:[638,566,530,211,463,816,679,853,339,623,185,890,2,188,364]


π”¬ Encoder Diversity (iter 3010):
  Avg similarity: 0.1140 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9209 (0.0=collapsed)
[Epoch 5/100] [Batch 344/669 (51.4%)] [Iter 3020] Loss: 1.2011 (freq: 0.4442, raw: 0.7565, quant: 0.0004, domain: 0.0000) LR: 9.03e-06 
π“ Codebook: 196/1024 (19.1%) Top5:[463,566,638,361,816,793,98,163,99,614,680,623,679,929,206]


π”¬ Encoder Diversity (iter 3020):
  Avg similarity: 0.1166 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9166 (0.0=collapsed)
[Epoch 5/100] [Batch 354/669 (52.9%)] [Iter 3030] Loss: 1.6264 (freq: 0.7087, raw: 0.9170, quant: 0.0007, domain: 0.0000) LR: 9.06e-06 
π“ Codebook: 277/1024 (27.1%) Top5:[463,566,793,680,929,638,163,98,99,890,361,574,679,614,894]


π”¬ Encoder Diversity (iter 3030):
  Avg similarity: 0.1507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9020 (0.0=collapsed)
[Epoch 5/100] [Batch 364/669 (54.4%)] [Iter 3040] Loss: 1.0615 (freq: 0.3946, raw: 0.6664, quant: 0.0005, domain: 0.0000) LR: 9.09e-06 
π“ Codebook: 231/1024 (22.6%) Top5:[566,463,206,188,530,163,445,605,680,722,499,70,638,98,99]


π”¬ Encoder Diversity (iter 3040):
  Avg similarity: 0.1852 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8830 (0.0=collapsed)
[Epoch 5/100] [Batch 374/669 (55.9%)] [Iter 3050] Loss: 1.0966 (freq: 0.4150, raw: 0.6812, quant: 0.0004, domain: 0.0000) LR: 9.12e-06 
π“ Codebook: 251/1024 (24.5%) Top5:[566,463,890,185,638,605,206,530,963,211,445,816,722,339,188]


π”¬ Encoder Diversity (iter 3050):
  Avg similarity: 0.2333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8756 (0.0=collapsed)
[Epoch 5/100] [Batch 384/669 (57.4%)] [Iter 3060] Loss: 1.4242 (freq: 0.5674, raw: 0.8564, quant: 0.0005, domain: 0.0000) LR: 9.15e-06 
π“ Codebook: 236/1024 (23.0%) Top5:[566,463,638,499,963,679,890,206,353,185,188,816,894,530,445]


π”¬ Encoder Diversity (iter 3060):
  Avg similarity: 0.1407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9194 (0.0=collapsed)
[Epoch 5/100] [Batch 394/669 (58.9%)] [Iter 3070] Loss: 1.5936 (freq: 0.6624, raw: 0.9306, quant: 0.0006, domain: 0.0000) LR: 9.18e-06 
π“ Codebook: 249/1024 (24.3%) Top5:[463,566,963,530,679,894,638,364,890,99,749,98,163,499,188]


π”¬ Encoder Diversity (iter 3070):
  Avg similarity: 0.1192 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9220 (0.0=collapsed)
[Epoch 5/100] [Batch 404/669 (60.4%)] [Iter 3080] Loss: 1.5166 (freq: 0.6571, raw: 0.8590, quant: 0.0006, domain: 0.0000) LR: 9.21e-06 
π“ Codebook: 246/1024 (24.0%) Top5:[463,963,566,530,545,364,853,749,679,894,890,339,361,1018,638]


π”¬ Encoder Diversity (iter 3080):
  Avg similarity: 0.1131 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9308 (0.0=collapsed)
[Epoch 5/100] [Batch 414/669 (61.9%)] [Iter 3090] Loss: 1.5893 (freq: 0.6668, raw: 0.9218, quant: 0.0006, domain: 0.0000) LR: 9.24e-06 
π“ Codebook: 246/1024 (24.0%) Top5:[566,463,638,361,963,793,574,816,499,853,679,680,614,364,99]


π”¬ Encoder Diversity (iter 3090):
  Avg similarity: 0.1921 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8924 (0.0=collapsed)
[Epoch 5/100] [Batch 424/669 (63.4%)] [Iter 3100] Loss: 1.2114 (freq: 0.4862, raw: 0.7247, quant: 0.0005, domain: 0.0000) LR: 9.27e-06 
π“ Codebook: 261/1024 (25.5%) Top5:[463,566,99,793,163,361,638,574,680,614,136,364,96,890,530]


π”¬ Encoder Diversity (iter 3100):
  Avg similarity: 0.1572 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9056 (0.0=collapsed)
[Epoch 5/100] [Batch 434/669 (64.9%)] [Iter 3110] Loss: 1.0520 (freq: 0.3741, raw: 0.6775, quant: 0.0004, domain: 0.0000) LR: 9.30e-06 
π“ Codebook: 258/1024 (25.2%) Top5:[566,463,638,499,679,816,530,894,793,188,70,206,963,163,853]


π”¬ Encoder Diversity (iter 3110):
  Avg similarity: 0.1536 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9296 (0.0=collapsed)
[Epoch 5/100] [Batch 444/669 (66.4%)] [Iter 3120] Loss: 1.6073 (freq: 0.6781, raw: 0.9286, quant: 0.0006, domain: 0.0000) LR: 9.33e-06 
π“ Codebook: 258/1024 (25.2%) Top5:[566,638,463,206,70,679,188,1003,694,445,816,353,605,499,530]


π”¬ Encoder Diversity (iter 3120):
  Avg similarity: 0.1745 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8977 (0.0=collapsed)
[Epoch 5/100] [Batch 454/669 (67.9%)] [Iter 3130] Loss: 1.7069 (freq: 0.7190, raw: 0.9868, quant: 0.0010, domain: 0.0000) LR: 9.36e-06 
π“ Codebook: 263/1024 (25.7%) Top5:[566,638,838,530,679,853,339,499,1018,816,463,364,211,2,54]


π”¬ Encoder Diversity (iter 3130):
  Avg similarity: 0.1179 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9230 (0.0=collapsed)
[Epoch 5/100] [Batch 464/669 (69.4%)] [Iter 3140] Loss: 1.2566 (freq: 0.4736, raw: 0.7826, quant: 0.0004, domain: 0.0000) LR: 9.39e-06 
π“ Codebook: 200/1024 (19.5%) Top5:[566,638,679,574,530,96,793,614,963,680,361,853,163,136,929]


π”¬ Encoder Diversity (iter 3140):
  Avg similarity: 0.2253 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8912 (0.0=collapsed)
[Epoch 5/100] [Batch 474/669 (70.9%)] [Iter 3150] Loss: 1.7679 (freq: 0.7789, raw: 0.9884, quant: 0.0006, domain: 0.0000) LR: 9.42e-06 
π“ Codebook: 215/1024 (21.0%) Top5:[566,679,638,530,963,890,463,499,185,364,853,749,793,894,1018]


π”¬ Encoder Diversity (iter 3150):
  Avg similarity: 0.1764 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9069 (0.0=collapsed)
[Epoch 5/100] [Batch 484/669 (72.3%)] [Iter 3160] Loss: 1.5576 (freq: 0.6264, raw: 0.9306, quant: 0.0006, domain: 0.0000) LR: 9.45e-06 
π“ Codebook: 194/1024 (18.9%) Top5:[566,188,353,206,638,694,70,1003,605,722,445,463,653,679,499]


π”¬ Encoder Diversity (iter 3160):
  Avg similarity: 0.1220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9160 (0.0=collapsed)
[Epoch 5/100] [Batch 494/669 (73.8%)] [Iter 3170] Loss: 1.4112 (freq: 0.5483, raw: 0.8624, quant: 0.0005, domain: 0.0000) LR: 9.48e-06 
π“ Codebook: 234/1024 (22.9%) Top5:[566,463,638,679,499,963,623,890,1018,185,648,174,530,728,545]


π”¬ Encoder Diversity (iter 3170):
  Avg similarity: 0.1878 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8965 (0.0=collapsed)
[Epoch 5/100] [Batch 504/669 (75.3%)] [Iter 3180] Loss: 1.2975 (freq: 0.5042, raw: 0.7928, quant: 0.0005, domain: 0.0000) LR: 9.51e-06 
π“ Codebook: 285/1024 (27.8%) Top5:[566,463,679,638,499,890,929,793,206,894,963,530,614,623,471]


π”¬ Encoder Diversity (iter 3180):
  Avg similarity: 0.1309 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9187 (0.0=collapsed)
[Epoch 5/100] [Batch 514/669 (76.8%)] [Iter 3190] Loss: 1.1751 (freq: 0.4498, raw: 0.7248, quant: 0.0005, domain: 0.0000) LR: 9.54e-06 
π“ Codebook: 295/1024 (28.8%) Top5:[463,566,679,963,70,206,530,605,890,188,545,653,77,894,364]


π”¬ Encoder Diversity (iter 3190):
  Avg similarity: 0.1289 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9256 (0.0=collapsed)
[Epoch 5/100] [Batch 524/669 (78.3%)] [Iter 3200] Loss: 1.5680 (freq: 0.6394, raw: 0.9281, quant: 0.0006, domain: 0.0000) LR: 9.56e-06 
π“ Codebook: 314/1024 (30.7%) Top5:[463,77,679,705,530,566,963,853,1018,185,364,764,375,816,838]


π”¬ Encoder Diversity (iter 3200):
  Avg similarity: 0.1110 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9244 (0.0=collapsed)
[Epoch 5/100] [Batch 534/669 (79.8%)] [Iter 3210] Loss: 1.1340 (freq: 0.4251, raw: 0.7085, quant: 0.0004, domain: 0.0000) LR: 9.59e-06 
π“ Codebook: 213/1024 (20.8%) Top5:[77,614,163,793,361,96,566,136,804,99,680,574,471,98,929]


π”¬ Encoder Diversity (iter 3210):
  Avg similarity: 0.2001 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8725 (0.0=collapsed)
[Epoch 5/100] [Batch 544/669 (81.3%)] [Iter 3220] Loss: 1.1839 (freq: 0.4699, raw: 0.7136, quant: 0.0005, domain: 0.0000) LR: 9.62e-06 
π“ Codebook: 231/1024 (22.6%) Top5:[530,963,566,1018,705,679,838,185,853,890,694,614,793,77,545]


π”¬ Encoder Diversity (iter 3220):
  Avg similarity: 0.0990 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9339 (0.0=collapsed)
[Epoch 5/100] [Batch 554/669 (82.8%)] [Iter 3230] Loss: 1.5713 (freq: 0.6574, raw: 0.9134, quant: 0.0006, domain: 0.0000) LR: 9.65e-06 
π“ Codebook: 258/1024 (25.2%) Top5:[566,679,77,463,705,804,793,614,163,136,574,471,894,816,638]


π”¬ Encoder Diversity (iter 3230):
  Avg similarity: 0.1832 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8887 (0.0=collapsed)
[Epoch 5/100] [Batch 564/669 (84.3%)] [Iter 3240] Loss: 1.0178 (freq: 0.3652, raw: 0.6522, quant: 0.0004, domain: 0.0000) LR: 9.68e-06 
π“ Codebook: 254/1024 (24.8%) Top5:[679,566,77,188,694,705,206,445,185,353,722,530,638,894,605]


π”¬ Encoder Diversity (iter 3240):
  Avg similarity: 0.1652 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9037 (0.0=collapsed)
[Epoch 5/100] [Batch 574/669 (85.8%)] [Iter 3250] Loss: 1.7883 (freq: 0.8025, raw: 0.9851, quant: 0.0006, domain: 0.0000) LR: 9.71e-06 
π“ Codebook: 208/1024 (20.3%) Top5:[530,804,185,853,679,816,339,749,211,638,1018,566,1015,273,890]


π”¬ Encoder Diversity (iter 3250):
  Avg similarity: 0.1537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9084 (0.0=collapsed)
[Epoch 5/100] [Batch 584/669 (87.3%)] [Iter 3260] Loss: 1.3913 (freq: 0.5370, raw: 0.8538, quant: 0.0005, domain: 0.0000) LR: 9.74e-06 
π“ Codebook: 227/1024 (22.2%) Top5:[705,838,530,614,679,574,1018,853,185,163,54,96,471,2,339]


π”¬ Encoder Diversity (iter 3260):
  Avg similarity: 0.1666 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8996 (0.0=collapsed)
[Epoch 5/100] [Batch 594/669 (88.8%)] [Iter 3270] Loss: 1.4358 (freq: 0.5775, raw: 0.8577, quant: 0.0006, domain: 0.0000) LR: 9.77e-06 
π“ Codebook: 223/1024 (21.8%) Top5:[463,566,890,679,530,705,185,963,853,1018,339,364,211,804,499]


π”¬ Encoder Diversity (iter 3270):
  Avg similarity: 0.1498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9051 (0.0=collapsed)
[Epoch 5/100] [Batch 604/669 (90.3%)] [Iter 3280] Loss: 1.2733 (freq: 0.4919, raw: 0.7808, quant: 0.0005, domain: 0.0000) LR: 9.80e-06 
π“ Codebook: 255/1024 (24.9%) Top5:[463,679,566,77,14,890,963,545,802,1018,705,445,804,530,499]


π”¬ Encoder Diversity (iter 3280):
  Avg similarity: 0.1240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9224 (0.0=collapsed)
[Epoch 5/100] [Batch 614/669 (91.8%)] [Iter 3290] Loss: 1.4501 (freq: 0.6040, raw: 0.8454, quant: 0.0007, domain: 0.0000) LR: 9.83e-06 
π“ Codebook: 248/1024 (24.2%) Top5:[566,679,77,463,890,70,353,963,188,705,1018,694,653,445,206]


π”¬ Encoder Diversity (iter 3290):
  Avg similarity: 0.1525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9005 (0.0=collapsed)
[Epoch 5/100] [Batch 624/669 (93.3%)] [Iter 3300] Loss: 0.9941 (freq: 0.3453, raw: 0.6484, quant: 0.0004, domain: 0.0000) LR: 9.86e-06 
π“ Codebook: 210/1024 (20.5%) Top5:[530,705,70,206,605,188,353,722,694,445,463,566,963,653,1003]


π”¬ Encoder Diversity (iter 3300):
  Avg similarity: 0.1531 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9081 (0.0=collapsed)
[Epoch 5/100] [Batch 634/669 (94.8%)] [Iter 3310] Loss: 1.0224 (freq: 0.3860, raw: 0.6360, quant: 0.0004, domain: 0.0000) LR: 9.89e-06 
π“ Codebook: 222/1024 (21.7%) Top5:[206,445,722,694,70,188,605,653,1003,353,793,96,530,471,163]


π”¬ Encoder Diversity (iter 3310):
  Avg similarity: 0.1017 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9338 (0.0=collapsed)
[Epoch 5/100] [Batch 644/669 (96.3%)] [Iter 3320] Loss: 1.2585 (freq: 0.4829, raw: 0.7749, quant: 0.0007, domain: 0.0000) LR: 9.92e-06 
π“ Codebook: 288/1024 (28.1%) Top5:[77,361,793,679,804,471,614,99,163,802,574,929,98,680,96]


π”¬ Encoder Diversity (iter 3320):
  Avg similarity: 0.0925 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9343 (0.0=collapsed)
[Epoch 5/100] [Batch 654/669 (97.8%)] [Iter 3330] Loss: 1.1539 (freq: 0.4335, raw: 0.7198, quant: 0.0005, domain: 0.0000) LR: 9.95e-06 
π“ Codebook: 270/1024 (26.4%) Top5:[679,463,163,445,614,793,99,361,206,188,680,574,136,566,605]


π”¬ Encoder Diversity (iter 3330):
  Avg similarity: 0.1228 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9191 (0.0=collapsed)
[Epoch 5/100] [Batch 664/669 (99.3%)] [Iter 3340] Loss: 0.9852 (freq: 0.3354, raw: 0.6493, quant: 0.0004, domain: 0.0000) LR: 9.98e-06 
π“ Codebook: 197/1024 (19.2%) Top5:[566,445,530,206,605,963,679,653,70,804,353,722,77,188,694]


π”¬ Encoder Diversity (iter 3340):
  Avg similarity: 0.1393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9159 (0.0=collapsed)

================================================================================
[Epoch 5] Validation Results:
  Total Loss: 0.7475
  Freq Loss:  0.2446
  Raw Loss:   0.5025
  Quant Loss: 0.0004
  π“ Codebook Usage: 130/1024 (12.7%)
  π“ Codebook Entropy: 3.3196 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 68751 (52.8%)
  Top 10 most used codes:
    1. Code 605: 8654 times (6.65%)
    2. Code 653: 8423 times (6.47%)
    3. Code 206: 7146 times (5.49%)
    4. Code 188: 6819 times (5.24%)
    5. Code 694: 6793 times (5.22%)
    6. Code 445: 6667 times (5.12%)
    7. Code 722: 6269 times (4.81%)
    8. Code 1003: 6011 times (4.62%)
    9. Code 96: 5989 times (4.60%)
    10. Code 70: 5980 times (4.59%)
  Bottom 5 least used codes (among used):
    1. Code 769: 1 times (0.00%)
    2. Code 615: 1 times (0.00%)
    3. Code 897: 1 times (0.00%)
    4. Code 985: 1 times (0.00%)
    5. Code 289: 2 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 5
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 6/100] [Batch 5/669 (0.7%)] [Iter 3350] Loss: 1.3098 (freq: 0.5238, raw: 0.7853, quant: 0.0008, domain: 0.0000) LR: 1.00e-05 
π“ Codebook: 1004/1024 (98.0%) Top5:[530,963,77,566,804,574,99,96,163,614,793,680,185,361,136]


π”¬ Encoder Diversity (iter 3350):
  Avg similarity: 0.1753 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9071 (0.0=collapsed)
[Epoch 6/100] [Batch 15/669 (2.2%)] [Iter 3360] Loss: 1.2698 (freq: 0.4866, raw: 0.7826, quant: 0.0005, domain: 0.0000) LR: 1.00e-05 
π“ Codebook: 505/1024 (49.3%) Top5:[530,963,77,804,185,853,364,188,206,574,614,321,694,793,99]


π”¬ Encoder Diversity (iter 3360):
  Avg similarity: 0.1593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9058 (0.0=collapsed)
[Epoch 6/100] [Batch 25/669 (3.7%)] [Iter 3370] Loss: 1.3059 (freq: 0.5176, raw: 0.7877, quant: 0.0006, domain: 0.0000) LR: 1.01e-05 
π“ Codebook: 347/1024 (33.9%) Top5:[734,792,530,77,968,185,321,963,853,804,353,364,870,890,61]


π”¬ Encoder Diversity (iter 3370):
  Avg similarity: 0.1313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9163 (0.0=collapsed)
[Epoch 6/100] [Batch 35/669 (5.2%)] [Iter 3380] Loss: 1.7039 (freq: 0.7284, raw: 0.9747, quant: 0.0008, domain: 0.0000) LR: 1.01e-05 
π“ Codebook: 270/1024 (26.4%) Top5:[792,734,206,445,99,188,70,653,574,361,605,163,680,793,722]


π”¬ Encoder Diversity (iter 3380):
  Avg similarity: 0.1091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9271 (0.0=collapsed)
[Epoch 6/100] [Batch 45/669 (6.7%)] [Iter 3390] Loss: 1.5428 (freq: 0.6456, raw: 0.8965, quant: 0.0007, domain: 0.0000) LR: 1.01e-05 
π“ Codebook: 263/1024 (25.7%) Top5:[870,792,99,574,680,361,136,163,793,98,614,929,944,96,734]


π”¬ Encoder Diversity (iter 3390):
  Avg similarity: 0.0811 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 6/100] [Batch 55/669 (8.2%)] [Iter 3400] Loss: 1.3232 (freq: 0.5360, raw: 0.7866, quant: 0.0006, domain: 0.0000) LR: 1.02e-05 
π“ Codebook: 202/1024 (19.7%) Top5:[61,99,445,870,792,361,734,574,96,929,353,793,471,70,963]


π”¬ Encoder Diversity (iter 3400):
  Avg similarity: 0.1096 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9293 (0.0=collapsed)
[Epoch 6/100] [Batch 65/669 (9.7%)] [Iter 3410] Loss: 1.5061 (freq: 0.5905, raw: 0.9148, quant: 0.0008, domain: 0.0000) LR: 1.02e-05 
π“ Codebook: 247/1024 (24.1%) Top5:[61,993,944,963,792,99,979,734,870,804,445,694,722,185,793]


π”¬ Encoder Diversity (iter 3410):
  Avg similarity: 0.1379 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9179 (0.0=collapsed)
[Epoch 6/100] [Batch 75/669 (11.2%)] [Iter 3420] Loss: 1.2791 (freq: 0.5025, raw: 0.7761, quant: 0.0005, domain: 0.0000) LR: 1.02e-05 
π“ Codebook: 194/1024 (18.9%) Top5:[61,792,263,353,542,321,734,206,963,979,653,722,188,804,70]


π”¬ Encoder Diversity (iter 3420):
  Avg similarity: 0.0987 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9303 (0.0=collapsed)
[Epoch 6/100] [Batch 85/669 (12.7%)] [Iter 3430] Loss: 1.4124 (freq: 0.5695, raw: 0.8421, quant: 0.0008, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 267/1024 (26.1%) Top5:[944,792,61,614,793,530,963,979,206,321,136,804,99,853,96]


π”¬ Encoder Diversity (iter 3430):
  Avg similarity: 0.1368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9105 (0.0=collapsed)
[Epoch 6/100] [Batch 95/669 (14.2%)] [Iter 3440] Loss: 1.3337 (freq: 0.5569, raw: 0.7764, quant: 0.0005, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 243/1024 (23.7%) Top5:[61,792,530,979,804,321,853,963,136,96,614,185,680,361,929]


π”¬ Encoder Diversity (iter 3440):
  Avg similarity: 0.1754 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8981 (0.0=collapsed)
[Epoch 6/100] [Batch 105/669 (15.7%)] [Iter 3450] Loss: 1.4364 (freq: 0.5854, raw: 0.8504, quant: 0.0006, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 310/1024 (30.3%) Top5:[61,944,542,792,979,530,993,853,136,821,734,99,706,185,96]


π”¬ Encoder Diversity (iter 3450):
  Avg similarity: 0.0874 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9322 (0.0=collapsed)
[Epoch 6/100] [Batch 115/669 (17.2%)] [Iter 3460] Loss: 1.3883 (freq: 0.5534, raw: 0.8343, quant: 0.0006, domain: 0.0000) LR: 1.03e-05 
π“ Codebook: 258/1024 (25.2%) Top5:[944,445,734,61,653,694,206,364,188,70,963,722,605,890,353]


π”¬ Encoder Diversity (iter 3460):
  Avg similarity: 0.1258 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9221 (0.0=collapsed)
[Epoch 6/100] [Batch 125/669 (18.7%)] [Iter 3470] Loss: 1.2710 (freq: 0.4866, raw: 0.7838, quant: 0.0006, domain: 0.0000) LR: 1.04e-05 
π“ Codebook: 232/1024 (22.7%) Top5:[61,734,944,792,542,99,963,680,361,98,471,890,163,793,993]


π”¬ Encoder Diversity (iter 3470):
  Avg similarity: 0.0741 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9431 (0.0=collapsed)
[Epoch 6/100] [Batch 135/669 (20.2%)] [Iter 3480] Loss: 1.4633 (freq: 0.5668, raw: 0.8957, quant: 0.0008, domain: 0.0000) LR: 1.04e-05 
π“ Codebook: 264/1024 (25.8%) Top5:[734,61,792,963,944,542,163,890,793,445,929,99,364,206,77]


π”¬ Encoder Diversity (iter 3480):
  Avg similarity: 0.0649 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 6/100] [Batch 145/669 (21.7%)] [Iter 3490] Loss: 1.2805 (freq: 0.5015, raw: 0.7784, quant: 0.0006, domain: 0.0000) LR: 1.04e-05 
π“ Codebook: 318/1024 (31.1%) Top5:[792,188,353,1003,206,445,61,70,734,653,361,605,694,722,793]


π”¬ Encoder Diversity (iter 3490):
  Avg similarity: 0.0859 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9365 (0.0=collapsed)
[Epoch 6/100] [Batch 155/669 (23.2%)] [Iter 3500] Loss: 1.5548 (freq: 0.6492, raw: 0.9049, quant: 0.0007, domain: 0.0000) LR: 1.05e-05 
π“ Codebook: 305/1024 (29.8%) Top5:[530,853,321,804,185,263,364,96,614,792,728,793,963,136,944]


π”¬ Encoder Diversity (iter 3500):
  Avg similarity: 0.1088 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9290 (0.0=collapsed)
[Epoch 6/100] [Batch 165/669 (24.7%)] [Iter 3510] Loss: 1.4205 (freq: 0.5749, raw: 0.8448, quant: 0.0007, domain: 0.0000) LR: 1.05e-05 
π“ Codebook: 249/1024 (24.3%) Top5:[804,530,853,185,321,96,963,605,614,353,792,136,70,61,653]


π”¬ Encoder Diversity (iter 3510):
  Avg similarity: 0.0958 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9279 (0.0=collapsed)
[Epoch 6/100] [Batch 175/669 (26.2%)] [Iter 3520] Loss: 1.6744 (freq: 0.7007, raw: 0.9729, quant: 0.0008, domain: 0.0000) LR: 1.05e-05 
π“ Codebook: 239/1024 (23.3%) Top5:[963,542,804,530,792,944,263,364,154,185,321,890,853,61,605]


π”¬ Encoder Diversity (iter 3520):
  Avg similarity: 0.1917 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8771 (0.0=collapsed)
[Epoch 6/100] [Batch 185/669 (27.7%)] [Iter 3530] Loss: 1.3515 (freq: 0.5145, raw: 0.8363, quant: 0.0007, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 266/1024 (26.0%) Top5:[542,792,61,963,944,734,804,530,890,979,263,968,364,706,154]


π”¬ Encoder Diversity (iter 3530):
  Avg similarity: 0.1678 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9142 (0.0=collapsed)
[Epoch 6/100] [Batch 195/669 (29.1%)] [Iter 3540] Loss: 1.2048 (freq: 0.4852, raw: 0.7191, quant: 0.0005, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 324/1024 (31.6%) Top5:[963,734,944,792,61,542,96,614,680,98,471,263,154,99,136]


π”¬ Encoder Diversity (iter 3540):
  Avg similarity: 0.0947 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9384 (0.0=collapsed)
[Epoch 6/100] [Batch 205/669 (30.6%)] [Iter 3550] Loss: 1.2398 (freq: 0.4554, raw: 0.7837, quant: 0.0007, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 338/1024 (33.0%) Top5:[614,445,188,653,99,694,206,1003,353,722,574,96,361,471,70]


π”¬ Encoder Diversity (iter 3550):
  Avg similarity: 0.1222 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9207 (0.0=collapsed)
[Epoch 6/100] [Batch 215/669 (32.1%)] [Iter 3560] Loss: 1.1424 (freq: 0.4515, raw: 0.6904, quant: 0.0005, domain: 0.0000) LR: 1.06e-05 
π“ Codebook: 258/1024 (25.2%) Top5:[614,96,99,574,361,136,471,680,98,793,445,70,929,163,653]


π”¬ Encoder Diversity (iter 3560):
  Avg similarity: 0.1038 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9330 (0.0=collapsed)
[Epoch 6/100] [Batch 225/669 (33.6%)] [Iter 3570] Loss: 1.1454 (freq: 0.4387, raw: 0.7062, quant: 0.0005, domain: 0.0000) LR: 1.07e-05 
π“ Codebook: 249/1024 (24.3%) Top5:[70,542,653,188,722,792,734,445,694,206,605,530,353,1003,99]


π”¬ Encoder Diversity (iter 3570):
  Avg similarity: 0.1091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9274 (0.0=collapsed)
[Epoch 6/100] [Batch 235/669 (35.1%)] [Iter 3580] Loss: 1.2875 (freq: 0.5327, raw: 0.7542, quant: 0.0006, domain: 0.0000) LR: 1.07e-05 
π“ Codebook: 313/1024 (30.6%) Top5:[542,792,136,96,530,99,574,653,605,98,188,361,680,944,963]


π”¬ Encoder Diversity (iter 3580):
  Avg similarity: 0.1107 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9282 (0.0=collapsed)
[Epoch 6/100] [Batch 245/669 (36.6%)] [Iter 3590] Loss: 1.4321 (freq: 0.5877, raw: 0.8437, quant: 0.0007, domain: 0.0000) LR: 1.07e-05 
π“ Codebook: 247/1024 (24.1%) Top5:[542,944,963,653,792,206,188,530,445,804,99,605,98,353,70]


π”¬ Encoder Diversity (iter 3590):
  Avg similarity: 0.1149 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9388 (0.0=collapsed)
[Epoch 6/100] [Batch 255/669 (38.1%)] [Iter 3600] Loss: 1.2652 (freq: 0.4842, raw: 0.7805, quant: 0.0006, domain: 0.0000) LR: 1.08e-05 
π“ Codebook: 243/1024 (23.7%) Top5:[963,944,542,792,154,99,804,734,361,471,574,364,614,98,979]


π”¬ Encoder Diversity (iter 3600):
  Avg similarity: 0.1249 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9187 (0.0=collapsed)
[Epoch 6/100] [Batch 265/669 (39.6%)] [Iter 3610] Loss: 1.4052 (freq: 0.5659, raw: 0.8388, quant: 0.0006, domain: 0.0000) LR: 1.08e-05 
π“ Codebook: 219/1024 (21.4%) Top5:[542,944,979,792,722,694,188,353,1003,263,206,963,70,653,445]


π”¬ Encoder Diversity (iter 3610):
  Avg similarity: 0.0926 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9300 (0.0=collapsed)
[Epoch 6/100] [Batch 275/669 (41.1%)] [Iter 3620] Loss: 1.3832 (freq: 0.5367, raw: 0.8460, quant: 0.0006, domain: 0.0000) LR: 1.08e-05 
π“ Codebook: 254/1024 (24.8%) Top5:[574,136,614,99,680,361,96,542,929,471,98,263,188,321,722]


π”¬ Encoder Diversity (iter 3620):
  Avg similarity: 0.0852 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9333 (0.0=collapsed)
[Epoch 6/100] [Batch 285/669 (42.6%)] [Iter 3630] Loss: 1.4626 (freq: 0.6111, raw: 0.8508, quant: 0.0007, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 282/1024 (27.5%) Top5:[542,792,944,979,734,99,722,706,614,821,574,136,70,471,929]


π”¬ Encoder Diversity (iter 3630):
  Avg similarity: 0.1847 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8877 (0.0=collapsed)
[Epoch 6/100] [Batch 295/669 (44.1%)] [Iter 3640] Loss: 1.4054 (freq: 0.5657, raw: 0.8391, quant: 0.0006, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 360/1024 (35.2%) Top5:[792,542,364,944,185,749,574,804,99,890,853,136,98,530,653]


π”¬ Encoder Diversity (iter 3640):
  Avg similarity: 0.1069 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9337 (0.0=collapsed)
[Epoch 6/100] [Batch 305/669 (45.6%)] [Iter 3650] Loss: 1.4083 (freq: 0.5738, raw: 0.8338, quant: 0.0006, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 276/1024 (27.0%) Top5:[542,804,792,70,364,890,722,188,445,993,206,653,694,156,185]


π”¬ Encoder Diversity (iter 3650):
  Avg similarity: 0.0919 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9340 (0.0=collapsed)
[Epoch 6/100] [Batch 315/669 (47.1%)] [Iter 3660] Loss: 1.4041 (freq: 0.5536, raw: 0.8499, quant: 0.0006, domain: 0.0000) LR: 1.09e-05 
π“ Codebook: 227/1024 (22.2%) Top5:[542,944,636,835,979,66,734,792,706,188,611,206,574,98,70]


π”¬ Encoder Diversity (iter 3660):
  Avg similarity: 0.1501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9062 (0.0=collapsed)
[Epoch 6/100] [Batch 325/669 (48.6%)] [Iter 3670] Loss: 1.2240 (freq: 0.4564, raw: 0.7670, quant: 0.0007, domain: 0.0000) LR: 1.10e-05 
π“ Codebook: 217/1024 (21.2%) Top5:[944,542,734,206,804,188,653,353,963,54,445,993,979,722,70]


π”¬ Encoder Diversity (iter 3670):
  Avg similarity: 0.1094 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9317 (0.0=collapsed)
[Epoch 6/100] [Batch 335/669 (50.1%)] [Iter 3680] Loss: 1.2283 (freq: 0.4403, raw: 0.7875, quant: 0.0005, domain: 0.0000) LR: 1.10e-05 
π“ Codebook: 235/1024 (22.9%) Top5:[944,542,734,792,963,263,54,804,979,163,99,574,821,96,361]


π”¬ Encoder Diversity (iter 3680):
  Avg similarity: 0.1135 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9195 (0.0=collapsed)
[Epoch 6/100] [Batch 345/669 (51.6%)] [Iter 3690] Loss: 1.6702 (freq: 0.6922, raw: 0.9772, quant: 0.0007, domain: 0.0000) LR: 1.10e-05 
π“ Codebook: 236/1024 (23.0%) Top5:[542,944,792,963,1003,188,694,804,99,722,364,70,530,353,206]


π”¬ Encoder Diversity (iter 3690):
  Avg similarity: 0.1396 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9243 (0.0=collapsed)
[Epoch 6/100] [Batch 355/669 (53.1%)] [Iter 3700] Loss: 1.3707 (freq: 0.5265, raw: 0.8436, quant: 0.0006, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 238/1024 (23.2%) Top5:[542,944,792,979,530,1003,734,353,963,694,835,706,54,722,263]


π”¬ Encoder Diversity (iter 3700):
  Avg similarity: 0.1198 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9091 (0.0=collapsed)
[Epoch 6/100] [Batch 365/669 (54.6%)] [Iter 3710] Loss: 1.6389 (freq: 0.7454, raw: 0.8929, quant: 0.0007, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 219/1024 (21.4%) Top5:[804,1003,263,963,542,694,530,353,792,188,70,445,653,364,944]


π”¬ Encoder Diversity (iter 3710):
  Avg similarity: 0.2018 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8764 (0.0=collapsed)
[Epoch 6/100] [Batch 375/669 (56.1%)] [Iter 3720] Loss: 1.5036 (freq: 0.5948, raw: 0.9081, quant: 0.0007, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 286/1024 (27.9%) Top5:[734,636,804,792,263,54,156,963,993,188,321,507,853,793,944]


π”¬ Encoder Diversity (iter 3720):
  Avg similarity: 0.1102 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 6/100] [Batch 385/669 (57.5%)] [Iter 3730] Loss: 1.2330 (freq: 0.5468, raw: 0.6857, quant: 0.0005, domain: 0.0000) LR: 1.11e-05 
π“ Codebook: 243/1024 (23.7%) Top5:[963,263,804,188,530,993,734,792,1003,944,353,156,321,722,445]


π”¬ Encoder Diversity (iter 3730):
  Avg similarity: 0.1336 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9236 (0.0=collapsed)
[Epoch 6/100] [Batch 395/669 (59.0%)] [Iter 3740] Loss: 1.4749 (freq: 0.6482, raw: 0.8261, quant: 0.0006, domain: 0.0000) LR: 1.12e-05 
π“ Codebook: 257/1024 (25.1%) Top5:[542,792,54,16,963,944,188,804,890,361,979,206,471,263,929]


π”¬ Encoder Diversity (iter 3740):
  Avg similarity: 0.1034 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9287 (0.0=collapsed)
[Epoch 6/100] [Batch 405/669 (60.5%)] [Iter 3750] Loss: 1.2229 (freq: 0.4525, raw: 0.7699, quant: 0.0005, domain: 0.0000) LR: 1.12e-05 
π“ Codebook: 240/1024 (23.4%) Top5:[542,188,967,488,1003,445,353,605,70,653,694,206,722,792,979]


π”¬ Encoder Diversity (iter 3750):
  Avg similarity: 0.1864 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9030 (0.0=collapsed)
[Epoch 6/100] [Batch 415/669 (62.0%)] [Iter 3760] Loss: 1.2931 (freq: 0.5311, raw: 0.7615, quant: 0.0005, domain: 0.0000) LR: 1.12e-05 
π“ Codebook: 261/1024 (25.5%) Top5:[804,890,156,542,364,853,963,96,574,263,530,680,792,793,614]


π”¬ Encoder Diversity (iter 3760):
  Avg similarity: 0.1004 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9303 (0.0=collapsed)
[Epoch 6/100] [Batch 425/669 (63.5%)] [Iter 3770] Loss: 1.2756 (freq: 0.5017, raw: 0.7734, quant: 0.0005, domain: 0.0000) LR: 1.13e-05 
π“ Codebook: 277/1024 (27.1%) Top5:[361,680,574,793,614,96,99,929,98,471,136,16,156,804,163]


π”¬ Encoder Diversity (iter 3770):
  Avg similarity: 0.0987 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9338 (0.0=collapsed)
[Epoch 6/100] [Batch 435/669 (65.0%)] [Iter 3780] Loss: 1.1226 (freq: 0.4348, raw: 0.6873, quant: 0.0005, domain: 0.0000) LR: 1.13e-05 
π“ Codebook: 285/1024 (27.8%) Top5:[16,792,338,542,263,963,188,722,530,694,206,364,944,653,804]


π”¬ Encoder Diversity (iter 3780):
  Avg similarity: 0.0990 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9329 (0.0=collapsed)
[Epoch 6/100] [Batch 445/669 (66.5%)] [Iter 3790] Loss: 1.1293 (freq: 0.4250, raw: 0.7038, quant: 0.0005, domain: 0.0000) LR: 1.13e-05 
π“ Codebook: 311/1024 (30.4%) Top5:[542,488,792,722,1003,944,188,694,361,16,471,530,734,614,99]


π”¬ Encoder Diversity (iter 3790):
  Avg similarity: 0.0863 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9407 (0.0=collapsed)
[Epoch 6/100] [Batch 455/669 (68.0%)] [Iter 3800] Loss: 1.3872 (freq: 0.5471, raw: 0.8396, quant: 0.0006, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 291/1024 (28.4%) Top5:[542,963,188,722,694,1003,353,263,653,206,614,70,804,605,99]


π”¬ Encoder Diversity (iter 3800):
  Avg similarity: 0.0871 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9366 (0.0=collapsed)
[Epoch 6/100] [Batch 465/669 (69.5%)] [Iter 3810] Loss: 1.0877 (freq: 0.3965, raw: 0.6907, quant: 0.0005, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 244/1024 (23.8%) Top5:[993,488,96,574,471,614,929,793,99,542,804,163,98,361,136]


π”¬ Encoder Diversity (iter 3810):
  Avg similarity: 0.1914 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8911 (0.0=collapsed)
[Epoch 6/100] [Batch 475/669 (71.0%)] [Iter 3820] Loss: 1.4221 (freq: 0.5021, raw: 0.9191, quant: 0.0009, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 248/1024 (24.2%) Top5:[804,963,993,188,206,263,156,605,353,722,890,1003,542,92,757]


π”¬ Encoder Diversity (iter 3820):
  Avg similarity: 0.1059 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9283 (0.0=collapsed)
[Epoch 6/100] [Batch 485/669 (72.5%)] [Iter 3830] Loss: 1.1155 (freq: 0.4348, raw: 0.6801, quant: 0.0005, domain: 0.0000) LR: 1.14e-05 
π“ Codebook: 252/1024 (24.6%) Top5:[263,206,574,792,963,188,530,605,722,653,136,853,793,542,70]


π”¬ Encoder Diversity (iter 3830):
  Avg similarity: 0.1114 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9220 (0.0=collapsed)
[Epoch 6/100] [Batch 495/669 (74.0%)] [Iter 3840] Loss: 1.3626 (freq: 0.5246, raw: 0.8374, quant: 0.0006, domain: 0.0000) LR: 1.15e-05 
π“ Codebook: 236/1024 (23.0%) Top5:[542,792,99,263,979,574,722,694,1003,54,361,96,445,821,70]


π”¬ Encoder Diversity (iter 3840):
  Avg similarity: 0.1222 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9161 (0.0=collapsed)
[Epoch 6/100] [Batch 505/669 (75.5%)] [Iter 3850] Loss: 1.5847 (freq: 0.6293, raw: 0.9546, quant: 0.0008, domain: 0.0000) LR: 1.15e-05 
π“ Codebook: 228/1024 (22.3%) Top5:[542,263,963,574,792,530,835,239,853,16,361,614,98,96,136]


π”¬ Encoder Diversity (iter 3850):
  Avg similarity: 0.2117 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8786 (0.0=collapsed)
[Epoch 6/100] [Batch 515/669 (77.0%)] [Iter 3860] Loss: 0.9895 (freq: 0.3597, raw: 0.6294, quant: 0.0004, domain: 0.0000) LR: 1.15e-05 
π“ Codebook: 287/1024 (28.0%) Top5:[16,542,792,890,944,963,507,263,530,793,54,361,804,99,574]


π”¬ Encoder Diversity (iter 3860):
  Avg similarity: 0.0827 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 6/100] [Batch 525/669 (78.5%)] [Iter 3870] Loss: 1.2884 (freq: 0.5241, raw: 0.7637, quant: 0.0006, domain: 0.0000) LR: 1.16e-05 
π“ Codebook: 298/1024 (29.1%) Top5:[70,793,605,98,361,653,929,574,445,136,614,96,722,99,792]


π”¬ Encoder Diversity (iter 3870):
  Avg similarity: 0.1308 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9280 (0.0=collapsed)
[Epoch 6/100] [Batch 535/669 (80.0%)] [Iter 3880] Loss: 1.2597 (freq: 0.4884, raw: 0.7706, quant: 0.0006, domain: 0.0000) LR: 1.16e-05 
π“ Codebook: 297/1024 (29.0%) Top5:[653,605,70,614,445,722,929,361,96,471,206,574,239,694,99]


π”¬ Encoder Diversity (iter 3880):
  Avg similarity: 0.1239 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9233 (0.0=collapsed)
[Epoch 6/100] [Batch 545/669 (81.5%)] [Iter 3890] Loss: 1.3683 (freq: 0.5846, raw: 0.7830, quant: 0.0007, domain: 0.0000) LR: 1.16e-05 
π“ Codebook: 303/1024 (29.6%) Top5:[239,947,605,722,488,445,112,1003,821,792,70,353,653,891,694]


π”¬ Encoder Diversity (iter 3890):
  Avg similarity: 0.1018 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9293 (0.0=collapsed)
[Epoch 6/100] [Batch 555/669 (83.0%)] [Iter 3900] Loss: 1.2340 (freq: 0.4668, raw: 0.7663, quant: 0.0009, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 277/1024 (27.1%) Top5:[188,694,605,722,1003,445,70,574,239,542,353,653,96,614,206]


π”¬ Encoder Diversity (iter 3900):
  Avg similarity: 0.1117 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9286 (0.0=collapsed)
[Epoch 6/100] [Batch 565/669 (84.5%)] [Iter 3910] Loss: 1.4093 (freq: 0.5667, raw: 0.8420, quant: 0.0006, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 305/1024 (29.8%) Top5:[239,263,963,542,530,792,321,488,993,853,804,749,694,54,156]


π”¬ Encoder Diversity (iter 3910):
  Avg similarity: 0.1037 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9337 (0.0=collapsed)
[Epoch 6/100] [Batch 575/669 (85.9%)] [Iter 3920] Loss: 1.1717 (freq: 0.4239, raw: 0.7472, quant: 0.0007, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 332/1024 (32.4%) Top5:[239,792,361,263,614,99,98,963,542,488,96,722,70,694,1003]


π”¬ Encoder Diversity (iter 3920):
  Avg similarity: 0.1067 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 6/100] [Batch 585/669 (87.4%)] [Iter 3930] Loss: 1.1681 (freq: 0.4474, raw: 0.7201, quant: 0.0006, domain: 0.0000) LR: 1.17e-05 
π“ Codebook: 326/1024 (31.8%) Top5:[361,99,98,471,96,574,614,793,136,929,680,993,156,263,154]


π”¬ Encoder Diversity (iter 3930):
  Avg similarity: 0.0761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9442 (0.0=collapsed)
[Epoch 6/100] [Batch 595/669 (88.9%)] [Iter 3940] Loss: 1.6170 (freq: 0.6415, raw: 0.9747, quant: 0.0008, domain: 0.0000) LR: 1.18e-05 
π“ Codebook: 327/1024 (31.9%) Top5:[792,944,734,96,361,614,574,98,929,488,99,793,471,680,993]


π”¬ Encoder Diversity (iter 3940):
  Avg similarity: 0.1393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9263 (0.0=collapsed)
[Epoch 6/100] [Batch 605/669 (90.4%)] [Iter 3950] Loss: 1.2777 (freq: 0.5018, raw: 0.7752, quant: 0.0007, domain: 0.0000) LR: 1.18e-05 
π“ Codebook: 283/1024 (27.6%) Top5:[792,542,944,963,722,653,96,98,734,70,471,361,993,136,445]


π”¬ Encoder Diversity (iter 3950):
  Avg similarity: 0.1945 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9051 (0.0=collapsed)
[Epoch 6/100] [Batch 615/669 (91.9%)] [Iter 3960] Loss: 1.2238 (freq: 0.4507, raw: 0.7726, quant: 0.0005, domain: 0.0000) LR: 1.18e-05 
π“ Codebook: 245/1024 (23.9%) Top5:[963,722,653,445,70,694,605,1003,239,792,542,993,206,353,890]


π”¬ Encoder Diversity (iter 3960):
  Avg similarity: 0.2011 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8805 (0.0=collapsed)
[Epoch 6/100] [Batch 625/669 (93.4%)] [Iter 3970] Loss: 1.5239 (freq: 0.6108, raw: 0.9123, quant: 0.0008, domain: 0.0000) LR: 1.19e-05 
π“ Codebook: 280/1024 (27.3%) Top5:[542,239,574,96,507,944,963,792,614,136,98,488,947,993,471]


π”¬ Encoder Diversity (iter 3970):
  Avg similarity: 0.0885 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9435 (0.0=collapsed)
[Epoch 6/100] [Batch 635/669 (94.9%)] [Iter 3980] Loss: 1.5749 (freq: 0.6723, raw: 0.9018, quant: 0.0008, domain: 0.0000) LR: 1.19e-05 
π“ Codebook: 383/1024 (37.4%) Top5:[963,445,722,653,70,694,206,156,835,614,993,1003,605,792,263]


π”¬ Encoder Diversity (iter 3980):
  Avg similarity: 0.0789 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9454 (0.0=collapsed)
[Epoch 6/100] [Batch 645/669 (96.4%)] [Iter 3990] Loss: 1.3830 (freq: 0.5562, raw: 0.8262, quant: 0.0006, domain: 0.0000) LR: 1.19e-05 
π“ Codebook: 326/1024 (31.8%) Top5:[963,361,792,96,156,614,136,574,98,488,530,263,791,471,99]


π”¬ Encoder Diversity (iter 3990):
  Avg similarity: 0.1213 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9341 (0.0=collapsed)
[Epoch 6/100] [Batch 655/669 (97.9%)] [Iter 4000] Loss: 1.2722 (freq: 0.4932, raw: 0.7784, quant: 0.0006, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 335/1024 (32.7%) Top5:[614,361,963,574,792,98,263,99,530,136,722,96,542,70,445]


π”¬ Encoder Diversity (iter 4000):
  Avg similarity: 0.1071 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9326 (0.0=collapsed)
[Epoch 6/100] [Batch 665/669 (99.4%)] [Iter 4010] Loss: 1.1984 (freq: 0.4289, raw: 0.7689, quant: 0.0006, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 337/1024 (32.9%) Top5:[542,488,239,792,963,263,96,361,507,979,821,136,574,98,530]


π”¬ Encoder Diversity (iter 4010):
  Avg similarity: 0.0885 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9345 (0.0=collapsed)

================================================================================
[Epoch 6] Validation Results:
  Total Loss: 0.6971
  Freq Loss:  0.2287
  Raw Loss:   0.4680
  Quant Loss: 0.0004
  π“ Codebook Usage: 234/1024 (22.9%)
  π“ Codebook Entropy: 3.5199 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 63738 (49.0%)
  Top 10 most used codes:
    1. Code 605: 7601 times (5.84%)
    2. Code 188: 7285 times (5.60%)
    3. Code 653: 7079 times (5.44%)
    4. Code 136: 6376 times (4.90%)
    5. Code 614: 6233 times (4.79%)
    6. Code 899: 6075 times (4.67%)
    7. Code 96: 6039 times (4.64%)
    8. Code 574: 5877 times (4.51%)
    9. Code 361: 5626 times (4.32%)
    10. Code 445: 5547 times (4.26%)
  Bottom 5 least used codes (among used):
    1. Code 874: 2 times (0.00%)
    2. Code 842: 2 times (0.00%)
    3. Code 736: 2 times (0.00%)
    4. Code 324: 3 times (0.00%)
    5. Code 241: 5 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 6
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 7/100] [Batch 6/669 (0.9%)] [Iter 4020] Loss: 0.9846 (freq: 0.3516, raw: 0.6322, quant: 0.0007, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 954/1024 (93.2%) Top5:[96,361,136,614,542,471,98,574,99,929,792,963,653,188,263]


π”¬ Encoder Diversity (iter 4020):
  Avg similarity: 0.1399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9096 (0.0=collapsed)
[Epoch 7/100] [Batch 16/669 (2.4%)] [Iter 4030] Loss: 1.2516 (freq: 0.4729, raw: 0.7781, quant: 0.0006, domain: 0.0000) LR: 1.20e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[542,963,792,263,96,136,574,680,471,614,361,98,234,389,99]


π”¬ Encoder Diversity (iter 4030):
  Avg similarity: 0.1672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9038 (0.0=collapsed)
[Epoch 7/100] [Batch 26/669 (3.9%)] [Iter 4040] Loss: 1.4799 (freq: 0.5816, raw: 0.8975, quant: 0.0008, domain: 0.0000) LR: 1.21e-05 
π“ Codebook: 435/1024 (42.5%) Top5:[792,542,963,263,234,244,605,389,958,899,653,295,206,188,373]


π”¬ Encoder Diversity (iter 4040):
  Avg similarity: 0.1235 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9315 (0.0=collapsed)
[Epoch 7/100] [Batch 36/669 (5.4%)] [Iter 4050] Loss: 1.1137 (freq: 0.4231, raw: 0.6900, quant: 0.0006, domain: 0.0000) LR: 1.21e-05 
π“ Codebook: 459/1024 (44.8%) Top5:[792,542,963,206,653,605,722,244,899,70,263,188,489,445,694]


π”¬ Encoder Diversity (iter 4050):
  Avg similarity: 0.0961 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9391 (0.0=collapsed)
[Epoch 7/100] [Batch 46/669 (6.9%)] [Iter 4060] Loss: 1.0057 (freq: 0.3801, raw: 0.6251, quant: 0.0005, domain: 0.0000) LR: 1.21e-05 
π“ Codebook: 349/1024 (34.1%) Top5:[96,542,929,136,471,614,98,792,206,658,963,680,574,653,371]


π”¬ Encoder Diversity (iter 4060):
  Avg similarity: 0.0878 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9394 (0.0=collapsed)
[Epoch 7/100] [Batch 56/669 (8.4%)] [Iter 4070] Loss: 1.3501 (freq: 0.5547, raw: 0.7947, quant: 0.0007, domain: 0.0000) LR: 1.22e-05 
π“ Codebook: 329/1024 (32.1%) Top5:[542,371,792,96,136,614,963,574,263,929,206,772,899,98,605]


π”¬ Encoder Diversity (iter 4070):
  Avg similarity: 0.1161 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9266 (0.0=collapsed)
[Epoch 7/100] [Batch 66/669 (9.9%)] [Iter 4080] Loss: 0.9526 (freq: 0.3208, raw: 0.6312, quant: 0.0005, domain: 0.0000) LR: 1.22e-05 
π“ Codebook: 311/1024 (30.4%) Top5:[578,963,698,792,542,206,614,371,772,899,263,1003,96,574,605]


π”¬ Encoder Diversity (iter 4080):
  Avg similarity: 0.0906 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9347 (0.0=collapsed)
[Epoch 7/100] [Batch 76/669 (11.4%)] [Iter 4090] Loss: 1.1125 (freq: 0.4074, raw: 0.7045, quant: 0.0005, domain: 0.0000) LR: 1.22e-05 
π“ Codebook: 333/1024 (32.5%) Top5:[899,963,445,722,653,206,371,1003,70,188,605,694,574,136,792]


π”¬ Encoder Diversity (iter 4090):
  Avg similarity: 0.0992 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9380 (0.0=collapsed)
[Epoch 7/100] [Batch 86/669 (12.9%)] [Iter 4100] Loss: 1.2539 (freq: 0.4886, raw: 0.7647, quant: 0.0006, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 378/1024 (36.9%) Top5:[792,339,578,574,98,136,471,614,361,899,542,96,445,1003,99]


π”¬ Encoder Diversity (iter 4100):
  Avg similarity: 0.1282 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9264 (0.0=collapsed)
[Epoch 7/100] [Batch 96/669 (14.3%)] [Iter 4110] Loss: 1.1127 (freq: 0.4154, raw: 0.6967, quant: 0.0005, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 367/1024 (35.8%) Top5:[471,614,361,98,136,96,445,99,1003,574,994,963,206,605,694]


π”¬ Encoder Diversity (iter 4110):
  Avg similarity: 0.1072 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9328 (0.0=collapsed)
[Epoch 7/100] [Batch 106/669 (15.8%)] [Iter 4120] Loss: 1.2232 (freq: 0.4579, raw: 0.7646, quant: 0.0007, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 325/1024 (31.7%) Top5:[542,371,792,738,614,471,361,96,258,98,136,772,578,99,167]


π”¬ Encoder Diversity (iter 4120):
  Avg similarity: 0.0861 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9350 (0.0=collapsed)
[Epoch 7/100] [Batch 116/669 (17.3%)] [Iter 4130] Loss: 1.4546 (freq: 0.5456, raw: 0.9083, quant: 0.0007, domain: 0.0000) LR: 1.23e-05 
π“ Codebook: 253/1024 (24.7%) Top5:[743,963,295,792,542,136,96,98,361,614,574,471,578,994,653]


π”¬ Encoder Diversity (iter 4130):
  Avg similarity: 0.1135 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9262 (0.0=collapsed)
[Epoch 7/100] [Batch 126/669 (18.8%)] [Iter 4140] Loss: 1.2320 (freq: 0.4654, raw: 0.7660, quant: 0.0006, domain: 0.0000) LR: 1.24e-05 
π“ Codebook: 322/1024 (31.4%) Top5:[542,792,578,371,361,574,614,963,772,653,136,929,98,698,676]


π”¬ Encoder Diversity (iter 4140):
  Avg similarity: 0.1377 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9164 (0.0=collapsed)
[Epoch 7/100] [Batch 136/669 (20.3%)] [Iter 4150] Loss: 1.2005 (freq: 0.4721, raw: 0.7277, quant: 0.0007, domain: 0.0000) LR: 1.24e-05 
π“ Codebook: 358/1024 (35.0%) Top5:[542,371,792,653,578,605,722,694,445,136,1003,574,899,206,70]


π”¬ Encoder Diversity (iter 4150):
  Avg similarity: 0.1253 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9180 (0.0=collapsed)
[Epoch 7/100] [Batch 146/669 (21.8%)] [Iter 4160] Loss: 1.4091 (freq: 0.5727, raw: 0.8357, quant: 0.0007, domain: 0.0000) LR: 1.24e-05 
π“ Codebook: 292/1024 (28.5%) Top5:[542,371,958,792,963,295,694,899,1003,389,698,53,777,653,632]


π”¬ Encoder Diversity (iter 4160):
  Avg similarity: 0.1035 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9359 (0.0=collapsed)
[Epoch 7/100] [Batch 156/669 (23.3%)] [Iter 4170] Loss: 1.2310 (freq: 0.4569, raw: 0.7736, quant: 0.0006, domain: 0.0000) LR: 1.25e-05 
π“ Codebook: 335/1024 (32.7%) Top5:[542,371,232,792,258,899,963,631,614,772,698,958,578,1003,96]


π”¬ Encoder Diversity (iter 4170):
  Avg similarity: 0.0969 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9266 (0.0=collapsed)
[Epoch 7/100] [Batch 166/669 (24.8%)] [Iter 4180] Loss: 1.2390 (freq: 0.4901, raw: 0.7483, quant: 0.0006, domain: 0.0000) LR: 1.25e-05 
π“ Codebook: 360/1024 (35.2%) Top5:[963,542,371,614,96,136,792,263,471,295,98,994,981,958,361]


π”¬ Encoder Diversity (iter 4180):
  Avg similarity: 0.1321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9250 (0.0=collapsed)
[Epoch 7/100] [Batch 176/669 (26.3%)] [Iter 4190] Loss: 1.2850 (freq: 0.5075, raw: 0.7770, quant: 0.0006, domain: 0.0000) LR: 1.25e-05 
π“ Codebook: 382/1024 (37.3%) Top5:[542,963,792,371,994,295,614,263,374,958,631,981,258,899,556]


π”¬ Encoder Diversity (iter 4190):
  Avg similarity: 0.1145 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9287 (0.0=collapsed)
[Epoch 7/100] [Batch 186/669 (27.8%)] [Iter 4200] Loss: 1.4334 (freq: 0.6092, raw: 0.8235, quant: 0.0007, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 364/1024 (35.5%) Top5:[792,445,653,694,206,614,1003,963,361,471,542,605,899,70,958]


π”¬ Encoder Diversity (iter 4200):
  Avg similarity: 0.1179 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9168 (0.0=collapsed)
[Epoch 7/100] [Batch 196/669 (29.3%)] [Iter 4210] Loss: 1.5051 (freq: 0.6162, raw: 0.8883, quant: 0.0006, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 311/1024 (30.4%) Top5:[792,542,371,772,703,278,578,676,958,963,526,631,738,143,653]


π”¬ Encoder Diversity (iter 4210):
  Avg similarity: 0.1593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9151 (0.0=collapsed)
[Epoch 7/100] [Batch 206/669 (30.8%)] [Iter 4220] Loss: 1.1192 (freq: 0.4305, raw: 0.6882, quant: 0.0005, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 294/1024 (28.7%) Top5:[792,614,278,445,574,98,542,96,371,361,958,136,471,605,70]


π”¬ Encoder Diversity (iter 4220):
  Avg similarity: 0.1183 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9249 (0.0=collapsed)
[Epoch 7/100] [Batch 216/669 (32.3%)] [Iter 4230] Loss: 1.2227 (freq: 0.4573, raw: 0.7646, quant: 0.0007, domain: 0.0000) LR: 1.26e-05 
π“ Codebook: 296/1024 (28.9%) Top5:[371,792,542,278,614,445,899,631,722,958,206,96,653,698,70]


π”¬ Encoder Diversity (iter 4230):
  Avg similarity: 0.1796 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9067 (0.0=collapsed)
[Epoch 7/100] [Batch 226/669 (33.8%)] [Iter 4240] Loss: 1.3518 (freq: 0.5278, raw: 0.8234, quant: 0.0006, domain: 0.0000) LR: 1.27e-05 
π“ Codebook: 348/1024 (34.0%) Top5:[371,542,614,792,339,96,963,958,574,136,98,278,994,744,471]


π”¬ Encoder Diversity (iter 4240):
  Avg similarity: 0.1718 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9001 (0.0=collapsed)
[Epoch 7/100] [Batch 236/669 (35.3%)] [Iter 4250] Loss: 1.2455 (freq: 0.4669, raw: 0.7780, quant: 0.0006, domain: 0.0000) LR: 1.27e-05 
π“ Codebook: 291/1024 (28.4%) Top5:[542,371,614,899,206,96,1003,694,722,744,574,70,658,152,653]


π”¬ Encoder Diversity (iter 4250):
  Avg similarity: 0.1013 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9337 (0.0=collapsed)
[Epoch 7/100] [Batch 246/669 (36.8%)] [Iter 4260] Loss: 1.0870 (freq: 0.3915, raw: 0.6950, quant: 0.0005, domain: 0.0000) LR: 1.27e-05 
π“ Codebook: 325/1024 (31.7%) Top5:[371,542,614,744,792,96,136,278,574,578,206,658,664,99,471]


π”¬ Encoder Diversity (iter 4260):
  Avg similarity: 0.1587 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9054 (0.0=collapsed)
[Epoch 7/100] [Batch 256/669 (38.3%)] [Iter 4270] Loss: 1.4279 (freq: 0.5245, raw: 0.9026, quant: 0.0008, domain: 0.0000) LR: 1.28e-05 
π“ Codebook: 352/1024 (34.4%) Top5:[792,371,295,958,963,994,278,744,167,542,899,694,96,614,981]


π”¬ Encoder Diversity (iter 4270):
  Avg similarity: 0.1773 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8971 (0.0=collapsed)
[Epoch 7/100] [Batch 266/669 (39.8%)] [Iter 4280] Loss: 1.1962 (freq: 0.4354, raw: 0.7602, quant: 0.0006, domain: 0.0000) LR: 1.28e-05 
π“ Codebook: 305/1024 (29.8%) Top5:[792,542,371,278,744,899,258,963,738,206,698,722,1003,664,510]


π”¬ Encoder Diversity (iter 4280):
  Avg similarity: 0.1065 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9341 (0.0=collapsed)
[Epoch 7/100] [Batch 276/669 (41.3%)] [Iter 4290] Loss: 1.3007 (freq: 0.4719, raw: 0.8281, quant: 0.0007, domain: 0.0000) LR: 1.28e-05 
π“ Codebook: 268/1024 (26.2%) Top5:[98,963,96,574,136,582,792,899,614,278,471,361,244,958,263]


π”¬ Encoder Diversity (iter 4290):
  Avg similarity: 0.1072 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9356 (0.0=collapsed)
[Epoch 7/100] [Batch 286/669 (42.8%)] [Iter 4300] Loss: 1.1175 (freq: 0.4394, raw: 0.6776, quant: 0.0006, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 282/1024 (27.5%) Top5:[899,722,206,445,98,70,694,574,136,278,1003,96,605,614,188]


π”¬ Encoder Diversity (iter 4300):
  Avg similarity: 0.1003 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9361 (0.0=collapsed)
[Epoch 7/100] [Batch 296/669 (44.2%)] [Iter 4310] Loss: 0.9744 (freq: 0.3473, raw: 0.6266, quant: 0.0005, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 364/1024 (35.5%) Top5:[136,96,98,614,574,792,582,994,471,99,958,371,278,698,361]


π”¬ Encoder Diversity (iter 4310):
  Avg similarity: 0.1045 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9334 (0.0=collapsed)
[Epoch 7/100] [Batch 306/669 (45.7%)] [Iter 4320] Loss: 1.0881 (freq: 0.4188, raw: 0.6689, quant: 0.0005, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[542,792,371,958,96,698,777,614,445,814,899,653,295,574,136]


π”¬ Encoder Diversity (iter 4320):
  Avg similarity: 0.0989 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9235 (0.0=collapsed)
[Epoch 7/100] [Batch 316/669 (47.2%)] [Iter 4330] Loss: 1.1039 (freq: 0.4217, raw: 0.6816, quant: 0.0005, domain: 0.0000) LR: 1.29e-05 
π“ Codebook: 309/1024 (30.2%) Top5:[542,899,70,653,694,722,445,1003,814,605,792,772,206,738,339]


π”¬ Encoder Diversity (iter 4330):
  Avg similarity: 0.1089 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9281 (0.0=collapsed)
[Epoch 7/100] [Batch 326/669 (48.7%)] [Iter 4340] Loss: 1.7096 (freq: 0.7543, raw: 0.9546, quant: 0.0007, domain: 0.0000) LR: 1.30e-05 
π“ Codebook: 340/1024 (33.2%) Top5:[278,542,792,744,963,631,664,263,772,738,994,257,578,244,295]


π”¬ Encoder Diversity (iter 4340):
  Avg similarity: 0.0931 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9339 (0.0=collapsed)
[Epoch 7/100] [Batch 336/669 (50.2%)] [Iter 4350] Loss: 1.0576 (freq: 0.3755, raw: 0.6816, quant: 0.0006, domain: 0.0000) LR: 1.30e-05 
π“ Codebook: 375/1024 (36.6%) Top5:[278,792,744,98,542,96,365,814,899,614,1003,694,574,99,206]


π”¬ Encoder Diversity (iter 4350):
  Avg similarity: 0.0829 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 7/100] [Batch 346/669 (51.7%)] [Iter 4360] Loss: 1.2891 (freq: 0.4385, raw: 0.8499, quant: 0.0007, domain: 0.0000) LR: 1.30e-05 
π“ Codebook: 386/1024 (37.7%) Top5:[278,994,792,98,70,899,605,206,1003,694,744,445,96,542,361]


π”¬ Encoder Diversity (iter 4360):
  Avg similarity: 0.1473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9147 (0.0=collapsed)
[Epoch 7/100] [Batch 356/669 (53.2%)] [Iter 4370] Loss: 1.4065 (freq: 0.5077, raw: 0.8981, quant: 0.0006, domain: 0.0000) LR: 1.31e-05 
π“ Codebook: 352/1024 (34.4%) Top5:[278,792,542,744,371,664,258,631,55,98,994,614,295,738,232]


π”¬ Encoder Diversity (iter 4370):
  Avg similarity: 0.1333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9253 (0.0=collapsed)
[Epoch 7/100] [Batch 366/669 (54.7%)] [Iter 4380] Loss: 1.3695 (freq: 0.5393, raw: 0.8296, quant: 0.0006, domain: 0.0000) LR: 1.31e-05 
π“ Codebook: 335/1024 (32.7%) Top5:[542,994,614,98,792,371,582,471,958,963,574,981,361,136,295]


π”¬ Encoder Diversity (iter 4380):
  Avg similarity: 0.1265 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9228 (0.0=collapsed)
[Epoch 7/100] [Batch 376/669 (56.2%)] [Iter 4390] Loss: 1.4207 (freq: 0.5883, raw: 0.8317, quant: 0.0007, domain: 0.0000) LR: 1.31e-05 
π“ Codebook: 371/1024 (36.2%) Top5:[605,958,963,694,994,792,653,295,1003,206,722,899,70,445,374]


π”¬ Encoder Diversity (iter 4390):
  Avg similarity: 0.1232 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9268 (0.0=collapsed)
[Epoch 7/100] [Batch 386/669 (57.7%)] [Iter 4400] Loss: 1.2811 (freq: 0.4632, raw: 0.8174, quant: 0.0005, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 340/1024 (33.2%) Top5:[792,278,371,631,542,258,738,188,1003,605,206,578,698,653,722]


π”¬ Encoder Diversity (iter 4400):
  Avg similarity: 0.1483 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9121 (0.0=collapsed)
[Epoch 7/100] [Batch 396/669 (59.2%)] [Iter 4410] Loss: 1.4596 (freq: 0.5875, raw: 0.8715, quant: 0.0006, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 322/1024 (31.4%) Top5:[278,792,542,371,738,631,258,664,510,369,55,703,698,526,676]


π”¬ Encoder Diversity (iter 4410):
  Avg similarity: 0.1490 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9096 (0.0=collapsed)
[Epoch 7/100] [Batch 406/669 (60.7%)] [Iter 4420] Loss: 1.4774 (freq: 0.5749, raw: 0.9019, quant: 0.0006, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 291/1024 (28.4%) Top5:[278,792,542,136,614,369,98,96,631,371,772,738,994,582,471]


π”¬ Encoder Diversity (iter 4420):
  Avg similarity: 0.1998 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8951 (0.0=collapsed)
[Epoch 7/100] [Batch 416/669 (62.2%)] [Iter 4430] Loss: 1.4587 (freq: 0.5661, raw: 0.8920, quant: 0.0006, domain: 0.0000) LR: 1.32e-05 
π“ Codebook: 415/1024 (40.5%) Top5:[963,994,542,958,792,369,981,244,143,295,374,257,232,777,489]


π”¬ Encoder Diversity (iter 4430):
  Avg similarity: 0.0845 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 7/100] [Batch 426/669 (63.7%)] [Iter 4440] Loss: 1.0808 (freq: 0.3887, raw: 0.6916, quant: 0.0005, domain: 0.0000) LR: 1.33e-05 
π“ Codebook: 348/1024 (34.0%) Top5:[98,614,899,96,471,793,605,994,574,278,445,814,722,582,653]


π”¬ Encoder Diversity (iter 4440):
  Avg similarity: 0.1015 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9274 (0.0=collapsed)
[Epoch 7/100] [Batch 436/669 (65.2%)] [Iter 4450] Loss: 1.3699 (freq: 0.5400, raw: 0.8292, quant: 0.0006, domain: 0.0000) LR: 1.33e-05 
π“ Codebook: 298/1024 (29.1%) Top5:[278,542,96,98,361,793,614,99,792,574,744,582,958,371,929]


π”¬ Encoder Diversity (iter 4450):
  Avg similarity: 0.1157 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9139 (0.0=collapsed)
[Epoch 7/100] [Batch 446/669 (66.7%)] [Iter 4460] Loss: 1.5398 (freq: 0.6520, raw: 0.8871, quant: 0.0006, domain: 0.0000) LR: 1.33e-05 
π“ Codebook: 379/1024 (37.0%) Top5:[278,374,295,614,263,96,720,971,958,963,361,234,98,793,244]


π”¬ Encoder Diversity (iter 4460):
  Avg similarity: 0.1170 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9232 (0.0=collapsed)
[Epoch 7/100] [Batch 456/669 (68.2%)] [Iter 4470] Loss: 1.4240 (freq: 0.5902, raw: 0.8332, quant: 0.0006, domain: 0.0000) LR: 1.34e-05 
π“ Codebook: 300/1024 (29.3%) Top5:[278,542,55,445,605,96,1003,744,70,614,722,582,664,792,361]


π”¬ Encoder Diversity (iter 4470):
  Avg similarity: 0.0683 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9440 (0.0=collapsed)
[Epoch 7/100] [Batch 466/669 (69.7%)] [Iter 4480] Loss: 1.2735 (freq: 0.5447, raw: 0.7283, quant: 0.0005, domain: 0.0000) LR: 1.34e-05 
π“ Codebook: 259/1024 (25.3%) Top5:[278,542,792,963,374,744,371,232,55,664,258,263,605,167,738]


π”¬ Encoder Diversity (iter 4480):
  Avg similarity: 0.0785 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9357 (0.0=collapsed)
[Epoch 7/100] [Batch 476/669 (71.2%)] [Iter 4490] Loss: 1.2268 (freq: 0.4533, raw: 0.7729, quant: 0.0006, domain: 0.0000) LR: 1.34e-05 
π“ Codebook: 294/1024 (28.7%) Top5:[278,792,963,542,371,605,582,744,738,70,143,994,361,653,574]


π”¬ Encoder Diversity (iter 4490):
  Avg similarity: 0.0825 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9384 (0.0=collapsed)
[Epoch 7/100] [Batch 486/669 (72.6%)] [Iter 4500] Loss: 1.1975 (freq: 0.4409, raw: 0.7561, quant: 0.0005, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 298/1024 (29.1%) Top5:[278,792,98,614,471,605,963,582,143,958,744,653,445,389,574]


π”¬ Encoder Diversity (iter 4500):
  Avg similarity: 0.0810 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 7/100] [Batch 496/669 (74.1%)] [Iter 4510] Loss: 1.4051 (freq: 0.5935, raw: 0.8111, quant: 0.0006, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 304/1024 (29.7%) Top5:[542,792,958,963,994,263,232,278,295,981,605,98,244,777,53]


π”¬ Encoder Diversity (iter 4510):
  Avg similarity: 0.0881 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9330 (0.0=collapsed)
[Epoch 7/100] [Batch 506/669 (75.6%)] [Iter 4520] Loss: 1.2392 (freq: 0.4733, raw: 0.7654, quant: 0.0005, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 276/1024 (27.0%) Top5:[278,614,98,582,471,295,263,777,542,96,361,963,639,374,958]


π”¬ Encoder Diversity (iter 4520):
  Avg similarity: 0.0739 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9414 (0.0=collapsed)
[Epoch 7/100] [Batch 516/669 (77.1%)] [Iter 4530] Loss: 1.2263 (freq: 0.4707, raw: 0.7550, quant: 0.0006, domain: 0.0000) LR: 1.35e-05 
π“ Codebook: 343/1024 (33.5%) Top5:[278,542,371,899,98,963,814,792,614,445,96,1003,263,316,777]


π”¬ Encoder Diversity (iter 4530):
  Avg similarity: 0.1444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9229 (0.0=collapsed)
[Epoch 7/100] [Batch 526/669 (78.6%)] [Iter 4540] Loss: 1.0659 (freq: 0.3835, raw: 0.6818, quant: 0.0006, domain: 0.0000) LR: 1.36e-05 
π“ Codebook: 433/1024 (42.3%) Top5:[542,792,963,371,278,258,899,1003,374,958,744,263,244,631,234]


π”¬ Encoder Diversity (iter 4540):
  Avg similarity: 0.0989 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9363 (0.0=collapsed)
[Epoch 7/100] [Batch 536/669 (80.1%)] [Iter 4550] Loss: 1.3623 (freq: 0.5369, raw: 0.8247, quant: 0.0006, domain: 0.0000) LR: 1.36e-05 
π“ Codebook: 384/1024 (37.5%) Top5:[542,98,582,278,96,792,99,614,639,361,658,574,471,316,744]


π”¬ Encoder Diversity (iter 4550):
  Avg similarity: 0.1020 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9362 (0.0=collapsed)
[Epoch 7/100] [Batch 546/669 (81.6%)] [Iter 4560] Loss: 1.3419 (freq: 0.5016, raw: 0.8398, quant: 0.0006, domain: 0.0000) LR: 1.36e-05 
π“ Codebook: 303/1024 (29.6%) Top5:[542,278,814,664,374,722,792,653,605,963,899,70,578,371,738]


π”¬ Encoder Diversity (iter 4560):
  Avg similarity: 0.1261 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9249 (0.0=collapsed)
[Epoch 7/100] [Batch 556/669 (83.1%)] [Iter 4570] Loss: 0.9322 (freq: 0.3302, raw: 0.6014, quant: 0.0006, domain: 0.0000) LR: 1.37e-05 
π“ Codebook: 322/1024 (31.4%) Top5:[605,722,445,814,98,899,1003,582,96,653,614,70,694,658,278]


π”¬ Encoder Diversity (iter 4570):
  Avg similarity: 0.1358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9215 (0.0=collapsed)
[Epoch 7/100] [Batch 566/669 (84.6%)] [Iter 4580] Loss: 0.8225 (freq: 0.2739, raw: 0.5481, quant: 0.0004, domain: 0.0000) LR: 1.37e-05 
π“ Codebook: 320/1024 (31.2%) Top5:[278,98,614,582,574,96,471,436,792,658,361,371,664,136,793]


π”¬ Encoder Diversity (iter 4580):
  Avg similarity: 0.0950 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9333 (0.0=collapsed)
[Epoch 7/100] [Batch 576/669 (86.1%)] [Iter 4590] Loss: 1.1578 (freq: 0.4148, raw: 0.7423, quant: 0.0006, domain: 0.0000) LR: 1.37e-05 
π“ Codebook: 337/1024 (32.9%) Top5:[278,792,371,436,994,963,220,664,542,738,631,55,44,698,445]


π”¬ Encoder Diversity (iter 4590):
  Avg similarity: 0.1122 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9270 (0.0=collapsed)
[Epoch 7/100] [Batch 586/669 (87.6%)] [Iter 4600] Loss: 1.2967 (freq: 0.4746, raw: 0.8215, quant: 0.0006, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 312/1024 (30.5%) Top5:[278,220,792,371,96,316,574,963,374,614,994,605,703,582,639]


π”¬ Encoder Diversity (iter 4600):
  Avg similarity: 0.1530 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9154 (0.0=collapsed)
[Epoch 7/100] [Batch 596/669 (89.1%)] [Iter 4610] Loss: 1.3628 (freq: 0.5440, raw: 0.8183, quant: 0.0006, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 282/1024 (27.5%) Top5:[371,44,605,445,542,814,263,614,664,1003,963,70,220,578,278]


π”¬ Encoder Diversity (iter 4610):
  Avg similarity: 0.0931 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9376 (0.0=collapsed)
[Epoch 7/100] [Batch 606/669 (90.6%)] [Iter 4620] Loss: 1.1395 (freq: 0.3833, raw: 0.7555, quant: 0.0007, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 284/1024 (27.7%) Top5:[614,96,605,814,792,582,44,98,220,99,542,188,445,574,639]


π”¬ Encoder Diversity (iter 4620):
  Avg similarity: 0.1028 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 7/100] [Batch 616/669 (92.1%)] [Iter 4630] Loss: 1.2829 (freq: 0.4551, raw: 0.8272, quant: 0.0006, domain: 0.0000) LR: 1.38e-05 
π“ Codebook: 304/1024 (29.7%) Top5:[792,44,605,994,963,899,814,220,958,295,445,70,1003,722,188]


π”¬ Encoder Diversity (iter 4630):
  Avg similarity: 0.0859 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9321 (0.0=collapsed)
[Epoch 7/100] [Batch 626/669 (93.6%)] [Iter 4640] Loss: 1.3144 (freq: 0.4956, raw: 0.8181, quant: 0.0007, domain: 0.0000) LR: 1.39e-05 
π“ Codebook: 343/1024 (33.5%) Top5:[605,445,44,814,722,336,694,1003,792,614,899,70,994,96,295]


π”¬ Encoder Diversity (iter 4640):
  Avg similarity: 0.1520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9270 (0.0=collapsed)
[Epoch 7/100] [Batch 636/669 (95.1%)] [Iter 4650] Loss: 1.5029 (freq: 0.6077, raw: 0.8946, quant: 0.0006, domain: 0.0000) LR: 1.39e-05 
π“ Codebook: 308/1024 (30.1%) Top5:[220,374,336,605,582,44,825,295,792,257,614,994,963,744,263]


π”¬ Encoder Diversity (iter 4650):
  Avg similarity: 0.1591 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9121 (0.0=collapsed)
[Epoch 7/100] [Batch 646/669 (96.6%)] [Iter 4660] Loss: 1.2118 (freq: 0.4461, raw: 0.7652, quant: 0.0005, domain: 0.0000) LR: 1.39e-05 
π“ Codebook: 274/1024 (26.8%) Top5:[278,582,436,605,98,471,792,614,220,664,574,96,445,814,336]


π”¬ Encoder Diversity (iter 4660):
  Avg similarity: 0.0952 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9262 (0.0=collapsed)
[Epoch 7/100] [Batch 656/669 (98.1%)] [Iter 4670] Loss: 1.3364 (freq: 0.5086, raw: 0.8271, quant: 0.0007, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 310/1024 (30.3%) Top5:[220,278,792,371,631,336,614,582,291,98,605,44,664,471,445]


π”¬ Encoder Diversity (iter 4670):
  Avg similarity: 0.0971 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9387 (0.0=collapsed)
[Epoch 7/100] [Batch 666/669 (99.6%)] [Iter 4680] Loss: 1.3634 (freq: 0.5458, raw: 0.8170, quant: 0.0006, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 312/1024 (30.5%) Top5:[278,792,220,336,196,958,371,711,578,994,631,316,436,814,664]


π”¬ Encoder Diversity (iter 4680):
  Avg similarity: 0.0811 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9409 (0.0=collapsed)

================================================================================
[Epoch 7] Validation Results:
  Total Loss: 0.6746
  Freq Loss:  0.2172
  Raw Loss:   0.4570
  Quant Loss: 0.0004
  π“ Codebook Usage: 241/1024 (23.5%)
  π“ Codebook Entropy: 3.7469 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 57896 (44.5%)
  Top 10 most used codes:
    1. Code 605: 7936 times (6.10%)
    2. Code 44: 7607 times (5.84%)
    3. Code 445: 6241 times (4.79%)
    4. Code 814: 6117 times (4.70%)
    5. Code 899: 5560 times (4.27%)
    6. Code 206: 5368 times (4.12%)
    7. Code 694: 4999 times (3.84%)
    8. Code 1003: 4853 times (3.73%)
    9. Code 574: 4628 times (3.55%)
    10. Code 722: 4587 times (3.52%)
  Bottom 5 least used codes (among used):
    1. Code 481: 1 times (0.00%)
    2. Code 664: 1 times (0.00%)
    3. Code 107: 2 times (0.00%)
    4. Code 730: 5 times (0.00%)
    5. Code 109: 6 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 7
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 8/100] [Batch 7/669 (1.0%)] [Iter 4690] Loss: 1.1627 (freq: 0.3994, raw: 0.7627, quant: 0.0006, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 949/1024 (92.7%) Top5:[582,98,614,99,471,96,361,152,574,639,658,136,958,44,605]


π”¬ Encoder Diversity (iter 4690):
  Avg similarity: 0.1151 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9326 (0.0=collapsed)
[Epoch 8/100] [Batch 17/669 (2.5%)] [Iter 4700] Loss: 1.1143 (freq: 0.4499, raw: 0.6639, quant: 0.0005, domain: 0.0000) LR: 1.40e-05 
π“ Codebook: 586/1024 (57.2%) Top5:[70,605,722,445,582,44,94,958,562,38,814,519,574,83,619]


π”¬ Encoder Diversity (iter 4700):
  Avg similarity: 0.0879 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9421 (0.0=collapsed)
[Epoch 8/100] [Batch 27/669 (4.0%)] [Iter 4710] Loss: 1.0998 (freq: 0.4316, raw: 0.6676, quant: 0.0005, domain: 0.0000) LR: 1.41e-05 
π“ Codebook: 345/1024 (33.7%) Top5:[605,722,94,614,70,44,361,582,99,445,694,206,1003,98,899]


π”¬ Encoder Diversity (iter 4710):
  Avg similarity: 0.1287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9172 (0.0=collapsed)
[Epoch 8/100] [Batch 37/669 (5.5%)] [Iter 4720] Loss: 1.1844 (freq: 0.4317, raw: 0.7520, quant: 0.0007, domain: 0.0000) LR: 1.41e-05 
π“ Codebook: 316/1024 (30.9%) Top5:[38,94,183,526,519,319,958,562,614,739,605,413,361,99,822]


π”¬ Encoder Diversity (iter 4720):
  Avg similarity: 0.0998 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9354 (0.0=collapsed)
[Epoch 8/100] [Batch 47/669 (7.0%)] [Iter 4730] Loss: 1.3723 (freq: 0.5596, raw: 0.8121, quant: 0.0006, domain: 0.0000) LR: 1.41e-05 
π“ Codebook: 265/1024 (25.9%) Top5:[94,44,605,899,445,814,38,70,958,526,200,896,1003,183,206]


π”¬ Encoder Diversity (iter 4730):
  Avg similarity: 0.0864 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9467 (0.0=collapsed)
[Epoch 8/100] [Batch 57/669 (8.5%)] [Iter 4740] Loss: 1.2077 (freq: 0.4680, raw: 0.7390, quant: 0.0006, domain: 0.0000) LR: 1.42e-05 
π“ Codebook: 301/1024 (29.4%) Top5:[614,38,152,574,94,361,582,98,471,96,958,888,453,52,526]


π”¬ Encoder Diversity (iter 4740):
  Avg similarity: 0.1519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9168 (0.0=collapsed)
[Epoch 8/100] [Batch 67/669 (10.0%)] [Iter 4750] Loss: 1.2942 (freq: 0.5314, raw: 0.7621, quant: 0.0006, domain: 0.0000) LR: 1.42e-05 
π“ Codebook: 308/1024 (30.1%) Top5:[94,614,361,38,99,152,98,582,77,183,519,888,96,574,605]


π”¬ Encoder Diversity (iter 4750):
  Avg similarity: 0.1029 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9354 (0.0=collapsed)
[Epoch 8/100] [Batch 77/669 (11.5%)] [Iter 4760] Loss: 1.1278 (freq: 0.4071, raw: 0.7199, quant: 0.0008, domain: 0.0000) LR: 1.42e-05 
π“ Codebook: 323/1024 (31.5%) Top5:[44,605,722,206,694,899,1003,814,70,445,896,958,971,188,319]


π”¬ Encoder Diversity (iter 4760):
  Avg similarity: 0.1082 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9341 (0.0=collapsed)
[Epoch 8/100] [Batch 87/669 (13.0%)] [Iter 4770] Loss: 1.0419 (freq: 0.3719, raw: 0.6695, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 327/1024 (31.9%) Top5:[574,605,814,206,722,96,614,44,971,899,958,526,694,445,188]


π”¬ Encoder Diversity (iter 4770):
  Avg similarity: 0.1012 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9292 (0.0=collapsed)
[Epoch 8/100] [Batch 97/669 (14.5%)] [Iter 4780] Loss: 1.2920 (freq: 0.4701, raw: 0.8213, quant: 0.0006, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 336/1024 (32.8%) Top5:[526,38,94,605,183,519,814,722,339,899,1003,694,445,206,44]


π”¬ Encoder Diversity (iter 4780):
  Avg similarity: 0.1061 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9256 (0.0=collapsed)
[Epoch 8/100] [Batch 107/669 (16.0%)] [Iter 4790] Loss: 1.1357 (freq: 0.3905, raw: 0.7447, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 316/1024 (30.9%) Top5:[38,526,519,339,562,183,200,958,319,605,899,361,98,96,94]


π”¬ Encoder Diversity (iter 4790):
  Avg similarity: 0.1416 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9188 (0.0=collapsed)
[Epoch 8/100] [Batch 117/669 (17.5%)] [Iter 4800] Loss: 0.9396 (freq: 0.3258, raw: 0.6133, quant: 0.0005, domain: 0.0000) LR: 1.43e-05 
π“ Codebook: 348/1024 (34.0%) Top5:[339,614,183,519,526,361,971,98,77,200,94,38,505,96,799]


π”¬ Encoder Diversity (iter 4800):
  Avg similarity: 0.1007 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)
[Epoch 8/100] [Batch 127/669 (19.0%)] [Iter 4810] Loss: 1.1381 (freq: 0.3680, raw: 0.7696, quant: 0.0005, domain: 0.0000) LR: 1.44e-05 
π“ Codebook: 318/1024 (31.1%) Top5:[361,614,98,96,888,505,339,38,99,136,574,582,152,680,526]


π”¬ Encoder Diversity (iter 4810):
  Avg similarity: 0.1239 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9201 (0.0=collapsed)
[Epoch 8/100] [Batch 137/669 (20.5%)] [Iter 4820] Loss: 1.2384 (freq: 0.4683, raw: 0.7696, quant: 0.0005, domain: 0.0000) LR: 1.44e-05 
π“ Codebook: 365/1024 (35.6%) Top5:[38,526,319,519,782,94,614,244,183,200,822,505,574,96,361]


π”¬ Encoder Diversity (iter 4820):
  Avg similarity: 0.1358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9118 (0.0=collapsed)
[Epoch 8/100] [Batch 147/669 (22.0%)] [Iter 4830] Loss: 1.4767 (freq: 0.5965, raw: 0.8795, quant: 0.0007, domain: 0.0000) LR: 1.44e-05 
π“ Codebook: 370/1024 (36.1%) Top5:[339,38,526,605,1003,519,722,44,694,614,445,814,319,899,625]


π”¬ Encoder Diversity (iter 4830):
  Avg similarity: 0.0909 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 8/100] [Batch 157/669 (23.5%)] [Iter 4840] Loss: 1.1964 (freq: 0.4581, raw: 0.7378, quant: 0.0005, domain: 0.0000) LR: 1.45e-05 
π“ Codebook: 343/1024 (33.5%) Top5:[445,361,814,605,722,614,136,70,339,44,952,519,694,526,888]


π”¬ Encoder Diversity (iter 4840):
  Avg similarity: 0.1728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9109 (0.0=collapsed)
[Epoch 8/100] [Batch 167/669 (25.0%)] [Iter 4850] Loss: 1.5112 (freq: 0.6312, raw: 0.8794, quant: 0.0006, domain: 0.0000) LR: 1.45e-05 
π“ Codebook: 289/1024 (28.2%) Top5:[38,339,526,98,562,361,519,200,314,888,799,505,83,183,958]


π”¬ Encoder Diversity (iter 4850):
  Avg similarity: 0.0849 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9450 (0.0=collapsed)
[Epoch 8/100] [Batch 177/669 (26.5%)] [Iter 4860] Loss: 1.2118 (freq: 0.4551, raw: 0.7561, quant: 0.0006, domain: 0.0000) LR: 1.45e-05 
π“ Codebook: 314/1024 (30.7%) Top5:[38,526,339,605,814,44,694,94,445,200,206,899,1003,722,519]


π”¬ Encoder Diversity (iter 4860):
  Avg similarity: 0.1801 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9024 (0.0=collapsed)
[Epoch 8/100] [Batch 187/669 (28.0%)] [Iter 4870] Loss: 1.2436 (freq: 0.4239, raw: 0.8186, quant: 0.0010, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 365/1024 (35.6%) Top5:[38,526,593,562,339,94,958,513,997,47,314,277,782,909,445]


π”¬ Encoder Diversity (iter 4870):
  Avg similarity: 0.0596 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 8/100] [Batch 197/669 (29.4%)] [Iter 4880] Loss: 1.4836 (freq: 0.6125, raw: 0.8705, quant: 0.0007, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 325/1024 (31.7%) Top5:[44,526,445,899,38,694,958,1003,605,722,888,479,206,339,98]


π”¬ Encoder Diversity (iter 4880):
  Avg similarity: 0.1239 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9192 (0.0=collapsed)
[Epoch 8/100] [Batch 207/669 (30.9%)] [Iter 4890] Loss: 1.5175 (freq: 0.5594, raw: 0.9574, quant: 0.0008, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 332/1024 (32.4%) Top5:[44,899,339,1003,526,445,694,38,605,722,958,680,479,83,814]


π”¬ Encoder Diversity (iter 4890):
  Avg similarity: 0.1462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9057 (0.0=collapsed)
[Epoch 8/100] [Batch 217/669 (32.4%)] [Iter 4900] Loss: 1.2129 (freq: 0.4721, raw: 0.7402, quant: 0.0006, domain: 0.0000) LR: 1.46e-05 
π“ Codebook: 308/1024 (30.1%) Top5:[38,83,361,200,98,339,614,44,519,1003,694,605,625,899,888]


π”¬ Encoder Diversity (iter 4900):
  Avg similarity: 0.0905 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9340 (0.0=collapsed)
[Epoch 8/100] [Batch 227/669 (33.9%)] [Iter 4910] Loss: 1.2057 (freq: 0.4597, raw: 0.7454, quant: 0.0006, domain: 0.0000) LR: 1.47e-05 
π“ Codebook: 290/1024 (28.3%) Top5:[339,526,888,77,152,413,98,52,38,433,614,200,519,361,83]


π”¬ Encoder Diversity (iter 4910):
  Avg similarity: 0.1371 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9166 (0.0=collapsed)
[Epoch 8/100] [Batch 237/669 (35.4%)] [Iter 4920] Loss: 1.0163 (freq: 0.3411, raw: 0.6745, quant: 0.0007, domain: 0.0000) LR: 1.47e-05 
π“ Codebook: 364/1024 (35.5%) Top5:[339,526,958,200,7,562,593,314,799,52,694,899,94,445,83]


π”¬ Encoder Diversity (iter 4920):
  Avg similarity: 0.1194 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9255 (0.0=collapsed)
[Epoch 8/100] [Batch 247/669 (36.9%)] [Iter 4930] Loss: 0.9079 (freq: 0.3167, raw: 0.5908, quant: 0.0005, domain: 0.0000) LR: 1.47e-05 
π“ Codebook: 348/1024 (34.0%) Top5:[38,98,526,888,505,445,614,99,361,136,562,479,152,680,339]


π”¬ Encoder Diversity (iter 4930):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9466 (0.0=collapsed)
[Epoch 8/100] [Batch 257/669 (38.4%)] [Iter 4940] Loss: 1.3926 (freq: 0.5148, raw: 0.8770, quant: 0.0008, domain: 0.0000) LR: 1.48e-05 
π“ Codebook: 357/1024 (34.9%) Top5:[98,505,152,361,888,99,136,38,281,309,96,582,614,639,997]


π”¬ Encoder Diversity (iter 4940):
  Avg similarity: 0.0990 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9332 (0.0=collapsed)
[Epoch 8/100] [Batch 267/669 (39.9%)] [Iter 4950] Loss: 1.3060 (freq: 0.4818, raw: 0.8235, quant: 0.0006, domain: 0.0000) LR: 1.48e-05 
π“ Codebook: 375/1024 (36.6%) Top5:[339,433,1013,38,77,519,413,391,526,479,44,470,899,1003,605]


π”¬ Encoder Diversity (iter 4950):
  Avg similarity: 0.1890 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9010 (0.0=collapsed)
[Epoch 8/100] [Batch 277/669 (41.4%)] [Iter 4960] Loss: 1.1820 (freq: 0.4250, raw: 0.7565, quant: 0.0005, domain: 0.0000) LR: 1.48e-05 
π“ Codebook: 357/1024 (34.9%) Top5:[339,433,38,526,77,519,470,1013,413,296,94,920,366,391,319]


π”¬ Encoder Diversity (iter 4960):
  Avg similarity: 0.0757 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9420 (0.0=collapsed)
[Epoch 8/100] [Batch 287/669 (42.9%)] [Iter 4970] Loss: 1.2476 (freq: 0.4478, raw: 0.7992, quant: 0.0006, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 343/1024 (33.5%) Top5:[576,339,526,888,433,38,958,152,361,44,309,98,614,605,814]


π”¬ Encoder Diversity (iter 4970):
  Avg similarity: 0.0796 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9377 (0.0=collapsed)
[Epoch 8/100] [Batch 297/669 (44.4%)] [Iter 4980] Loss: 1.0299 (freq: 0.3658, raw: 0.6635, quant: 0.0005, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 341/1024 (33.3%) Top5:[814,899,445,44,605,1003,722,339,188,526,206,70,694,36,433]


π”¬ Encoder Diversity (iter 4980):
  Avg similarity: 0.1046 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9377 (0.0=collapsed)
[Epoch 8/100] [Batch 307/669 (45.9%)] [Iter 4990] Loss: 0.9985 (freq: 0.3130, raw: 0.6848, quant: 0.0007, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 301/1024 (29.4%) Top5:[361,614,152,98,44,888,505,605,639,814,309,339,136,562,188]


π”¬ Encoder Diversity (iter 4990):
  Avg similarity: 0.1091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9313 (0.0=collapsed)
[Epoch 8/100] [Batch 317/669 (47.4%)] [Iter 5000] Loss: 1.2312 (freq: 0.4872, raw: 0.7434, quant: 0.0006, domain: 0.0000) LR: 1.49e-05 
π“ Codebook: 278/1024 (27.1%) Top5:[38,888,445,44,505,526,200,814,152,99,899,722,83,309,614]


π”¬ Encoder Diversity (iter 5000):
  Avg similarity: 0.1125 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9289 (0.0=collapsed)
[Epoch 8/100] [Batch 327/669 (48.9%)] [Iter 5010] Loss: 1.1585 (freq: 0.4149, raw: 0.7431, quant: 0.0005, domain: 0.0000) LR: 1.50e-05 
π“ Codebook: 347/1024 (33.9%) Top5:[38,526,470,694,445,722,94,920,637,44,772,70,896,888,47]


π”¬ Encoder Diversity (iter 5010):
  Avg similarity: 0.0771 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 8/100] [Batch 337/669 (50.4%)] [Iter 5020] Loss: 1.0354 (freq: 0.3521, raw: 0.6827, quant: 0.0005, domain: 0.0000) LR: 1.50e-05 
π“ Codebook: 327/1024 (31.9%) Top5:[888,614,309,136,98,505,36,574,958,152,694,526,680,99,44]


π”¬ Encoder Diversity (iter 5020):
  Avg similarity: 0.0853 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9490 (0.0=collapsed)
[Epoch 8/100] [Batch 347/669 (51.9%)] [Iter 5030] Loss: 1.2237 (freq: 0.4657, raw: 0.7574, quant: 0.0005, domain: 0.0000) LR: 1.50e-05 
π“ Codebook: 330/1024 (32.2%) Top5:[445,339,526,1013,70,722,694,38,958,309,44,479,899,896,36]


π”¬ Encoder Diversity (iter 5030):
  Avg similarity: 0.0790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 8/100] [Batch 357/669 (53.4%)] [Iter 5040] Loss: 1.3610 (freq: 0.5425, raw: 0.8179, quant: 0.0006, domain: 0.0000) LR: 1.51e-05 
π“ Codebook: 312/1024 (30.5%) Top5:[339,1013,445,722,309,526,44,94,38,1003,694,77,98,614,772]


π”¬ Encoder Diversity (iter 5040):
  Avg similarity: 0.0978 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9361 (0.0=collapsed)
[Epoch 8/100] [Batch 367/669 (54.9%)] [Iter 5050] Loss: 1.3067 (freq: 0.4953, raw: 0.8108, quant: 0.0006, domain: 0.0000) LR: 1.51e-05 
π“ Codebook: 339/1024 (33.1%) Top5:[339,526,1013,77,782,38,952,433,958,997,309,83,772,614,94]


π”¬ Encoder Diversity (iter 5050):
  Avg similarity: 0.1320 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9247 (0.0=collapsed)
[Epoch 8/100] [Batch 377/669 (56.4%)] [Iter 5060] Loss: 1.4445 (freq: 0.4992, raw: 0.9445, quant: 0.0008, domain: 0.0000) LR: 1.51e-05 
π“ Codebook: 370/1024 (36.1%) Top5:[526,339,958,971,38,799,83,782,200,453,94,77,98,952,766]


π”¬ Encoder Diversity (iter 5060):
  Avg similarity: 0.0773 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9449 (0.0=collapsed)
[Epoch 8/100] [Batch 387/669 (57.8%)] [Iter 5070] Loss: 1.2603 (freq: 0.4470, raw: 0.8125, quant: 0.0008, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 295/1024 (28.8%) Top5:[339,38,971,94,1013,526,453,958,433,200,188,614,1012,782,98]


π”¬ Encoder Diversity (iter 5070):
  Avg similarity: 0.1039 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9411 (0.0=collapsed)
[Epoch 8/100] [Batch 397/669 (59.3%)] [Iter 5080] Loss: 0.9394 (freq: 0.3388, raw: 0.6000, quant: 0.0005, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 346/1024 (33.8%) Top5:[309,339,98,152,614,361,36,888,562,38,639,316,99,574,136]


π”¬ Encoder Diversity (iter 5080):
  Avg similarity: 0.1287 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9306 (0.0=collapsed)
[Epoch 8/100] [Batch 407/669 (60.8%)] [Iter 5090] Loss: 1.4675 (freq: 0.5829, raw: 0.8838, quant: 0.0007, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 377/1024 (36.8%) Top5:[38,339,44,899,562,958,70,188,526,637,83,799,722,136,997]


π”¬ Encoder Diversity (iter 5090):
  Avg similarity: 0.0897 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9458 (0.0=collapsed)
[Epoch 8/100] [Batch 417/669 (62.3%)] [Iter 5100] Loss: 1.3609 (freq: 0.4859, raw: 0.8743, quant: 0.0007, domain: 0.0000) LR: 1.52e-05 
π“ Codebook: 342/1024 (33.4%) Top5:[309,339,136,526,99,888,98,43,316,494,614,44,70,38,694]


π”¬ Encoder Diversity (iter 5100):
  Avg similarity: 0.0701 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 8/100] [Batch 427/669 (63.8%)] [Iter 5110] Loss: 1.2825 (freq: 0.4726, raw: 0.8094, quant: 0.0006, domain: 0.0000) LR: 1.53e-05 
π“ Codebook: 310/1024 (30.3%) Top5:[958,339,309,1013,136,340,888,43,526,971,316,98,99,772,694]


π”¬ Encoder Diversity (iter 5110):
  Avg similarity: 0.1014 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 8/100] [Batch 437/669 (65.3%)] [Iter 5120] Loss: 0.9069 (freq: 0.3034, raw: 0.6030, quant: 0.0005, domain: 0.0000) LR: 1.53e-05 
π“ Codebook: 307/1024 (30.0%) Top5:[339,296,1013,43,413,33,136,888,1003,94,694,77,526,38,309]


π”¬ Encoder Diversity (iter 5120):
  Avg similarity: 0.0795 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 8/100] [Batch 447/669 (66.8%)] [Iter 5130] Loss: 1.0344 (freq: 0.3606, raw: 0.6732, quant: 0.0006, domain: 0.0000) LR: 1.53e-05 
π“ Codebook: 382/1024 (37.3%) Top5:[38,70,44,722,309,605,316,136,98,574,1003,899,888,694,614]


π”¬ Encoder Diversity (iter 5130):
  Avg similarity: 0.0970 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9420 (0.0=collapsed)
[Epoch 8/100] [Batch 457/669 (68.3%)] [Iter 5140] Loss: 1.3560 (freq: 0.5301, raw: 0.8252, quant: 0.0006, domain: 0.0000) LR: 1.54e-05 
π“ Codebook: 358/1024 (35.0%) Top5:[38,70,899,605,44,526,958,617,562,722,136,829,206,366,339]


π”¬ Encoder Diversity (iter 5140):
  Avg similarity: 0.0680 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9453 (0.0=collapsed)
[Epoch 8/100] [Batch 467/669 (69.8%)] [Iter 5150] Loss: 1.1517 (freq: 0.4078, raw: 0.7433, quant: 0.0006, domain: 0.0000) LR: 1.54e-05 
π“ Codebook: 334/1024 (32.6%) Top5:[44,899,605,433,70,829,1003,206,722,339,896,316,614,617,494]


π”¬ Encoder Diversity (iter 5150):
  Avg similarity: 0.0772 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9435 (0.0=collapsed)
[Epoch 8/100] [Batch 477/669 (71.3%)] [Iter 5160] Loss: 1.0609 (freq: 0.3777, raw: 0.6827, quant: 0.0005, domain: 0.0000) LR: 1.54e-05 
π“ Codebook: 343/1024 (33.5%) Top5:[316,152,339,494,582,98,309,540,38,99,433,94,614,361,639]


π”¬ Encoder Diversity (iter 5160):
  Avg similarity: 0.0641 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 8/100] [Batch 487/669 (72.8%)] [Iter 5170] Loss: 1.3636 (freq: 0.4873, raw: 0.8755, quant: 0.0008, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 345/1024 (33.7%) Top5:[339,152,361,574,316,309,526,98,540,99,582,200,94,562,958]


π”¬ Encoder Diversity (iter 5170):
  Avg similarity: 0.1130 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 8/100] [Batch 497/669 (74.3%)] [Iter 5180] Loss: 0.7775 (freq: 0.2592, raw: 0.5179, quant: 0.0004, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 320/1024 (31.2%) Top5:[70,136,722,526,316,339,361,152,309,44,582,605,1003,617,98]


π”¬ Encoder Diversity (iter 5180):
  Avg similarity: 0.1279 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9300 (0.0=collapsed)
[Epoch 8/100] [Batch 507/669 (75.8%)] [Iter 5190] Loss: 1.0268 (freq: 0.3558, raw: 0.6706, quant: 0.0005, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 288/1024 (28.1%) Top5:[339,526,1013,94,77,722,136,958,70,296,38,316,605,433,43]


π”¬ Encoder Diversity (iter 5190):
  Avg similarity: 0.1024 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9321 (0.0=collapsed)
[Epoch 8/100] [Batch 517/669 (77.3%)] [Iter 5200] Loss: 0.9888 (freq: 0.3565, raw: 0.6317, quant: 0.0006, domain: 0.0000) LR: 1.55e-05 
π“ Codebook: 285/1024 (27.8%) Top5:[339,38,605,722,44,136,617,94,562,70,83,540,1013,233,43]


π”¬ Encoder Diversity (iter 5200):
  Avg similarity: 0.1294 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9257 (0.0=collapsed)
[Epoch 8/100] [Batch 527/669 (78.8%)] [Iter 5210] Loss: 1.3023 (freq: 0.4920, raw: 0.8098, quant: 0.0006, domain: 0.0000) LR: 1.56e-05 
π“ Codebook: 339/1024 (33.1%) Top5:[339,38,94,526,519,43,296,433,958,1013,413,562,200,540,152]


π”¬ Encoder Diversity (iter 5210):
  Avg similarity: 0.1321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9182 (0.0=collapsed)
[Epoch 8/100] [Batch 537/669 (80.3%)] [Iter 5220] Loss: 1.0703 (freq: 0.4012, raw: 0.6685, quant: 0.0006, domain: 0.0000) LR: 1.56e-05 
π“ Codebook: 382/1024 (37.3%) Top5:[339,38,605,526,1003,617,136,44,899,722,94,70,206,47,188]


π”¬ Encoder Diversity (iter 5220):
  Avg similarity: 0.1017 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9277 (0.0=collapsed)
[Epoch 8/100] [Batch 547/669 (81.8%)] [Iter 5230] Loss: 1.4573 (freq: 0.5655, raw: 0.8910, quant: 0.0008, domain: 0.0000) LR: 1.56e-05 
π“ Codebook: 322/1024 (31.4%) Top5:[605,98,309,526,582,639,152,316,694,44,361,494,614,722,540]


π”¬ Encoder Diversity (iter 5230):
  Avg similarity: 0.1005 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9364 (0.0=collapsed)
[Epoch 8/100] [Batch 557/669 (83.3%)] [Iter 5240] Loss: 0.8766 (freq: 0.2683, raw: 0.6078, quant: 0.0005, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 301/1024 (29.4%) Top5:[98,361,309,152,639,526,77,614,1013,582,99,316,494,339,505]


π”¬ Encoder Diversity (iter 5240):
  Avg similarity: 0.1251 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9276 (0.0=collapsed)
[Epoch 8/100] [Batch 567/669 (84.8%)] [Iter 5250] Loss: 1.3497 (freq: 0.4646, raw: 0.8843, quant: 0.0008, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[339,526,1013,77,433,38,413,519,296,899,617,43,605,540,44]


π”¬ Encoder Diversity (iter 5250):
  Avg similarity: 0.0665 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 8/100] [Batch 577/669 (86.2%)] [Iter 5260] Loss: 1.0338 (freq: 0.3788, raw: 0.6545, quant: 0.0005, domain: 0.0000) LR: 1.57e-05 
π“ Codebook: 346/1024 (33.8%) Top5:[617,722,605,98,44,562,70,136,814,526,188,505,361,574,316]


π”¬ Encoder Diversity (iter 5260):
  Avg similarity: 0.1015 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9361 (0.0=collapsed)
[Epoch 8/100] [Batch 587/669 (87.7%)] [Iter 5270] Loss: 1.2399 (freq: 0.4381, raw: 0.8012, quant: 0.0006, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 417/1024 (40.7%) Top5:[339,526,38,316,94,605,98,200,562,958,36,433,540,413,614]


π”¬ Encoder Diversity (iter 5270):
  Avg similarity: 0.1024 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9306 (0.0=collapsed)
[Epoch 8/100] [Batch 597/669 (89.2%)] [Iter 5280] Loss: 1.1573 (freq: 0.3996, raw: 0.7571, quant: 0.0006, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 398/1024 (38.9%) Top5:[339,361,316,605,98,99,617,36,574,38,1013,94,540,582,614]


π”¬ Encoder Diversity (iter 5280):
  Avg similarity: 0.2075 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.8947 (0.0=collapsed)
[Epoch 8/100] [Batch 607/669 (90.7%)] [Iter 5290] Loss: 1.3654 (freq: 0.5492, raw: 0.8156, quant: 0.0006, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 381/1024 (37.2%) Top5:[38,997,339,519,540,233,1013,366,958,98,952,277,413,526,920]


π”¬ Encoder Diversity (iter 5290):
  Avg similarity: 0.0940 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 8/100] [Batch 617/669 (92.2%)] [Iter 5300] Loss: 1.3519 (freq: 0.4642, raw: 0.8871, quant: 0.0006, domain: 0.0000) LR: 1.58e-05 
π“ Codebook: 373/1024 (36.4%) Top5:[526,407,519,38,878,605,722,617,413,136,637,366,899,98,339]


π”¬ Encoder Diversity (iter 5300):
  Avg similarity: 0.1608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9071 (0.0=collapsed)
[Epoch 8/100] [Batch 627/669 (93.7%)] [Iter 5310] Loss: 0.9995 (freq: 0.3097, raw: 0.6892, quant: 0.0005, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 405/1024 (39.6%) Top5:[526,339,38,899,309,878,98,617,605,829,316,519,722,70,136]


π”¬ Encoder Diversity (iter 5310):
  Avg similarity: 0.1061 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9353 (0.0=collapsed)
[Epoch 8/100] [Batch 637/669 (95.2%)] [Iter 5320] Loss: 1.1759 (freq: 0.4434, raw: 0.7318, quant: 0.0007, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[98,309,316,614,99,361,540,562,200,958,782,605,152,494,526]


π”¬ Encoder Diversity (iter 5320):
  Avg similarity: 0.0686 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 8/100] [Batch 647/669 (96.7%)] [Iter 5330] Loss: 1.4401 (freq: 0.5709, raw: 0.8687, quant: 0.0006, domain: 0.0000) LR: 1.59e-05 
π“ Codebook: 392/1024 (38.3%) Top5:[605,526,562,1012,540,47,617,339,997,44,513,340,94,593,958]


π”¬ Encoder Diversity (iter 5330):
  Avg similarity: 0.1036 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9402 (0.0=collapsed)
[Epoch 8/100] [Batch 657/669 (98.2%)] [Iter 5340] Loss: 1.4322 (freq: 0.5502, raw: 0.8814, quant: 0.0006, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 390/1024 (38.1%) Top5:[339,38,433,526,1013,94,906,296,77,519,540,43,605,997,47]


π”¬ Encoder Diversity (iter 5340):
  Avg similarity: 0.0766 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 8/100] [Batch 667/669 (99.7%)] [Iter 5350] Loss: 1.3067 (freq: 0.5142, raw: 0.7918, quant: 0.0007, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 418/1024 (40.8%) Top5:[339,433,38,526,605,958,540,562,83,997,316,309,1013,391,920]


π”¬ Encoder Diversity (iter 5350):
  Avg similarity: 0.0991 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9400 (0.0=collapsed)

================================================================================
[Epoch 8] Validation Results:
  Total Loss: 0.6378
  Freq Loss:  0.1980
  Raw Loss:   0.4393
  Quant Loss: 0.0005
  π“ Codebook Usage: 323/1024 (31.5%)
  π“ Codebook Entropy: 4.0150 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 48619 (37.3%)
  Top 10 most used codes:
    1. Code 605: 6876 times (5.28%)
    2. Code 44: 5689 times (4.37%)
    3. Code 98: 5340 times (4.10%)
    4. Code 617: 4670 times (3.59%)
    5. Code 316: 4482 times (3.44%)
    6. Code 361: 4421 times (3.40%)
    7. Code 188: 4396 times (3.38%)
    8. Code 70: 4333 times (3.33%)
    9. Code 829: 4331 times (3.33%)
    10. Code 722: 4081 times (3.13%)
  Bottom 5 least used codes (among used):
    1. Code 102: 1 times (0.00%)
    2. Code 306: 2 times (0.00%)
    3. Code 255: 2 times (0.00%)
    4. Code 885: 3 times (0.00%)
    5. Code 154: 5 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 8
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 9/100] [Batch 8/669 (1.2%)] [Iter 5360] Loss: 1.2847 (freq: 0.4898, raw: 0.7942, quant: 0.0007, domain: 0.0000) LR: 1.60e-05 
π“ Codebook: 951/1024 (92.9%) Top5:[316,582,98,309,361,722,99,44,70,614,605,958,505,494,617]


π”¬ Encoder Diversity (iter 5360):
  Avg similarity: 0.1153 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9249 (0.0=collapsed)
[Epoch 9/100] [Batch 18/669 (2.7%)] [Iter 5370] Loss: 1.5731 (freq: 0.6262, raw: 0.9462, quant: 0.0007, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 638/1024 (62.3%) Top5:[234,605,703,44,140,807,722,897,70,72,104,29,382,899,951]


π”¬ Encoder Diversity (iter 5370):
  Avg similarity: 0.1275 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9146 (0.0=collapsed)
[Epoch 9/100] [Batch 28/669 (4.2%)] [Iter 5380] Loss: 1.4645 (freq: 0.6011, raw: 0.8627, quant: 0.0007, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 380/1024 (37.1%) Top5:[98,361,152,99,309,614,316,494,136,639,958,605,582,399,44]


π”¬ Encoder Diversity (iter 5380):
  Avg similarity: 0.1045 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9265 (0.0=collapsed)
[Epoch 9/100] [Batch 38/669 (5.7%)] [Iter 5390] Loss: 1.1820 (freq: 0.4244, raw: 0.7571, quant: 0.0005, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 386/1024 (37.7%) Top5:[98,72,361,152,234,470,309,582,951,316,839,958,639,494,669]


π”¬ Encoder Diversity (iter 5390):
  Avg similarity: 0.0946 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9395 (0.0=collapsed)
[Epoch 9/100] [Batch 48/669 (7.2%)] [Iter 5400] Loss: 1.3979 (freq: 0.5850, raw: 0.8122, quant: 0.0007, domain: 0.0000) LR: 1.61e-05 
π“ Codebook: 387/1024 (37.8%) Top5:[722,958,582,605,309,361,98,639,136,316,99,70,44,152,669]


π”¬ Encoder Diversity (iter 5400):
  Avg similarity: 0.0675 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 9/100] [Batch 58/669 (8.7%)] [Iter 5410] Loss: 1.4614 (freq: 0.5839, raw: 0.8769, quant: 0.0006, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 388/1024 (37.9%) Top5:[958,44,70,722,599,605,206,33,779,136,350,899,592,234,797]


π”¬ Encoder Diversity (iter 5410):
  Avg similarity: 0.0900 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 9/100] [Batch 68/669 (10.2%)] [Iter 5420] Loss: 1.2510 (freq: 0.4484, raw: 0.8019, quant: 0.0007, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 333/1024 (32.5%) Top5:[14,234,309,582,98,136,361,316,680,722,494,536,152,99,175]


π”¬ Encoder Diversity (iter 5420):
  Avg similarity: 0.1444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9093 (0.0=collapsed)
[Epoch 9/100] [Batch 78/669 (11.7%)] [Iter 5430] Loss: 0.8349 (freq: 0.2929, raw: 0.5415, quant: 0.0005, domain: 0.0000) LR: 1.62e-05 
π“ Codebook: 421/1024 (41.1%) Top5:[361,309,98,582,234,316,152,694,614,99,722,136,536,639,494]


π”¬ Encoder Diversity (iter 5430):
  Avg similarity: 0.1105 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9206 (0.0=collapsed)
[Epoch 9/100] [Batch 88/669 (13.2%)] [Iter 5440] Loss: 1.4056 (freq: 0.5103, raw: 0.8947, quant: 0.0007, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 432/1024 (42.2%) Top5:[234,228,363,253,140,72,104,846,350,470,951,669,44,169,958]


π”¬ Encoder Diversity (iter 5440):
  Avg similarity: 0.0651 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 9/100] [Batch 98/669 (14.6%)] [Iter 5450] Loss: 1.3430 (freq: 0.5461, raw: 0.7963, quant: 0.0007, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 365/1024 (35.6%) Top5:[44,70,722,309,316,98,361,614,136,152,206,899,582,958,99]


π”¬ Encoder Diversity (iter 5450):
  Avg similarity: 0.1036 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9313 (0.0=collapsed)
[Epoch 9/100] [Batch 108/669 (16.1%)] [Iter 5460] Loss: 1.0478 (freq: 0.3703, raw: 0.6770, quant: 0.0005, domain: 0.0000) LR: 1.63e-05 
π“ Codebook: 359/1024 (35.1%) Top5:[234,582,954,169,361,958,1018,316,253,722,136,309,143,70,104]


π”¬ Encoder Diversity (iter 5460):
  Avg similarity: 0.1053 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9316 (0.0=collapsed)
[Epoch 9/100] [Batch 118/669 (17.6%)] [Iter 5470] Loss: 1.1940 (freq: 0.4518, raw: 0.7417, quant: 0.0006, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 368/1024 (35.9%) Top5:[722,234,136,70,44,228,951,72,582,253,316,617,361,687,382]


π”¬ Encoder Diversity (iter 5470):
  Avg similarity: 0.0755 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9410 (0.0=collapsed)
[Epoch 9/100] [Batch 128/669 (19.1%)] [Iter 5480] Loss: 1.2123 (freq: 0.4816, raw: 0.7302, quant: 0.0005, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 353/1024 (34.5%) Top5:[722,136,316,361,70,605,309,206,99,582,44,614,639,228,72]


π”¬ Encoder Diversity (iter 5480):
  Avg similarity: 0.0872 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9445 (0.0=collapsed)
[Epoch 9/100] [Batch 138/669 (20.6%)] [Iter 5490] Loss: 1.3516 (freq: 0.4533, raw: 0.8976, quant: 0.0006, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 366/1024 (35.7%) Top5:[72,228,285,951,234,253,669,316,846,363,551,361,514,99,958]


π”¬ Encoder Diversity (iter 5490):
  Avg similarity: 0.0929 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9410 (0.0=collapsed)
[Epoch 9/100] [Batch 148/669 (22.1%)] [Iter 5500] Loss: 1.1857 (freq: 0.4362, raw: 0.7489, quant: 0.0006, domain: 0.0000) LR: 1.64e-05 
π“ Codebook: 389/1024 (38.0%) Top5:[363,958,680,99,72,582,903,253,316,309,779,361,44,669,234]


π”¬ Encoder Diversity (iter 5500):
  Avg similarity: 0.1497 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9239 (0.0=collapsed)
[Epoch 9/100] [Batch 158/669 (23.6%)] [Iter 5510] Loss: 1.1355 (freq: 0.4200, raw: 0.7148, quant: 0.0007, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 366/1024 (35.7%) Top5:[44,70,206,363,899,903,697,779,111,694,136,687,599,99,10]


π”¬ Encoder Diversity (iter 5510):
  Avg similarity: 0.1062 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9313 (0.0=collapsed)
[Epoch 9/100] [Batch 168/669 (25.1%)] [Iter 5520] Loss: 1.1295 (freq: 0.3937, raw: 0.7351, quant: 0.0006, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 348/1024 (34.0%) Top5:[234,136,99,44,722,70,899,903,206,672,363,617,582,309,605]


π”¬ Encoder Diversity (iter 5520):
  Avg similarity: 0.1299 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9209 (0.0=collapsed)
[Epoch 9/100] [Batch 178/669 (26.6%)] [Iter 5530] Loss: 1.1416 (freq: 0.4001, raw: 0.7408, quant: 0.0007, domain: 0.0000) LR: 1.65e-05 
π“ Codebook: 391/1024 (38.2%) Top5:[363,136,234,316,309,903,582,687,72,722,528,779,99,958,703]


π”¬ Encoder Diversity (iter 5530):
  Avg similarity: 0.0852 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 9/100] [Batch 188/669 (28.1%)] [Iter 5540] Loss: 1.3146 (freq: 0.4877, raw: 0.8262, quant: 0.0007, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 356/1024 (34.8%) Top5:[234,350,136,443,363,316,722,582,551,903,703,72,614,528,361]


π”¬ Encoder Diversity (iter 5540):
  Avg similarity: 0.0877 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9393 (0.0=collapsed)
[Epoch 9/100] [Batch 198/669 (29.6%)] [Iter 5550] Loss: 1.2975 (freq: 0.5151, raw: 0.7818, quant: 0.0006, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 410/1024 (40.0%) Top5:[72,361,309,316,136,152,614,582,470,734,98,350,903,443,234]


π”¬ Encoder Diversity (iter 5550):
  Avg similarity: 0.0749 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 9/100] [Batch 208/669 (31.1%)] [Iter 5560] Loss: 1.0356 (freq: 0.3772, raw: 0.6578, quant: 0.0006, domain: 0.0000) LR: 1.66e-05 
π“ Codebook: 404/1024 (39.5%) Top5:[72,361,363,722,136,903,99,951,234,825,169,779,846,614,309]


π”¬ Encoder Diversity (iter 5560):
  Avg similarity: 0.1399 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9125 (0.0=collapsed)
[Epoch 9/100] [Batch 218/669 (32.6%)] [Iter 5570] Loss: 1.1579 (freq: 0.4397, raw: 0.7177, quant: 0.0006, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 371/1024 (36.2%) Top5:[136,722,234,72,99,316,951,143,903,361,206,846,614,309,363]


π”¬ Encoder Diversity (iter 5570):
  Avg similarity: 0.1127 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9378 (0.0=collapsed)
[Epoch 9/100] [Batch 228/669 (34.1%)] [Iter 5580] Loss: 0.8924 (freq: 0.2942, raw: 0.5978, quant: 0.0005, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 367/1024 (35.8%) Top5:[70,722,136,206,672,903,44,234,617,687,99,605,361,694,214]


π”¬ Encoder Diversity (iter 5580):
  Avg similarity: 0.0963 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 9/100] [Batch 238/669 (35.6%)] [Iter 5590] Loss: 1.2036 (freq: 0.4735, raw: 0.7296, quant: 0.0006, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 409/1024 (39.9%) Top5:[234,136,72,316,99,361,470,903,350,722,951,140,152,617,694]


π”¬ Encoder Diversity (iter 5590):
  Avg similarity: 0.0825 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9454 (0.0=collapsed)
[Epoch 9/100] [Batch 248/669 (37.1%)] [Iter 5600] Loss: 1.3567 (freq: 0.5401, raw: 0.8159, quant: 0.0007, domain: 0.0000) LR: 1.67e-05 
π“ Codebook: 428/1024 (41.8%) Top5:[361,309,152,958,99,136,574,316,779,234,350,528,582,717,614]


π”¬ Encoder Diversity (iter 5600):
  Avg similarity: 0.1418 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9086 (0.0=collapsed)
[Epoch 9/100] [Batch 258/669 (38.6%)] [Iter 5610] Loss: 1.0301 (freq: 0.3854, raw: 0.6441, quant: 0.0006, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 379/1024 (37.0%) Top5:[234,44,72,214,169,617,899,70,228,722,253,779,734,687,363]


π”¬ Encoder Diversity (iter 5610):
  Avg similarity: 0.0755 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 9/100] [Batch 268/669 (40.1%)] [Iter 5620] Loss: 1.0528 (freq: 0.3809, raw: 0.6713, quant: 0.0006, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 414/1024 (40.4%) Top5:[234,72,33,470,951,253,947,825,169,958,99,111,309,779,260]


π”¬ Encoder Diversity (iter 5620):
  Avg similarity: 0.0745 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9418 (0.0=collapsed)
[Epoch 9/100] [Batch 278/669 (41.6%)] [Iter 5630] Loss: 1.4250 (freq: 0.5415, raw: 0.8828, quant: 0.0006, domain: 0.0000) LR: 1.68e-05 
π“ Codebook: 321/1024 (31.3%) Top5:[44,33,779,350,819,99,309,253,136,169,143,70,958,176,234]


π”¬ Encoder Diversity (iter 5630):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 9/100] [Batch 288/669 (43.0%)] [Iter 5640] Loss: 1.1240 (freq: 0.3971, raw: 0.7263, quant: 0.0006, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 385/1024 (37.6%) Top5:[234,99,136,722,309,253,903,687,694,582,361,152,617,639,672]


π”¬ Encoder Diversity (iter 5640):
  Avg similarity: 0.1030 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9269 (0.0=collapsed)
[Epoch 9/100] [Batch 298/669 (44.5%)] [Iter 5650] Loss: 1.0136 (freq: 0.3469, raw: 0.6660, quant: 0.0006, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 447/1024 (43.7%) Top5:[234,99,363,361,309,253,72,582,903,136,44,140,316,806,152]


π”¬ Encoder Diversity (iter 5650):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9458 (0.0=collapsed)
[Epoch 9/100] [Batch 308/669 (46.0%)] [Iter 5660] Loss: 1.4143 (freq: 0.5520, raw: 0.8616, quant: 0.0007, domain: 0.0000) LR: 1.69e-05 
π“ Codebook: 448/1024 (43.8%) Top5:[234,72,363,253,104,897,99,779,592,140,470,228,375,672,44]


π”¬ Encoder Diversity (iter 5660):
  Avg similarity: 0.0815 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9439 (0.0=collapsed)
[Epoch 9/100] [Batch 318/669 (47.5%)] [Iter 5670] Loss: 1.2323 (freq: 0.4076, raw: 0.8242, quant: 0.0006, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 355/1024 (34.7%) Top5:[234,361,44,363,72,253,136,99,819,316,309,722,897,687,470]


π”¬ Encoder Diversity (iter 5670):
  Avg similarity: 0.0867 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 9/100] [Batch 328/669 (49.0%)] [Iter 5680] Loss: 1.0596 (freq: 0.3924, raw: 0.6666, quant: 0.0006, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 399/1024 (39.0%) Top5:[44,136,958,672,779,253,687,214,605,722,70,361,617,417,33]


π”¬ Encoder Diversity (iter 5680):
  Avg similarity: 0.1240 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9360 (0.0=collapsed)
[Epoch 9/100] [Batch 338/669 (50.5%)] [Iter 5690] Loss: 1.2731 (freq: 0.4462, raw: 0.8262, quant: 0.0007, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 427/1024 (41.7%) Top5:[253,44,361,779,136,169,496,72,363,417,309,375,1018,958,111]


π”¬ Encoder Diversity (iter 5690):
  Avg similarity: 0.1032 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9369 (0.0=collapsed)
[Epoch 9/100] [Batch 348/669 (52.0%)] [Iter 5700] Loss: 0.8863 (freq: 0.2994, raw: 0.5864, quant: 0.0006, domain: 0.0000) LR: 1.70e-05 
π“ Codebook: 435/1024 (42.5%) Top5:[253,72,44,214,136,617,672,470,234,687,846,551,951,903,206]


π”¬ Encoder Diversity (iter 5700):
  Avg similarity: 0.0794 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9390 (0.0=collapsed)
[Epoch 9/100] [Batch 358/669 (53.5%)] [Iter 5710] Loss: 1.0181 (freq: 0.3634, raw: 0.6541, quant: 0.0007, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 457/1024 (44.6%) Top5:[253,363,260,958,779,825,574,152,1015,169,592,29,722,309,33]


π”¬ Encoder Diversity (iter 5710):
  Avg similarity: 0.1134 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9328 (0.0=collapsed)
[Epoch 9/100] [Batch 368/669 (55.0%)] [Iter 5720] Loss: 1.4010 (freq: 0.5050, raw: 0.8952, quant: 0.0008, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 399/1024 (39.0%) Top5:[44,136,253,72,722,672,234,694,206,70,687,363,99,214,617]


π”¬ Encoder Diversity (iter 5720):
  Avg similarity: 0.0741 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)
[Epoch 9/100] [Batch 378/669 (56.5%)] [Iter 5730] Loss: 1.1697 (freq: 0.4527, raw: 0.7163, quant: 0.0006, domain: 0.0000) LR: 1.71e-05 
π“ Codebook: 378/1024 (36.9%) Top5:[136,234,687,44,722,70,253,316,309,72,672,361,214,694,206]


π”¬ Encoder Diversity (iter 5730):
  Avg similarity: 0.0756 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9491 (0.0=collapsed)
[Epoch 9/100] [Batch 388/669 (58.0%)] [Iter 5740] Loss: 1.4143 (freq: 0.5426, raw: 0.8710, quant: 0.0007, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 398/1024 (38.9%) Top5:[234,253,363,259,551,819,797,143,1018,496,399,33,136,779,316]


π”¬ Encoder Diversity (iter 5740):
  Avg similarity: 0.0740 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 9/100] [Batch 398/669 (59.5%)] [Iter 5750] Loss: 1.0898 (freq: 0.3955, raw: 0.6936, quant: 0.0007, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 385/1024 (37.6%) Top5:[44,617,253,206,136,72,672,316,496,951,214,899,687,234,70]


π”¬ Encoder Diversity (iter 5750):
  Avg similarity: 0.1426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9081 (0.0=collapsed)
[Epoch 9/100] [Batch 408/669 (61.0%)] [Iter 5760] Loss: 1.4236 (freq: 0.5390, raw: 0.8839, quant: 0.0007, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 443/1024 (43.3%) Top5:[253,316,363,234,309,44,846,551,152,574,717,31,958,72,703]


π”¬ Encoder Diversity (iter 5760):
  Avg similarity: 0.0860 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9426 (0.0=collapsed)
[Epoch 9/100] [Batch 418/669 (62.5%)] [Iter 5770] Loss: 1.3393 (freq: 0.5417, raw: 0.7970, quant: 0.0007, domain: 0.0000) LR: 1.72e-05 
π“ Codebook: 399/1024 (39.0%) Top5:[72,253,44,363,951,470,316,672,206,136,234,309,899,703,989]


π”¬ Encoder Diversity (iter 5770):
  Avg similarity: 0.0896 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9436 (0.0=collapsed)
[Epoch 9/100] [Batch 428/669 (64.0%)] [Iter 5780] Loss: 0.7495 (freq: 0.2170, raw: 0.5320, quant: 0.0005, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 338/1024 (33.0%) Top5:[44,72,363,316,470,253,309,494,617,687,496,206,672,582,361]


π”¬ Encoder Diversity (iter 5780):
  Avg similarity: 0.1065 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9351 (0.0=collapsed)
[Epoch 9/100] [Batch 438/669 (65.5%)] [Iter 5790] Loss: 1.4304 (freq: 0.5641, raw: 0.8657, quant: 0.0006, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 329/1024 (32.1%) Top5:[44,672,994,70,169,206,617,253,573,687,259,111,108,214,825]


π”¬ Encoder Diversity (iter 5790):
  Avg similarity: 0.1109 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9271 (0.0=collapsed)
[Epoch 9/100] [Batch 448/669 (67.0%)] [Iter 5800] Loss: 0.9112 (freq: 0.3541, raw: 0.5566, quant: 0.0005, domain: 0.0000) LR: 1.73e-05 
π“ Codebook: 437/1024 (42.7%) Top5:[994,44,361,316,672,791,687,617,309,722,899,206,152,903,694]


π”¬ Encoder Diversity (iter 5800):
  Avg similarity: 0.1000 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9312 (0.0=collapsed)
[Epoch 9/100] [Batch 458/669 (68.5%)] [Iter 5810] Loss: 1.0607 (freq: 0.3981, raw: 0.6620, quant: 0.0006, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 436/1024 (42.6%) Top5:[253,44,899,234,274,72,206,104,846,967,70,470,903,703,617]


π”¬ Encoder Diversity (iter 5810):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 9/100] [Batch 468/669 (70.0%)] [Iter 5820] Loss: 0.8631 (freq: 0.2783, raw: 0.5842, quant: 0.0006, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 370/1024 (36.1%) Top5:[361,316,152,253,309,722,98,536,57,791,494,846,717,72,639]


π”¬ Encoder Diversity (iter 5820):
  Avg similarity: 0.0895 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9465 (0.0=collapsed)
[Epoch 9/100] [Batch 478/669 (71.4%)] [Iter 5830] Loss: 1.4482 (freq: 0.5824, raw: 0.8651, quant: 0.0007, domain: 0.0000) LR: 1.74e-05 
π“ Codebook: 429/1024 (41.9%) Top5:[253,72,361,951,897,470,846,779,514,104,967,375,791,965,703]


π”¬ Encoder Diversity (iter 5830):
  Avg similarity: 0.0782 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 9/100] [Batch 488/669 (72.9%)] [Iter 5840] Loss: 1.4841 (freq: 0.5280, raw: 0.9554, quant: 0.0007, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 383/1024 (37.4%) Top5:[253,965,104,111,825,687,375,779,44,169,1018,819,363,989,33]


π”¬ Encoder Diversity (iter 5840):
  Avg similarity: 0.0801 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9402 (0.0=collapsed)
[Epoch 9/100] [Batch 498/669 (74.4%)] [Iter 5850] Loss: 1.1593 (freq: 0.4467, raw: 0.7120, quant: 0.0006, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 422/1024 (41.2%) Top5:[617,253,44,70,363,687,206,965,672,274,522,573,143,140,829]


π”¬ Encoder Diversity (iter 5850):
  Avg similarity: 0.1313 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9235 (0.0=collapsed)
[Epoch 9/100] [Batch 508/669 (75.9%)] [Iter 5860] Loss: 1.0971 (freq: 0.3975, raw: 0.6989, quant: 0.0006, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 356/1024 (34.8%) Top5:[363,573,819,496,253,33,617,70,259,72,140,417,44,672,206]


π”¬ Encoder Diversity (iter 5860):
  Avg similarity: 0.0928 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9323 (0.0=collapsed)
[Epoch 9/100] [Batch 518/669 (77.4%)] [Iter 5870] Loss: 1.4247 (freq: 0.5588, raw: 0.8653, quant: 0.0007, domain: 0.0000) LR: 1.75e-05 
π“ Codebook: 375/1024 (36.6%) Top5:[57,259,33,779,260,734,417,399,592,169,528,44,458,171,350]


π”¬ Encoder Diversity (iter 5870):
  Avg similarity: 0.0682 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9533 (0.0=collapsed)
[Epoch 9/100] [Batch 528/669 (78.9%)] [Iter 5880] Loss: 1.0921 (freq: 0.3523, raw: 0.7392, quant: 0.0007, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 430/1024 (42.0%) Top5:[72,253,361,140,57,470,703,316,169,734,952,779,434,951,104]


π”¬ Encoder Diversity (iter 5880):
  Avg similarity: 0.1042 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9357 (0.0=collapsed)
[Epoch 9/100] [Batch 538/669 (80.4%)] [Iter 5890] Loss: 1.3048 (freq: 0.5005, raw: 0.8037, quant: 0.0007, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 344/1024 (33.6%) Top5:[253,361,316,846,722,573,206,44,274,569,899,958,470,967,140]


π”¬ Encoder Diversity (iter 5890):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 9/100] [Batch 548/669 (81.9%)] [Iter 5900] Loss: 1.4576 (freq: 0.5217, raw: 0.9351, quant: 0.0008, domain: 0.0000) LR: 1.76e-05 
π“ Codebook: 374/1024 (36.5%) Top5:[392,253,846,951,470,434,946,361,234,72,316,722,206,967,703]


π”¬ Encoder Diversity (iter 5900):
  Avg similarity: 0.1455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9326 (0.0=collapsed)
[Epoch 9/100] [Batch 558/669 (83.4%)] [Iter 5910] Loss: 1.1929 (freq: 0.3954, raw: 0.7967, quant: 0.0008, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 408/1024 (39.8%) Top5:[253,573,470,143,361,169,897,965,206,140,392,33,111,171,363]


π”¬ Encoder Diversity (iter 5910):
  Avg similarity: 0.0976 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9405 (0.0=collapsed)
[Epoch 9/100] [Batch 568/669 (84.9%)] [Iter 5920] Loss: 1.0430 (freq: 0.3872, raw: 0.6553, quant: 0.0006, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 370/1024 (36.1%) Top5:[573,206,694,392,722,361,274,70,16,253,899,687,140,791,72]


π”¬ Encoder Diversity (iter 5920):
  Avg similarity: 0.0994 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9260 (0.0=collapsed)
[Epoch 9/100] [Batch 578/669 (86.4%)] [Iter 5930] Loss: 1.2194 (freq: 0.4152, raw: 0.8035, quant: 0.0007, domain: 0.0000) LR: 1.77e-05 
π“ Codebook: 387/1024 (37.8%) Top5:[392,253,259,375,946,470,136,234,573,361,98,140,734,104,57]


π”¬ Encoder Diversity (iter 5930):
  Avg similarity: 0.0834 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9404 (0.0=collapsed)
[Epoch 9/100] [Batch 588/669 (87.9%)] [Iter 5940] Loss: 1.0256 (freq: 0.3626, raw: 0.6623, quant: 0.0007, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 392/1024 (38.3%) Top5:[392,361,573,316,952,582,946,791,31,951,458,903,958,234,694]


π”¬ Encoder Diversity (iter 5940):
  Avg similarity: 0.1321 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9266 (0.0=collapsed)
[Epoch 9/100] [Batch 598/669 (89.4%)] [Iter 5950] Loss: 1.1486 (freq: 0.4140, raw: 0.7340, quant: 0.0006, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 355/1024 (34.7%) Top5:[361,791,316,98,952,903,717,31,169,434,253,582,722,234,470]


π”¬ Encoder Diversity (iter 5950):
  Avg similarity: 0.1083 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9338 (0.0=collapsed)
[Epoch 9/100] [Batch 608/669 (90.9%)] [Iter 5960] Loss: 0.8986 (freq: 0.3124, raw: 0.5856, quant: 0.0005, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 448/1024 (43.8%) Top5:[72,253,434,846,951,458,234,470,44,897,392,958,967,573,399]


π”¬ Encoder Diversity (iter 5960):
  Avg similarity: 0.1153 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9273 (0.0=collapsed)
[Epoch 9/100] [Batch 618/669 (92.4%)] [Iter 5970] Loss: 1.3860 (freq: 0.5110, raw: 0.8744, quant: 0.0007, domain: 0.0000) LR: 1.78e-05 
π“ Codebook: 458/1024 (44.7%) Top5:[253,259,779,967,392,72,846,897,350,171,140,965,417,694,112]


π”¬ Encoder Diversity (iter 5970):
  Avg similarity: 0.1217 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9247 (0.0=collapsed)
[Epoch 9/100] [Batch 628/669 (93.9%)] [Iter 5980] Loss: 1.0482 (freq: 0.3815, raw: 0.6662, quant: 0.0006, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 420/1024 (41.0%) Top5:[392,44,140,779,70,259,16,903,253,694,573,10,417,734,206]


π”¬ Encoder Diversity (iter 5980):
  Avg similarity: 0.0937 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9438 (0.0=collapsed)
[Epoch 9/100] [Batch 638/669 (95.4%)] [Iter 5990] Loss: 1.2153 (freq: 0.4090, raw: 0.8057, quant: 0.0007, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 428/1024 (41.8%) Top5:[392,694,253,171,903,140,234,72,791,31,434,228,965,951,361]


π”¬ Encoder Diversity (iter 5990):
  Avg similarity: 0.0954 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9479 (0.0=collapsed)
[Epoch 9/100] [Batch 648/669 (96.9%)] [Iter 6000] Loss: 1.0602 (freq: 0.3921, raw: 0.6676, quant: 0.0006, domain: 0.0000) LR: 1.79e-05 
π“ Codebook: 377/1024 (36.8%) Top5:[903,44,694,573,72,392,829,70,16,951,617,274,434,206,470]


π”¬ Encoder Diversity (iter 6000):
  Avg similarity: 0.0595 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 9/100] [Batch 658/669 (98.4%)] [Iter 6010] Loss: 1.2230 (freq: 0.4353, raw: 0.7868, quant: 0.0008, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 401/1024 (39.2%) Top5:[72,573,829,44,791,33,470,70,392,694,903,458,253,16,206]


π”¬ Encoder Diversity (iter 6010):
  Avg similarity: 0.1089 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9329 (0.0=collapsed)
[Epoch 9/100] [Batch 668/669 (99.9%)] [Iter 6020] Loss: 1.1855 (freq: 0.4539, raw: 0.7310, quant: 0.0006, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 401/1024 (39.2%) Top5:[72,951,791,169,417,253,470,903,111,33,829,16,363,582,104]


π”¬ Encoder Diversity (iter 6020):
  Avg similarity: 0.0785 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)

================================================================================
[Epoch 9] Validation Results:
  Total Loss: 0.6281
  Freq Loss:  0.1963
  Raw Loss:   0.4313
  Quant Loss: 0.0005
  π“ Codebook Usage: 258/1024 (25.2%)
  π“ Codebook Entropy: 4.1251 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 39141 (30.1%)
  Top 10 most used codes:
    1. Code 44: 4664 times (3.58%)
    2. Code 16: 4247 times (3.26%)
    3. Code 70: 4120 times (3.16%)
    4. Code 361: 4062 times (3.12%)
    5. Code 309: 3874 times (2.98%)
    6. Code 573: 3857 times (2.96%)
    7. Code 206: 3705 times (2.85%)
    8. Code 791: 3632 times (2.79%)
    9. Code 152: 3609 times (2.77%)
    10. Code 694: 3371 times (2.59%)
  Bottom 5 least used codes (among used):
    1. Code 83: 1 times (0.00%)
    2. Code 40: 1 times (0.00%)
    3. Code 479: 1 times (0.00%)
    4. Code 1022: 1 times (0.00%)
    5. Code 629: 1 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 9
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 10/100] [Batch 9/669 (1.3%)] [Iter 6030] Loss: 1.3876 (freq: 0.5223, raw: 0.8645, quant: 0.0008, domain: 0.0000) LR: 1.80e-05 
π“ Codebook: 1019/1024 (99.5%) Top5:[722,903,70,791,582,31,316,206,573,494,829,932,694,16,680]


π”¬ Encoder Diversity (iter 6030):
  Avg similarity: 0.0882 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 10/100] [Batch 19/669 (2.8%)] [Iter 6040] Loss: 1.1263 (freq: 0.4262, raw: 0.6994, quant: 0.0007, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 528/1024 (51.6%) Top5:[283,829,765,206,903,44,722,16,694,70,899,791,878,573,569]


π”¬ Encoder Diversity (iter 6040):
  Avg similarity: 0.1325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9303 (0.0=collapsed)
[Epoch 10/100] [Batch 29/669 (4.3%)] [Iter 6050] Loss: 1.2679 (freq: 0.4758, raw: 0.7914, quant: 0.0007, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 386/1024 (37.7%) Top5:[791,31,722,582,594,694,569,829,707,878,903,468,952,932,152]


π”¬ Encoder Diversity (iter 6050):
  Avg similarity: 0.1117 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9367 (0.0=collapsed)
[Epoch 10/100] [Batch 39/669 (5.8%)] [Iter 6060] Loss: 1.2797 (freq: 0.4672, raw: 0.8118, quant: 0.0007, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 399/1024 (39.0%) Top5:[283,903,958,701,765,722,44,694,223,506,901,444,569,486,614]


π”¬ Encoder Diversity (iter 6060):
  Avg similarity: 0.1024 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9419 (0.0=collapsed)
[Epoch 10/100] [Batch 49/669 (7.3%)] [Iter 6070] Loss: 0.7857 (freq: 0.2716, raw: 0.5136, quant: 0.0005, domain: 0.0000) LR: 1.81e-05 
π“ Codebook: 442/1024 (43.2%) Top5:[722,903,283,70,694,44,227,958,569,791,765,7,31,486,468]


π”¬ Encoder Diversity (iter 6070):
  Avg similarity: 0.1022 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9300 (0.0=collapsed)
[Epoch 10/100] [Batch 59/669 (8.8%)] [Iter 6080] Loss: 0.9822 (freq: 0.3165, raw: 0.6652, quant: 0.0006, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 447/1024 (43.7%) Top5:[765,283,903,44,801,255,722,70,624,573,701,858,936,569,206]


π”¬ Encoder Diversity (iter 6080):
  Avg similarity: 0.1454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9177 (0.0=collapsed)
[Epoch 10/100] [Batch 69/669 (10.3%)] [Iter 6090] Loss: 1.1557 (freq: 0.4159, raw: 0.7391, quant: 0.0006, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 482/1024 (47.1%) Top5:[791,31,878,283,722,582,254,903,316,958,535,506,595,494,468]


π”¬ Encoder Diversity (iter 6090):
  Avg similarity: 0.1109 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9220 (0.0=collapsed)
[Epoch 10/100] [Batch 79/669 (11.8%)] [Iter 6100] Loss: 1.1541 (freq: 0.4131, raw: 0.7403, quant: 0.0007, domain: 0.0000) LR: 1.82e-05 
π“ Codebook: 409/1024 (39.9%) Top5:[283,897,701,624,56,506,468,773,678,223,958,535,255,595,486]


π”¬ Encoder Diversity (iter 6100):
  Avg similarity: 0.0944 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9440 (0.0=collapsed)
[Epoch 10/100] [Batch 89/669 (13.3%)] [Iter 6110] Loss: 1.0061 (freq: 0.3347, raw: 0.6708, quant: 0.0006, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 455/1024 (44.4%) Top5:[283,765,506,801,468,722,223,701,791,897,624,603,44,451,460]


π”¬ Encoder Diversity (iter 6110):
  Avg similarity: 0.0850 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9485 (0.0=collapsed)
[Epoch 10/100] [Batch 99/669 (14.8%)] [Iter 6120] Loss: 1.2762 (freq: 0.4892, raw: 0.7862, quant: 0.0008, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 513/1024 (50.1%) Top5:[283,152,903,791,31,694,932,494,765,722,801,70,309,624,614]


π”¬ Encoder Diversity (iter 6120):
  Avg similarity: 0.0620 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 10/100] [Batch 109/669 (16.3%)] [Iter 6130] Loss: 1.3825 (freq: 0.4883, raw: 0.8935, quant: 0.0007, domain: 0.0000) LR: 1.83e-05 
π“ Codebook: 389/1024 (38.0%) Top5:[903,694,44,765,283,206,70,829,573,594,585,722,701,255,7]


π”¬ Encoder Diversity (iter 6130):
  Avg similarity: 0.0846 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9464 (0.0=collapsed)
[Epoch 10/100] [Batch 119/669 (17.8%)] [Iter 6140] Loss: 1.2805 (freq: 0.4761, raw: 0.8038, quant: 0.0006, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 488/1024 (47.7%) Top5:[765,903,958,694,283,585,801,878,468,858,206,936,7,443,594]


π”¬ Encoder Diversity (iter 6140):
  Avg similarity: 0.1011 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9337 (0.0=collapsed)
[Epoch 10/100] [Batch 129/669 (19.3%)] [Iter 6150] Loss: 1.0206 (freq: 0.3775, raw: 0.6425, quant: 0.0006, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 460/1024 (44.9%) Top5:[283,765,801,878,958,903,694,701,936,624,31,585,829,858,443]


π”¬ Encoder Diversity (iter 6150):
  Avg similarity: 0.0758 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9429 (0.0=collapsed)
[Epoch 10/100] [Batch 139/669 (20.8%)] [Iter 6160] Loss: 1.0204 (freq: 0.3500, raw: 0.6698, quant: 0.0006, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 432/1024 (42.2%) Top5:[765,707,903,31,801,829,206,44,932,722,283,694,255,152,506]


π”¬ Encoder Diversity (iter 6160):
  Avg similarity: 0.0710 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 10/100] [Batch 149/669 (22.3%)] [Iter 6170] Loss: 1.1669 (freq: 0.4379, raw: 0.7284, quant: 0.0006, domain: 0.0000) LR: 1.84e-05 
π“ Codebook: 487/1024 (47.6%) Top5:[31,694,722,903,44,707,70,952,614,829,152,316,56,791,573]


π”¬ Encoder Diversity (iter 6170):
  Avg similarity: 0.0937 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9335 (0.0=collapsed)
[Epoch 10/100] [Batch 159/669 (23.8%)] [Iter 6180] Loss: 1.2943 (freq: 0.5030, raw: 0.7906, quant: 0.0007, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 461/1024 (45.0%) Top5:[70,31,722,694,44,573,717,152,316,801,903,707,206,952,255]


π”¬ Encoder Diversity (iter 6180):
  Avg similarity: 0.1041 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 10/100] [Batch 169/669 (25.3%)] [Iter 6190] Loss: 1.2311 (freq: 0.4407, raw: 0.7897, quant: 0.0006, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 434/1024 (42.4%) Top5:[694,801,44,70,16,765,722,283,903,255,206,361,680,573,31]


π”¬ Encoder Diversity (iter 6190):
  Avg similarity: 0.1181 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9258 (0.0=collapsed)
[Epoch 10/100] [Batch 179/669 (26.8%)] [Iter 6200] Loss: 1.0296 (freq: 0.3716, raw: 0.6574, quant: 0.0006, domain: 0.0000) LR: 1.85e-05 
π“ Codebook: 438/1024 (42.8%) Top5:[70,31,573,936,801,16,44,582,283,903,958,694,316,722,717]


π”¬ Encoder Diversity (iter 6200):
  Avg similarity: 0.0783 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 10/100] [Batch 189/669 (28.3%)] [Iter 6210] Loss: 1.1305 (freq: 0.3999, raw: 0.7300, quant: 0.0006, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 427/1024 (41.7%) Top5:[31,283,316,791,722,152,801,309,582,717,932,136,694,707,603]


π”¬ Encoder Diversity (iter 6210):
  Avg similarity: 0.0750 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 10/100] [Batch 199/669 (29.7%)] [Iter 6220] Loss: 1.2060 (freq: 0.4810, raw: 0.7244, quant: 0.0007, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 420/1024 (41.0%) Top5:[283,201,801,624,506,701,44,694,70,206,936,594,585,294,878]


π”¬ Encoder Diversity (iter 6220):
  Avg similarity: 0.0748 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9434 (0.0=collapsed)
[Epoch 10/100] [Batch 209/669 (31.2%)] [Iter 6230] Loss: 1.1000 (freq: 0.3640, raw: 0.7353, quant: 0.0007, domain: 0.0000) LR: 1.86e-05 
π“ Codebook: 396/1024 (38.7%) Top5:[765,801,201,255,858,31,594,283,254,701,717,9,152,585,901]


π”¬ Encoder Diversity (iter 6230):
  Avg similarity: 0.1141 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9229 (0.0=collapsed)
[Epoch 10/100] [Batch 219/669 (32.7%)] [Iter 6240] Loss: 1.3635 (freq: 0.5124, raw: 0.8504, quant: 0.0007, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 477/1024 (46.6%) Top5:[801,316,31,569,722,952,717,701,152,254,256,791,582,283,932]


π”¬ Encoder Diversity (iter 6240):
  Avg similarity: 0.0772 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9461 (0.0=collapsed)
[Epoch 10/100] [Batch 229/669 (34.2%)] [Iter 6250] Loss: 1.4055 (freq: 0.5330, raw: 0.8718, quant: 0.0007, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 472/1024 (46.1%) Top5:[283,801,206,701,680,44,250,958,765,16,50,256,460,573,622]


π”¬ Encoder Diversity (iter 6250):
  Avg similarity: 0.0839 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9382 (0.0=collapsed)
[Epoch 10/100] [Batch 239/669 (35.7%)] [Iter 6260] Loss: 1.0079 (freq: 0.3645, raw: 0.6428, quant: 0.0006, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 428/1024 (41.8%) Top5:[958,680,206,801,903,227,44,994,707,50,722,694,701,952,70]


π”¬ Encoder Diversity (iter 6260):
  Avg similarity: 0.0731 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9465 (0.0=collapsed)
[Epoch 10/100] [Batch 249/669 (37.2%)] [Iter 6270] Loss: 1.0767 (freq: 0.3770, raw: 0.6989, quant: 0.0007, domain: 0.0000) LR: 1.87e-05 
π“ Codebook: 504/1024 (49.2%) Top5:[903,283,206,994,801,44,694,899,50,722,573,70,361,680,735]


π”¬ Encoder Diversity (iter 6270):
  Avg similarity: 0.0993 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9340 (0.0=collapsed)
[Epoch 10/100] [Batch 259/669 (38.7%)] [Iter 6280] Loss: 1.2240 (freq: 0.4302, raw: 0.7931, quant: 0.0006, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 493/1024 (48.1%) Top5:[801,765,201,283,903,958,594,254,585,878,255,438,624,987,44]


π”¬ Encoder Diversity (iter 6280):
  Avg similarity: 0.1431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9324 (0.0=collapsed)
[Epoch 10/100] [Batch 269/669 (40.2%)] [Iter 6290] Loss: 1.2174 (freq: 0.4839, raw: 0.7329, quant: 0.0007, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 510/1024 (49.8%) Top5:[801,201,283,765,255,585,865,901,878,250,451,594,958,936,254]


π”¬ Encoder Diversity (iter 6290):
  Avg similarity: 0.0769 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 10/100] [Batch 279/669 (41.7%)] [Iter 6300] Loss: 1.4137 (freq: 0.5499, raw: 0.8630, quant: 0.0007, domain: 0.0000) LR: 1.88e-05 
π“ Codebook: 428/1024 (41.8%) Top5:[283,801,878,958,582,765,996,707,694,858,44,865,217,936,901]


π”¬ Encoder Diversity (iter 6300):
  Avg similarity: 0.0952 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9377 (0.0=collapsed)
[Epoch 10/100] [Batch 289/669 (43.2%)] [Iter 6310] Loss: 0.9748 (freq: 0.3196, raw: 0.6546, quant: 0.0006, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 469/1024 (45.8%) Top5:[206,707,680,791,903,582,765,932,50,694,801,952,274,722,664]


π”¬ Encoder Diversity (iter 6310):
  Avg similarity: 0.0693 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 10/100] [Batch 299/669 (44.7%)] [Iter 6320] Loss: 1.1295 (freq: 0.3832, raw: 0.7456, quant: 0.0006, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 476/1024 (46.5%) Top5:[43,801,535,958,701,250,903,206,283,664,680,50,936,569,567]


π”¬ Encoder Diversity (iter 6320):
  Avg similarity: 0.0892 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9450 (0.0=collapsed)
[Epoch 10/100] [Batch 309/669 (46.2%)] [Iter 6330] Loss: 1.4346 (freq: 0.5629, raw: 0.8710, quant: 0.0007, domain: 0.0000) LR: 1.89e-05 
π“ Codebook: 460/1024 (44.9%) Top5:[801,283,201,958,765,701,206,901,858,595,664,250,506,678,254]


π”¬ Encoder Diversity (iter 6330):
  Avg similarity: 0.0837 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 10/100] [Batch 319/669 (47.7%)] [Iter 6340] Loss: 1.1822 (freq: 0.4564, raw: 0.7252, quant: 0.0007, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 470/1024 (45.9%) Top5:[283,801,765,206,333,678,903,201,255,680,152,624,958,250,486]


π”¬ Encoder Diversity (iter 6340):
  Avg similarity: 0.1214 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9388 (0.0=collapsed)
[Epoch 10/100] [Batch 329/669 (49.2%)] [Iter 6350] Loss: 1.1342 (freq: 0.3926, raw: 0.7410, quant: 0.0006, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 475/1024 (46.4%) Top5:[283,765,801,903,624,333,255,70,680,897,694,152,50,451,256]


π”¬ Encoder Diversity (iter 6350):
  Avg similarity: 0.0647 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9401 (0.0=collapsed)
[Epoch 10/100] [Batch 339/669 (50.7%)] [Iter 6360] Loss: 1.5127 (freq: 0.5861, raw: 0.9258, quant: 0.0008, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 464/1024 (45.3%) Top5:[283,801,765,152,903,333,255,201,516,701,865,309,694,256,958]


π”¬ Encoder Diversity (iter 6360):
  Avg similarity: 0.0987 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 10/100] [Batch 349/669 (52.2%)] [Iter 6370] Loss: 1.2619 (freq: 0.4712, raw: 0.7900, quant: 0.0007, domain: 0.0000) LR: 1.90e-05 
π“ Codebook: 448/1024 (43.8%) Top5:[283,201,903,152,801,624,255,791,701,50,897,31,582,709,256]


π”¬ Encoder Diversity (iter 6370):
  Avg similarity: 0.1174 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 10/100] [Batch 359/669 (53.7%)] [Iter 6380] Loss: 1.4307 (freq: 0.5657, raw: 0.8643, quant: 0.0007, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 454/1024 (44.3%) Top5:[903,569,283,50,614,445,694,833,44,206,152,141,468,801,994]


π”¬ Encoder Diversity (iter 6380):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 10/100] [Batch 369/669 (55.2%)] [Iter 6390] Loss: 0.9886 (freq: 0.3460, raw: 0.6421, quant: 0.0006, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 436/1024 (42.6%) Top5:[791,801,152,833,952,141,694,569,958,903,664,254,582,309,70]


π”¬ Encoder Diversity (iter 6390):
  Avg similarity: 0.0784 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 10/100] [Batch 379/669 (56.7%)] [Iter 6400] Loss: 1.1473 (freq: 0.4019, raw: 0.7448, quant: 0.0006, domain: 0.0000) LR: 1.91e-05 
π“ Codebook: 471/1024 (46.0%) Top5:[801,283,595,858,256,333,254,255,250,201,701,901,7,688,506]


π”¬ Encoder Diversity (iter 6400):
  Avg similarity: 0.0918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9470 (0.0=collapsed)
[Epoch 10/100] [Batch 389/669 (58.1%)] [Iter 6410] Loss: 1.0241 (freq: 0.3547, raw: 0.6687, quant: 0.0006, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 475/1024 (46.4%) Top5:[283,152,801,765,255,701,791,250,952,932,958,50,309,217,694]


π”¬ Encoder Diversity (iter 6410):
  Avg similarity: 0.0659 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 10/100] [Batch 399/669 (59.6%)] [Iter 6420] Loss: 1.1033 (freq: 0.3688, raw: 0.7338, quant: 0.0007, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 466/1024 (45.5%) Top5:[445,140,283,206,277,958,333,801,252,701,680,255,468,996,688]


π”¬ Encoder Diversity (iter 6420):
  Avg similarity: 0.0950 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9469 (0.0=collapsed)
[Epoch 10/100] [Batch 409/669 (61.1%)] [Iter 6430] Loss: 1.3883 (freq: 0.5139, raw: 0.8736, quant: 0.0008, domain: 0.0000) LR: 1.92e-05 
π“ Codebook: 436/1024 (42.6%) Top5:[283,624,333,152,255,801,50,901,56,31,773,460,294,451,277]


π”¬ Encoder Diversity (iter 6430):
  Avg similarity: 0.0956 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9413 (0.0=collapsed)
[Epoch 10/100] [Batch 419/669 (62.6%)] [Iter 6440] Loss: 1.2624 (freq: 0.4593, raw: 0.8024, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 488/1024 (47.7%) Top5:[801,283,624,443,516,333,152,901,517,858,255,765,50,773,277]


π”¬ Encoder Diversity (iter 6440):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 10/100] [Batch 429/669 (64.1%)] [Iter 6450] Loss: 1.2810 (freq: 0.4932, raw: 0.7870, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 420/1024 (41.0%) Top5:[283,801,50,152,141,694,535,958,901,255,569,773,277,858,443]


π”¬ Encoder Diversity (iter 6450):
  Avg similarity: 0.0935 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9400 (0.0=collapsed)
[Epoch 10/100] [Batch 439/669 (65.6%)] [Iter 6460] Loss: 1.2076 (freq: 0.4289, raw: 0.7780, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 491/1024 (47.9%) Top5:[283,206,252,801,694,333,255,250,201,596,897,413,595,443,141]


π”¬ Encoder Diversity (iter 6460):
  Avg similarity: 0.0828 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9484 (0.0=collapsed)
[Epoch 10/100] [Batch 449/669 (67.1%)] [Iter 6470] Loss: 1.2319 (freq: 0.4426, raw: 0.7886, quant: 0.0007, domain: 0.0000) LR: 1.93e-05 
π“ Codebook: 535/1024 (52.2%) Top5:[283,201,206,678,801,567,486,56,995,680,878,252,595,255,858]


π”¬ Encoder Diversity (iter 6470):
  Avg similarity: 0.0940 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 10/100] [Batch 459/669 (68.6%)] [Iter 6480] Loss: 1.2539 (freq: 0.4556, raw: 0.7976, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 456/1024 (44.5%) Top5:[283,694,201,451,801,582,152,624,903,833,596,255,603,50,19]


π”¬ Encoder Diversity (iter 6480):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 10/100] [Batch 469/669 (70.1%)] [Iter 6490] Loss: 1.4571 (freq: 0.5751, raw: 0.8814, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 412/1024 (40.2%) Top5:[206,801,903,694,201,445,596,283,680,659,624,252,897,755,50]


π”¬ Encoder Diversity (iter 6490):
  Avg similarity: 0.1032 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 10/100] [Batch 479/669 (71.6%)] [Iter 6500] Loss: 1.1460 (freq: 0.4225, raw: 0.7228, quant: 0.0007, domain: 0.0000) LR: 1.94e-05 
π“ Codebook: 480/1024 (46.9%) Top5:[254,801,858,595,854,201,594,283,765,903,333,255,996,582,865]


π”¬ Encoder Diversity (iter 6500):
  Avg similarity: 0.1269 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9258 (0.0=collapsed)
[Epoch 10/100] [Batch 489/669 (73.1%)] [Iter 6510] Loss: 0.6459 (freq: 0.1887, raw: 0.4567, quant: 0.0005, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 437/1024 (42.7%) Top5:[152,595,833,791,801,31,858,254,582,494,50,709,283,701,569]


π”¬ Encoder Diversity (iter 6510):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 10/100] [Batch 499/669 (74.6%)] [Iter 6520] Loss: 1.1048 (freq: 0.3839, raw: 0.7202, quant: 0.0006, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 479/1024 (46.8%) Top5:[283,680,801,445,468,701,333,486,250,995,255,903,858,694,622]


π”¬ Encoder Diversity (iter 6520):
  Avg similarity: 0.0947 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9400 (0.0=collapsed)
[Epoch 10/100] [Batch 509/669 (76.1%)] [Iter 6530] Loss: 1.3205 (freq: 0.5207, raw: 0.7990, quant: 0.0007, domain: 0.0000) LR: 1.95e-05 
π“ Codebook: 470/1024 (45.9%) Top5:[445,680,903,807,70,283,833,50,252,31,498,694,659,596,468]


π”¬ Encoder Diversity (iter 6530):
  Avg similarity: 0.1103 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9313 (0.0=collapsed)
[Epoch 10/100] [Batch 519/669 (77.6%)] [Iter 6540] Loss: 1.2636 (freq: 0.4845, raw: 0.7784, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 547/1024 (53.4%) Top5:[283,56,333,152,255,801,835,624,773,897,50,494,694,995,201]


π”¬ Encoder Diversity (iter 6540):
  Avg similarity: 0.0783 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9495 (0.0=collapsed)
[Epoch 10/100] [Batch 529/669 (79.1%)] [Iter 6550] Loss: 1.2421 (freq: 0.4540, raw: 0.7873, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[152,903,50,254,791,582,31,858,835,694,585,932,516,854,996]


π”¬ Encoder Diversity (iter 6550):
  Avg similarity: 0.1024 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9366 (0.0=collapsed)
[Epoch 10/100] [Batch 539/669 (80.6%)] [Iter 6560] Loss: 1.1192 (freq: 0.4189, raw: 0.6997, quant: 0.0006, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 488/1024 (47.7%) Top5:[283,332,765,688,624,333,858,254,878,595,56,201,451,506,801]


π”¬ Encoder Diversity (iter 6560):
  Avg similarity: 0.0883 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9464 (0.0=collapsed)
[Epoch 10/100] [Batch 549/669 (82.1%)] [Iter 6570] Loss: 0.9993 (freq: 0.3618, raw: 0.6368, quant: 0.0007, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 483/1024 (47.2%) Top5:[152,50,70,31,765,932,903,283,716,569,445,722,659,16,707]


π”¬ Encoder Diversity (iter 6570):
  Avg similarity: 0.0588 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9542 (0.0=collapsed)
[Epoch 10/100] [Batch 559/669 (83.6%)] [Iter 6580] Loss: 0.9805 (freq: 0.3193, raw: 0.6606, quant: 0.0006, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 466/1024 (45.5%) Top5:[807,283,70,152,50,316,277,903,445,680,716,722,913,382,707]


π”¬ Encoder Diversity (iter 6580):
  Avg similarity: 0.0541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 10/100] [Batch 569/669 (85.1%)] [Iter 6590] Loss: 0.9181 (freq: 0.3363, raw: 0.5811, quant: 0.0006, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[995,50,152,932,31,688,516,596,486,664,801,19,283,603,56]


π”¬ Encoder Diversity (iter 6590):
  Avg similarity: 0.1428 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9231 (0.0=collapsed)
[Epoch 10/100] [Batch 579/669 (86.5%)] [Iter 6600] Loss: 0.9548 (freq: 0.2950, raw: 0.6592, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 471/1024 (46.0%) Top5:[995,688,858,865,254,595,413,694,585,7,987,596,901,854,56]


π”¬ Encoder Diversity (iter 6600):
  Avg similarity: 0.0763 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9430 (0.0=collapsed)
[Epoch 10/100] [Batch 589/669 (88.0%)] [Iter 6610] Loss: 1.1960 (freq: 0.4127, raw: 0.7825, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 487/1024 (47.6%) Top5:[833,50,932,309,765,494,624,694,858,31,791,596,333,498,283]


π”¬ Encoder Diversity (iter 6610):
  Avg similarity: 0.1270 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9306 (0.0=collapsed)
[Epoch 10/100] [Batch 599/669 (89.5%)] [Iter 6620] Loss: 1.0684 (freq: 0.3654, raw: 0.7024, quant: 0.0006, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 479/1024 (46.8%) Top5:[765,680,333,595,694,382,70,901,801,1015,7,596,445,332,745]


π”¬ Encoder Diversity (iter 6620):
  Avg similarity: 0.0942 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9407 (0.0=collapsed)
[Epoch 10/100] [Batch 609/669 (91.0%)] [Iter 6630] Loss: 0.6163 (freq: 0.1737, raw: 0.4420, quant: 0.0005, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 499/1024 (48.7%) Top5:[70,932,694,903,494,332,152,596,833,624,31,791,801,722,952]


π”¬ Encoder Diversity (iter 6630):
  Avg similarity: 0.0856 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9348 (0.0=collapsed)
[Epoch 10/100] [Batch 619/669 (92.5%)] [Iter 6640] Loss: 1.3927 (freq: 0.5237, raw: 0.8683, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 527/1024 (51.5%) Top5:[801,332,283,995,624,152,903,694,56,932,680,50,109,567,333]


π”¬ Encoder Diversity (iter 6640):
  Avg similarity: 0.1070 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9387 (0.0=collapsed)
[Epoch 10/100] [Batch 629/669 (94.0%)] [Iter 6650] Loss: 1.0678 (freq: 0.4124, raw: 0.6547, quant: 0.0006, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 567/1024 (55.4%) Top5:[152,31,582,50,494,70,801,932,903,995,952,833,694,858,569]


π”¬ Encoder Diversity (iter 6650):
  Avg similarity: 0.1017 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9324 (0.0=collapsed)
[Epoch 10/100] [Batch 639/669 (95.5%)] [Iter 6660] Loss: 1.2591 (freq: 0.4624, raw: 0.7960, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 522/1024 (51.0%) Top5:[765,801,688,70,152,995,516,451,201,19,283,596,680,56,694]


π”¬ Encoder Diversity (iter 6660):
  Avg similarity: 0.0918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9421 (0.0=collapsed)
[Epoch 10/100] [Batch 649/669 (97.0%)] [Iter 6670] Loss: 1.0133 (freq: 0.3720, raw: 0.6406, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 580/1024 (56.6%) Top5:[734,332,43,688,694,801,996,807,70,878,19,498,854,835,596]


π”¬ Encoder Diversity (iter 6670):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9548 (0.0=collapsed)
[Epoch 10/100] [Batch 659/669 (98.5%)] [Iter 6680] Loss: 1.4141 (freq: 0.5589, raw: 0.8544, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 563/1024 (55.0%) Top5:[152,516,801,833,43,50,932,333,31,395,874,494,596,316,582]


π”¬ Encoder Diversity (iter 6680):
  Avg similarity: 0.0949 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9372 (0.0=collapsed)
[Epoch 10/100] [Batch 669/669 (100.0%)] [Iter 6690] Loss: 1.4358 (freq: 0.5504, raw: 0.8847, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[765,333,680,445,624,595,854,995,283,878,277,701,254,70,332]


================================================================================
[Epoch 10] Validation Results:
  Total Loss: 0.6140
  Freq Loss:  0.1875
  Raw Loss:   0.4259
  Quant Loss: 0.0006
  π“ Codebook Usage: 169/1024 (16.5%)
  π“ Codebook Entropy: 4.0281 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 38628 (29.7%)
  Top 10 most used codes:
    1. Code 445: 4236 times (3.25%)
    2. Code 913: 4162 times (3.20%)
    3. Code 309: 4127 times (3.17%)
    4. Code 833: 4028 times (3.09%)
    5. Code 694: 3927 times (3.02%)
    6. Code 206: 3758 times (2.89%)
    7. Code 316: 3641 times (2.80%)
    8. Code 382: 3613 times (2.77%)
    9. Code 596: 3572 times (2.74%)
    10. Code 498: 3564 times (2.74%)
  Bottom 5 least used codes (among used):
    1. Code 303: 1 times (0.00%)
    2. Code 55: 1 times (0.00%)
    3. Code 885: 5 times (0.00%)
    4. Code 25: 7 times (0.01%)
    5. Code 24: 7 times (0.01%)
================================================================================

[EarlyStopping] Best model saved at epoch 10
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 9 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 6690):
  Avg similarity: 0.1013 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9344 (0.0=collapsed)
[Epoch 11/100] [Batch 10/669 (1.5%)] [Iter 6700] Loss: 0.9709 (freq: 0.3260, raw: 0.6443, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 1023/1024 (99.9%) Top5:[445,680,382,755,722,694,745,903,596,807,913,333,70,332,316]


π”¬ Encoder Diversity (iter 6700):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9478 (0.0=collapsed)
[Epoch 11/100] [Batch 20/669 (3.0%)] [Iter 6710] Loss: 1.1780 (freq: 0.4367, raw: 0.7406, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 550/1024 (53.7%) Top5:[354,445,332,680,878,333,642,305,193,892,391,93,11,280,885]


π”¬ Encoder Diversity (iter 6710):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 11/100] [Batch 30/669 (4.5%)] [Iter 6720] Loss: 1.1522 (freq: 0.4055, raw: 0.7460, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 467/1024 (45.6%) Top5:[354,152,395,305,494,932,878,680,707,722,280,445,833,642,93]


π”¬ Encoder Diversity (iter 6720):
  Avg similarity: 0.0743 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 11/100] [Batch 40/669 (6.0%)] [Iter 6730] Loss: 0.9047 (freq: 0.3091, raw: 0.5950, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 519/1024 (50.7%) Top5:[354,305,152,411,236,333,332,857,798,885,854,373,193,662,190]


π”¬ Encoder Diversity (iter 6730):
  Avg similarity: 0.0689 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9519 (0.0=collapsed)
[Epoch 11/100] [Batch 50/669 (7.5%)] [Iter 6740] Loss: 1.0647 (freq: 0.3999, raw: 0.6642, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 513/1024 (50.1%) Top5:[152,31,932,354,722,885,754,395,338,322,582,333,236,373,662]


π”¬ Encoder Diversity (iter 6740):
  Avg similarity: 0.0886 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9455 (0.0=collapsed)
[Epoch 11/100] [Batch 60/669 (9.0%)] [Iter 6750] Loss: 1.1498 (freq: 0.3977, raw: 0.7514, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 506/1024 (49.4%) Top5:[680,70,599,662,23,711,754,692,445,722,190,798,747,373,316]


π”¬ Encoder Diversity (iter 6750):
  Avg similarity: 0.1387 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9332 (0.0=collapsed)
[Epoch 11/100] [Batch 70/669 (10.5%)] [Iter 6760] Loss: 0.8961 (freq: 0.3179, raw: 0.5776, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 505/1024 (49.3%) Top5:[305,798,190,692,235,768,599,338,333,280,322,70,747,722,517]


π”¬ Encoder Diversity (iter 6760):
  Avg similarity: 0.0871 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 11/100] [Batch 80/669 (12.0%)] [Iter 6770] Loss: 0.8694 (freq: 0.3028, raw: 0.5660, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 524/1024 (51.2%) Top5:[332,680,70,517,193,722,694,714,411,305,72,31,798,450,854]


π”¬ Encoder Diversity (iter 6770):
  Avg similarity: 0.0976 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 11/100] [Batch 90/669 (13.5%)] [Iter 6780] Loss: 1.1148 (freq: 0.3800, raw: 0.7342, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 480/1024 (46.9%) Top5:[305,517,333,798,854,11,582,885,680,235,714,791,411,354,72]


π”¬ Encoder Diversity (iter 6780):
  Avg similarity: 0.0934 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 11/100] [Batch 100/669 (14.9%)] [Iter 6790] Loss: 1.2815 (freq: 0.4748, raw: 0.8060, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 507/1024 (49.5%) Top5:[333,305,798,236,354,885,680,754,11,854,445,373,857,72,411]


π”¬ Encoder Diversity (iter 6790):
  Avg similarity: 0.1169 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9269 (0.0=collapsed)
[Epoch 11/100] [Batch 110/669 (16.4%)] [Iter 6800] Loss: 1.2903 (freq: 0.4875, raw: 0.8022, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 511/1024 (49.9%) Top5:[305,798,885,754,333,354,854,517,11,299,373,680,662,72,50]


π”¬ Encoder Diversity (iter 6800):
  Avg similarity: 0.0983 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9371 (0.0=collapsed)
[Epoch 11/100] [Batch 120/669 (17.9%)] [Iter 6810] Loss: 1.0505 (freq: 0.3761, raw: 0.6739, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 544/1024 (53.1%) Top5:[305,354,885,517,680,299,193,582,833,707,280,506,903,50,664]


π”¬ Encoder Diversity (iter 6810):
  Avg similarity: 0.0728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 11/100] [Batch 130/669 (19.4%)] [Iter 6820] Loss: 1.0418 (freq: 0.3788, raw: 0.6624, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 575/1024 (56.2%) Top5:[680,801,204,517,301,694,807,722,72,152,23,50,395,664,332]


π”¬ Encoder Diversity (iter 6820):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 11/100] [Batch 140/669 (20.9%)] [Iter 6830] Loss: 0.9705 (freq: 0.3184, raw: 0.6515, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 536/1024 (52.3%) Top5:[615,932,885,801,305,517,798,694,662,152,301,722,280,332,11]


π”¬ Encoder Diversity (iter 6830):
  Avg similarity: 0.0651 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 11/100] [Batch 150/669 (22.4%)] [Iter 6840] Loss: 1.3756 (freq: 0.5091, raw: 0.8658, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[305,865,881,885,354,190,280,662,517,754,236,235,711,722,322]


π”¬ Encoder Diversity (iter 6840):
  Avg similarity: 0.0760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 11/100] [Batch 160/669 (23.9%)] [Iter 6850] Loss: 0.8609 (freq: 0.2878, raw: 0.5726, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 457/1024 (44.6%) Top5:[23,680,305,354,694,801,445,722,190,16,517,31,807,885,70]


π”¬ Encoder Diversity (iter 6850):
  Avg similarity: 0.0798 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 11/100] [Batch 170/669 (25.4%)] [Iter 6860] Loss: 1.2961 (freq: 0.4903, raw: 0.8051, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 472/1024 (46.1%) Top5:[305,662,754,391,72,439,411,332,857,333,424,235,582,885,373]


π”¬ Encoder Diversity (iter 6860):
  Avg similarity: 0.1210 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9212 (0.0=collapsed)
[Epoch 11/100] [Batch 180/669 (26.9%)] [Iter 6870] Loss: 0.8699 (freq: 0.2833, raw: 0.5859, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[680,23,305,517,885,72,722,235,798,338,886,439,755,445,801]


π”¬ Encoder Diversity (iter 6870):
  Avg similarity: 0.0911 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9467 (0.0=collapsed)
[Epoch 11/100] [Batch 190/669 (28.4%)] [Iter 6880] Loss: 1.2403 (freq: 0.4487, raw: 0.7908, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 497/1024 (48.5%) Top5:[305,459,517,338,204,714,798,280,301,885,354,754,333,854,523]


π”¬ Encoder Diversity (iter 6880):
  Avg similarity: 0.0832 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9352 (0.0=collapsed)
[Epoch 11/100] [Batch 200/669 (29.9%)] [Iter 6890] Loss: 0.9915 (freq: 0.3672, raw: 0.6236, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 518/1024 (50.6%) Top5:[680,903,807,596,450,50,23,517,582,332,338,204,801,305,301]


π”¬ Encoder Diversity (iter 6890):
  Avg similarity: 0.1136 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9272 (0.0=collapsed)
[Epoch 11/100] [Batch 210/669 (31.4%)] [Iter 6900] Loss: 1.4012 (freq: 0.5423, raw: 0.8582, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[694,801,517,305,354,382,680,280,722,807,141,23,798,333,886]


π”¬ Encoder Diversity (iter 6900):
  Avg similarity: 0.0622 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 11/100] [Batch 220/669 (32.9%)] [Iter 6910] Loss: 1.2711 (freq: 0.4963, raw: 0.7741, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 542/1024 (52.9%) Top5:[517,333,305,885,857,280,369,332,354,411,854,72,424,235,711]


π”¬ Encoder Diversity (iter 6910):
  Avg similarity: 0.0759 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 11/100] [Batch 230/669 (34.4%)] [Iter 6920] Loss: 1.2126 (freq: 0.4277, raw: 0.7842, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 537/1024 (52.4%) Top5:[333,517,662,589,865,798,857,305,885,754,11,373,323,411,299]


π”¬ Encoder Diversity (iter 6920):
  Avg similarity: 0.0828 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9436 (0.0=collapsed)
[Epoch 11/100] [Batch 240/669 (35.9%)] [Iter 6930] Loss: 1.2166 (freq: 0.4370, raw: 0.7789, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 521/1024 (50.9%) Top5:[459,517,354,885,798,754,373,333,801,235,722,50,494,305,31]


π”¬ Encoder Diversity (iter 6930):
  Avg similarity: 0.0614 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 11/100] [Batch 250/669 (37.4%)] [Iter 6940] Loss: 1.0996 (freq: 0.3764, raw: 0.7225, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 497/1024 (48.5%) Top5:[445,722,886,23,50,517,680,903,932,952,596,707,749,494,31]


π”¬ Encoder Diversity (iter 6940):
  Avg similarity: 0.1021 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9424 (0.0=collapsed)
[Epoch 11/100] [Batch 260/669 (38.9%)] [Iter 6950] Loss: 0.7297 (freq: 0.2131, raw: 0.5161, quant: 0.0005, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 500/1024 (48.8%) Top5:[354,517,62,236,582,50,664,596,305,791,445,382,952,307,494]


π”¬ Encoder Diversity (iter 6950):
  Avg similarity: 0.0838 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9456 (0.0=collapsed)
[Epoch 11/100] [Batch 270/669 (40.4%)] [Iter 6960] Loss: 0.9903 (freq: 0.3508, raw: 0.6389, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 444/1024 (43.4%) Top5:[445,886,305,353,754,798,615,261,354,517,692,280,596,749,722]


π”¬ Encoder Diversity (iter 6960):
  Avg similarity: 0.0607 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 11/100] [Batch 280/669 (41.9%)] [Iter 6970] Loss: 1.2836 (freq: 0.4730, raw: 0.8100, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 532/1024 (52.0%) Top5:[305,517,72,692,459,333,582,791,369,754,382,280,761,798,711]


π”¬ Encoder Diversity (iter 6970):
  Avg similarity: 0.0782 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9520 (0.0=collapsed)
[Epoch 11/100] [Batch 290/669 (43.3%)] [Iter 6980] Loss: 0.8253 (freq: 0.2568, raw: 0.5679, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 479/1024 (46.8%) Top5:[305,517,72,459,141,903,596,11,791,354,39,382,798,333,50]


π”¬ Encoder Diversity (iter 6980):
  Avg similarity: 0.0586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9521 (0.0=collapsed)
[Epoch 11/100] [Batch 300/669 (44.8%)] [Iter 6990] Loss: 1.2272 (freq: 0.4323, raw: 0.7943, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[596,141,50,903,722,801,445,791,333,316,886,354,280,353,31]


π”¬ Encoder Diversity (iter 6990):
  Avg similarity: 0.0567 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9484 (0.0=collapsed)
[Epoch 11/100] [Batch 310/669 (46.3%)] [Iter 7000] Loss: 0.9785 (freq: 0.3162, raw: 0.6616, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 553/1024 (54.0%) Top5:[373,236,854,450,190,62,517,932,382,280,333,50,494,141,664]


π”¬ Encoder Diversity (iter 7000):
  Avg similarity: 0.0715 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9453 (0.0=collapsed)
[Epoch 11/100] [Batch 320/669 (47.8%)] [Iter 7010] Loss: 1.0824 (freq: 0.3807, raw: 0.7010, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 522/1024 (51.0%) Top5:[333,517,332,445,662,885,373,635,483,664,903,857,305,212,70]


π”¬ Encoder Diversity (iter 7010):
  Avg similarity: 0.0631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 11/100] [Batch 330/669 (49.3%)] [Iter 7020] Loss: 1.2273 (freq: 0.4498, raw: 0.7768, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 552/1024 (53.9%) Top5:[596,664,807,62,50,141,517,305,722,332,662,363,333,31,754]


π”¬ Encoder Diversity (iter 7020):
  Avg similarity: 0.1199 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9315 (0.0=collapsed)
[Epoch 11/100] [Batch 340/669 (50.8%)] [Iter 7030] Loss: 1.0287 (freq: 0.3958, raw: 0.6322, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 523/1024 (51.1%) Top5:[459,517,62,305,72,11,903,932,664,801,31,494,596,798,707]


π”¬ Encoder Diversity (iter 7030):
  Avg similarity: 0.0945 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9460 (0.0=collapsed)
[Epoch 11/100] [Batch 350/669 (52.3%)] [Iter 7040] Loss: 1.3293 (freq: 0.4856, raw: 0.8429, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 448/1024 (43.8%) Top5:[459,517,491,31,62,322,39,801,236,798,204,664,932,11,354]


π”¬ Encoder Diversity (iter 7040):
  Avg similarity: 0.0731 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 11/100] [Batch 360/669 (53.8%)] [Iter 7050] Loss: 1.2649 (freq: 0.4709, raw: 0.7932, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 568/1024 (55.5%) Top5:[332,857,754,299,333,517,280,615,166,391,865,589,635,854,305]


π”¬ Encoder Diversity (iter 7050):
  Avg similarity: 0.0682 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 11/100] [Batch 370/669 (55.3%)] [Iter 7060] Loss: 0.8506 (freq: 0.2427, raw: 0.6072, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 610/1024 (59.6%) Top5:[305,517,395,791,932,141,62,333,50,31,707,373,354,664,328]


π”¬ Encoder Diversity (iter 7060):
  Avg similarity: 0.0599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 11/100] [Batch 380/669 (56.8%)] [Iter 7070] Loss: 1.3299 (freq: 0.4962, raw: 0.8329, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 572/1024 (55.9%) Top5:[333,711,141,596,807,332,517,305,50,754,885,373,854,280,11]


π”¬ Encoder Diversity (iter 7070):
  Avg similarity: 0.0487 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 11/100] [Batch 390/669 (58.3%)] [Iter 7080] Loss: 1.2603 (freq: 0.4550, raw: 0.8046, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 498/1024 (48.6%) Top5:[462,459,596,517,116,256,445,373,382,305,332,754,72,692,599]


π”¬ Encoder Diversity (iter 7080):
  Avg similarity: 0.0602 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 11/100] [Batch 400/669 (59.8%)] [Iter 7090] Loss: 0.9788 (freq: 0.3305, raw: 0.6477, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 561/1024 (54.8%) Top5:[517,459,305,798,11,801,332,596,369,722,913,197,807,642,275]


π”¬ Encoder Diversity (iter 7090):
  Avg similarity: 0.0984 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9336 (0.0=collapsed)
[Epoch 11/100] [Batch 410/669 (61.3%)] [Iter 7100] Loss: 1.3184 (freq: 0.4722, raw: 0.8454, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 461/1024 (45.0%) Top5:[494,362,459,197,332,382,517,615,72,62,508,950,373,722,11]


π”¬ Encoder Diversity (iter 7100):
  Avg similarity: 0.1266 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9228 (0.0=collapsed)
[Epoch 11/100] [Batch 420/669 (62.8%)] [Iter 7110] Loss: 1.2027 (freq: 0.4170, raw: 0.7850, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 535/1024 (52.2%) Top5:[382,305,459,932,711,754,333,354,801,373,332,70,854,798,450]


π”¬ Encoder Diversity (iter 7110):
  Avg similarity: 0.1061 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9420 (0.0=collapsed)
[Epoch 11/100] [Batch 430/669 (64.3%)] [Iter 7120] Loss: 1.3065 (freq: 0.4432, raw: 0.8627, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 520/1024 (50.8%) Top5:[382,305,333,854,635,711,450,459,754,332,373,236,354,299,256]


π”¬ Encoder Diversity (iter 7120):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 11/100] [Batch 440/669 (65.8%)] [Iter 7130] Loss: 0.7007 (freq: 0.2068, raw: 0.4933, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 577/1024 (56.3%) Top5:[305,517,798,373,596,299,39,369,50,333,801,644,196,761,382]


π”¬ Encoder Diversity (iter 7130):
  Avg similarity: 0.0813 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 11/100] [Batch 450/669 (67.3%)] [Iter 7140] Loss: 1.2529 (freq: 0.4594, raw: 0.7928, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[680,644,332,798,196,373,754,517,333,462,299,582,450,362,11]


π”¬ Encoder Diversity (iter 7140):
  Avg similarity: 0.0794 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9495 (0.0=collapsed)
[Epoch 11/100] [Batch 460/669 (68.8%)] [Iter 7150] Loss: 1.0882 (freq: 0.3658, raw: 0.7218, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 530/1024 (51.8%) Top5:[680,596,798,644,642,459,333,517,931,305,532,664,801,382,196]


π”¬ Encoder Diversity (iter 7150):
  Avg similarity: 0.1040 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9373 (0.0=collapsed)
[Epoch 11/100] [Batch 470/669 (70.3%)] [Iter 7160] Loss: 1.3391 (freq: 0.5065, raw: 0.8319, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 537/1024 (52.4%) Top5:[305,680,333,798,517,459,382,711,235,596,332,635,362,299,642]


π”¬ Encoder Diversity (iter 7160):
  Avg similarity: 0.1220 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9255 (0.0=collapsed)
[Epoch 11/100] [Batch 480/669 (71.7%)] [Iter 7170] Loss: 1.2322 (freq: 0.4321, raw: 0.7994, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 576/1024 (56.2%) Top5:[305,517,459,798,299,333,801,680,39,72,615,845,642,373,280]


π”¬ Encoder Diversity (iter 7170):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 11/100] [Batch 490/669 (73.2%)] [Iter 7180] Loss: 1.1361 (freq: 0.4244, raw: 0.7110, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 568/1024 (55.5%) Top5:[517,369,332,798,642,615,722,664,62,932,725,375,582,236,801]


π”¬ Encoder Diversity (iter 7180):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 11/100] [Batch 500/669 (74.7%)] [Iter 7190] Loss: 1.1383 (freq: 0.4146, raw: 0.7231, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 486/1024 (47.5%) Top5:[932,375,50,62,517,11,692,1007,459,285,722,952,664,931,754]


π”¬ Encoder Diversity (iter 7190):
  Avg similarity: 0.0838 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 11/100] [Batch 510/669 (76.2%)] [Iter 7200] Loss: 0.8808 (freq: 0.2936, raw: 0.5866, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 522/1024 (51.0%) Top5:[62,459,596,680,462,932,722,517,931,285,542,952,798,50,11]


π”¬ Encoder Diversity (iter 7200):
  Avg similarity: 0.0725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9393 (0.0=collapsed)
[Epoch 11/100] [Batch 520/669 (77.7%)] [Iter 7210] Loss: 0.9879 (freq: 0.3433, raw: 0.6440, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 507/1024 (49.5%) Top5:[305,517,333,798,680,382,644,596,11,604,459,63,532,369,299]


π”¬ Encoder Diversity (iter 7210):
  Avg similarity: 0.0652 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 11/100] [Batch 530/669 (79.2%)] [Iter 7220] Loss: 0.9285 (freq: 0.3016, raw: 0.6261, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 561/1024 (54.8%) Top5:[305,517,459,63,333,596,664,680,39,798,604,382,644,931,373]


π”¬ Encoder Diversity (iter 7220):
  Avg similarity: 0.0602 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 11/100] [Batch 540/669 (80.7%)] [Iter 7230] Loss: 1.1242 (freq: 0.3958, raw: 0.7277, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[680,62,932,596,664,722,532,517,707,285,644,382,903,125,931]


π”¬ Encoder Diversity (iter 7230):
  Avg similarity: 0.0798 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 11/100] [Batch 550/669 (82.2%)] [Iter 7240] Loss: 1.2320 (freq: 0.4208, raw: 0.8105, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[305,332,384,517,382,236,711,116,361,369,333,725,588,932,280]


π”¬ Encoder Diversity (iter 7240):
  Avg similarity: 0.0798 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9427 (0.0=collapsed)
[Epoch 11/100] [Batch 560/669 (83.7%)] [Iter 7250] Loss: 1.1572 (freq: 0.4627, raw: 0.6938, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 537/1024 (52.4%) Top5:[305,798,333,680,517,932,754,382,11,472,532,707,903,722,450]


π”¬ Encoder Diversity (iter 7250):
  Avg similarity: 0.0856 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9440 (0.0=collapsed)
[Epoch 11/100] [Batch 570/669 (85.2%)] [Iter 7260] Loss: 1.2652 (freq: 0.4652, raw: 0.7993, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 571/1024 (55.8%) Top5:[711,517,462,798,362,754,615,472,333,635,450,332,301,39,11]


π”¬ Encoder Diversity (iter 7260):
  Avg similarity: 0.0920 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9468 (0.0=collapsed)
[Epoch 11/100] [Batch 580/669 (86.7%)] [Iter 7270] Loss: 1.2203 (freq: 0.4321, raw: 0.7875, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 540/1024 (52.7%) Top5:[517,125,459,305,707,798,931,363,39,333,932,711,373,1003,523]


π”¬ Encoder Diversity (iter 7270):
  Avg similarity: 0.0652 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9567 (0.0=collapsed)
[Epoch 11/100] [Batch 590/669 (88.2%)] [Iter 7280] Loss: 1.2200 (freq: 0.4254, raw: 0.7940, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 511/1024 (49.9%) Top5:[305,459,711,382,532,635,517,523,369,333,332,72,256,798,596]


π”¬ Encoder Diversity (iter 7280):
  Avg similarity: 0.0708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 11/100] [Batch 600/669 (89.7%)] [Iter 7290] Loss: 1.0058 (freq: 0.3635, raw: 0.6417, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 515/1024 (50.3%) Top5:[305,532,459,711,604,680,450,725,615,635,256,754,931,72,517]


π”¬ Encoder Diversity (iter 7290):
  Avg similarity: 0.0440 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 11/100] [Batch 610/669 (91.2%)] [Iter 7300] Loss: 0.8550 (freq: 0.2920, raw: 0.5623, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 569/1024 (55.6%) Top5:[932,305,62,125,517,333,332,885,664,918,604,827,680,707,742]


π”¬ Encoder Diversity (iter 7300):
  Avg similarity: 0.0799 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9428 (0.0=collapsed)
[Epoch 11/100] [Batch 620/669 (92.7%)] [Iter 7310] Loss: 1.1517 (freq: 0.4284, raw: 0.7227, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 523/1024 (51.1%) Top5:[305,798,62,11,72,711,332,932,333,459,340,680,885,39,382]


π”¬ Encoder Diversity (iter 7310):
  Avg similarity: 0.0593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 11/100] [Batch 630/669 (94.2%)] [Iter 7320] Loss: 1.3722 (freq: 0.4820, raw: 0.8895, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 491/1024 (47.9%) Top5:[798,517,305,711,885,462,11,333,747,322,301,204,236,235,280]


π”¬ Encoder Diversity (iter 7320):
  Avg similarity: 0.0715 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9523 (0.0=collapsed)
[Epoch 11/100] [Batch 640/669 (95.7%)] [Iter 7330] Loss: 0.7253 (freq: 0.2194, raw: 0.5052, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 515/1024 (50.3%) Top5:[596,875,918,707,932,62,931,517,644,680,903,333,722,335,718]


π”¬ Encoder Diversity (iter 7330):
  Avg similarity: 0.0895 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 11/100] [Batch 650/669 (97.2%)] [Iter 7340] Loss: 1.2119 (freq: 0.4266, raw: 0.7845, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 552/1024 (53.9%) Top5:[517,305,236,885,615,725,459,382,680,333,322,711,391,532,335]


π”¬ Encoder Diversity (iter 7340):
  Avg similarity: 0.0842 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 11/100] [Batch 660/669 (98.7%)] [Iter 7350] Loss: 0.8564 (freq: 0.2901, raw: 0.5657, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 494/1024 (48.2%) Top5:[680,931,532,903,332,711,722,644,1003,596,875,517,707,236,335]


π”¬ Encoder Diversity (iter 7350):
  Avg similarity: 0.0838 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9406 (0.0=collapsed)

================================================================================
[Epoch 11] Validation Results:
  Total Loss: 0.5935
  Freq Loss:  0.1825
  Raw Loss:   0.4104
  Quant Loss: 0.0006
  π“ Codebook Usage: 389/1024 (38.0%)
  π“ Codebook Entropy: 4.4786 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 31628 (24.3%)
  Top 10 most used codes:
    1. Code 932: 3802 times (2.92%)
    2. Code 62: 3538 times (2.72%)
    3. Code 918: 3344 times (2.57%)
    4. Code 931: 3335 times (2.56%)
    5. Code 1007: 3135 times (2.41%)
    6. Code 375: 3075 times (2.36%)
    7. Code 340: 2874 times (2.21%)
    8. Code 532: 2848 times (2.19%)
    9. Code 542: 2846 times (2.19%)
    10. Code 664: 2831 times (2.17%)
  Bottom 5 least used codes (among used):
    1. Code 344: 1 times (0.00%)
    2. Code 199: 1 times (0.00%)
    3. Code 403: 1 times (0.00%)
    4. Code 891: 1 times (0.00%)
    5. Code 95: 6 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 11
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 12/100] [Batch 1/669 (0.1%)] [Iter 7360] Loss: 0.8326 (freq: 0.2923, raw: 0.5397, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 629/1024 (61.4%) Top5:[680,807,644,517,532,722,931,305,459,92,711,664,615,885,382]


π”¬ Encoder Diversity (iter 7360):
  Avg similarity: 0.0617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 12/100] [Batch 11/669 (1.6%)] [Iter 7370] Loss: 0.7713 (freq: 0.2403, raw: 0.5304, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 1004/1024 (98.0%) Top5:[275,125,722,931,644,340,62,932,858,1003,445,742,903,375,50]


π”¬ Encoder Diversity (iter 7370):
  Avg similarity: 0.0869 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9472 (0.0=collapsed)
[Epoch 12/100] [Batch 21/669 (3.1%)] [Iter 7380] Loss: 1.3475 (freq: 0.4927, raw: 0.8540, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 607/1024 (59.3%) Top5:[1017,108,691,369,716,332,1014,137,978,166,774,30,750,963,884]


π”¬ Encoder Diversity (iter 7380):
  Avg similarity: 0.1303 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9231 (0.0=collapsed)
[Epoch 12/100] [Batch 31/669 (4.6%)] [Iter 7390] Loss: 1.2133 (freq: 0.4181, raw: 0.7945, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 506/1024 (49.4%) Top5:[716,691,743,986,108,52,760,921,433,1017,644,44,927,569,267]


π”¬ Encoder Diversity (iter 7390):
  Avg similarity: 0.0983 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9369 (0.0=collapsed)
[Epoch 12/100] [Batch 41/669 (6.1%)] [Iter 7400] Loss: 1.1644 (freq: 0.4581, raw: 0.7056, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[743,204,774,691,927,332,969,166,369,782,1017,108,628,367,986]


π”¬ Encoder Diversity (iter 7400):
  Avg similarity: 0.0983 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9345 (0.0=collapsed)
[Epoch 12/100] [Batch 51/669 (7.6%)] [Iter 7410] Loss: 0.9655 (freq: 0.3208, raw: 0.6441, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 517/1024 (50.5%) Top5:[275,644,596,743,469,722,875,774,969,664,445,931,932,614,363]


π”¬ Encoder Diversity (iter 7410):
  Avg similarity: 0.0806 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9517 (0.0=collapsed)
[Epoch 12/100] [Batch 61/669 (9.1%)] [Iter 7420] Loss: 1.1403 (freq: 0.4417, raw: 0.6980, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 448/1024 (43.8%) Top5:[858,166,569,269,204,369,117,108,658,418,939,419,743,978,218]


π”¬ Encoder Diversity (iter 7420):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 12/100] [Batch 71/669 (10.6%)] [Iter 7430] Loss: 1.2409 (freq: 0.4647, raw: 0.7755, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 492/1024 (48.0%) Top5:[858,204,369,614,1017,418,691,569,269,750,932,931,743,108,137]


π”¬ Encoder Diversity (iter 7430):
  Avg similarity: 0.1025 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9377 (0.0=collapsed)
[Epoch 12/100] [Batch 81/669 (12.1%)] [Iter 7440] Loss: 1.2730 (freq: 0.4837, raw: 0.7887, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 484/1024 (47.3%) Top5:[644,275,569,903,722,375,680,742,70,963,50,931,992,714,269]


π”¬ Encoder Diversity (iter 7440):
  Avg similarity: 0.1237 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9278 (0.0=collapsed)
[Epoch 12/100] [Batch 91/669 (13.6%)] [Iter 7450] Loss: 1.0258 (freq: 0.3713, raw: 0.6538, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 537/1024 (52.4%) Top5:[628,418,569,691,52,992,963,782,986,714,781,658,137,271,269]


π”¬ Encoder Diversity (iter 7450):
  Avg similarity: 0.0626 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9515 (0.0=collapsed)
[Epoch 12/100] [Batch 101/669 (15.1%)] [Iter 7460] Loss: 1.2748 (freq: 0.5162, raw: 0.7578, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 479/1024 (46.8%) Top5:[1017,931,62,166,969,691,628,50,418,782,328,275,918,137,858]


π”¬ Encoder Diversity (iter 7460):
  Avg similarity: 0.0761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9534 (0.0=collapsed)
[Epoch 12/100] [Batch 111/669 (16.6%)] [Iter 7470] Loss: 1.1675 (freq: 0.4203, raw: 0.7465, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 579/1024 (56.5%) Top5:[932,275,875,129,722,62,204,931,858,166,918,596,644,542,663]


π”¬ Encoder Diversity (iter 7470):
  Avg similarity: 0.1111 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9376 (0.0=collapsed)
[Epoch 12/100] [Batch 121/669 (18.1%)] [Iter 7480] Loss: 1.2230 (freq: 0.4279, raw: 0.7944, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[150,858,166,204,405,614,516,269,657,774,969,418,1014,138,1017]


π”¬ Encoder Diversity (iter 7480):
  Avg similarity: 0.0725 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 12/100] [Batch 131/669 (19.6%)] [Iter 7490] Loss: 0.9829 (freq: 0.3394, raw: 0.6428, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 520/1024 (50.8%) Top5:[166,644,332,62,267,129,743,596,30,875,782,628,969,884,137]


π”¬ Encoder Diversity (iter 7490):
  Avg similarity: 0.0746 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9482 (0.0=collapsed)
[Epoch 12/100] [Batch 141/669 (21.1%)] [Iter 7500] Loss: 1.2848 (freq: 0.5076, raw: 0.7765, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 505/1024 (49.3%) Top5:[137,743,166,52,628,614,858,332,569,369,782,267,927,471,419]


π”¬ Encoder Diversity (iter 7500):
  Avg similarity: 0.1248 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9308 (0.0=collapsed)
[Epoch 12/100] [Batch 151/669 (22.6%)] [Iter 7510] Loss: 0.8665 (freq: 0.2992, raw: 0.5668, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 570/1024 (55.7%) Top5:[166,275,596,614,663,858,269,539,874,722,963,52,665,931,418]


π”¬ Encoder Diversity (iter 7510):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 12/100] [Batch 161/669 (24.1%)] [Iter 7520] Loss: 1.1269 (freq: 0.4147, raw: 0.7116, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 615/1024 (60.1%) Top5:[1017,166,969,691,332,269,1014,750,204,986,369,271,52,539,367]


π”¬ Encoder Diversity (iter 7520):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 12/100] [Batch 171/669 (25.6%)] [Iter 7530] Loss: 0.9779 (freq: 0.3262, raw: 0.6510, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 566/1024 (55.3%) Top5:[204,969,1017,691,1014,858,166,332,269,614,367,782,774,742,418]


π”¬ Encoder Diversity (iter 7530):
  Avg similarity: 0.1599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9253 (0.0=collapsed)
[Epoch 12/100] [Batch 181/669 (27.1%)] [Iter 7540] Loss: 1.1094 (freq: 0.3728, raw: 0.7359, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[269,858,992,1017,166,419,204,367,614,332,658,782,691,963,62]


π”¬ Encoder Diversity (iter 7540):
  Avg similarity: 0.0750 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9467 (0.0=collapsed)
[Epoch 12/100] [Batch 191/669 (28.6%)] [Iter 7550] Loss: 1.2743 (freq: 0.4979, raw: 0.7757, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[596,743,782,969,166,332,607,992,663,628,138,1014,986,774,750]


π”¬ Encoder Diversity (iter 7550):
  Avg similarity: 0.0769 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9504 (0.0=collapsed)
[Epoch 12/100] [Batch 201/669 (30.0%)] [Iter 7560] Loss: 1.1233 (freq: 0.3844, raw: 0.7382, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[166,596,858,932,419,275,424,52,969,978,658,884,269,918,614]


π”¬ Encoder Diversity (iter 7560):
  Avg similarity: 0.0491 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 12/100] [Batch 211/669 (31.5%)] [Iter 7570] Loss: 1.1344 (freq: 0.4042, raw: 0.7295, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 574/1024 (56.1%) Top5:[424,596,932,17,827,745,918,375,125,664,930,644,50,453,663]


π”¬ Encoder Diversity (iter 7570):
  Avg similarity: 0.0804 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 12/100] [Batch 221/669 (33.0%)] [Iter 7580] Loss: 1.1329 (freq: 0.3638, raw: 0.7684, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 545/1024 (53.2%) Top5:[663,614,875,204,667,419,424,17,596,269,658,111,644,607,275]


π”¬ Encoder Diversity (iter 7580):
  Avg similarity: 0.0703 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 12/100] [Batch 231/669 (34.5%)] [Iter 7590] Loss: 1.2068 (freq: 0.4497, raw: 0.7563, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 516/1024 (50.4%) Top5:[166,204,691,663,269,658,750,30,644,858,419,52,875,596,111]


π”¬ Encoder Diversity (iter 7590):
  Avg similarity: 0.0962 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9408 (0.0=collapsed)
[Epoch 12/100] [Batch 241/669 (36.0%)] [Iter 7600] Loss: 1.0841 (freq: 0.3523, raw: 0.7312, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 517/1024 (50.5%) Top5:[166,658,1014,978,137,750,986,52,108,539,745,469,963,419,969]


π”¬ Encoder Diversity (iter 7600):
  Avg similarity: 0.1046 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9405 (0.0=collapsed)
[Epoch 12/100] [Batch 251/669 (37.5%)] [Iter 7610] Loss: 1.1485 (freq: 0.4348, raw: 0.7130, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 567/1024 (55.4%) Top5:[782,658,745,569,978,1017,743,992,760,218,166,716,691,539,969]


π”¬ Encoder Diversity (iter 7610):
  Avg similarity: 0.0861 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9453 (0.0=collapsed)
[Epoch 12/100] [Batch 261/669 (39.0%)] [Iter 7620] Loss: 1.1401 (freq: 0.3778, raw: 0.7615, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 593/1024 (57.9%) Top5:[166,332,1017,992,30,596,782,858,986,969,405,931,138,418,275]


π”¬ Encoder Diversity (iter 7620):
  Avg similarity: 0.0954 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9518 (0.0=collapsed)
[Epoch 12/100] [Batch 271/669 (40.5%)] [Iter 7630] Loss: 0.9390 (freq: 0.2780, raw: 0.6603, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 567/1024 (55.4%) Top5:[166,858,419,418,614,204,1017,658,108,269,52,227,469,539,275]


π”¬ Encoder Diversity (iter 7630):
  Avg similarity: 0.0986 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9367 (0.0=collapsed)
[Epoch 12/100] [Batch 281/669 (42.0%)] [Iter 7640] Loss: 1.4120 (freq: 0.5631, raw: 0.8481, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 633/1024 (61.8%) Top5:[858,424,62,166,596,644,275,969,17,604,745,931,875,1004,269]


π”¬ Encoder Diversity (iter 7640):
  Avg similarity: 0.0899 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 12/100] [Batch 291/669 (43.5%)] [Iter 7650] Loss: 1.1328 (freq: 0.4095, raw: 0.7226, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 581/1024 (56.7%) Top5:[166,858,204,137,664,375,269,986,52,932,418,658,614,419,275]


π”¬ Encoder Diversity (iter 7650):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)
[Epoch 12/100] [Batch 301/669 (45.0%)] [Iter 7660] Loss: 1.0778 (freq: 0.3691, raw: 0.7080, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 587/1024 (57.3%) Top5:[664,596,137,441,840,275,644,62,604,50,858,52,969,932,918]


π”¬ Encoder Diversity (iter 7660):
  Avg similarity: 0.0674 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 12/100] [Batch 311/669 (46.5%)] [Iter 7670] Loss: 1.1262 (freq: 0.4088, raw: 0.7167, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 482/1024 (47.1%) Top5:[963,858,664,269,125,1004,108,50,418,52,424,827,657,419,328]


π”¬ Encoder Diversity (iter 7670):
  Avg similarity: 0.1197 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9293 (0.0=collapsed)
[Epoch 12/100] [Batch 321/669 (48.0%)] [Iter 7680] Loss: 1.3669 (freq: 0.4996, raw: 0.8665, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 483/1024 (47.2%) Top5:[166,858,969,138,418,978,986,658,782,332,716,30,108,743,469]


π”¬ Encoder Diversity (iter 7680):
  Avg similarity: 0.0938 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9486 (0.0=collapsed)
[Epoch 12/100] [Batch 331/669 (49.5%)] [Iter 7690] Loss: 1.0489 (freq: 0.3486, raw: 0.6996, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 584/1024 (57.0%) Top5:[166,875,840,658,367,858,664,399,469,969,405,549,691,1017,963]


π”¬ Encoder Diversity (iter 7690):
  Avg similarity: 0.0903 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9384 (0.0=collapsed)
[Epoch 12/100] [Batch 341/669 (51.0%)] [Iter 7700] Loss: 1.3904 (freq: 0.5388, raw: 0.8509, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 508/1024 (49.6%) Top5:[858,549,418,1017,1004,760,969,875,867,166,691,62,930,469,369]


π”¬ Encoder Diversity (iter 7700):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 12/100] [Batch 351/669 (52.5%)] [Iter 7710] Loss: 1.1200 (freq: 0.4026, raw: 0.7167, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 542/1024 (52.9%) Top5:[663,840,875,437,596,275,17,930,604,769,722,969,500,1014,166]


π”¬ Encoder Diversity (iter 7710):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9414 (0.0=collapsed)
[Epoch 12/100] [Batch 361/669 (54.0%)] [Iter 7720] Loss: 1.5265 (freq: 0.5961, raw: 0.9297, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 566/1024 (55.3%) Top5:[269,166,969,419,204,52,782,716,332,137,1014,986,808,691,418]


π”¬ Encoder Diversity (iter 7720):
  Avg similarity: 0.1049 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9483 (0.0=collapsed)
[Epoch 12/100] [Batch 371/669 (55.5%)] [Iter 7730] Loss: 1.0895 (freq: 0.3738, raw: 0.7149, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 539/1024 (52.6%) Top5:[166,418,986,782,52,419,227,658,978,269,615,808,469,137,204]


π”¬ Encoder Diversity (iter 7730):
  Avg similarity: 0.1052 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9269 (0.0=collapsed)
[Epoch 12/100] [Batch 381/669 (57.0%)] [Iter 7740] Loss: 1.0412 (freq: 0.3811, raw: 0.6594, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 557/1024 (54.4%) Top5:[166,227,858,614,52,269,419,658,395,657,549,774,1017,204,418]


π”¬ Encoder Diversity (iter 7740):
  Avg similarity: 0.0621 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 12/100] [Batch 391/669 (58.4%)] [Iter 7750] Loss: 0.9262 (freq: 0.3279, raw: 0.5977, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 609/1024 (59.5%) Top5:[858,503,932,827,745,166,918,1004,419,418,405,452,195,395,802]


π”¬ Encoder Diversity (iter 7750):
  Avg similarity: 0.0875 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9408 (0.0=collapsed)
[Epoch 12/100] [Batch 401/669 (59.9%)] [Iter 7760] Loss: 1.2649 (freq: 0.4684, raw: 0.7958, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 548/1024 (53.5%) Top5:[691,858,503,1004,664,658,745,150,269,615,628,418,1017,275,549]


π”¬ Encoder Diversity (iter 7760):
  Avg similarity: 0.0881 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 12/100] [Batch 411/669 (61.4%)] [Iter 7770] Loss: 1.0591 (freq: 0.3952, raw: 0.6632, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 608/1024 (59.4%) Top5:[875,1017,166,275,596,931,930,665,17,840,269,691,424,604,469]


π”¬ Encoder Diversity (iter 7770):
  Avg similarity: 0.1051 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9348 (0.0=collapsed)
[Epoch 12/100] [Batch 421/669 (62.9%)] [Iter 7780] Loss: 0.9216 (freq: 0.3265, raw: 0.5945, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 570/1024 (55.7%) Top5:[166,1017,658,418,269,858,969,549,367,108,227,419,963,452,782]


π”¬ Encoder Diversity (iter 7780):
  Avg similarity: 0.0638 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 12/100] [Batch 431/669 (64.4%)] [Iter 7790] Loss: 1.2313 (freq: 0.4676, raw: 0.7630, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 596/1024 (58.2%) Top5:[858,750,332,963,418,367,1017,691,745,269,658,166,969,137,452]


π”¬ Encoder Diversity (iter 7790):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 12/100] [Batch 441/669 (65.9%)] [Iter 7800] Loss: 1.0787 (freq: 0.3698, raw: 0.7082, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 574/1024 (56.1%) Top5:[745,1004,827,742,503,332,596,525,875,918,597,782,275,633,125]


π”¬ Encoder Diversity (iter 7800):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9537 (0.0=collapsed)
[Epoch 12/100] [Batch 451/669 (67.4%)] [Iter 7810] Loss: 0.9545 (freq: 0.3174, raw: 0.6365, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 600/1024 (58.6%) Top5:[858,745,166,596,644,50,875,722,275,827,1004,280,257,658,269]


π”¬ Encoder Diversity (iter 7810):
  Avg similarity: 0.0690 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9464 (0.0=collapsed)
[Epoch 12/100] [Batch 461/669 (68.9%)] [Iter 7820] Loss: 1.0731 (freq: 0.3791, raw: 0.6933, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[227,269,204,969,633,44,166,986,658,604,419,153,1017,742,7]


π”¬ Encoder Diversity (iter 7820):
  Avg similarity: 0.0929 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9424 (0.0=collapsed)
[Epoch 12/100] [Batch 471/669 (70.4%)] [Iter 7830] Loss: 0.9860 (freq: 0.3419, raw: 0.6434, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 539/1024 (52.6%) Top5:[166,269,418,847,204,986,7,419,227,664,137,369,745,503,52]


π”¬ Encoder Diversity (iter 7830):
  Avg similarity: 0.1011 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9454 (0.0=collapsed)
[Epoch 12/100] [Batch 481/669 (71.9%)] [Iter 7840] Loss: 1.3261 (freq: 0.4966, raw: 0.8287, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 543/1024 (53.0%) Top5:[166,969,658,1017,418,858,332,269,657,847,516,691,743,827,419]


π”¬ Encoder Diversity (iter 7840):
  Avg similarity: 0.0760 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9501 (0.0=collapsed)
[Epoch 12/100] [Batch 491/669 (73.4%)] [Iter 7850] Loss: 1.1083 (freq: 0.4113, raw: 0.6964, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 513/1024 (50.1%) Top5:[166,858,657,269,418,658,1017,549,419,691,204,332,108,150,1014]


π”¬ Encoder Diversity (iter 7850):
  Avg similarity: 0.0761 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 12/100] [Batch 501/669 (74.9%)] [Iter 7860] Loss: 0.6787 (freq: 0.2111, raw: 0.4671, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 495/1024 (48.3%) Top5:[275,596,48,782,840,309,17,875,749,418,138,722,930,148,257]


π”¬ Encoder Diversity (iter 7860):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 12/100] [Batch 511/669 (76.4%)] [Iter 7870] Loss: 0.9741 (freq: 0.3302, raw: 0.6433, quant: 0.0006, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 594/1024 (58.0%) Top5:[658,1014,269,419,986,978,280,52,166,0,452,831,7,516,615]


π”¬ Encoder Diversity (iter 7870):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9570 (0.0=collapsed)
[Epoch 12/100] [Batch 521/669 (77.9%)] [Iter 7880] Loss: 1.5028 (freq: 0.5761, raw: 0.9259, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 566/1024 (55.3%) Top5:[969,166,658,986,419,269,1014,831,418,7,0,847,950,782,137]


π”¬ Encoder Diversity (iter 7880):
  Avg similarity: 0.0451 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 12/100] [Batch 531/669 (79.4%)] [Iter 7890] Loss: 0.9839 (freq: 0.3511, raw: 0.6321, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 503/1024 (49.1%) Top5:[831,269,782,658,227,332,453,853,266,204,503,858,750,722,596]


π”¬ Encoder Diversity (iter 7890):
  Avg similarity: 0.1213 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9308 (0.0=collapsed)
[Epoch 12/100] [Batch 541/669 (80.9%)] [Iter 7900] Loss: 1.1075 (freq: 0.4014, raw: 0.7054, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 563/1024 (55.0%) Top5:[332,269,782,722,831,969,774,657,1017,931,658,257,204,453,614]


π”¬ Encoder Diversity (iter 7900):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9527 (0.0=collapsed)
[Epoch 12/100] [Batch 551/669 (82.4%)] [Iter 7910] Loss: 1.2592 (freq: 0.4757, raw: 0.7828, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[658,418,166,858,831,269,419,204,1017,657,227,782,722,614,549]


π”¬ Encoder Diversity (iter 7910):
  Avg similarity: 0.0645 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 12/100] [Batch 561/669 (83.9%)] [Iter 7920] Loss: 1.2248 (freq: 0.4319, raw: 0.7923, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 489/1024 (47.8%) Top5:[166,218,1017,549,627,658,44,204,774,419,691,113,782,332,1014]


π”¬ Encoder Diversity (iter 7920):
  Avg similarity: 0.0558 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 12/100] [Batch 571/669 (85.4%)] [Iter 7930] Loss: 1.0816 (freq: 0.3543, raw: 0.7267, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 618/1024 (60.4%) Top5:[745,918,525,399,802,266,827,950,275,664,257,226,596,722,975]


π”¬ Encoder Diversity (iter 7930):
  Avg similarity: 0.0763 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 12/100] [Batch 581/669 (86.8%)] [Iter 7940] Loss: 1.0100 (freq: 0.3404, raw: 0.6689, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 567/1024 (55.4%) Top5:[266,419,918,831,418,1017,166,658,745,853,257,0,927,275,227]


π”¬ Encoder Diversity (iter 7940):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 12/100] [Batch 591/669 (88.3%)] [Iter 7950] Loss: 1.1435 (freq: 0.3775, raw: 0.7652, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 606/1024 (59.2%) Top5:[831,615,604,419,17,503,266,0,931,257,875,418,853,137,782]


π”¬ Encoder Diversity (iter 7950):
  Avg similarity: 0.0818 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 12/100] [Batch 601/669 (89.8%)] [Iter 7960] Loss: 1.1913 (freq: 0.4227, raw: 0.7680, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 552/1024 (53.9%) Top5:[831,227,166,658,867,269,137,419,418,931,604,840,48,614,0]


π”¬ Encoder Diversity (iter 7960):
  Avg similarity: 0.0696 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 12/100] [Batch 611/669 (91.3%)] [Iter 7970] Loss: 1.3126 (freq: 0.4363, raw: 0.8755, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 614/1024 (60.0%) Top5:[166,658,269,831,614,452,419,227,418,0,204,992,137,358,52]


π”¬ Encoder Diversity (iter 7970):
  Avg similarity: 0.0796 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 12/100] [Batch 621/669 (92.8%)] [Iter 7980] Loss: 1.0725 (freq: 0.3469, raw: 0.7249, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[266,658,525,549,1003,399,742,332,503,831,950,918,722,678,596]


π”¬ Encoder Diversity (iter 7980):
  Avg similarity: 0.0852 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 12/100] [Batch 631/669 (94.3%)] [Iter 7990] Loss: 1.1170 (freq: 0.4113, raw: 0.7050, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 636/1024 (62.1%) Top5:[204,266,722,332,1004,399,166,226,275,549,525,657,927,969,742]


π”¬ Encoder Diversity (iter 7990):
  Avg similarity: 0.1027 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9348 (0.0=collapsed)
[Epoch 12/100] [Batch 641/669 (95.8%)] [Iter 8000] Loss: 0.9580 (freq: 0.3147, raw: 0.6427, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 616/1024 (60.2%) Top5:[269,418,782,549,419,138,204,658,0,52,885,831,596,202,657]


π”¬ Encoder Diversity (iter 8000):
  Avg similarity: 0.0982 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9384 (0.0=collapsed)
[Epoch 12/100] [Batch 651/669 (97.3%)] [Iter 8010] Loss: 1.2778 (freq: 0.4395, raw: 0.8375, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 604/1024 (59.0%) Top5:[895,658,232,170,1004,377,316,950,833,722,399,644,596,931,154]


π”¬ Encoder Diversity (iter 8010):
  Avg similarity: 0.0887 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9375 (0.0=collapsed)
[Epoch 12/100] [Batch 661/669 (98.8%)] [Iter 8020] Loss: 1.1911 (freq: 0.3943, raw: 0.7960, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 651/1024 (63.6%) Top5:[658,0,418,831,1017,166,885,782,931,562,867,419,644,452,52]


π”¬ Encoder Diversity (iter 8020):
  Avg similarity: 0.0728 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9495 (0.0=collapsed)

================================================================================
[Epoch 12] Validation Results:
  Total Loss: 0.5996
  Freq Loss:  0.1808
  Raw Loss:   0.4181
  Quant Loss: 0.0007
  π“ Codebook Usage: 223/1024 (21.8%)
  π“ Codebook Entropy: 4.1776 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 34543 (26.5%)
  Top 10 most used codes:
    1. Code 895: 3948 times (3.03%)
    2. Code 154: 3895 times (2.99%)
    3. Code 175: 3693 times (2.84%)
    4. Code 833: 3523 times (2.71%)
    5. Code 931: 3482 times (2.67%)
    6. Code 50: 3324 times (2.55%)
    7. Code 62: 3298 times (2.53%)
    8. Code 266: 3215 times (2.47%)
    9. Code 722: 3100 times (2.38%)
    10. Code 213: 3065 times (2.35%)
  Bottom 5 least used codes (among used):
    1. Code 98: 1 times (0.00%)
    2. Code 45: 1 times (0.00%)
    3. Code 425: 1 times (0.00%)
    4. Code 778: 1 times (0.00%)
    5. Code 668: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 13/100] [Batch 2/669 (0.3%)] [Iter 8030] Loss: 1.3944 (freq: 0.6104, raw: 0.7829, quant: 0.0011, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[166,831,269,266,399,658,418,742,615,419,969,525,931,808,257]


π”¬ Encoder Diversity (iter 8030):
  Avg similarity: 0.0551 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 13/100] [Batch 12/669 (1.8%)] [Iter 8040] Loss: 1.3827 (freq: 0.5238, raw: 0.8582, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 969/1024 (94.6%) Top5:[170,154,213,833,48,277,1005,91,644,377,853,895,275,931,17]


π”¬ Encoder Diversity (iter 8040):
  Avg similarity: 0.0877 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9478 (0.0=collapsed)
[Epoch 13/100] [Batch 22/669 (3.3%)] [Iter 8050] Loss: 1.4842 (freq: 0.5691, raw: 0.9144, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 648/1024 (63.3%) Top5:[858,859,38,580,525,722,577,581,117,92,789,540,936,399,602]


π”¬ Encoder Diversity (iter 8050):
  Avg similarity: 0.1064 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9209 (0.0=collapsed)
[Epoch 13/100] [Batch 32/669 (4.8%)] [Iter 8060] Loss: 1.1322 (freq: 0.4235, raw: 0.7080, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 595/1024 (58.1%) Top5:[580,859,993,651,92,912,6,722,536,32,931,91,61,19,110]


π”¬ Encoder Diversity (iter 8060):
  Avg similarity: 0.0816 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 13/100] [Batch 42/669 (6.3%)] [Iter 8070] Loss: 1.1330 (freq: 0.4333, raw: 0.6989, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 598/1024 (58.4%) Top5:[91,580,1004,931,561,722,858,70,936,11,275,845,969,266,170]


π”¬ Encoder Diversity (iter 8070):
  Avg similarity: 0.0924 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9452 (0.0=collapsed)
[Epoch 13/100] [Batch 52/669 (7.8%)] [Iter 8080] Loss: 1.3839 (freq: 0.5201, raw: 0.8631, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 565/1024 (55.2%) Top5:[859,580,32,274,891,745,219,975,936,885,561,286,117,61,38]


π”¬ Encoder Diversity (iter 8080):
  Avg similarity: 0.1226 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9336 (0.0=collapsed)
[Epoch 13/100] [Batch 62/669 (9.3%)] [Iter 8090] Loss: 1.1436 (freq: 0.4340, raw: 0.7089, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 604/1024 (59.0%) Top5:[110,731,969,859,767,91,274,333,580,495,912,257,266,11,508]


π”¬ Encoder Diversity (iter 8090):
  Avg similarity: 0.0665 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 13/100] [Batch 72/669 (10.8%)] [Iter 8100] Loss: 1.1029 (freq: 0.3941, raw: 0.7081, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 595/1024 (58.1%) Top5:[858,508,859,533,962,580,737,602,390,731,767,11,38,274,696]


π”¬ Encoder Diversity (iter 8100):
  Avg similarity: 0.1194 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 13/100] [Batch 82/669 (12.3%)] [Iter 8110] Loss: 1.2248 (freq: 0.4184, raw: 0.8057, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 605/1024 (59.1%) Top5:[962,581,859,767,737,508,912,580,11,390,885,845,919,731,38]


π”¬ Encoder Diversity (iter 8110):
  Avg similarity: 0.0871 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9432 (0.0=collapsed)
[Epoch 13/100] [Batch 92/669 (13.8%)] [Iter 8120] Loss: 0.6207 (freq: 0.1920, raw: 0.4280, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 615/1024 (60.1%) Top5:[651,580,111,678,48,987,525,495,508,286,885,765,919,950,561]


π”¬ Encoder Diversity (iter 8120):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9507 (0.0=collapsed)
[Epoch 13/100] [Batch 102/669 (15.2%)] [Iter 8130] Loss: 0.9435 (freq: 0.3309, raw: 0.6118, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 589/1024 (57.5%) Top5:[737,508,580,32,859,987,885,11,38,533,91,94,936,919,274]


π”¬ Encoder Diversity (iter 8130):
  Avg similarity: 0.0670 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 13/100] [Batch 112/669 (16.7%)] [Iter 8140] Loss: 1.1873 (freq: 0.4228, raw: 0.7637, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 608/1024 (59.4%) Top5:[91,789,859,561,274,377,211,737,580,1004,150,885,286,275,956]


π”¬ Encoder Diversity (iter 8140):
  Avg similarity: 0.0961 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9309 (0.0=collapsed)
[Epoch 13/100] [Batch 122/669 (18.2%)] [Iter 8150] Loss: 1.1084 (freq: 0.4056, raw: 0.7021, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 606/1024 (59.2%) Top5:[859,580,737,956,32,536,274,936,731,38,561,789,311,1018,61]


π”¬ Encoder Diversity (iter 8150):
  Avg similarity: 0.0912 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9411 (0.0=collapsed)
[Epoch 13/100] [Batch 132/669 (19.7%)] [Iter 8160] Loss: 0.9784 (freq: 0.3489, raw: 0.6287, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 545/1024 (53.2%) Top5:[731,581,580,969,889,548,956,19,258,993,264,150,859,229,274]


π”¬ Encoder Diversity (iter 8160):
  Avg similarity: 0.0688 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9532 (0.0=collapsed)
[Epoch 13/100] [Batch 142/669 (21.2%)] [Iter 8170] Loss: 1.1424 (freq: 0.3974, raw: 0.7444, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 547/1024 (53.4%) Top5:[155,859,956,536,274,580,91,858,737,860,481,211,533,889,275]


π”¬ Encoder Diversity (iter 8170):
  Avg similarity: 0.0662 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 13/100] [Batch 152/669 (22.7%)] [Iter 8180] Loss: 1.1089 (freq: 0.3855, raw: 0.7227, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 530/1024 (51.8%) Top5:[859,956,580,503,91,561,32,150,936,525,274,275,975,858,286]


π”¬ Encoder Diversity (iter 8180):
  Avg similarity: 0.1018 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9295 (0.0=collapsed)
[Epoch 13/100] [Batch 162/669 (24.2%)] [Iter 8190] Loss: 1.0285 (freq: 0.3799, raw: 0.6479, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 602/1024 (58.8%) Top5:[859,956,32,580,150,110,19,858,11,274,936,155,651,536,56]


π”¬ Encoder Diversity (iter 8190):
  Avg similarity: 0.0918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 13/100] [Batch 172/669 (25.7%)] [Iter 8200] Loss: 1.1987 (freq: 0.4288, raw: 0.7692, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 593/1024 (57.9%) Top5:[859,481,258,858,354,32,580,956,274,11,536,789,91,602,617]


π”¬ Encoder Diversity (iter 8200):
  Avg similarity: 0.0806 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9419 (0.0=collapsed)
[Epoch 13/100] [Batch 182/669 (27.2%)] [Iter 8210] Loss: 1.3835 (freq: 0.5260, raw: 0.8567, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 587/1024 (57.3%) Top5:[859,858,580,11,32,602,481,19,617,354,912,258,956,219,274]


π”¬ Encoder Diversity (iter 8210):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9517 (0.0=collapsed)
[Epoch 13/100] [Batch 192/669 (28.7%)] [Iter 8220] Loss: 0.9521 (freq: 0.3001, raw: 0.6513, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 645/1024 (63.0%) Top5:[859,1004,602,858,275,956,11,91,32,226,495,580,731,257,121]


π”¬ Encoder Diversity (iter 8220):
  Avg similarity: 0.0889 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9483 (0.0=collapsed)
[Epoch 13/100] [Batch 202/669 (30.2%)] [Iter 8230] Loss: 1.3608 (freq: 0.5099, raw: 0.8501, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 630/1024 (61.5%) Top5:[859,580,211,1004,91,525,885,577,275,602,962,858,936,987,166]


π”¬ Encoder Diversity (iter 8230):
  Avg similarity: 0.0748 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 13/100] [Batch 212/669 (31.7%)] [Iter 8240] Loss: 1.2220 (freq: 0.4407, raw: 0.7806, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 652/1024 (63.7%) Top5:[6,745,561,372,859,956,110,150,525,1004,969,32,987,580,19]


π”¬ Encoder Diversity (iter 8240):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9554 (0.0=collapsed)
[Epoch 13/100] [Batch 222/669 (33.2%)] [Iter 8250] Loss: 1.3867 (freq: 0.5212, raw: 0.8648, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 599/1024 (58.5%) Top5:[859,580,32,969,602,891,19,737,6,956,264,912,150,274,651]


π”¬ Encoder Diversity (iter 8250):
  Avg similarity: 0.1005 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9416 (0.0=collapsed)
[Epoch 13/100] [Batch 232/669 (34.7%)] [Iter 8260] Loss: 1.1492 (freq: 0.3768, raw: 0.7716, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 600/1024 (58.6%) Top5:[956,859,580,858,275,602,211,912,473,390,484,91,135,92,722]


π”¬ Encoder Diversity (iter 8260):
  Avg similarity: 0.0678 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9476 (0.0=collapsed)
[Epoch 13/100] [Batch 242/669 (36.2%)] [Iter 8270] Loss: 1.2954 (freq: 0.4952, raw: 0.7993, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 544/1024 (53.1%) Top5:[859,481,956,155,473,602,651,32,580,858,912,91,737,372,135]


π”¬ Encoder Diversity (iter 8270):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 13/100] [Batch 252/669 (37.7%)] [Iter 8280] Loss: 0.9780 (freq: 0.3232, raw: 0.6541, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 612/1024 (59.8%) Top5:[956,859,32,91,950,536,399,525,333,435,745,166,580,651,121]


π”¬ Encoder Diversity (iter 8280):
  Avg similarity: 0.0572 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 13/100] [Batch 262/669 (39.2%)] [Iter 8290] Loss: 1.2868 (freq: 0.4378, raw: 0.8483, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 602/1024 (58.8%) Top5:[956,32,859,580,651,91,737,473,969,150,950,274,481,110,678]


π”¬ Encoder Diversity (iter 8290):
  Avg similarity: 0.0753 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9549 (0.0=collapsed)
[Epoch 13/100] [Batch 272/669 (40.7%)] [Iter 8300] Loss: 0.9131 (freq: 0.3283, raw: 0.5841, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 569/1024 (55.6%) Top5:[859,484,154,651,580,722,796,895,226,91,1004,11,737,377,561]


π”¬ Encoder Diversity (iter 8300):
  Avg similarity: 0.0717 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9423 (0.0=collapsed)
[Epoch 13/100] [Batch 282/669 (42.2%)] [Iter 8310] Loss: 0.9003 (freq: 0.3115, raw: 0.5882, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[859,580,651,473,912,956,229,969,860,19,508,274,211,135,11]


π”¬ Encoder Diversity (iter 8310):
  Avg similarity: 0.0715 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 13/100] [Batch 292/669 (43.6%)] [Iter 8320] Loss: 1.3521 (freq: 0.4940, raw: 0.8573, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 633/1024 (61.8%) Top5:[859,956,261,651,354,580,912,731,602,211,581,229,885,860,91]


π”¬ Encoder Diversity (iter 8320):
  Avg similarity: 0.0581 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9554 (0.0=collapsed)
[Epoch 13/100] [Batch 302/669 (45.1%)] [Iter 8330] Loss: 1.1202 (freq: 0.4159, raw: 0.7036, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 597/1024 (58.3%) Top5:[651,859,481,885,508,354,767,480,889,602,229,731,956,912,135]


π”¬ Encoder Diversity (iter 8330):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 13/100] [Batch 312/669 (46.6%)] [Iter 8340] Loss: 1.2362 (freq: 0.4487, raw: 0.7868, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 673/1024 (65.7%) Top5:[561,399,745,91,286,257,275,70,731,678,950,722,796,161,333]


π”¬ Encoder Diversity (iter 8340):
  Avg similarity: 0.1060 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9398 (0.0=collapsed)
[Epoch 13/100] [Batch 322/669 (48.1%)] [Iter 8350] Loss: 1.5017 (freq: 0.5812, raw: 0.9198, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 593/1024 (57.9%) Top5:[859,481,536,580,737,276,602,789,879,92,234,912,110,956,242]


π”¬ Encoder Diversity (iter 8350):
  Avg similarity: 0.0873 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9345 (0.0=collapsed)
[Epoch 13/100] [Batch 332/669 (49.6%)] [Iter 8360] Loss: 1.2270 (freq: 0.4418, raw: 0.7844, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 553/1024 (54.0%) Top5:[859,91,326,38,580,276,602,536,234,319,274,155,731,969,110]


π”¬ Encoder Diversity (iter 8360):
  Avg similarity: 0.0637 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 13/100] [Batch 342/669 (51.1%)] [Iter 8370] Loss: 1.1173 (freq: 0.3898, raw: 0.7269, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 608/1024 (59.4%) Top5:[859,481,580,895,38,19,150,651,155,508,32,261,731,919,956]


π”¬ Encoder Diversity (iter 8370):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 13/100] [Batch 352/669 (52.6%)] [Iter 8380] Loss: 0.9644 (freq: 0.3483, raw: 0.6154, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 551/1024 (53.8%) Top5:[796,91,481,1004,651,319,956,581,261,26,154,211,760,275,166]


π”¬ Encoder Diversity (iter 8380):
  Avg similarity: 0.0941 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9372 (0.0=collapsed)
[Epoch 13/100] [Batch 362/669 (54.1%)] [Iter 8390] Loss: 1.0431 (freq: 0.3422, raw: 0.7000, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 629/1024 (61.4%) Top5:[481,859,651,956,581,211,796,858,580,912,950,264,275,602,879]


π”¬ Encoder Diversity (iter 8390):
  Avg similarity: 0.0635 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9490 (0.0=collapsed)
[Epoch 13/100] [Batch 372/669 (55.6%)] [Iter 8400] Loss: 1.0211 (freq: 0.3468, raw: 0.6735, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 629/1024 (61.4%) Top5:[481,956,859,275,580,70,1004,561,261,38,319,19,602,722,536]


π”¬ Encoder Diversity (iter 8400):
  Avg similarity: 0.0727 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9457 (0.0=collapsed)
[Epoch 13/100] [Batch 382/669 (57.1%)] [Iter 8410] Loss: 1.0846 (freq: 0.3805, raw: 0.7033, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 644/1024 (62.9%) Top5:[859,745,956,257,796,481,91,722,536,651,950,399,155,525,286]


π”¬ Encoder Diversity (iter 8410):
  Avg similarity: 0.0874 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9446 (0.0=collapsed)
[Epoch 13/100] [Batch 392/669 (58.6%)] [Iter 8420] Loss: 1.3003 (freq: 0.4502, raw: 0.8494, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 620/1024 (60.5%) Top5:[956,32,859,536,481,211,789,354,261,431,508,155,737,580,473]


π”¬ Encoder Diversity (iter 8420):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 13/100] [Batch 402/669 (60.1%)] [Iter 8430] Loss: 1.1295 (freq: 0.3449, raw: 0.7838, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 652/1024 (63.7%) Top5:[859,956,936,481,38,860,536,91,602,211,155,274,731,390,166]


π”¬ Encoder Diversity (iter 8430):
  Avg similarity: 0.0617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 13/100] [Batch 412/669 (61.6%)] [Iter 8440] Loss: 1.0708 (freq: 0.3624, raw: 0.7077, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 622/1024 (60.7%) Top5:[859,796,956,473,91,481,319,950,166,16,581,860,580,561,377]


π”¬ Encoder Diversity (iter 8440):
  Avg similarity: 0.0613 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9524 (0.0=collapsed)
[Epoch 13/100] [Batch 422/669 (63.1%)] [Iter 8450] Loss: 0.9672 (freq: 0.3160, raw: 0.6505, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 578/1024 (56.4%) Top5:[481,91,651,859,580,32,860,796,602,936,737,912,261,956,561]


π”¬ Encoder Diversity (iter 8450):
  Avg similarity: 0.0712 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 13/100] [Batch 432/669 (64.6%)] [Iter 8460] Loss: 1.1226 (freq: 0.4190, raw: 0.7028, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 638/1024 (62.3%) Top5:[651,166,91,796,508,503,742,372,969,333,525,561,481,399,745]


π”¬ Encoder Diversity (iter 8460):
  Avg similarity: 0.0872 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 13/100] [Batch 442/669 (66.1%)] [Iter 8470] Loss: 1.3249 (freq: 0.4349, raw: 0.8893, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 636/1024 (62.1%) Top5:[956,481,473,651,390,261,580,91,936,891,536,860,602,525,742]


π”¬ Encoder Diversity (iter 8470):
  Avg similarity: 0.0673 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9526 (0.0=collapsed)
[Epoch 13/100] [Batch 452/669 (67.6%)] [Iter 8480] Loss: 0.9741 (freq: 0.3425, raw: 0.6308, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 616/1024 (60.2%) Top5:[473,956,651,602,91,969,936,372,56,796,861,26,481,580,891]


π”¬ Encoder Diversity (iter 8480):
  Avg similarity: 0.0637 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)
[Epoch 13/100] [Batch 462/669 (69.1%)] [Iter 8490] Loss: 0.9705 (freq: 0.3611, raw: 0.6087, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[859,481,956,372,211,91,473,731,1004,32,166,796,580,602,495]


π”¬ Encoder Diversity (iter 8490):
  Avg similarity: 0.0481 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 13/100] [Batch 472/669 (70.6%)] [Iter 8500] Loss: 1.1491 (freq: 0.4119, raw: 0.7363, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[859,473,580,651,32,962,858,81,796,19,536,261,70,234,581]


π”¬ Encoder Diversity (iter 8500):
  Avg similarity: 0.1091 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9335 (0.0=collapsed)
[Epoch 13/100] [Batch 482/669 (72.0%)] [Iter 8510] Loss: 1.2104 (freq: 0.3958, raw: 0.8138, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 658/1024 (64.3%) Top5:[261,481,211,859,473,956,32,722,581,275,91,912,525,81,693]


π”¬ Encoder Diversity (iter 8510):
  Avg similarity: 0.0566 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 13/100] [Batch 492/669 (73.5%)] [Iter 8520] Loss: 0.9387 (freq: 0.2984, raw: 0.6395, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 635/1024 (62.0%) Top5:[275,796,333,261,91,401,1004,473,875,683,70,722,993,503,211]


π”¬ Encoder Diversity (iter 8520):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 13/100] [Batch 502/669 (75.0%)] [Iter 8530] Loss: 1.0798 (freq: 0.3794, raw: 0.6997, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 616/1024 (60.2%) Top5:[651,32,859,936,693,481,956,234,211,879,473,722,219,91,81]


π”¬ Encoder Diversity (iter 8530):
  Avg similarity: 0.0617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 13/100] [Batch 512/669 (76.5%)] [Iter 8540] Loss: 1.0979 (freq: 0.3594, raw: 0.7378, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 661/1024 (64.6%) Top5:[859,481,651,11,360,81,274,693,936,150,91,155,956,796,508]


π”¬ Encoder Diversity (iter 8540):
  Avg similarity: 0.0792 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 13/100] [Batch 522/669 (78.0%)] [Iter 8550] Loss: 1.1724 (freq: 0.4048, raw: 0.7668, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 674/1024 (65.8%) Top5:[859,481,91,602,81,275,257,11,693,278,651,956,525,936,226]


π”¬ Encoder Diversity (iter 8550):
  Avg similarity: 0.0943 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9508 (0.0=collapsed)
[Epoch 13/100] [Batch 532/669 (79.5%)] [Iter 8560] Loss: 1.1103 (freq: 0.3903, raw: 0.7193, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 599/1024 (58.5%) Top5:[1022,481,859,693,651,81,602,257,536,326,91,275,956,473,936]


π”¬ Encoder Diversity (iter 8560):
  Avg similarity: 0.0908 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9423 (0.0=collapsed)
[Epoch 13/100] [Batch 542/669 (81.0%)] [Iter 8570] Loss: 1.1826 (freq: 0.4015, raw: 0.7803, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 695/1024 (67.9%) Top5:[859,481,956,602,536,651,473,693,525,275,745,372,796,819,32]


π”¬ Encoder Diversity (iter 8570):
  Avg similarity: 0.0923 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 13/100] [Batch 552/669 (82.5%)] [Iter 8580] Loss: 1.3849 (freq: 0.5285, raw: 0.8556, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 691/1024 (67.5%) Top5:[936,651,473,765,481,731,360,962,693,956,683,510,858,859,274]


π”¬ Encoder Diversity (iter 8580):
  Avg similarity: 0.0512 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 13/100] [Batch 562/669 (84.0%)] [Iter 8590] Loss: 1.2063 (freq: 0.4098, raw: 0.7958, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 639/1024 (62.4%) Top5:[859,274,91,536,473,211,936,32,765,956,92,55,912,481,11]


π”¬ Encoder Diversity (iter 8590):
  Avg similarity: 0.0626 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 13/100] [Batch 572/669 (85.5%)] [Iter 8600] Loss: 1.2709 (freq: 0.4853, raw: 0.7849, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 612/1024 (59.8%) Top5:[431,651,912,275,91,875,969,860,261,150,399,745,956,561,481]


π”¬ Encoder Diversity (iter 8600):
  Avg similarity: 0.1212 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9350 (0.0=collapsed)
[Epoch 13/100] [Batch 582/669 (87.0%)] [Iter 8610] Loss: 1.1147 (freq: 0.3912, raw: 0.7227, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 667/1024 (65.1%) Top5:[859,81,536,860,481,360,211,651,956,912,737,693,931,879,150]


π”¬ Encoder Diversity (iter 8610):
  Avg similarity: 0.0663 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9530 (0.0=collapsed)
[Epoch 13/100] [Batch 592/669 (88.5%)] [Iter 8620] Loss: 1.0797 (freq: 0.3743, raw: 0.7047, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 684/1024 (66.8%) Top5:[481,936,602,360,956,651,91,859,150,508,860,580,211,473,533]


π”¬ Encoder Diversity (iter 8620):
  Avg similarity: 0.0624 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 13/100] [Batch 602/669 (90.0%)] [Iter 8630] Loss: 1.2611 (freq: 0.4431, raw: 0.8171, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 628/1024 (61.3%) Top5:[859,956,536,473,860,276,150,731,602,481,161,580,796,651,503]


π”¬ Encoder Diversity (iter 8630):
  Avg similarity: 0.0641 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 13/100] [Batch 612/669 (91.5%)] [Iter 8640] Loss: 1.2534 (freq: 0.4896, raw: 0.7631, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[891,229,860,580,326,859,956,858,481,508,748,617,56,11,91]


π”¬ Encoder Diversity (iter 8640):
  Avg similarity: 0.0454 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 13/100] [Batch 622/669 (93.0%)] [Iter 8650] Loss: 1.2435 (freq: 0.4935, raw: 0.7492, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 616/1024 (60.2%) Top5:[326,91,742,722,161,503,796,968,274,895,536,651,693,166,481]


π”¬ Encoder Diversity (iter 8650):
  Avg similarity: 0.0563 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9567 (0.0=collapsed)
[Epoch 13/100] [Batch 632/669 (94.5%)] [Iter 8660] Loss: 1.2145 (freq: 0.4312, raw: 0.7825, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[481,265,859,956,536,819,912,326,19,860,261,211,602,508,92]


π”¬ Encoder Diversity (iter 8660):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 13/100] [Batch 642/669 (96.0%)] [Iter 8670] Loss: 1.2355 (freq: 0.4325, raw: 0.8021, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 642/1024 (62.7%) Top5:[956,326,859,651,211,527,580,722,261,155,390,581,536,92,617]


π”¬ Encoder Diversity (iter 8670):
  Avg similarity: 0.0596 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 13/100] [Batch 652/669 (97.5%)] [Iter 8680] Loss: 1.1895 (freq: 0.3890, raw: 0.7998, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 603/1024 (58.9%) Top5:[956,481,81,859,722,360,936,602,1004,536,796,912,580,390,346]


π”¬ Encoder Diversity (iter 8680):
  Avg similarity: 0.0891 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9465 (0.0=collapsed)
[Epoch 13/100] [Batch 662/669 (99.0%)] [Iter 8690] Loss: 1.2395 (freq: 0.3964, raw: 0.8422, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 614/1024 (60.0%) Top5:[936,360,956,211,150,580,860,617,274,789,473,11,859,602,481]


π”¬ Encoder Diversity (iter 8690):
  Avg similarity: 0.0504 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9595 (0.0=collapsed)

================================================================================
[Epoch 13] Validation Results:
  Total Loss: 0.5765
  Freq Loss:  0.1784
  Raw Loss:   0.3974
  Quant Loss: 0.0007
  π“ Codebook Usage: 487/1024 (47.6%)
  π“ Codebook Entropy: 4.8200 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28255 (21.7%)
  Top 10 most used codes:
    1. Code 257: 3646 times (2.80%)
    2. Code 435: 3316 times (2.55%)
    3. Code 745: 2838 times (2.18%)
    4. Code 333: 2813 times (2.16%)
    5. Code 950: 2767 times (2.13%)
    6. Code 525: 2734 times (2.10%)
    7. Code 678: 2594 times (1.99%)
    8. Code 474: 2533 times (1.95%)
    9. Code 93: 2531 times (1.94%)
    10. Code 377: 2483 times (1.91%)
  Bottom 5 least used codes (among used):
    1. Code 376: 1 times (0.00%)
    2. Code 95: 1 times (0.00%)
    3. Code 466: 2 times (0.00%)
    4. Code 862: 2 times (0.00%)
    5. Code 552: 4 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 13
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 14/100] [Batch 3/669 (0.4%)] [Iter 8700] Loss: 0.9208 (freq: 0.3074, raw: 0.6125, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 958/1024 (93.6%) Top5:[722,161,334,1004,275,796,185,858,561,127,503,226,511,319,931]


π”¬ Encoder Diversity (iter 8700):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 14/100] [Batch 13/669 (1.9%)] [Iter 8710] Loss: 0.9360 (freq: 0.2866, raw: 0.6486, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[950,796,561,678,535,742,710,275,767,722,819,257,525,93,745]


π”¬ Encoder Diversity (iter 8710):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 14/100] [Batch 23/669 (3.4%)] [Iter 8720] Loss: 1.2529 (freq: 0.4945, raw: 0.7575, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[357,710,438,950,372,561,742,399,93,262,525,275,91,819,745]


π”¬ Encoder Diversity (iter 8720):
  Avg similarity: 0.1157 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9345 (0.0=collapsed)
[Epoch 14/100] [Batch 33/669 (4.9%)] [Iter 8730] Loss: 1.1863 (freq: 0.4243, raw: 0.7612, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 651/1024 (63.6%) Top5:[357,959,561,710,946,438,859,878,258,719,633,685,737,932,91]


π”¬ Encoder Diversity (iter 8730):
  Avg similarity: 0.0572 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 14/100] [Batch 43/669 (6.4%)] [Iter 8740] Loss: 1.1423 (freq: 0.4253, raw: 0.7163, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 599/1024 (58.5%) Top5:[91,530,166,438,226,503,357,959,685,161,946,719,710,950,474]


π”¬ Encoder Diversity (iter 8740):
  Avg similarity: 0.0627 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 14/100] [Batch 53/669 (7.9%)] [Iter 8750] Loss: 1.1174 (freq: 0.3727, raw: 0.7439, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 663/1024 (64.7%) Top5:[29,166,946,932,982,161,91,357,885,561,506,268,710,959,796]


π”¬ Encoder Diversity (iter 8750):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 14/100] [Batch 63/669 (9.4%)] [Iter 8760] Loss: 0.9550 (freq: 0.3293, raw: 0.6249, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 648/1024 (63.3%) Top5:[932,357,166,91,506,968,438,561,1004,982,742,946,796,722,390]


π”¬ Encoder Diversity (iter 8760):
  Avg similarity: 0.0696 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 14/100] [Batch 73/669 (10.9%)] [Iter 8770] Loss: 1.5259 (freq: 0.6205, raw: 0.9045, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 615/1024 (60.1%) Top5:[980,878,319,932,438,586,685,859,80,1022,262,176,334,881,982]


π”¬ Encoder Diversity (iter 8770):
  Avg similarity: 0.0857 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 14/100] [Batch 83/669 (12.4%)] [Iter 8780] Loss: 1.1866 (freq: 0.4063, raw: 0.7795, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 692/1024 (67.6%) Top5:[878,390,357,932,438,1022,946,331,176,685,780,506,543,604,587]


π”¬ Encoder Diversity (iter 8780):
  Avg similarity: 0.1068 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9381 (0.0=collapsed)
[Epoch 14/100] [Batch 93/669 (13.9%)] [Iter 8790] Loss: 1.0987 (freq: 0.3865, raw: 0.7115, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 646/1024 (63.1%) Top5:[357,390,438,946,164,932,878,535,258,506,262,79,859,233,939]


π”¬ Encoder Diversity (iter 8790):
  Avg similarity: 0.0820 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 14/100] [Batch 103/669 (15.4%)] [Iter 8800] Loss: 1.0283 (freq: 0.3727, raw: 0.6548, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 669/1024 (65.3%) Top5:[946,357,859,932,258,438,334,166,164,176,275,268,530,91,752]


π”¬ Encoder Diversity (iter 8800):
  Avg similarity: 0.0620 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 14/100] [Batch 113/669 (16.9%)] [Iter 8810] Loss: 1.1753 (freq: 0.4007, raw: 0.7737, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 689/1024 (67.3%) Top5:[946,381,932,939,752,258,357,438,91,737,982,722,311,586,79]


π”¬ Encoder Diversity (iter 8810):
  Avg similarity: 0.0444 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 14/100] [Batch 123/669 (18.4%)] [Iter 8820] Loss: 0.9823 (freq: 0.3364, raw: 0.6451, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[334,946,530,166,1004,268,932,91,161,29,377,752,463,503,767]


π”¬ Encoder Diversity (iter 8820):
  Avg similarity: 0.0405 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 14/100] [Batch 133/669 (19.9%)] [Iter 8830] Loss: 1.2834 (freq: 0.4412, raw: 0.8413, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 640/1024 (62.5%) Top5:[946,535,268,357,885,140,685,858,604,663,1004,878,950,503,161]


π”¬ Encoder Diversity (iter 8830):
  Avg similarity: 0.0664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9551 (0.0=collapsed)
[Epoch 14/100] [Batch 143/669 (21.4%)] [Iter 8840] Loss: 0.9550 (freq: 0.3318, raw: 0.6226, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 650/1024 (63.5%) Top5:[161,722,29,485,91,334,745,372,257,127,357,530,685,157,561]


π”¬ Encoder Diversity (iter 8840):
  Avg similarity: 0.0977 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 14/100] [Batch 153/669 (22.9%)] [Iter 8850] Loss: 1.1738 (freq: 0.4136, raw: 0.7595, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 558/1024 (54.5%) Top5:[357,946,1003,258,176,685,878,586,248,980,438,161,148,932,91]


π”¬ Encoder Diversity (iter 8850):
  Avg similarity: 0.0674 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 14/100] [Batch 163/669 (24.4%)] [Iter 8860] Loss: 1.0847 (freq: 0.4005, raw: 0.6835, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 604/1024 (59.0%) Top5:[791,946,878,357,980,886,950,959,1004,859,932,514,438,535,91]


π”¬ Encoder Diversity (iter 8860):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9599 (0.0=collapsed)
[Epoch 14/100] [Batch 173/669 (25.9%)] [Iter 8870] Loss: 1.1194 (freq: 0.4165, raw: 0.7021, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 686/1024 (67.0%) Top5:[357,561,1004,886,742,438,226,257,157,932,946,745,858,485,372]


π”¬ Encoder Diversity (iter 8870):
  Avg similarity: 0.0698 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9480 (0.0=collapsed)
[Epoch 14/100] [Batch 183/669 (27.4%)] [Iter 8880] Loss: 1.4933 (freq: 0.5736, raw: 0.9189, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 634/1024 (61.9%) Top5:[946,506,176,1022,268,357,982,258,885,586,438,80,685,311,198]


π”¬ Encoder Diversity (iter 8880):
  Avg similarity: 0.0742 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9435 (0.0=collapsed)
[Epoch 14/100] [Batch 193/669 (28.8%)] [Iter 8890] Loss: 0.9371 (freq: 0.3027, raw: 0.6336, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 680/1024 (66.4%) Top5:[946,1004,438,722,91,663,752,742,878,710,268,157,586,275,258]


π”¬ Encoder Diversity (iter 8890):
  Avg similarity: 0.0317 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 14/100] [Batch 203/669 (30.3%)] [Iter 8900] Loss: 0.9520 (freq: 0.3352, raw: 0.6161, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 637/1024 (62.2%) Top5:[1004,946,357,752,586,722,319,881,474,1008,275,176,959,875,91]


π”¬ Encoder Diversity (iter 8900):
  Avg similarity: 0.0436 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 14/100] [Batch 213/669 (31.8%)] [Iter 8910] Loss: 1.0780 (freq: 0.3800, raw: 0.6972, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 678/1024 (66.2%) Top5:[357,932,878,29,164,722,946,258,506,561,268,91,1008,173,395]


π”¬ Encoder Diversity (iter 8910):
  Avg similarity: 0.0463 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 14/100] [Batch 223/669 (33.3%)] [Iter 8920] Loss: 0.9122 (freq: 0.2865, raw: 0.6250, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 675/1024 (65.9%) Top5:[1004,91,161,395,474,357,1008,530,816,275,157,40,886,722,542]


π”¬ Encoder Diversity (iter 8920):
  Avg similarity: 0.0650 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 14/100] [Batch 233/669 (34.8%)] [Iter 8930] Loss: 1.1827 (freq: 0.4027, raw: 0.7792, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 668/1024 (65.2%) Top5:[1004,946,535,959,980,331,932,1022,586,91,710,258,859,982,742]


π”¬ Encoder Diversity (iter 8930):
  Avg similarity: 0.0586 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 14/100] [Batch 243/669 (36.3%)] [Iter 8940] Loss: 1.4009 (freq: 0.5371, raw: 0.8629, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 676/1024 (66.0%) Top5:[535,357,946,859,331,164,932,959,506,381,710,586,881,390,950]


π”¬ Encoder Diversity (iter 8940):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 14/100] [Batch 253/669 (37.8%)] [Iter 8950] Loss: 0.8186 (freq: 0.2985, raw: 0.5195, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 704/1024 (68.8%) Top5:[932,164,357,959,587,1004,946,29,859,506,514,91,535,982,275]


π”¬ Encoder Diversity (iter 8950):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 14/100] [Batch 263/669 (39.3%)] [Iter 8960] Loss: 0.9835 (freq: 0.3151, raw: 0.6677, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 700/1024 (68.4%) Top5:[946,357,932,959,164,859,982,881,268,506,29,1003,197,186,685]


π”¬ Encoder Diversity (iter 8960):
  Avg similarity: 0.0496 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 14/100] [Batch 273/669 (40.8%)] [Iter 8970] Loss: 1.0711 (freq: 0.3531, raw: 0.7172, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 673/1024 (65.7%) Top5:[226,946,950,91,70,134,161,166,561,268,722,1004,357,110,886]


π”¬ Encoder Diversity (iter 8970):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 14/100] [Batch 283/669 (42.3%)] [Iter 8980] Loss: 1.0270 (freq: 0.3799, raw: 0.6464, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 611/1024 (59.7%) Top5:[946,357,982,506,859,765,881,878,710,477,1004,268,587,164,959]


π”¬ Encoder Diversity (iter 8980):
  Avg similarity: 0.0811 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9503 (0.0=collapsed)
[Epoch 14/100] [Batch 293/669 (43.8%)] [Iter 8990] Loss: 1.3265 (freq: 0.4770, raw: 0.8487, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 610/1024 (59.6%) Top5:[29,331,685,80,982,477,198,56,357,381,575,176,1004,980,710]


π”¬ Encoder Diversity (iter 8990):
  Avg similarity: 0.0579 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 14/100] [Batch 303/669 (45.3%)] [Iter 9000] Loss: 1.2538 (freq: 0.4714, raw: 0.7817, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 607/1024 (59.3%) Top5:[331,932,275,931,29,767,418,587,895,875,734,746,1004,722,268]


π”¬ Encoder Diversity (iter 9000):
  Avg similarity: 0.0701 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 14/100] [Batch 313/669 (46.8%)] [Iter 9010] Loss: 1.3502 (freq: 0.5048, raw: 0.8445, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 643/1024 (62.8%) Top5:[767,946,29,1003,685,587,980,164,950,621,959,331,561,858,268]


π”¬ Encoder Diversity (iter 9010):
  Avg similarity: 0.1005 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 14/100] [Batch 323/669 (48.3%)] [Iter 9020] Loss: 1.3166 (freq: 0.4922, raw: 0.8235, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 668/1024 (65.2%) Top5:[587,29,161,164,932,522,530,946,110,1003,357,980,710,542,885]


π”¬ Encoder Diversity (iter 9020):
  Avg similarity: 0.0913 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9380 (0.0=collapsed)
[Epoch 14/100] [Batch 333/669 (49.8%)] [Iter 9030] Loss: 1.0911 (freq: 0.3595, raw: 0.7309, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 705/1024 (68.8%) Top5:[357,710,878,164,932,621,438,946,506,859,331,140,587,959,942]


π”¬ Encoder Diversity (iter 9030):
  Avg similarity: 0.1027 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9386 (0.0=collapsed)
[Epoch 14/100] [Batch 343/669 (51.3%)] [Iter 9040] Loss: 1.1935 (freq: 0.4346, raw: 0.7582, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 708/1024 (69.1%) Top5:[357,621,535,932,1004,710,31,29,765,268,946,915,311,859,140]


π”¬ Encoder Diversity (iter 9040):
  Avg similarity: 0.0783 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 14/100] [Batch 353/669 (52.8%)] [Iter 9050] Loss: 1.3616 (freq: 0.5224, raw: 0.8384, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 655/1024 (64.0%) Top5:[357,31,29,268,202,334,1004,710,164,931,418,185,990,530,932]


π”¬ Encoder Diversity (iter 9050):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 14/100] [Batch 363/669 (54.3%)] [Iter 9060] Loss: 1.0484 (freq: 0.4076, raw: 0.6400, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 632/1024 (61.7%) Top5:[719,176,164,91,1004,959,1003,29,990,226,886,621,698,110,915]


π”¬ Encoder Diversity (iter 9060):
  Avg similarity: 0.0462 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 14/100] [Batch 373/669 (55.8%)] [Iter 9070] Loss: 0.9704 (freq: 0.3466, raw: 0.6231, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 683/1024 (66.7%) Top5:[1004,1003,31,946,530,990,164,185,166,719,70,275,535,331,858]


π”¬ Encoder Diversity (iter 9070):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 14/100] [Batch 383/669 (57.2%)] [Iter 9080] Loss: 1.0845 (freq: 0.3624, raw: 0.7213, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 697/1024 (68.1%) Top5:[91,950,150,399,300,1004,875,827,886,443,561,1007,388,722,530]


π”¬ Encoder Diversity (iter 9080):
  Avg similarity: 0.0727 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9554 (0.0=collapsed)
[Epoch 14/100] [Batch 393/669 (58.7%)] [Iter 9090] Loss: 1.3483 (freq: 0.5225, raw: 0.8250, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 690/1024 (67.4%) Top5:[357,331,942,765,915,946,506,710,31,982,885,858,719,186,56]


π”¬ Encoder Diversity (iter 9090):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 14/100] [Batch 403/669 (60.2%)] [Iter 9100] Loss: 0.9562 (freq: 0.3281, raw: 0.6274, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 699/1024 (68.3%) Top5:[535,765,357,710,167,31,176,982,561,268,331,522,534,381,767]


π”¬ Encoder Diversity (iter 9100):
  Avg similarity: 0.0767 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9427 (0.0=collapsed)
[Epoch 14/100] [Batch 413/669 (61.7%)] [Iter 9110] Loss: 1.4817 (freq: 0.5546, raw: 0.9263, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[621,534,109,698,357,164,477,522,710,268,29,959,765,262,535]


π”¬ Encoder Diversity (iter 9110):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 14/100] [Batch 423/669 (63.2%)] [Iter 9120] Loss: 0.9613 (freq: 0.3279, raw: 0.6327, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[91,827,1004,950,388,522,29,1007,399,561,372,621,651,443,31]


π”¬ Encoder Diversity (iter 9120):
  Avg similarity: 0.0637 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9569 (0.0=collapsed)
[Epoch 14/100] [Batch 433/669 (64.7%)] [Iter 9130] Loss: 1.2382 (freq: 0.4429, raw: 0.7945, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 728/1024 (71.1%) Top5:[29,91,530,31,950,1007,561,150,982,946,621,710,110,186,275]


π”¬ Encoder Diversity (iter 9130):
  Avg similarity: 0.0532 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 14/100] [Batch 443/669 (66.2%)] [Iter 9140] Loss: 1.0065 (freq: 0.3654, raw: 0.6404, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 661/1024 (64.6%) Top5:[1004,522,982,1007,621,710,31,222,399,268,530,719,70,583,275]


π”¬ Encoder Diversity (iter 9140):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 14/100] [Batch 453/669 (67.7%)] [Iter 9150] Loss: 1.0136 (freq: 0.3906, raw: 0.6223, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 689/1024 (67.3%) Top5:[357,710,140,362,767,186,337,906,477,506,583,719,535,164,621]


π”¬ Encoder Diversity (iter 9150):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 14/100] [Batch 463/669 (69.2%)] [Iter 9160] Loss: 1.2350 (freq: 0.4606, raw: 0.7736, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 673/1024 (65.7%) Top5:[878,29,198,767,268,737,530,932,167,535,587,906,522,1007,275]


π”¬ Encoder Diversity (iter 9160):
  Avg similarity: 0.0635 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 14/100] [Batch 473/669 (70.7%)] [Iter 9170] Loss: 1.0112 (freq: 0.3666, raw: 0.6438, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 626/1024 (61.1%) Top5:[372,530,561,70,742,167,275,150,357,702,29,399,336,173,22]


π”¬ Encoder Diversity (iter 9170):
  Avg similarity: 0.0561 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 14/100] [Batch 483/669 (72.2%)] [Iter 9180] Loss: 1.2142 (freq: 0.4130, raw: 0.8005, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 644/1024 (62.9%) Top5:[372,150,875,561,388,827,300,946,1014,942,258,275,886,70,161]


π”¬ Encoder Diversity (iter 9180):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9574 (0.0=collapsed)
[Epoch 14/100] [Batch 493/669 (73.7%)] [Iter 9190] Loss: 1.0484 (freq: 0.3456, raw: 0.7021, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 744/1024 (72.7%) Top5:[70,875,1007,946,91,710,372,29,438,685,702,331,150,388,262]


π”¬ Encoder Diversity (iter 9190):
  Avg similarity: 0.0639 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9540 (0.0=collapsed)
[Epoch 14/100] [Batch 503/669 (75.2%)] [Iter 9200] Loss: 1.2965 (freq: 0.4572, raw: 0.8385, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 672/1024 (65.6%) Top5:[621,982,765,946,91,1004,878,915,357,506,942,875,197,522,1007]


π”¬ Encoder Diversity (iter 9200):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 14/100] [Batch 513/669 (76.7%)] [Iter 9210] Loss: 1.2261 (freq: 0.4655, raw: 0.7598, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 654/1024 (63.9%) Top5:[946,915,621,362,186,583,514,982,636,258,858,176,685,197,29]


π”¬ Encoder Diversity (iter 9210):
  Avg similarity: 0.0524 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 14/100] [Batch 523/669 (78.2%)] [Iter 9220] Loss: 1.1996 (freq: 0.4060, raw: 0.7929, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[946,621,982,197,388,226,974,685,915,587,827,878,477,586,372]


π”¬ Encoder Diversity (iter 9220):
  Avg similarity: 0.0331 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 14/100] [Batch 533/669 (79.7%)] [Iter 9230] Loss: 0.9810 (freq: 0.3321, raw: 0.6481, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[946,710,357,29,274,765,906,878,561,337,477,586,959,540,390]


π”¬ Encoder Diversity (iter 9230):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 14/100] [Batch 543/669 (81.2%)] [Iter 9240] Loss: 0.9681 (freq: 0.3619, raw: 0.6053, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 698/1024 (68.2%) Top5:[522,745,742,29,698,906,535,1004,337,530,506,982,30,946,878]


π”¬ Encoder Diversity (iter 9240):
  Avg similarity: 0.0655 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 14/100] [Batch 553/669 (82.7%)] [Iter 9250] Loss: 0.9739 (freq: 0.3516, raw: 0.6215, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[522,710,29,535,621,262,561,477,982,530,176,91,980,586,56]


π”¬ Encoder Diversity (iter 9250):
  Avg similarity: 0.0667 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9490 (0.0=collapsed)
[Epoch 14/100] [Batch 563/669 (84.2%)] [Iter 9260] Loss: 1.1534 (freq: 0.4592, raw: 0.6934, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 655/1024 (64.0%) Top5:[982,621,561,522,31,91,357,372,765,710,197,70,942,745,176]


π”¬ Encoder Diversity (iter 9260):
  Avg similarity: 0.0543 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 14/100] [Batch 573/669 (85.7%)] [Iter 9270] Loss: 1.2054 (freq: 0.4360, raw: 0.7686, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[31,522,258,765,710,942,274,357,197,581,982,767,878,621,186]


π”¬ Encoder Diversity (iter 9270):
  Avg similarity: 0.0368 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 14/100] [Batch 583/669 (87.1%)] [Iter 9280] Loss: 0.9702 (freq: 0.3191, raw: 0.6503, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 656/1024 (64.1%) Top5:[91,561,875,1007,474,372,1012,745,70,893,173,15,742,530,275]


π”¬ Encoder Diversity (iter 9280):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 14/100] [Batch 593/669 (88.6%)] [Iter 9290] Loss: 1.1956 (freq: 0.4222, raw: 0.7726, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 620/1024 (60.5%) Top5:[561,173,906,982,946,702,197,1007,942,581,1004,534,913,248,959]


π”¬ Encoder Diversity (iter 9290):
  Avg similarity: 0.0626 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 14/100] [Batch 603/669 (90.1%)] [Iter 9300] Loss: 1.1827 (freq: 0.3910, raw: 0.7908, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 704/1024 (68.8%) Top5:[959,522,1004,164,621,906,946,685,268,710,29,858,575,587,381]


π”¬ Encoder Diversity (iter 9300):
  Avg similarity: 0.0684 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9458 (0.0=collapsed)
[Epoch 14/100] [Batch 613/669 (91.6%)] [Iter 9310] Loss: 1.3697 (freq: 0.5033, raw: 0.8656, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 657/1024 (64.2%) Top5:[522,946,587,357,742,176,959,702,645,906,1004,534,621,258,982]


π”¬ Encoder Diversity (iter 9310):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 14/100] [Batch 623/669 (93.1%)] [Iter 9320] Loss: 0.9721 (freq: 0.3448, raw: 0.6265, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 659/1024 (64.4%) Top5:[29,946,982,197,959,56,906,586,262,587,710,258,932,176,70]


π”¬ Encoder Diversity (iter 9320):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 14/100] [Batch 633/669 (94.6%)] [Iter 9330] Loss: 1.3424 (freq: 0.5067, raw: 0.8348, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 683/1024 (66.7%) Top5:[700,896,145,226,522,702,816,745,274,969,95,222,501,959,621]


π”¬ Encoder Diversity (iter 9330):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 14/100] [Batch 643/669 (96.1%)] [Iter 9340] Loss: 1.1190 (freq: 0.4102, raw: 0.7081, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 685/1024 (66.9%) Top5:[357,29,906,685,621,702,575,522,745,248,337,70,942,710,274]


π”¬ Encoder Diversity (iter 9340):
  Avg similarity: 0.0782 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9554 (0.0=collapsed)
[Epoch 14/100] [Batch 653/669 (97.6%)] [Iter 9350] Loss: 1.3403 (freq: 0.4827, raw: 0.8567, quant: 0.0009, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 708/1024 (69.1%) Top5:[31,710,29,946,337,357,540,906,331,381,581,274,268,390,232]


π”¬ Encoder Diversity (iter 9350):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 14/100] [Batch 663/669 (99.1%)] [Iter 9360] Loss: 0.9613 (freq: 0.3008, raw: 0.6598, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 621/1024 (60.6%) Top5:[31,966,946,581,64,710,438,999,700,222,170,91,501,258,95]


π”¬ Encoder Diversity (iter 9360):
  Avg similarity: 0.0767 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9544 (0.0=collapsed)

================================================================================
[Epoch 14] Validation Results:
  Total Loss: 0.5712
  Freq Loss:  0.1755
  Raw Loss:   0.3949
  Quant Loss: 0.0007
  π“ Codebook Usage: 593/1024 (57.9%)
  π“ Codebook Entropy: 5.0227 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 25826 (19.8%)
  Top 10 most used codes:
    1. Code 561: 3153 times (2.42%)
    2. Code 222: 2964 times (2.28%)
    3. Code 600: 2605 times (2.00%)
    4. Code 501: 2570 times (1.97%)
    5. Code 700: 2510 times (1.93%)
    6. Code 372: 2504 times (1.92%)
    7. Code 1004: 2430 times (1.87%)
    8. Code 530: 2395 times (1.84%)
    9. Code 185: 2353 times (1.81%)
    10. Code 745: 2342 times (1.80%)
  Bottom 5 least used codes (among used):
    1. Code 1016: 1 times (0.00%)
    2. Code 723: 1 times (0.00%)
    3. Code 148: 1 times (0.00%)
    4. Code 513: 2 times (0.00%)
    5. Code 380: 2 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 14
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 15/100] [Batch 4/669 (0.6%)] [Iter 9370] Loss: 1.3970 (freq: 0.5350, raw: 0.8611, quant: 0.0010, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 992/1024 (96.9%) Top5:[767,924,875,222,600,778,745,702,91,966,354,816,275,185,95]


π”¬ Encoder Diversity (iter 9370):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 15/100] [Batch 14/669 (2.1%)] [Iter 9380] Loss: 1.2154 (freq: 0.4110, raw: 0.8036, quant: 0.0008, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 921/1024 (89.9%) Top5:[415,170,95,501,896,107,702,387,944,700,969,101,745,875,778]


π”¬ Encoder Diversity (iter 9380):
  Avg similarity: 0.0359 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 15/100] [Batch 24/669 (3.6%)] [Iter 9390] Loss: 1.2329 (freq: 0.4440, raw: 0.7882, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 762/1024 (74.4%) Top5:[91,745,16,924,501,1004,70,490,1007,557,742,796,107,444,185]


π”¬ Encoder Diversity (iter 9390):
  Avg similarity: 0.0373 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9644 (0.0=collapsed)
[Epoch 15/100] [Batch 34/669 (5.1%)] [Iter 9400] Loss: 0.9485 (freq: 0.3248, raw: 0.6231, quant: 0.0007, domain: 0.0000) LR: 2.00e-05 
π“ Codebook: 639/1024 (62.4%) Top5:[490,1004,91,745,372,506,796,924,670,220,43,742,146,346,627]


π”¬ Encoder Diversity (iter 9400):
  Avg similarity: 0.0582 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9547 (0.0=collapsed)
[Epoch 15/100] [Batch 44/669 (6.6%)] [Iter 9410] Loss: 1.2872 (freq: 0.4988, raw: 0.7876, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 693/1024 (67.7%) Top5:[627,490,640,6,115,944,131,433,44,973,146,442,654,673,216]


π”¬ Encoder Diversity (iter 9410):
  Avg similarity: 0.0663 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 15/100] [Batch 54/669 (8.1%)] [Iter 9420] Loss: 1.1717 (freq: 0.4110, raw: 0.7598, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[490,170,95,816,415,372,474,969,745,222,354,387,600,166,875]


π”¬ Encoder Diversity (iter 9420):
  Avg similarity: 0.0430 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9607 (0.0=collapsed)
[Epoch 15/100] [Batch 64/669 (9.6%)] [Iter 9430] Loss: 0.9367 (freq: 0.2958, raw: 0.6402, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 691/1024 (67.5%) Top5:[222,387,95,875,490,924,141,1004,115,557,833,816,372,354,107]


π”¬ Encoder Diversity (iter 9430):
  Avg similarity: 0.0583 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 15/100] [Batch 74/669 (11.1%)] [Iter 9440] Loss: 1.0861 (freq: 0.3689, raw: 0.7165, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 729/1024 (71.2%) Top5:[973,833,882,673,3,200,95,288,657,557,323,101,601,44,433]


π”¬ Encoder Diversity (iter 9440):
  Avg similarity: 0.0881 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9443 (0.0=collapsed)
[Epoch 15/100] [Batch 84/669 (12.6%)] [Iter 9450] Loss: 1.2888 (freq: 0.4225, raw: 0.8655, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 730/1024 (71.3%) Top5:[490,627,44,391,95,170,875,101,387,115,673,200,1004,963,431]


π”¬ Encoder Diversity (iter 9450):
  Avg similarity: 0.0920 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 15/100] [Batch 94/669 (14.1%)] [Iter 9460] Loss: 1.1809 (freq: 0.4062, raw: 0.7739, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 682/1024 (66.6%) Top5:[490,627,44,115,101,391,146,216,973,177,166,141,796,201,963]


π”¬ Encoder Diversity (iter 9460):
  Avg similarity: 0.0932 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9489 (0.0=collapsed)
[Epoch 15/100] [Batch 104/669 (15.5%)] [Iter 9470] Loss: 1.0783 (freq: 0.3743, raw: 0.7032, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 694/1024 (67.8%) Top5:[973,91,1022,101,490,200,627,1004,170,501,166,44,700,216,875]


π”¬ Encoder Diversity (iter 9470):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 15/100] [Batch 114/669 (17.0%)] [Iter 9480] Loss: 1.1669 (freq: 0.4130, raw: 0.7532, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 672/1024 (65.6%) Top5:[490,833,391,917,670,6,44,431,152,944,654,718,146,673,627]


π”¬ Encoder Diversity (iter 9480):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 15/100] [Batch 124/669 (18.5%)] [Iter 9490] Loss: 0.8042 (freq: 0.2469, raw: 0.5567, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[917,146,969,391,70,490,91,156,833,1007,742,970,1004,501,89]


π”¬ Encoder Diversity (iter 9490):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 15/100] [Batch 134/669 (20.0%)] [Iter 9500] Loss: 1.2065 (freq: 0.4399, raw: 0.7658, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 738/1024 (72.1%) Top5:[718,391,973,833,141,796,490,501,145,600,657,628,963,95,601]


π”¬ Encoder Diversity (iter 9500):
  Avg similarity: 0.0606 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 15/100] [Batch 144/669 (21.5%)] [Iter 9510] Loss: 1.2963 (freq: 0.5007, raw: 0.7948, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 640/1024 (62.5%) Top5:[490,627,833,654,944,375,101,415,43,485,535,6,875,657,141]


π”¬ Encoder Diversity (iter 9510):
  Avg similarity: 0.0613 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 15/100] [Batch 154/669 (23.0%)] [Iter 9520] Loss: 0.7224 (freq: 0.2303, raw: 0.4915, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 702/1024 (68.6%) Top5:[1004,875,1007,387,433,1022,275,91,677,794,6,43,166,535,600]


π”¬ Encoder Diversity (iter 9520):
  Avg similarity: 0.0772 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9455 (0.0=collapsed)
[Epoch 15/100] [Batch 164/669 (24.5%)] [Iter 9530] Loss: 1.2896 (freq: 0.4821, raw: 0.8067, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 678/1024 (66.2%) Top5:[490,657,146,601,6,559,846,391,769,627,44,917,833,687,944]


π”¬ Encoder Diversity (iter 9530):
  Avg similarity: 0.0748 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 15/100] [Batch 174/669 (26.0%)] [Iter 9540] Loss: 0.8404 (freq: 0.2783, raw: 0.5613, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 736/1024 (71.9%) Top5:[816,1022,600,875,718,170,190,944,490,415,95,387,501,657,101]


π”¬ Encoder Diversity (iter 9540):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 15/100] [Batch 184/669 (27.5%)] [Iter 9550] Loss: 1.3191 (freq: 0.4679, raw: 0.8503, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 691/1024 (67.5%) Top5:[431,101,490,146,627,917,718,657,654,687,236,875,115,676,673]


π”¬ Encoder Diversity (iter 9550):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 15/100] [Batch 194/669 (29.0%)] [Iter 9560] Loss: 1.3429 (freq: 0.4990, raw: 0.8430, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 742/1024 (72.5%) Top5:[6,431,141,627,559,676,442,687,833,601,490,387,673,511,122]


π”¬ Encoder Diversity (iter 9560):
  Avg similarity: 0.0913 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9407 (0.0=collapsed)
[Epoch 15/100] [Batch 204/669 (30.5%)] [Iter 9570] Loss: 1.0563 (freq: 0.3492, raw: 0.7063, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 731/1024 (71.4%) Top5:[91,745,236,415,190,718,95,1004,372,875,275,431,817,474,170]


π”¬ Encoder Diversity (iter 9570):
  Avg similarity: 0.0802 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 15/100] [Batch 214/669 (32.0%)] [Iter 9580] Loss: 1.1118 (freq: 0.3590, raw: 0.7519, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 696/1024 (68.0%) Top5:[627,200,718,6,833,115,490,676,559,640,673,236,654,391,431]


π”¬ Encoder Diversity (iter 9580):
  Avg similarity: 0.0922 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9467 (0.0=collapsed)
[Epoch 15/100] [Batch 224/669 (33.5%)] [Iter 9590] Loss: 1.4535 (freq: 0.5156, raw: 0.9370, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 713/1024 (69.6%) Top5:[718,490,200,627,559,654,391,882,833,146,236,6,970,156,673]


π”¬ Encoder Diversity (iter 9590):
  Avg similarity: 0.0559 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 15/100] [Batch 234/669 (35.0%)] [Iter 9600] Loss: 1.3215 (freq: 0.5057, raw: 0.8149, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 696/1024 (68.0%) Top5:[627,875,687,391,973,616,436,833,657,771,817,970,200,95,387]


π”¬ Encoder Diversity (iter 9600):
  Avg similarity: 0.0807 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9379 (0.0=collapsed)
[Epoch 15/100] [Batch 244/669 (36.5%)] [Iter 9610] Loss: 1.0298 (freq: 0.3989, raw: 0.6301, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 705/1024 (68.8%) Top5:[745,875,387,627,474,924,436,1022,372,601,91,101,95,969,657]


π”¬ Encoder Diversity (iter 9610):
  Avg similarity: 0.0646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9582 (0.0=collapsed)
[Epoch 15/100] [Batch 254/669 (38.0%)] [Iter 9620] Loss: 1.3393 (freq: 0.4991, raw: 0.8393, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 754/1024 (73.6%) Top5:[627,431,833,101,944,44,654,718,687,673,131,141,895,628,771]


π”¬ Encoder Diversity (iter 9620):
  Avg similarity: 0.0932 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9492 (0.0=collapsed)
[Epoch 15/100] [Batch 264/669 (39.5%)] [Iter 9630] Loss: 1.1304 (freq: 0.3948, raw: 0.7348, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 728/1024 (71.1%) Top5:[627,875,745,461,600,251,372,95,816,107,1022,687,490,391,969]


π”¬ Encoder Diversity (iter 9630):
  Avg similarity: 0.0470 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 15/100] [Batch 274/669 (41.0%)] [Iter 9640] Loss: 1.3083 (freq: 0.4743, raw: 0.8331, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 737/1024 (72.0%) Top5:[657,431,687,864,944,391,833,490,200,236,769,115,746,654,511]


π”¬ Encoder Diversity (iter 9640):
  Avg similarity: 0.0876 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9382 (0.0=collapsed)
[Epoch 15/100] [Batch 284/669 (42.5%)] [Iter 9650] Loss: 0.8660 (freq: 0.3007, raw: 0.5646, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[91,833,1004,354,969,784,175,700,687,107,816,190,170,495,415]


π”¬ Encoder Diversity (iter 9650):
  Avg similarity: 0.0758 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 15/100] [Batch 294/669 (43.9%)] [Iter 9660] Loss: 1.2824 (freq: 0.4375, raw: 0.8440, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 756/1024 (73.8%) Top5:[436,200,431,115,236,559,485,944,627,654,846,288,718,391,687]


π”¬ Encoder Diversity (iter 9660):
  Avg similarity: 0.0477 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 15/100] [Batch 304/669 (45.4%)] [Iter 9670] Loss: 1.1493 (freq: 0.3943, raw: 0.7541, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 696/1024 (68.0%) Top5:[431,44,944,718,436,200,391,236,490,190,627,737,95,29,177]


π”¬ Encoder Diversity (iter 9670):
  Avg similarity: 0.0335 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 15/100] [Batch 314/669 (46.9%)] [Iter 9680] Loss: 1.2963 (freq: 0.4522, raw: 0.8433, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 676/1024 (66.0%) Top5:[970,627,944,833,718,687,107,882,746,969,436,431,485,170,44]


π”¬ Encoder Diversity (iter 9680):
  Avg similarity: 0.1187 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9245 (0.0=collapsed)
[Epoch 15/100] [Batch 324/669 (48.4%)] [Iter 9690] Loss: 0.7474 (freq: 0.2390, raw: 0.5076, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 662/1024 (64.6%) Top5:[490,200,559,718,627,436,431,654,115,882,137,44,657,676,391]


π”¬ Encoder Diversity (iter 9690):
  Avg similarity: 0.0544 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 15/100] [Batch 334/669 (49.9%)] [Iter 9700] Loss: 1.0094 (freq: 0.3527, raw: 0.6560, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 740/1024 (72.3%) Top5:[490,436,200,559,654,917,864,146,627,833,702,6,657,687,216]


π”¬ Encoder Diversity (iter 9700):
  Avg similarity: 0.0657 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9531 (0.0=collapsed)
[Epoch 15/100] [Batch 344/669 (51.4%)] [Iter 9710] Loss: 1.2159 (freq: 0.4318, raw: 0.7834, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 714/1024 (69.7%) Top5:[490,698,833,95,190,601,687,391,179,769,436,115,501,298,44]


π”¬ Encoder Diversity (iter 9710):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9541 (0.0=collapsed)
[Epoch 15/100] [Batch 354/669 (52.9%)] [Iter 9720] Loss: 1.0099 (freq: 0.3355, raw: 0.6737, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 711/1024 (69.4%) Top5:[70,869,91,969,536,200,916,875,490,485,970,687,745,739,333]


π”¬ Encoder Diversity (iter 9720):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 15/100] [Batch 364/669 (54.4%)] [Iter 9730] Loss: 1.0773 (freq: 0.4047, raw: 0.6719, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 698/1024 (68.2%) Top5:[687,869,70,236,95,490,190,742,107,745,91,372,657,671,474]


π”¬ Encoder Diversity (iter 9730):
  Avg similarity: 0.0407 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 15/100] [Batch 374/669 (55.9%)] [Iter 9740] Loss: 0.8518 (freq: 0.2597, raw: 0.5913, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[916,175,869,297,91,769,714,490,372,70,391,969,944,333,745]


π”¬ Encoder Diversity (iter 9740):
  Avg similarity: 0.0621 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 15/100] [Batch 384/669 (57.4%)] [Iter 9750] Loss: 1.2312 (freq: 0.4575, raw: 0.7729, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 681/1024 (66.5%) Top5:[490,882,431,833,200,917,676,137,101,627,391,875,657,216,146]


π”¬ Encoder Diversity (iter 9750):
  Avg similarity: 0.0983 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9392 (0.0=collapsed)
[Epoch 15/100] [Batch 394/669 (58.9%)] [Iter 9760] Loss: 1.1104 (freq: 0.4120, raw: 0.6976, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 780/1024 (76.2%) Top5:[833,485,627,236,490,6,657,115,874,860,687,391,559,190,101]


π”¬ Encoder Diversity (iter 9760):
  Avg similarity: 0.0806 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 15/100] [Batch 404/669 (60.4%)] [Iter 9770] Loss: 1.1562 (freq: 0.4083, raw: 0.7470, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[485,601,29,833,391,875,101,236,676,137,490,860,436,673,141]


π”¬ Encoder Diversity (iter 9770):
  Avg similarity: 0.0558 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 15/100] [Batch 414/669 (61.9%)] [Iter 9780] Loss: 1.2118 (freq: 0.4487, raw: 0.7623, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 712/1024 (69.5%) Top5:[485,687,1022,137,833,559,671,970,616,115,389,737,700,601,107]


π”¬ Encoder Diversity (iter 9780):
  Avg similarity: 0.0572 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 15/100] [Batch 424/669 (63.4%)] [Iter 9790] Loss: 1.0183 (freq: 0.3856, raw: 0.6319, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[627,156,718,698,875,579,6,137,115,700,485,179,654,101,671]


π”¬ Encoder Diversity (iter 9790):
  Avg similarity: 0.0457 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9616 (0.0=collapsed)
[Epoch 15/100] [Batch 434/669 (64.9%)] [Iter 9800] Loss: 0.9649 (freq: 0.3453, raw: 0.6188, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 696/1024 (68.0%) Top5:[627,485,146,156,654,745,436,236,6,657,391,101,559,200,616]


π”¬ Encoder Diversity (iter 9800):
  Avg similarity: 0.1128 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9348 (0.0=collapsed)
[Epoch 15/100] [Batch 444/669 (66.4%)] [Iter 9810] Loss: 1.0533 (freq: 0.3773, raw: 0.6753, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 717/1024 (70.0%) Top5:[833,687,236,156,874,436,485,917,200,627,122,296,745,490,115]


π”¬ Encoder Diversity (iter 9810):
  Avg similarity: 0.0453 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 15/100] [Batch 454/669 (67.9%)] [Iter 9820] Loss: 0.9838 (freq: 0.3644, raw: 0.6187, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 730/1024 (71.3%) Top5:[200,833,875,969,236,115,495,860,485,190,657,1022,874,774,490]


π”¬ Encoder Diversity (iter 9820):
  Avg similarity: 0.1130 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9417 (0.0=collapsed)
[Epoch 15/100] [Batch 464/669 (69.4%)] [Iter 9830] Loss: 1.0471 (freq: 0.3651, raw: 0.6812, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 731/1024 (71.4%) Top5:[833,490,864,485,391,687,137,673,355,970,200,627,917,771,44]


π”¬ Encoder Diversity (iter 9830):
  Avg similarity: 0.0690 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9467 (0.0=collapsed)
[Epoch 15/100] [Batch 474/669 (70.9%)] [Iter 9840] Loss: 1.0457 (freq: 0.3819, raw: 0.6630, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 752/1024 (73.4%) Top5:[391,1004,745,742,687,875,44,292,944,190,671,91,718,200,202]


π”¬ Encoder Diversity (iter 9840):
  Avg similarity: 0.0746 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 15/100] [Batch 484/669 (72.3%)] [Iter 9850] Loss: 0.9016 (freq: 0.3390, raw: 0.5618, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 719/1024 (70.2%) Top5:[490,687,485,115,391,718,44,742,29,200,601,91,107,216,190]


π”¬ Encoder Diversity (iter 9850):
  Avg similarity: 0.0602 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 15/100] [Batch 494/669 (73.8%)] [Iter 9860] Loss: 1.3460 (freq: 0.4985, raw: 0.8467, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 745/1024 (72.8%) Top5:[917,391,115,200,490,754,687,864,137,724,641,253,292,627,601]


π”¬ Encoder Diversity (iter 9860):
  Avg similarity: 0.0494 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 15/100] [Batch 504/669 (75.3%)] [Iter 9870] Loss: 0.9655 (freq: 0.3536, raw: 0.6111, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 689/1024 (67.3%) Top5:[671,742,190,1022,1004,175,89,687,101,718,170,91,391,355,495]


π”¬ Encoder Diversity (iter 9870):
  Avg similarity: 0.0918 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9520 (0.0=collapsed)
[Epoch 15/100] [Batch 514/669 (76.8%)] [Iter 9880] Loss: 1.3947 (freq: 0.5043, raw: 0.8895, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[718,833,944,673,627,236,391,970,431,137,860,216,101,851,115]


π”¬ Encoder Diversity (iter 9880):
  Avg similarity: 0.0973 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9396 (0.0=collapsed)
[Epoch 15/100] [Batch 524/669 (78.3%)] [Iter 9890] Loss: 0.8508 (freq: 0.2982, raw: 0.5519, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 709/1024 (69.2%) Top5:[654,490,718,91,200,860,944,485,44,969,640,236,627,1004,724]


π”¬ Encoder Diversity (iter 9890):
  Avg similarity: 0.0401 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 15/100] [Batch 534/669 (79.8%)] [Iter 9900] Loss: 1.1153 (freq: 0.3935, raw: 0.7210, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 749/1024 (73.1%) Top5:[627,718,654,944,490,485,115,156,137,687,436,737,101,200,44]


π”¬ Encoder Diversity (iter 9900):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 15/100] [Batch 544/669 (81.3%)] [Iter 9910] Loss: 0.8153 (freq: 0.2682, raw: 0.5464, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 715/1024 (69.8%) Top5:[490,627,436,698,559,570,579,742,297,745,826,969,718,253,179]


π”¬ Encoder Diversity (iter 9910):
  Avg similarity: 0.0883 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9476 (0.0=collapsed)
[Epoch 15/100] [Batch 554/669 (82.8%)] [Iter 9920] Loss: 0.8907 (freq: 0.3170, raw: 0.5729, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[833,115,687,826,944,490,627,671,916,391,742,485,200,44,698]


π”¬ Encoder Diversity (iter 9920):
  Avg similarity: 0.0793 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 15/100] [Batch 564/669 (84.3%)] [Iter 9930] Loss: 1.0646 (freq: 0.3583, raw: 0.7056, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 711/1024 (69.4%) Top5:[718,490,860,200,895,673,336,431,115,601,627,944,742,724,6]


π”¬ Encoder Diversity (iter 9930):
  Avg similarity: 0.0753 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 15/100] [Batch 574/669 (85.8%)] [Iter 9940] Loss: 1.0786 (freq: 0.3930, raw: 0.6849, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 728/1024 (71.1%) Top5:[391,718,485,490,944,288,601,190,671,887,746,250,200,882,253]


π”¬ Encoder Diversity (iter 9940):
  Avg similarity: 0.0582 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 15/100] [Batch 584/669 (87.3%)] [Iter 9950] Loss: 0.8251 (freq: 0.2878, raw: 0.5365, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 760/1024 (74.2%) Top5:[253,190,1004,775,742,698,928,826,579,570,641,969,745,495,490]


π”¬ Encoder Diversity (iter 9950):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9601 (0.0=collapsed)
[Epoch 15/100] [Batch 594/669 (88.8%)] [Iter 9960] Loss: 1.1566 (freq: 0.3989, raw: 0.7569, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 729/1024 (71.2%) Top5:[391,627,718,860,101,673,833,559,681,333,490,742,687,485,436]


π”¬ Encoder Diversity (iter 9960):
  Avg similarity: 0.0755 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9514 (0.0=collapsed)
[Epoch 15/100] [Batch 604/669 (90.3%)] [Iter 9970] Loss: 1.2804 (freq: 0.4321, raw: 0.8475, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 661/1024 (64.6%) Top5:[627,433,391,101,673,687,485,601,1004,495,657,860,1022,333,654]


π”¬ Encoder Diversity (iter 9970):
  Avg similarity: 0.0943 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 15/100] [Batch 614/669 (91.8%)] [Iter 9980] Loss: 1.3120 (freq: 0.4750, raw: 0.8362, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 747/1024 (72.9%) Top5:[687,490,391,775,718,115,616,44,358,236,654,250,673,917,288]


π”¬ Encoder Diversity (iter 9980):
  Avg similarity: 0.0730 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9530 (0.0=collapsed)
[Epoch 15/100] [Batch 624/669 (93.3%)] [Iter 9990] Loss: 1.2602 (freq: 0.4129, raw: 0.8464, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[687,495,492,190,924,358,742,1022,156,559,436,91,515,490,200]


π”¬ Encoder Diversity (iter 9990):
  Avg similarity: 0.1120 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9418 (0.0=collapsed)
[Epoch 15/100] [Batch 634/669 (94.8%)] [Iter 10000] Loss: 1.3692 (freq: 0.5256, raw: 0.8427, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 695/1024 (67.9%) Top5:[236,718,687,673,559,490,860,3,358,115,966,391,917,44,796]


π”¬ Encoder Diversity (iter 10000):
  Avg similarity: 0.0753 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9481 (0.0=collapsed)
[Epoch 15/100] [Batch 644/669 (96.3%)] [Iter 10010] Loss: 0.8490 (freq: 0.2834, raw: 0.5648, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 670/1024 (65.4%) Top5:[775,391,673,627,860,718,559,742,115,882,654,44,1022,969,156]


π”¬ Encoder Diversity (iter 10010):
  Avg similarity: 0.0674 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 15/100] [Batch 654/669 (97.8%)] [Iter 10020] Loss: 1.0666 (freq: 0.3629, raw: 0.7028, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 686/1024 (67.0%) Top5:[775,146,860,490,391,44,101,718,944,170,676,627,687,754,731]


π”¬ Encoder Diversity (iter 10020):
  Avg similarity: 0.0722 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9523 (0.0=collapsed)
[Epoch 15/100] [Batch 664/669 (99.3%)] [Iter 10030] Loss: 1.1206 (freq: 0.3770, raw: 0.7426, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 723/1024 (70.6%) Top5:[490,944,775,391,44,657,718,860,654,200,6,29,917,170,115]


π”¬ Encoder Diversity (iter 10030):
  Avg similarity: 0.0646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)

================================================================================
[Epoch 15] Validation Results:
  Total Loss: 0.5839
  Freq Loss:  0.1767
  Raw Loss:   0.4064
  Quant Loss: 0.0008
  π“ Codebook Usage: 496/1024 (48.4%)
  π“ Codebook Entropy: 4.7883 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 32925 (25.3%)
  Top 10 most used codes:
    1. Code 916: 3881 times (2.98%)
    2. Code 369: 3518 times (2.70%)
    3. Code 89: 3439 times (2.64%)
    4. Code 70: 3389 times (2.60%)
    5. Code 1004: 3265 times (2.51%)
    6. Code 130: 3190 times (2.45%)
    7. Code 742: 3134 times (2.41%)
    8. Code 492: 3091 times (2.37%)
    9. Code 175: 3009 times (2.31%)
    10. Code 924: 3009 times (2.31%)
  Bottom 5 least used codes (among used):
    1. Code 155: 1 times (0.00%)
    2. Code 84: 1 times (0.00%)
    3. Code 163: 1 times (0.00%)
    4. Code 484: 1 times (0.00%)
    5. Code 341: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 16/100] [Batch 5/669 (0.7%)] [Iter 10040] Loss: 1.2122 (freq: 0.4565, raw: 0.7547, quant: 0.0010, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 1013/1024 (98.9%) Top5:[687,754,1004,742,495,175,970,738,775,91,826,107,70,8,68]


π”¬ Encoder Diversity (iter 10040):
  Avg similarity: 0.0921 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9408 (0.0=collapsed)
[Epoch 16/100] [Batch 15/669 (2.2%)] [Iter 10050] Loss: 0.8565 (freq: 0.3111, raw: 0.5446, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[742,508,1004,928,512,89,869,687,91,916,372,745,924,738,130]


π”¬ Encoder Diversity (iter 10050):
  Avg similarity: 0.0797 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 16/100] [Batch 25/669 (3.7%)] [Iter 10060] Loss: 1.2600 (freq: 0.4825, raw: 0.7766, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 758/1024 (74.0%) Top5:[916,512,969,91,687,1004,110,699,731,869,928,170,977,89,369]


π”¬ Encoder Diversity (iter 10060):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9596 (0.0=collapsed)
[Epoch 16/100] [Batch 35/669 (5.2%)] [Iter 10070] Loss: 1.1986 (freq: 0.4194, raw: 0.7784, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 733/1024 (71.6%) Top5:[919,704,512,290,803,606,230,687,316,1022,508,55,928,409,640]


π”¬ Encoder Diversity (iter 10070):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 16/100] [Batch 45/669 (6.7%)] [Iter 10080] Loss: 1.1190 (freq: 0.3996, raw: 0.7185, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 711/1024 (69.4%) Top5:[919,704,508,290,430,445,922,512,478,969,91,597,435,96,606]


π”¬ Encoder Diversity (iter 10080):
  Avg similarity: 0.0532 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 16/100] [Batch 55/669 (8.2%)] [Iter 10090] Loss: 1.2577 (freq: 0.5019, raw: 0.7549, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[916,495,445,597,919,699,687,345,770,803,836,328,606,492,928]


π”¬ Encoder Diversity (iter 10090):
  Avg similarity: 0.1051 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9414 (0.0=collapsed)
[Epoch 16/100] [Batch 65/669 (9.7%)] [Iter 10100] Loss: 0.8570 (freq: 0.2826, raw: 0.5737, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[290,328,704,508,597,687,316,512,510,803,919,55,922,947,478]


π”¬ Encoder Diversity (iter 10100):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 16/100] [Batch 75/669 (11.2%)] [Iter 10110] Loss: 0.8540 (freq: 0.3069, raw: 0.5463, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 760/1024 (74.2%) Top5:[687,170,612,579,45,875,493,495,512,928,970,91,55,317,754]


π”¬ Encoder Diversity (iter 10110):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 16/100] [Batch 85/669 (12.7%)] [Iter 10120] Loss: 1.2520 (freq: 0.4656, raw: 0.7855, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 736/1024 (71.9%) Top5:[803,606,512,704,478,316,290,922,409,571,55,313,1004,91,142]


π”¬ Encoder Diversity (iter 10120):
  Avg similarity: 0.0703 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9498 (0.0=collapsed)
[Epoch 16/100] [Batch 95/669 (14.2%)] [Iter 10130] Loss: 0.8515 (freq: 0.2696, raw: 0.5812, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 702/1024 (68.6%) Top5:[803,317,316,689,290,922,178,345,512,136,230,826,208,91,300]


π”¬ Encoder Diversity (iter 10130):
  Avg similarity: 0.0699 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9524 (0.0=collapsed)
[Epoch 16/100] [Batch 105/669 (15.7%)] [Iter 10140] Loss: 1.1593 (freq: 0.3747, raw: 0.7838, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 715/1024 (69.8%) Top5:[290,328,687,508,68,157,55,445,409,300,919,597,704,492,208]


π”¬ Encoder Diversity (iter 10140):
  Avg similarity: 0.0649 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 16/100] [Batch 115/669 (17.2%)] [Iter 10150] Loss: 1.1062 (freq: 0.4191, raw: 0.6863, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 693/1024 (67.7%) Top5:[91,8,928,1004,508,919,297,687,969,495,55,579,745,869,175]


π”¬ Encoder Diversity (iter 10150):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 16/100] [Batch 125/669 (18.7%)] [Iter 10160] Loss: 1.1817 (freq: 0.4091, raw: 0.7718, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 690/1024 (67.4%) Top5:[508,512,445,687,328,606,704,208,290,482,430,333,919,818,55]


π”¬ Encoder Diversity (iter 10160):
  Avg similarity: 0.0754 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9520 (0.0=collapsed)
[Epoch 16/100] [Batch 135/669 (20.2%)] [Iter 10170] Loss: 1.2502 (freq: 0.4404, raw: 0.8089, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 750/1024 (73.2%) Top5:[508,579,698,928,445,606,208,919,997,745,339,290,333,704,689]


π”¬ Encoder Diversity (iter 10170):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 16/100] [Batch 145/669 (21.7%)] [Iter 10180] Loss: 1.3211 (freq: 0.4642, raw: 0.8561, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[339,96,409,606,492,508,924,919,259,826,297,360,969,445,91]


π”¬ Encoder Diversity (iter 10180):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 16/100] [Batch 155/669 (23.2%)] [Iter 10190] Loss: 1.1721 (freq: 0.3796, raw: 0.7917, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[170,143,579,512,643,826,1004,290,875,470,687,508,42,493,328]


π”¬ Encoder Diversity (iter 10190):
  Avg similarity: 0.0684 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 16/100] [Batch 165/669 (24.7%)] [Iter 10200] Loss: 1.0408 (freq: 0.3846, raw: 0.6555, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[125,687,339,928,508,997,492,924,916,328,495,704,689,470,431]


π”¬ Encoder Diversity (iter 10200):
  Avg similarity: 0.0429 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9564 (0.0=collapsed)
[Epoch 16/100] [Batch 175/669 (26.2%)] [Iter 10210] Loss: 0.7437 (freq: 0.2467, raw: 0.4962, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[259,470,316,928,597,339,492,55,142,208,290,15,612,517,508]


π”¬ Encoder Diversity (iter 10210):
  Avg similarity: 0.0584 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9559 (0.0=collapsed)
[Epoch 16/100] [Batch 185/669 (27.7%)] [Iter 10220] Loss: 1.3311 (freq: 0.4741, raw: 0.8561, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 725/1024 (70.8%) Top5:[290,230,508,316,259,470,704,657,445,512,55,328,571,947,803]


π”¬ Encoder Diversity (iter 10220):
  Avg similarity: 0.0712 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9506 (0.0=collapsed)
[Epoch 16/100] [Batch 195/669 (29.1%)] [Iter 10230] Loss: 1.2287 (freq: 0.4445, raw: 0.7833, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 716/1024 (69.9%) Top5:[230,571,157,290,316,445,508,482,430,328,803,512,687,339,208]


π”¬ Encoder Diversity (iter 10230):
  Avg similarity: 0.0413 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 16/100] [Batch 205/669 (30.6%)] [Iter 10240] Loss: 1.1751 (freq: 0.3890, raw: 0.7851, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 740/1024 (72.3%) Top5:[704,657,230,571,290,208,512,470,374,335,142,157,948,445,316]


π”¬ Encoder Diversity (iter 10240):
  Avg similarity: 0.0623 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 16/100] [Batch 215/669 (32.1%)] [Iter 10250] Loss: 0.9287 (freq: 0.2977, raw: 0.6301, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 778/1024 (76.0%) Top5:[290,333,512,445,687,374,492,689,470,478,597,297,704,745,916]


π”¬ Encoder Diversity (iter 10250):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9556 (0.0=collapsed)
[Epoch 16/100] [Batch 225/669 (33.6%)] [Iter 10260] Loss: 1.0886 (freq: 0.4000, raw: 0.6878, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 746/1024 (72.9%) Top5:[826,687,445,297,492,431,742,928,70,290,91,175,969,922,307]


π”¬ Encoder Diversity (iter 10260):
  Avg similarity: 0.0750 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9473 (0.0=collapsed)
[Epoch 16/100] [Batch 235/669 (35.1%)] [Iter 10270] Loss: 1.0347 (freq: 0.3425, raw: 0.6913, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 749/1024 (73.1%) Top5:[339,687,290,826,612,704,328,512,259,657,431,91,737,297,606]


π”¬ Encoder Diversity (iter 10270):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 16/100] [Batch 245/669 (36.6%)] [Iter 10280] Loss: 1.0868 (freq: 0.3814, raw: 0.7046, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 765/1024 (74.7%) Top5:[339,96,290,175,742,492,508,826,335,512,328,579,745,687,431]


π”¬ Encoder Diversity (iter 10280):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 16/100] [Batch 255/669 (38.1%)] [Iter 10290] Loss: 1.1629 (freq: 0.4362, raw: 0.7258, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[363,495,508,339,928,297,175,826,208,431,606,687,230,157,290]


π”¬ Encoder Diversity (iter 10290):
  Avg similarity: 0.0615 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9537 (0.0=collapsed)
[Epoch 16/100] [Batch 265/669 (39.6%)] [Iter 10300] Loss: 0.9501 (freq: 0.3189, raw: 0.6304, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 775/1024 (75.7%) Top5:[687,579,969,251,643,431,143,997,492,297,495,170,435,928,875]


π”¬ Encoder Diversity (iter 10300):
  Avg similarity: 0.0620 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 16/100] [Batch 275/669 (41.1%)] [Iter 10310] Loss: 0.9551 (freq: 0.3522, raw: 0.6021, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[687,493,251,928,745,875,170,969,643,742,297,431,997,495,492]


π”¬ Encoder Diversity (iter 10310):
  Avg similarity: 0.0532 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9605 (0.0=collapsed)
[Epoch 16/100] [Batch 285/669 (42.6%)] [Iter 10320] Loss: 1.1927 (freq: 0.4413, raw: 0.7505, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[495,251,643,969,431,754,745,687,1022,297,170,4,409,493,8]


π”¬ Encoder Diversity (iter 10320):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 16/100] [Batch 295/669 (44.1%)] [Iter 10330] Loss: 1.0382 (freq: 0.3452, raw: 0.6922, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 754/1024 (73.6%) Top5:[495,290,445,230,745,96,208,969,339,512,175,687,597,91,297]


π”¬ Encoder Diversity (iter 10330):
  Avg similarity: 0.0333 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 16/100] [Batch 305/669 (45.6%)] [Iter 10340] Loss: 1.3417 (freq: 0.4914, raw: 0.8495, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 721/1024 (70.4%) Top5:[328,687,339,512,230,208,445,597,409,470,704,948,571,657,737]


π”¬ Encoder Diversity (iter 10340):
  Avg similarity: 0.0646 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9609 (0.0=collapsed)
[Epoch 16/100] [Batch 315/669 (47.1%)] [Iter 10350] Loss: 1.1814 (freq: 0.4210, raw: 0.7596, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 727/1024 (71.0%) Top5:[512,339,108,230,597,175,470,687,91,492,495,253,335,96,432]


π”¬ Encoder Diversity (iter 10350):
  Avg similarity: 0.0418 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 16/100] [Batch 325/669 (48.6%)] [Iter 10360] Loss: 1.3476 (freq: 0.4987, raw: 0.8481, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 715/1024 (69.8%) Top5:[230,445,170,704,462,512,597,657,108,470,15,290,687,495,678]


π”¬ Encoder Diversity (iter 10360):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 16/100] [Batch 335/669 (50.1%)] [Iter 10370] Loss: 1.1189 (freq: 0.4267, raw: 0.6914, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[704,687,230,290,339,208,512,597,59,919,445,478,803,470,517]


π”¬ Encoder Diversity (iter 10370):
  Avg similarity: 0.0404 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 16/100] [Batch 345/669 (51.6%)] [Iter 10380] Loss: 1.1703 (freq: 0.4143, raw: 0.7552, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[290,854,704,597,230,16,687,342,208,328,492,96,919,571,335]


π”¬ Encoder Diversity (iter 10380):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 16/100] [Batch 355/669 (53.1%)] [Iter 10390] Loss: 1.4605 (freq: 0.5634, raw: 0.8962, quant: 0.0010, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 724/1024 (70.7%) Top5:[339,208,259,290,230,687,919,445,244,606,704,350,430,803,59]


π”¬ Encoder Diversity (iter 10390):
  Avg similarity: 0.1025 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9441 (0.0=collapsed)
[Epoch 16/100] [Batch 365/669 (54.6%)] [Iter 10400] Loss: 0.9681 (freq: 0.3562, raw: 0.6110, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 762/1024 (74.4%) Top5:[335,832,290,470,230,409,339,313,59,259,96,687,99,737,704]


π”¬ Encoder Diversity (iter 10400):
  Avg similarity: 0.0603 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 16/100] [Batch 375/669 (56.1%)] [Iter 10410] Loss: 0.9030 (freq: 0.2915, raw: 0.6107, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[342,660,495,328,492,689,948,470,290,92,478,493,922,404,687]


π”¬ Encoder Diversity (iter 10410):
  Avg similarity: 0.0562 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 16/100] [Batch 385/669 (57.5%)] [Iter 10420] Loss: 1.2295 (freq: 0.4401, raw: 0.7886, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 730/1024 (71.3%) Top5:[687,774,919,754,751,290,470,108,495,59,170,922,328,175,339]


π”¬ Encoder Diversity (iter 10420):
  Avg similarity: 0.0731 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9542 (0.0=collapsed)
[Epoch 16/100] [Batch 395/669 (59.0%)] [Iter 10430] Loss: 1.0617 (freq: 0.3723, raw: 0.6885, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 717/1024 (70.0%) Top5:[230,571,339,687,977,59,698,597,703,290,342,1006,470,419,660]


π”¬ Encoder Diversity (iter 10430):
  Avg similarity: 0.0690 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 16/100] [Batch 405/669 (60.5%)] [Iter 10440] Loss: 0.9198 (freq: 0.2963, raw: 0.6228, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 737/1024 (72.0%) Top5:[687,208,919,230,339,259,175,495,660,478,291,59,342,290,108]


π”¬ Encoder Diversity (iter 10440):
  Avg similarity: 0.0422 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 16/100] [Batch 415/669 (62.0%)] [Iter 10450] Loss: 0.8063 (freq: 0.2654, raw: 0.5401, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[230,806,704,684,59,409,290,571,470,162,737,328,335,16,919]


π”¬ Encoder Diversity (iter 10450):
  Avg similarity: 0.0718 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9573 (0.0=collapsed)
[Epoch 16/100] [Batch 425/669 (63.5%)] [Iter 10460] Loss: 1.0648 (freq: 0.3909, raw: 0.6730, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[687,478,328,230,836,660,495,244,290,571,409,291,335,512,704]


π”¬ Encoder Diversity (iter 10460):
  Avg similarity: 0.0448 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 16/100] [Batch 435/669 (65.0%)] [Iter 10470] Loss: 1.2315 (freq: 0.4658, raw: 0.7647, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 723/1024 (70.6%) Top5:[230,59,495,328,704,409,512,660,290,339,597,335,259,25,616]


π”¬ Encoder Diversity (iter 10470):
  Avg similarity: 0.0855 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9518 (0.0=collapsed)
[Epoch 16/100] [Batch 445/669 (66.5%)] [Iter 10480] Loss: 0.8936 (freq: 0.2984, raw: 0.5945, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 693/1024 (67.7%) Top5:[660,512,492,290,478,83,59,495,445,339,571,328,836,493,253]


π”¬ Encoder Diversity (iter 10480):
  Avg similarity: 0.0854 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9505 (0.0=collapsed)
[Epoch 16/100] [Batch 455/669 (68.0%)] [Iter 10490] Loss: 1.2456 (freq: 0.4651, raw: 0.7797, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 697/1024 (68.1%) Top5:[328,290,59,922,948,478,409,687,703,820,470,230,512,597,25]


π”¬ Encoder Diversity (iter 10490):
  Avg similarity: 0.0659 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9515 (0.0=collapsed)
[Epoch 16/100] [Batch 465/669 (69.5%)] [Iter 10500] Loss: 1.2186 (freq: 0.4258, raw: 0.7919, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 740/1024 (72.3%) Top5:[59,948,687,754,108,328,478,660,495,493,832,571,704,430,919]


π”¬ Encoder Diversity (iter 10500):
  Avg similarity: 0.0533 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 16/100] [Batch 475/669 (71.0%)] [Iter 10510] Loss: 1.0927 (freq: 0.4065, raw: 0.6854, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 741/1024 (72.4%) Top5:[742,342,195,495,687,83,704,297,175,291,854,980,91,616,96]


π”¬ Encoder Diversity (iter 10510):
  Avg similarity: 0.0465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 16/100] [Batch 485/669 (72.5%)] [Iter 10520] Loss: 1.0584 (freq: 0.3669, raw: 0.6907, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[742,687,660,616,635,751,91,342,754,291,721,495,419,778,2]


π”¬ Encoder Diversity (iter 10520):
  Avg similarity: 0.1097 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9385 (0.0=collapsed)
[Epoch 16/100] [Batch 495/669 (74.0%)] [Iter 10530] Loss: 0.6202 (freq: 0.2039, raw: 0.4155, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 720/1024 (70.3%) Top5:[230,597,687,335,339,134,854,470,869,478,208,342,571,610,326]


π”¬ Encoder Diversity (iter 10530):
  Avg similarity: 0.0612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 16/100] [Batch 505/669 (75.5%)] [Iter 10540] Loss: 1.1934 (freq: 0.4191, raw: 0.7735, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 671/1024 (65.5%) Top5:[687,230,597,742,660,948,616,977,703,854,418,49,820,478,59]


π”¬ Encoder Diversity (iter 10540):
  Avg similarity: 0.0520 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 16/100] [Batch 515/669 (77.0%)] [Iter 10550] Loss: 1.1309 (freq: 0.4328, raw: 0.6973, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 723/1024 (70.6%) Top5:[616,635,660,897,2,419,230,492,254,83,495,980,195,298,251]


π”¬ Encoder Diversity (iter 10550):
  Avg similarity: 0.0926 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9444 (0.0=collapsed)
[Epoch 16/100] [Batch 525/669 (78.5%)] [Iter 10560] Loss: 1.1606 (freq: 0.3839, raw: 0.7760, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 688/1024 (67.2%) Top5:[470,290,335,704,96,948,478,689,684,328,432,59,660,409,339]


π”¬ Encoder Diversity (iter 10560):
  Avg similarity: 0.0605 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 16/100] [Batch 535/669 (80.0%)] [Iter 10570] Loss: 0.7144 (freq: 0.2004, raw: 0.5133, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 734/1024 (71.7%) Top5:[919,470,59,970,328,635,254,259,290,571,616,419,751,431,350]


π”¬ Encoder Diversity (iter 10570):
  Avg similarity: 0.0623 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 16/100] [Batch 545/669 (81.5%)] [Iter 10580] Loss: 1.3387 (freq: 0.4978, raw: 0.8400, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[134,59,290,854,244,678,259,16,339,704,470,335,948,328,359]


π”¬ Encoder Diversity (iter 10580):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 16/100] [Batch 555/669 (83.0%)] [Iter 10590] Loss: 1.1930 (freq: 0.4153, raw: 0.7768, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 715/1024 (69.8%) Top5:[259,660,612,948,470,230,571,59,478,836,704,897,1007,419,254]


π”¬ Encoder Diversity (iter 10590):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)
[Epoch 16/100] [Batch 565/669 (84.5%)] [Iter 10600] Loss: 0.9831 (freq: 0.3762, raw: 0.6061, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 754/1024 (73.6%) Top5:[313,339,721,597,244,492,687,59,342,660,91,328,818,751,606]


π”¬ Encoder Diversity (iter 10600):
  Avg similarity: 0.0872 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9537 (0.0=collapsed)
[Epoch 16/100] [Batch 575/669 (85.9%)] [Iter 10610] Loss: 1.0604 (freq: 0.3427, raw: 0.7169, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 776/1024 (75.8%) Top5:[470,230,290,657,588,919,339,350,689,106,660,704,25,612,59]


π”¬ Encoder Diversity (iter 10610):
  Avg similarity: 0.0442 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 16/100] [Batch 585/669 (87.4%)] [Iter 10620] Loss: 0.9719 (freq: 0.3266, raw: 0.6445, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[660,970,83,948,431,495,470,36,818,297,1007,721,980,635,96]


π”¬ Encoder Diversity (iter 10620):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 16/100] [Batch 595/669 (88.9%)] [Iter 10630] Loss: 1.0836 (freq: 0.3851, raw: 0.6977, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 745/1024 (72.8%) Top5:[470,230,409,948,108,290,328,737,930,59,687,335,336,142,83]


π”¬ Encoder Diversity (iter 10630):
  Avg similarity: 0.0592 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 16/100] [Batch 605/669 (90.4%)] [Iter 10640] Loss: 1.2088 (freq: 0.4598, raw: 0.7481, quant: 0.0010, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 745/1024 (72.8%) Top5:[635,470,96,948,512,495,335,922,980,897,259,230,571,369,328]


π”¬ Encoder Diversity (iter 10640):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9658 (0.0=collapsed)
[Epoch 16/100] [Batch 615/669 (91.9%)] [Iter 10650] Loss: 0.9795 (freq: 0.3553, raw: 0.6235, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 728/1024 (71.1%) Top5:[492,869,660,91,36,635,339,230,431,59,83,297,948,571,478]


π”¬ Encoder Diversity (iter 10650):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9515 (0.0=collapsed)
[Epoch 16/100] [Batch 625/669 (93.4%)] [Iter 10660] Loss: 0.7168 (freq: 0.2502, raw: 0.4660, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 756/1024 (73.8%) Top5:[492,846,966,36,387,339,980,83,2,478,687,342,278,635,919]


π”¬ Encoder Diversity (iter 10660):
  Avg similarity: 0.0526 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9615 (0.0=collapsed)
[Epoch 16/100] [Batch 635/669 (94.9%)] [Iter 10670] Loss: 1.1676 (freq: 0.4457, raw: 0.7211, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[687,339,59,948,597,635,832,980,478,409,966,470,335,660,328]


π”¬ Encoder Diversity (iter 10670):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 16/100] [Batch 645/669 (96.4%)] [Iter 10680] Loss: 1.0874 (freq: 0.3726, raw: 0.7140, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[930,470,948,335,290,25,818,339,445,96,230,59,571,328,919]


π”¬ Encoder Diversity (iter 10680):
  Avg similarity: 0.0617 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9535 (0.0=collapsed)
[Epoch 16/100] [Batch 655/669 (97.9%)] [Iter 10690] Loss: 1.1681 (freq: 0.4327, raw: 0.7346, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[470,339,948,335,290,328,96,678,59,108,588,597,259,832,16]


π”¬ Encoder Diversity (iter 10690):
  Avg similarity: 0.0807 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9454 (0.0=collapsed)
[Epoch 16/100] [Batch 665/669 (99.4%)] [Iter 10700] Loss: 1.2767 (freq: 0.4579, raw: 0.8179, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 764/1024 (74.6%) Top5:[328,678,290,854,922,230,350,470,478,588,430,704,840,335,108]


π”¬ Encoder Diversity (iter 10700):
  Avg similarity: 0.0737 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9551 (0.0=collapsed)

================================================================================
[Epoch 16] Validation Results:
  Total Loss: 0.5801
  Freq Loss:  0.1746
  Raw Loss:   0.4047
  Quant Loss: 0.0008
  π“ Codebook Usage: 594/1024 (58.0%)
  π“ Codebook Entropy: 4.9101 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 31505 (24.2%)
  Top 10 most used codes:
    1. Code 773: 3851 times (2.96%)
    2. Code 498: 3696 times (2.84%)
    3. Code 492: 3282 times (2.52%)
    4. Code 778: 3251 times (2.50%)
    5. Code 997: 3190 times (2.45%)
    6. Code 732: 3122 times (2.40%)
    7. Code 342: 2879 times (2.21%)
    8. Code 870: 2876 times (2.21%)
    9. Code 495: 2689 times (2.07%)
    10. Code 713: 2669 times (2.05%)
  Bottom 5 least used codes (among used):
    1. Code 824: 1 times (0.00%)
    2. Code 415: 1 times (0.00%)
    3. Code 412: 1 times (0.00%)
    4. Code 814: 2 times (0.00%)
    5. Code 293: 4 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 17/100] [Batch 6/669 (0.9%)] [Iter 10710] Loss: 1.0250 (freq: 0.3755, raw: 0.6486, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 1019/1024 (99.5%) Top5:[244,2,251,721,667,732,950,846,941,660,966,256,997,980,298]


π”¬ Encoder Diversity (iter 10710):
  Avg similarity: 0.0825 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9512 (0.0=collapsed)
[Epoch 17/100] [Batch 16/669 (2.4%)] [Iter 10720] Loss: 1.2193 (freq: 0.4390, raw: 0.7794, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 890/1024 (86.9%) Top5:[970,941,667,298,778,205,278,1022,846,254,690,99,1007,713,721]


π”¬ Encoder Diversity (iter 10720):
  Avg similarity: 0.0430 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 17/100] [Batch 26/669 (3.9%)] [Iter 10730] Loss: 0.8632 (freq: 0.3084, raw: 0.5540, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[298,980,672,853,660,713,67,732,810,498,966,322,870,488,531]


π”¬ Encoder Diversity (iter 10730):
  Avg similarity: 0.1101 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9349 (0.0=collapsed)
[Epoch 17/100] [Batch 36/669 (5.4%)] [Iter 10740] Loss: 1.0529 (freq: 0.3357, raw: 0.7165, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[67,660,278,467,405,488,298,99,846,667,980,393,722,545,851]


π”¬ Encoder Diversity (iter 10740):
  Avg similarity: 0.0468 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 17/100] [Batch 46/669 (6.9%)] [Iter 10750] Loss: 1.2115 (freq: 0.4545, raw: 0.7561, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 759/1024 (74.1%) Top5:[467,67,762,722,232,405,492,425,99,303,295,244,468,2,310]


π”¬ Encoder Diversity (iter 10750):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9701 (0.0=collapsed)
[Epoch 17/100] [Batch 56/669 (8.4%)] [Iter 10760] Loss: 1.3293 (freq: 0.4660, raw: 0.8625, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[67,492,732,2,467,983,779,329,295,935,405,193,1003,60,256]


π”¬ Encoder Diversity (iter 10760):
  Avg similarity: 0.0411 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 17/100] [Batch 66/669 (9.9%)] [Iter 10770] Loss: 1.1132 (freq: 0.4033, raw: 0.7091, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 760/1024 (74.2%) Top5:[67,628,672,468,981,449,851,352,393,935,635,278,616,2,254]


π”¬ Encoder Diversity (iter 10770):
  Avg similarity: 0.0631 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 17/100] [Batch 76/669 (11.4%)] [Iter 10780] Loss: 1.2127 (freq: 0.4419, raw: 0.7698, quant: 0.0010, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[67,468,405,1006,2,307,721,970,672,280,212,635,869,777,628]


π”¬ Encoder Diversity (iter 10780):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 17/100] [Batch 86/669 (12.9%)] [Iter 10790] Loss: 0.9798 (freq: 0.3576, raw: 0.6214, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 723/1024 (70.6%) Top5:[67,1006,468,724,280,244,488,672,307,295,357,352,981,682,23]


π”¬ Encoder Diversity (iter 10790):
  Avg similarity: 0.0814 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 17/100] [Batch 96/669 (14.3%)] [Iter 10800] Loss: 0.8617 (freq: 0.3014, raw: 0.5595, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[1006,517,935,67,405,1007,488,329,823,307,468,303,833,467,846]


π”¬ Encoder Diversity (iter 10800):
  Avg similarity: 0.0485 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 17/100] [Batch 106/669 (15.8%)] [Iter 10810] Loss: 1.0718 (freq: 0.3667, raw: 0.7043, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[869,1007,256,635,616,1006,846,467,970,966,27,673,416,2,493]


π”¬ Encoder Diversity (iter 10810):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 17/100] [Batch 116/669 (17.3%)] [Iter 10820] Loss: 1.1997 (freq: 0.4541, raw: 0.7447, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 738/1024 (72.1%) Top5:[908,244,467,70,83,869,660,790,493,966,303,297,721,381,342]


π”¬ Encoder Diversity (iter 10820):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9653 (0.0=collapsed)
[Epoch 17/100] [Batch 126/669 (18.8%)] [Iter 10830] Loss: 0.7218 (freq: 0.2390, raw: 0.4821, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 653/1024 (63.8%) Top5:[966,493,869,660,846,732,405,980,906,721,531,83,988,1022,851]


π”¬ Encoder Diversity (iter 10830):
  Avg similarity: 0.0721 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9500 (0.0=collapsed)
[Epoch 17/100] [Batch 136/669 (20.3%)] [Iter 10840] Loss: 0.7978 (freq: 0.2592, raw: 0.5378, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[545,966,851,672,467,549,915,754,878,342,833,212,174,846,493]


π”¬ Encoder Diversity (iter 10840):
  Avg similarity: 0.0639 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9495 (0.0=collapsed)
[Epoch 17/100] [Batch 146/669 (21.8%)] [Iter 10850] Loss: 1.2227 (freq: 0.4627, raw: 0.7592, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 718/1024 (70.1%) Top5:[352,517,67,468,378,851,1006,307,724,52,833,823,856,329,280]


π”¬ Encoder Diversity (iter 10850):
  Avg similarity: 0.0743 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9509 (0.0=collapsed)
[Epoch 17/100] [Batch 156/669 (23.3%)] [Iter 10860] Loss: 1.2244 (freq: 0.4655, raw: 0.7581, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 758/1024 (74.0%) Top5:[467,329,67,468,303,983,545,205,342,60,433,174,628,488,393]


π”¬ Encoder Diversity (iter 10860):
  Avg similarity: 0.0740 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9539 (0.0=collapsed)
[Epoch 17/100] [Batch 166/669 (24.8%)] [Iter 10870] Loss: 0.8557 (freq: 0.2668, raw: 0.5880, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 732/1024 (71.5%) Top5:[67,193,205,468,174,1006,357,950,517,672,628,307,378,159,280]


π”¬ Encoder Diversity (iter 10870):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 17/100] [Batch 176/669 (26.3%)] [Iter 10880] Loss: 1.0912 (freq: 0.3812, raw: 0.7091, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[352,467,99,910,1006,983,405,981,468,393,433,935,425,966,616]


π”¬ Encoder Diversity (iter 10880):
  Avg similarity: 0.0740 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 17/100] [Batch 186/669 (27.8%)] [Iter 10890] Loss: 0.8893 (freq: 0.2953, raw: 0.5932, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[467,433,493,628,660,732,67,910,352,966,983,1022,1006,678,254]


π”¬ Encoder Diversity (iter 10890):
  Avg similarity: 0.0367 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 17/100] [Batch 196/669 (29.3%)] [Iter 10900] Loss: 1.1688 (freq: 0.3962, raw: 0.7717, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[467,1022,966,762,493,393,492,846,628,357,869,425,910,352,70]


π”¬ Encoder Diversity (iter 10900):
  Avg similarity: 0.0455 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 17/100] [Batch 206/669 (30.8%)] [Iter 10910] Loss: 1.1363 (freq: 0.4114, raw: 0.7240, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[2,351,616,493,966,468,1022,1006,198,467,491,950,721,254,67]


π”¬ Encoder Diversity (iter 10910):
  Avg similarity: 0.0414 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 17/100] [Batch 216/669 (32.3%)] [Iter 10920] Loss: 1.1493 (freq: 0.3838, raw: 0.7646, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[468,1006,99,67,223,280,545,433,488,205,823,440,517,416,455]


π”¬ Encoder Diversity (iter 10920):
  Avg similarity: 0.0677 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 17/100] [Batch 226/669 (33.8%)] [Iter 10930] Loss: 1.2707 (freq: 0.4473, raw: 0.8224, quant: 0.0010, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[468,67,416,329,983,672,833,482,722,823,1006,378,810,280,223]


π”¬ Encoder Diversity (iter 10930):
  Avg similarity: 0.0959 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9436 (0.0=collapsed)
[Epoch 17/100] [Batch 236/669 (35.3%)] [Iter 10940] Loss: 0.9376 (freq: 0.3425, raw: 0.5943, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 736/1024 (71.9%) Top5:[67,468,488,440,467,329,545,983,823,352,1006,351,790,346,810]


π”¬ Encoder Diversity (iter 10940):
  Avg similarity: 0.0465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 17/100] [Batch 246/669 (36.8%)] [Iter 10950] Loss: 1.1774 (freq: 0.4024, raw: 0.7741, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[616,67,467,468,1007,380,159,615,980,908,488,493,915,491,236]


π”¬ Encoder Diversity (iter 10950):
  Avg similarity: 0.0809 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 17/100] [Batch 256/669 (38.3%)] [Iter 10960] Loss: 1.0806 (freq: 0.3626, raw: 0.7172, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 753/1024 (73.5%) Top5:[468,1006,405,672,455,127,935,433,488,966,810,346,915,67,303]


π”¬ Encoder Diversity (iter 10960):
  Avg similarity: 0.0323 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 17/100] [Batch 266/669 (39.8%)] [Iter 10970] Loss: 1.0956 (freq: 0.4217, raw: 0.6730, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[935,67,455,672,467,405,352,856,980,205,517,127,492,280,628]


π”¬ Encoder Diversity (iter 10970):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9574 (0.0=collapsed)
[Epoch 17/100] [Batch 276/669 (41.3%)] [Iter 10980] Loss: 1.3330 (freq: 0.4597, raw: 0.8724, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 750/1024 (73.2%) Top5:[935,67,616,351,2,488,405,492,569,425,980,915,837,810,380]


π”¬ Encoder Diversity (iter 10980):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 17/100] [Batch 286/669 (42.8%)] [Iter 10990] Loss: 1.1101 (freq: 0.3769, raw: 0.7324, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 737/1024 (72.0%) Top5:[672,935,127,433,412,488,983,99,280,468,346,67,833,352,908]


π”¬ Encoder Diversity (iter 10990):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 17/100] [Batch 296/669 (44.2%)] [Iter 11000] Loss: 1.3380 (freq: 0.4996, raw: 0.8375, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[346,672,488,983,433,60,614,449,467,468,970,722,159,549,351]


π”¬ Encoder Diversity (iter 11000):
  Avg similarity: 0.0515 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9546 (0.0=collapsed)
[Epoch 17/100] [Batch 306/669 (45.7%)] [Iter 11010] Loss: 1.0966 (freq: 0.3750, raw: 0.7208, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 748/1024 (73.0%) Top5:[468,614,517,67,198,980,351,763,672,935,329,1006,433,1022,378]


π”¬ Encoder Diversity (iter 11010):
  Avg similarity: 0.0410 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 17/100] [Batch 316/669 (47.2%)] [Iter 11020] Loss: 1.0321 (freq: 0.3574, raw: 0.6738, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 740/1024 (72.3%) Top5:[468,67,329,1022,846,935,1006,455,381,2,488,467,822,672,980]


π”¬ Encoder Diversity (iter 11020):
  Avg similarity: 0.0556 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9571 (0.0=collapsed)
[Epoch 17/100] [Batch 326/669 (48.7%)] [Iter 11030] Loss: 1.4280 (freq: 0.5446, raw: 0.8824, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[468,488,67,40,467,672,425,910,1006,935,826,99,878,346,127]


π”¬ Encoder Diversity (iter 11030):
  Avg similarity: 0.0669 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9585 (0.0=collapsed)
[Epoch 17/100] [Batch 336/669 (50.2%)] [Iter 11040] Loss: 0.9619 (freq: 0.3360, raw: 0.6252, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[488,468,616,303,615,569,673,672,221,46,67,467,1007,980,127]


π”¬ Encoder Diversity (iter 11040):
  Avg similarity: 0.0713 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9555 (0.0=collapsed)
[Epoch 17/100] [Batch 346/669 (51.7%)] [Iter 11050] Loss: 1.1837 (freq: 0.4376, raw: 0.7452, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[433,303,67,1006,628,329,673,823,468,2,762,856,983,488,127]


π”¬ Encoder Diversity (iter 11050):
  Avg similarity: 0.0972 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9384 (0.0=collapsed)
[Epoch 17/100] [Batch 356/669 (53.2%)] [Iter 11060] Loss: 0.9562 (freq: 0.3032, raw: 0.6521, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 774/1024 (75.6%) Top5:[488,177,790,425,468,1006,433,878,205,467,616,851,125,823,549]


π”¬ Encoder Diversity (iter 11060):
  Avg similarity: 0.0790 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9545 (0.0=collapsed)
[Epoch 17/100] [Batch 366/669 (54.7%)] [Iter 11070] Loss: 1.3282 (freq: 0.4842, raw: 0.8432, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[823,405,1022,846,351,488,467,272,2,378,449,99,433,40,455]


π”¬ Encoder Diversity (iter 11070):
  Avg similarity: 0.0714 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9520 (0.0=collapsed)
[Epoch 17/100] [Batch 376/669 (56.2%)] [Iter 11080] Loss: 1.2307 (freq: 0.4586, raw: 0.7712, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[467,488,127,966,99,405,60,425,822,40,856,391,614,1006,67]


π”¬ Encoder Diversity (iter 11080):
  Avg similarity: 0.0540 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 17/100] [Batch 386/669 (57.7%)] [Iter 11090] Loss: 1.1019 (freq: 0.3955, raw: 0.7055, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 787/1024 (76.9%) Top5:[67,468,352,672,433,1006,727,127,846,629,1007,980,2,856,280]


π”¬ Encoder Diversity (iter 11090):
  Avg similarity: 0.0730 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 17/100] [Batch 396/669 (59.2%)] [Iter 11100] Loss: 1.1091 (freq: 0.4060, raw: 0.7023, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[673,491,198,46,2,935,727,980,329,352,846,616,879,614,488]


π”¬ Encoder Diversity (iter 11100):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 17/100] [Batch 406/669 (60.7%)] [Iter 11110] Loss: 0.7235 (freq: 0.2340, raw: 0.4888, quant: 0.0007, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[351,980,492,12,198,468,2,491,1022,467,826,352,948,433,280]


π”¬ Encoder Diversity (iter 11110):
  Avg similarity: 0.0385 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9690 (0.0=collapsed)
[Epoch 17/100] [Batch 416/669 (62.2%)] [Iter 11120] Loss: 1.1447 (freq: 0.4517, raw: 0.6921, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[1006,629,449,127,405,672,467,455,468,23,628,433,935,272,134]


π”¬ Encoder Diversity (iter 11120):
  Avg similarity: 0.0593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 17/100] [Batch 426/669 (63.7%)] [Iter 11130] Loss: 1.2798 (freq: 0.4388, raw: 0.8400, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[449,468,467,108,40,279,649,289,878,405,910,826,99,67,174]


π”¬ Encoder Diversity (iter 11130):
  Avg similarity: 0.0708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9584 (0.0=collapsed)
[Epoch 17/100] [Batch 436/669 (65.2%)] [Iter 11140] Loss: 1.0495 (freq: 0.3406, raw: 0.7080, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 728/1024 (71.1%) Top5:[468,67,455,433,99,980,378,492,616,221,878,574,672,46,127]


π”¬ Encoder Diversity (iter 11140):
  Avg similarity: 0.0393 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 17/100] [Batch 446/669 (66.7%)] [Iter 11150] Loss: 1.3758 (freq: 0.5190, raw: 0.8559, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[468,405,67,1006,134,549,433,2,99,467,108,983,289,672,425]


π”¬ Encoder Diversity (iter 11150):
  Avg similarity: 0.0967 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9474 (0.0=collapsed)
[Epoch 17/100] [Batch 456/669 (68.2%)] [Iter 11160] Loss: 1.1084 (freq: 0.3892, raw: 0.7182, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[468,433,672,935,67,549,99,425,378,878,127,173,629,810,27]


π”¬ Encoder Diversity (iter 11160):
  Avg similarity: 0.0585 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9640 (0.0=collapsed)
[Epoch 17/100] [Batch 466/669 (69.7%)] [Iter 11170] Loss: 1.0636 (freq: 0.3359, raw: 0.7269, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 735/1024 (71.8%) Top5:[468,433,488,2,672,405,822,856,851,833,492,448,616,549,127]


π”¬ Encoder Diversity (iter 11170):
  Avg similarity: 0.0518 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 17/100] [Batch 476/669 (71.2%)] [Iter 11180] Loss: 0.9643 (freq: 0.3609, raw: 0.6025, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[223,378,425,67,4,672,468,488,810,352,673,948,935,303,174]


π”¬ Encoder Diversity (iter 11180):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 17/100] [Batch 486/669 (72.6%)] [Iter 11190] Loss: 0.8845 (freq: 0.3012, raw: 0.5824, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 772/1024 (75.4%) Top5:[980,468,95,352,122,616,826,812,634,727,46,407,661,198,127]


π”¬ Encoder Diversity (iter 11190):
  Avg similarity: 0.0473 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 17/100] [Batch 496/669 (74.1%)] [Iter 11200] Loss: 0.9170 (freq: 0.3096, raw: 0.6066, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[378,223,488,467,198,2,1006,433,722,236,329,878,393,99,67]


π”¬ Encoder Diversity (iter 11200):
  Avg similarity: 0.0534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 17/100] [Batch 506/669 (75.6%)] [Iter 11210] Loss: 1.0458 (freq: 0.3649, raw: 0.6802, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[468,672,628,980,673,174,146,478,614,99,472,127,134,351,765]


π”¬ Encoder Diversity (iter 11210):
  Avg similarity: 0.0523 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9665 (0.0=collapsed)
[Epoch 17/100] [Batch 516/669 (77.1%)] [Iter 11220] Loss: 1.1877 (freq: 0.4420, raw: 0.7449, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[378,99,823,468,122,467,237,329,980,433,461,722,826,60,279]


π”¬ Encoder Diversity (iter 11220):
  Avg similarity: 0.0542 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9550 (0.0=collapsed)
[Epoch 17/100] [Batch 526/669 (78.6%)] [Iter 11230] Loss: 1.0796 (freq: 0.3700, raw: 0.7087, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 730/1024 (71.3%) Top5:[303,378,122,468,560,67,488,672,221,754,846,822,803,615,407]


π”¬ Encoder Diversity (iter 11230):
  Avg similarity: 0.0796 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9497 (0.0=collapsed)
[Epoch 17/100] [Batch 536/669 (80.1%)] [Iter 11240] Loss: 0.9461 (freq: 0.3066, raw: 0.6387, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[67,378,108,468,433,856,303,467,1006,833,826,488,661,846,4]


π”¬ Encoder Diversity (iter 11240):
  Avg similarity: 0.0661 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 17/100] [Batch 546/669 (81.6%)] [Iter 11250] Loss: 1.0824 (freq: 0.3885, raw: 0.6931, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[488,468,935,99,108,879,492,274,67,856,352,433,754,661,727]


π”¬ Encoder Diversity (iter 11250):
  Avg similarity: 0.0472 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 17/100] [Batch 556/669 (83.1%)] [Iter 11260] Loss: 1.0603 (freq: 0.3992, raw: 0.6602, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[468,433,672,99,467,833,935,378,826,823,271,67,878,279,177]


π”¬ Encoder Diversity (iter 11260):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 17/100] [Batch 566/669 (84.6%)] [Iter 11270] Loss: 1.0905 (freq: 0.3941, raw: 0.6955, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 766/1024 (74.8%) Top5:[223,722,271,125,433,488,177,1006,428,468,378,67,628,461,99]


π”¬ Encoder Diversity (iter 11270):
  Avg similarity: 0.0846 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9578 (0.0=collapsed)
[Epoch 17/100] [Batch 576/669 (86.1%)] [Iter 11280] Loss: 1.2650 (freq: 0.4447, raw: 0.8195, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 751/1024 (73.3%) Top5:[468,67,378,433,574,223,412,672,177,329,335,878,455,517,488]


π”¬ Encoder Diversity (iter 11280):
  Avg similarity: 0.0404 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 17/100] [Batch 586/669 (87.6%)] [Iter 11290] Loss: 0.9410 (freq: 0.3352, raw: 0.6050, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 752/1024 (73.4%) Top5:[614,6,472,274,198,714,448,128,447,95,2,639,822,173,955]


π”¬ Encoder Diversity (iter 11290):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9557 (0.0=collapsed)
[Epoch 17/100] [Batch 596/669 (89.1%)] [Iter 11300] Loss: 1.2950 (freq: 0.4842, raw: 0.8099, quant: 0.0010, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 755/1024 (73.7%) Top5:[468,672,127,488,378,352,440,433,223,108,6,964,467,629,177]


π”¬ Encoder Diversity (iter 11300):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9548 (0.0=collapsed)
[Epoch 17/100] [Batch 606/669 (90.6%)] [Iter 11310] Loss: 1.0533 (freq: 0.3454, raw: 0.7071, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 773/1024 (75.5%) Top5:[108,433,6,878,468,67,378,472,352,488,935,134,177,289,36]


π”¬ Encoder Diversity (iter 11310):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 17/100] [Batch 616/669 (92.1%)] [Iter 11320] Loss: 1.4353 (freq: 0.5257, raw: 0.9087, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[67,468,99,378,467,223,303,1006,271,177,289,803,935,36,125]


π”¬ Encoder Diversity (iter 11320):
  Avg similarity: 0.0652 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9545 (0.0=collapsed)
[Epoch 17/100] [Batch 626/669 (93.6%)] [Iter 11330] Loss: 1.3589 (freq: 0.4894, raw: 0.8686, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[32,488,378,99,800,127,672,108,279,2,134,271,468,634,6]


π”¬ Encoder Diversity (iter 11330):
  Avg similarity: 0.0476 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 17/100] [Batch 636/669 (95.1%)] [Iter 11340] Loss: 1.2830 (freq: 0.4624, raw: 0.8197, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[468,378,433,329,99,67,467,1006,833,237,271,127,177,614,221]


π”¬ Encoder Diversity (iter 11340):
  Avg similarity: 0.0907 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9514 (0.0=collapsed)
[Epoch 17/100] [Batch 646/669 (96.6%)] [Iter 11350] Loss: 1.1806 (freq: 0.4148, raw: 0.7649, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[1006,433,95,468,672,983,272,629,833,99,488,221,378,803,810]


π”¬ Encoder Diversity (iter 11350):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 17/100] [Batch 656/669 (98.1%)] [Iter 11360] Loss: 1.1130 (freq: 0.3832, raw: 0.7289, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 747/1024 (72.9%) Top5:[468,672,433,378,134,901,198,574,569,786,614,352,67,51,472]


π”¬ Encoder Diversity (iter 11360):
  Avg similarity: 0.0630 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 17/100] [Batch 666/669 (99.6%)] [Iter 11370] Loss: 0.9712 (freq: 0.3399, raw: 0.6304, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[856,569,468,221,108,177,947,634,95,378,901,67,833,237,948]


π”¬ Encoder Diversity (iter 11370):
  Avg similarity: 0.0417 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9671 (0.0=collapsed)

================================================================================
[Epoch 17] Validation Results:
  Total Loss: 0.5805
  Freq Loss:  0.1771
  Raw Loss:   0.4025
  Quant Loss: 0.0009
  π“ Codebook Usage: 395/1024 (38.6%)
  π“ Codebook Entropy: 4.3780 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 33444 (25.7%)
  Top 10 most used codes:
    1. Code 568: 4022 times (3.09%)
    2. Code 229: 3781 times (2.90%)
    3. Code 948: 3655 times (2.81%)
    4. Code 95: 3526 times (2.71%)
    5. Code 800: 3430 times (2.63%)
    6. Code 514: 3298 times (2.53%)
    7. Code 204: 3007 times (2.31%)
    8. Code 221: 2972 times (2.28%)
    9. Code 492: 2953 times (2.27%)
    10. Code 569: 2800 times (2.15%)
  Bottom 5 least used codes (among used):
    1. Code 582: 1 times (0.00%)
    2. Code 423: 1 times (0.00%)
    3. Code 602: 1 times (0.00%)
    4. Code 794: 1 times (0.00%)
    5. Code 126: 2 times (0.00%)
================================================================================

[EarlyStopping] Patience 3/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 18/100] [Batch 7/669 (1.0%)] [Iter 11380] Loss: 1.1104 (freq: 0.3997, raw: 0.7098, quant: 0.0009, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 1020/1024 (99.6%) Top5:[841,569,1009,851,6,948,549,812,560,447,198,274,397,1006,568]


π”¬ Encoder Diversity (iter 11380):
  Avg similarity: 0.0627 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9452 (0.0=collapsed)
[Epoch 18/100] [Batch 17/669 (2.5%)] [Iter 11390] Loss: 0.8611 (freq: 0.3044, raw: 0.5559, quant: 0.0008, domain: 0.0000) LR: 1.99e-05 
π“ Codebook: 895/1024 (87.4%) Top5:[557,569,500,549,786,901,812,407,633,20,634,841,775,486,445]


π”¬ Encoder Diversity (iter 11390):
  Avg similarity: 0.0676 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 18/100] [Batch 27/669 (4.0%)] [Iter 11400] Loss: 1.1698 (freq: 0.3989, raw: 0.7701, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[775,569,596,397,948,848,386,991,545,486,549,221,520,2,715]


π”¬ Encoder Diversity (iter 11400):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 18/100] [Batch 37/669 (5.5%)] [Iter 11410] Loss: 1.1974 (freq: 0.4649, raw: 0.7316, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 780/1024 (76.2%) Top5:[445,775,848,901,486,557,339,170,874,305,274,682,755,215,500]


π”¬ Encoder Diversity (iter 11410):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 18/100] [Batch 47/669 (7.0%)] [Iter 11420] Loss: 1.2301 (freq: 0.4897, raw: 0.7395, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[775,1009,646,424,39,991,755,880,770,339,142,274,606,848,305]


π”¬ Encoder Diversity (iter 11420):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 18/100] [Batch 57/669 (8.5%)] [Iter 11430] Loss: 0.9450 (freq: 0.3076, raw: 0.6365, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 773/1024 (75.5%) Top5:[274,786,901,755,472,549,431,775,500,520,445,569,988,682,841]


π”¬ Encoder Diversity (iter 11430):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 18/100] [Batch 67/669 (10.0%)] [Iter 11440] Loss: 1.3255 (freq: 0.4634, raw: 0.8612, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[755,682,775,339,849,639,549,39,708,841,965,616,959,1022,424]


π”¬ Encoder Diversity (iter 11440):
  Avg similarity: 0.0496 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 18/100] [Batch 77/669 (11.5%)] [Iter 11450] Loss: 0.7992 (freq: 0.2532, raw: 0.5453, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[755,98,142,775,448,274,614,988,305,431,397,156,486,39,35]


π”¬ Encoder Diversity (iter 11450):
  Avg similarity: 0.0650 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 18/100] [Batch 87/669 (13.0%)] [Iter 11460] Loss: 1.2220 (freq: 0.4472, raw: 0.7740, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 780/1024 (76.2%) Top5:[486,221,755,472,988,98,661,904,95,800,198,775,786,386,682]


π”¬ Encoder Diversity (iter 11460):
  Avg similarity: 0.0684 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9523 (0.0=collapsed)
[Epoch 18/100] [Batch 97/669 (14.5%)] [Iter 11470] Loss: 0.7858 (freq: 0.2760, raw: 0.5091, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[486,445,755,98,851,728,305,183,639,138,786,988,549,474,538]


π”¬ Encoder Diversity (iter 11470):
  Avg similarity: 0.0797 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 18/100] [Batch 107/669 (16.0%)] [Iter 11480] Loss: 1.1102 (freq: 0.3897, raw: 0.7195, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[755,445,142,948,486,98,904,167,639,339,425,682,95,905,156]


π”¬ Encoder Diversity (iter 11480):
  Avg similarity: 0.0843 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 18/100] [Batch 117/669 (17.5%)] [Iter 11490] Loss: 0.9655 (freq: 0.3479, raw: 0.6168, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 764/1024 (74.6%) Top5:[486,755,121,167,549,142,564,818,339,472,905,492,274,765,639]


π”¬ Encoder Diversity (iter 11490):
  Avg similarity: 0.0449 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 18/100] [Batch 127/669 (19.0%)] [Iter 11500] Loss: 1.1825 (freq: 0.3970, raw: 0.7847, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 763/1024 (74.5%) Top5:[339,755,539,520,240,119,775,965,848,545,770,728,305,799,156]


π”¬ Encoder Diversity (iter 11500):
  Avg similarity: 0.0546 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 18/100] [Batch 137/669 (20.5%)] [Iter 11510] Loss: 1.2320 (freq: 0.4583, raw: 0.7728, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[755,156,26,339,775,520,500,645,98,142,874,486,616,799,240]


π”¬ Encoder Diversity (iter 11510):
  Avg similarity: 0.0908 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9437 (0.0=collapsed)
[Epoch 18/100] [Batch 147/669 (22.0%)] [Iter 11520] Loss: 1.2098 (freq: 0.4127, raw: 0.7961, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[156,98,305,431,775,274,198,26,204,786,874,142,799,520,486]


π”¬ Encoder Diversity (iter 11520):
  Avg similarity: 0.0642 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9562 (0.0=collapsed)
[Epoch 18/100] [Batch 157/669 (23.5%)] [Iter 11530] Loss: 1.2182 (freq: 0.4400, raw: 0.7773, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[142,486,849,98,26,156,520,775,965,792,539,616,755,52,278]


π”¬ Encoder Diversity (iter 11530):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 18/100] [Batch 167/669 (25.0%)] [Iter 11540] Loss: 0.4770 (freq: 0.1331, raw: 0.3431, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[786,800,26,614,6,198,221,948,32,1022,2,244,472,407,569]


π”¬ Encoder Diversity (iter 11540):
  Avg similarity: 0.0388 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9681 (0.0=collapsed)
[Epoch 18/100] [Batch 177/669 (26.5%)] [Iter 11550] Loss: 0.9145 (freq: 0.3399, raw: 0.5737, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 769/1024 (75.1%) Top5:[988,198,472,786,646,614,183,486,32,617,305,525,769,639,204]


π”¬ Encoder Diversity (iter 11550):
  Avg similarity: 0.0434 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 18/100] [Batch 187/669 (28.0%)] [Iter 11560] Loss: 1.0957 (freq: 0.4018, raw: 0.6930, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[614,988,198,290,948,6,32,639,472,244,335,407,800,645,240]


π”¬ Encoder Diversity (iter 11560):
  Avg similarity: 0.0944 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9459 (0.0=collapsed)
[Epoch 18/100] [Batch 197/669 (29.4%)] [Iter 11570] Loss: 1.3193 (freq: 0.4673, raw: 0.8511, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[156,682,799,120,755,240,35,520,988,456,715,152,291,215,97]


π”¬ Encoder Diversity (iter 11570):
  Avg similarity: 0.0480 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 18/100] [Batch 207/669 (30.9%)] [Iter 11580] Loss: 0.9175 (freq: 0.3218, raw: 0.5948, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[156,755,775,6,965,843,39,682,988,569,456,322,818,614,525]


π”¬ Encoder Diversity (iter 11580):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 18/100] [Batch 217/669 (32.4%)] [Iter 11590] Loss: 0.7118 (freq: 0.2418, raw: 0.4693, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[614,274,322,525,198,569,6,765,486,414,755,51,646,204,818]


π”¬ Encoder Diversity (iter 11590):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 18/100] [Batch 227/669 (33.9%)] [Iter 11600] Loss: 0.9784 (freq: 0.2866, raw: 0.6910, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[274,755,614,948,486,769,229,431,634,32,472,386,204,775,291]


π”¬ Encoder Diversity (iter 11600):
  Avg similarity: 0.0722 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 18/100] [Batch 237/669 (35.4%)] [Iter 11610] Loss: 1.0922 (freq: 0.4114, raw: 0.6799, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[708,486,156,26,339,305,35,965,616,715,183,682,988,278,849]


π”¬ Encoder Diversity (iter 11610):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 18/100] [Batch 247/669 (36.9%)] [Iter 11620] Loss: 0.9450 (freq: 0.3258, raw: 0.6183, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[486,6,156,786,98,639,339,988,520,198,240,52,769,586,456]


π”¬ Encoder Diversity (iter 11620):
  Avg similarity: 0.0664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9612 (0.0=collapsed)
[Epoch 18/100] [Batch 257/669 (38.4%)] [Iter 11630] Loss: 0.8371 (freq: 0.2760, raw: 0.5603, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 752/1024 (73.4%) Top5:[198,988,6,617,156,63,305,661,32,274,799,616,407,26,792]


π”¬ Encoder Diversity (iter 11630):
  Avg similarity: 0.0909 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9477 (0.0=collapsed)
[Epoch 18/100] [Batch 267/669 (39.9%)] [Iter 11640] Loss: 0.9556 (freq: 0.3428, raw: 0.6120, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 768/1024 (75.0%) Top5:[755,792,305,156,142,339,769,183,456,988,6,545,407,634,555]


π”¬ Encoder Diversity (iter 11640):
  Avg similarity: 0.0618 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 18/100] [Batch 277/669 (41.4%)] [Iter 11650] Loss: 0.8747 (freq: 0.3045, raw: 0.5693, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[198,274,766,860,614,769,786,569,55,801,818,32,1004,867,407]


π”¬ Encoder Diversity (iter 11650):
  Avg similarity: 0.0469 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9628 (0.0=collapsed)
[Epoch 18/100] [Batch 287/669 (42.9%)] [Iter 11660] Loss: 1.4152 (freq: 0.5053, raw: 0.9089, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 794/1024 (77.5%) Top5:[215,988,156,339,520,142,755,486,382,386,234,331,456,639,646]


π”¬ Encoder Diversity (iter 11660):
  Avg similarity: 0.0450 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 18/100] [Batch 297/669 (44.4%)] [Iter 11670] Loss: 0.9787 (freq: 0.3513, raw: 0.6264, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 772/1024 (75.4%) Top5:[755,40,339,305,775,520,988,322,183,382,848,708,832,215,56]


π”¬ Encoder Diversity (iter 11670):
  Avg similarity: 0.0509 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 18/100] [Batch 307/669 (45.9%)] [Iter 11680] Loss: 0.6879 (freq: 0.2112, raw: 0.4759, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[631,472,40,456,755,792,32,56,775,769,525,621,988,639,848]


π”¬ Encoder Diversity (iter 11680):
  Avg similarity: 0.0966 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9518 (0.0=collapsed)
[Epoch 18/100] [Batch 317/669 (47.4%)] [Iter 11690] Loss: 1.1708 (freq: 0.3856, raw: 0.7843, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 771/1024 (75.3%) Top5:[152,786,32,848,970,988,500,948,56,322,569,407,198,947,504]


π”¬ Encoder Diversity (iter 11690):
  Avg similarity: 0.0747 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9524 (0.0=collapsed)
[Epoch 18/100] [Batch 327/669 (48.9%)] [Iter 11700] Loss: 1.2054 (freq: 0.4192, raw: 0.7855, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[305,322,851,988,121,500,728,792,848,40,755,142,386,799,183]


π”¬ Encoder Diversity (iter 11700):
  Avg similarity: 0.0730 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 18/100] [Batch 337/669 (50.4%)] [Iter 11710] Loss: 1.0496 (freq: 0.3580, raw: 0.6907, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[851,965,305,715,382,545,1012,386,616,775,799,95,264,645,988]


π”¬ Encoder Diversity (iter 11710):
  Avg similarity: 0.0972 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9502 (0.0=collapsed)
[Epoch 18/100] [Batch 347/669 (51.9%)] [Iter 11720] Loss: 1.3299 (freq: 0.4951, raw: 0.8340, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 783/1024 (76.5%) Top5:[142,849,486,851,775,965,183,755,56,152,545,792,539,616,121]


π”¬ Encoder Diversity (iter 11720):
  Avg similarity: 0.0763 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9472 (0.0=collapsed)
[Epoch 18/100] [Batch 357/669 (53.4%)] [Iter 11730] Loss: 1.2044 (freq: 0.4273, raw: 0.7762, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[988,947,486,520,32,182,473,822,198,320,431,661,545,591,204]


π”¬ Encoder Diversity (iter 11730):
  Avg similarity: 0.0357 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9693 (0.0=collapsed)
[Epoch 18/100] [Batch 367/669 (54.9%)] [Iter 11740] Loss: 1.0490 (freq: 0.3792, raw: 0.6689, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[786,472,291,6,244,39,948,736,32,486,800,634,586,431,156]


π”¬ Encoder Diversity (iter 11740):
  Avg similarity: 0.0573 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 18/100] [Batch 377/669 (56.4%)] [Iter 11750] Loss: 0.9553 (freq: 0.3407, raw: 0.6137, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[183,614,708,988,119,965,849,331,305,274,6,539,639,142,56]


π”¬ Encoder Diversity (iter 11750):
  Avg similarity: 0.0420 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 18/100] [Batch 387/669 (57.8%)] [Iter 11760] Loss: 1.4435 (freq: 0.5149, raw: 0.9276, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[849,965,142,539,728,456,183,305,26,988,322,56,755,395,792]


π”¬ Encoder Diversity (iter 11760):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9685 (0.0=collapsed)
[Epoch 18/100] [Batch 397/669 (59.3%)] [Iter 11770] Loss: 0.9563 (freq: 0.3289, raw: 0.6266, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[40,924,156,988,98,183,586,525,545,198,792,26,970,472,6]


π”¬ Encoder Diversity (iter 11770):
  Avg similarity: 0.0612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9590 (0.0=collapsed)
[Epoch 18/100] [Batch 407/669 (60.8%)] [Iter 11780] Loss: 1.1729 (freq: 0.3773, raw: 0.7948, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[183,40,244,970,407,822,486,736,924,274,364,525,830,504,156]


π”¬ Encoder Diversity (iter 11780):
  Avg similarity: 0.0662 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9513 (0.0=collapsed)
[Epoch 18/100] [Batch 417/669 (62.3%)] [Iter 11790] Loss: 1.0033 (freq: 0.3311, raw: 0.6713, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[775,924,244,29,35,26,6,382,631,939,142,472,988,715,229]


π”¬ Encoder Diversity (iter 11790):
  Avg similarity: 0.0685 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9571 (0.0=collapsed)
[Epoch 18/100] [Batch 427/669 (63.8%)] [Iter 11800] Loss: 1.4985 (freq: 0.6019, raw: 0.8957, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[486,775,26,792,142,56,848,645,6,591,364,322,1012,198,755]


π”¬ Encoder Diversity (iter 11800):
  Avg similarity: 0.0738 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9473 (0.0=collapsed)
[Epoch 18/100] [Batch 437/669 (65.3%)] [Iter 11810] Loss: 0.8183 (freq: 0.2643, raw: 0.5533, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[142,320,755,734,947,775,229,234,830,121,472,948,569,32,849]


π”¬ Encoder Diversity (iter 11810):
  Avg similarity: 0.0703 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 18/100] [Batch 447/669 (66.8%)] [Iter 11820] Loss: 1.1816 (freq: 0.3958, raw: 0.7850, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[29,545,156,142,322,988,198,472,792,848,786,98,503,775,614]


π”¬ Encoder Diversity (iter 11820):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 18/100] [Batch 457/669 (68.3%)] [Iter 11830] Loss: 1.1131 (freq: 0.4093, raw: 0.7030, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 790/1024 (77.1%) Top5:[734,322,631,924,198,996,431,821,715,472,545,830,799,728,56]


π”¬ Encoder Diversity (iter 11830):
  Avg similarity: 0.0902 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9518 (0.0=collapsed)
[Epoch 18/100] [Batch 467/669 (69.8%)] [Iter 11840] Loss: 1.0907 (freq: 0.3654, raw: 0.7244, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[1012,56,848,708,841,965,52,29,851,1022,988,830,639,156,775]


π”¬ Encoder Diversity (iter 11840):
  Avg similarity: 0.0479 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9676 (0.0=collapsed)
[Epoch 18/100] [Batch 477/669 (71.3%)] [Iter 11850] Loss: 1.0851 (freq: 0.3877, raw: 0.6966, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[183,848,1012,486,142,456,849,996,322,729,121,504,775,320,734]


π”¬ Encoder Diversity (iter 11850):
  Avg similarity: 0.0628 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 18/100] [Batch 487/669 (72.8%)] [Iter 11860] Loss: 1.1582 (freq: 0.4139, raw: 0.7434, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 842/1024 (82.2%) Top5:[486,848,1012,634,183,545,472,637,322,832,1022,425,1006,996,792]


π”¬ Encoder Diversity (iter 11860):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9629 (0.0=collapsed)
[Epoch 18/100] [Batch 497/669 (74.3%)] [Iter 11870] Loss: 1.1495 (freq: 0.3834, raw: 0.7652, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 792/1024 (77.3%) Top5:[472,965,775,634,183,52,947,848,486,734,591,244,545,560,586]


π”¬ Encoder Diversity (iter 11870):
  Avg similarity: 0.0831 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 18/100] [Batch 507/669 (75.8%)] [Iter 11880] Loss: 1.0075 (freq: 0.3476, raw: 0.6590, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[183,486,569,142,56,591,792,503,545,775,639,29,121,65,734]


π”¬ Encoder Diversity (iter 11880):
  Avg similarity: 0.0625 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9543 (0.0=collapsed)
[Epoch 18/100] [Batch 517/669 (77.3%)] [Iter 11890] Loss: 1.2333 (freq: 0.4797, raw: 0.7527, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[472,142,639,729,545,486,849,988,52,244,407,755,734,119,775]


π”¬ Encoder Diversity (iter 11890):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 18/100] [Batch 527/669 (78.8%)] [Iter 11900] Loss: 1.3991 (freq: 0.5124, raw: 0.8858, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 764/1024 (74.6%) Top5:[486,708,792,274,645,569,1012,1022,591,472,56,46,616,32,404]


π”¬ Encoder Diversity (iter 11900):
  Avg similarity: 0.0787 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9499 (0.0=collapsed)
[Epoch 18/100] [Batch 537/669 (80.3%)] [Iter 11910] Loss: 1.0680 (freq: 0.3544, raw: 0.7127, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[486,29,56,786,121,1012,715,500,183,274,988,947,645,472,32]


π”¬ Encoder Diversity (iter 11910):
  Avg similarity: 0.0609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 18/100] [Batch 547/669 (81.8%)] [Iter 11920] Loss: 0.9605 (freq: 0.3199, raw: 0.6398, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[486,1012,947,948,545,142,504,616,786,988,472,278,591,121,848]


π”¬ Encoder Diversity (iter 11920):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9668 (0.0=collapsed)
[Epoch 18/100] [Batch 557/669 (83.3%)] [Iter 11930] Loss: 0.9432 (freq: 0.3257, raw: 0.6165, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 778/1024 (76.0%) Top5:[29,539,472,838,734,545,198,631,616,879,947,395,755,848,569]


π”¬ Encoder Diversity (iter 11930):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 18/100] [Batch 567/669 (84.8%)] [Iter 11940] Loss: 0.9562 (freq: 0.3282, raw: 0.6271, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[142,56,539,560,734,965,1012,792,278,936,500,861,183,32,848]


π”¬ Encoder Diversity (iter 11940):
  Avg similarity: 0.0392 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 18/100] [Batch 577/669 (86.2%)] [Iter 11950] Loss: 1.4180 (freq: 0.4875, raw: 0.9296, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[56,965,861,503,152,545,142,849,1012,939,637,183,775,586,539]


π”¬ Encoder Diversity (iter 11950):
  Avg similarity: 0.0979 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9380 (0.0=collapsed)
[Epoch 18/100] [Batch 587/669 (87.7%)] [Iter 11960] Loss: 1.2126 (freq: 0.4674, raw: 0.7441, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 855/1024 (83.5%) Top5:[775,1012,849,56,142,320,503,456,821,322,278,486,614,848,183]


π”¬ Encoder Diversity (iter 11960):
  Avg similarity: 0.0608 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9641 (0.0=collapsed)
[Epoch 18/100] [Batch 597/669 (89.2%)] [Iter 11970] Loss: 0.9997 (freq: 0.3337, raw: 0.6652, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[198,792,26,183,775,472,614,848,142,545,1012,750,6,965,656]


π”¬ Encoder Diversity (iter 11970):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 18/100] [Batch 607/669 (90.7%)] [Iter 11980] Loss: 1.0425 (freq: 0.3493, raw: 0.6924, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[775,750,472,848,32,183,591,716,142,198,456,545,322,860,431]


π”¬ Encoder Diversity (iter 11980):
  Avg similarity: 0.0590 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 18/100] [Batch 617/669 (92.2%)] [Iter 11990] Loss: 0.9997 (freq: 0.3565, raw: 0.6424, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 770/1024 (75.2%) Top5:[569,614,274,472,848,775,560,838,244,407,734,291,948,32,936]


π”¬ Encoder Diversity (iter 11990):
  Avg similarity: 0.0553 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 18/100] [Batch 627/669 (93.7%)] [Iter 12000] Loss: 1.3552 (freq: 0.5479, raw: 0.8063, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[848,472,821,904,120,988,1012,32,545,879,832,616,320,768,65]


π”¬ Encoder Diversity (iter 12000):
  Avg similarity: 0.0394 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 18/100] [Batch 637/669 (95.2%)] [Iter 12010] Loss: 1.1751 (freq: 0.4232, raw: 0.7510, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 769/1024 (75.1%) Top5:[947,472,121,775,431,848,1005,750,569,560,486,65,198,792,32]


π”¬ Encoder Diversity (iter 12010):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 18/100] [Batch 647/669 (96.7%)] [Iter 12020] Loss: 1.3756 (freq: 0.5443, raw: 0.8303, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[939,851,821,616,183,906,848,65,637,849,792,182,504,486,431]


π”¬ Encoder Diversity (iter 12020):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 18/100] [Batch 657/669 (98.2%)] [Iter 12030] Loss: 1.0431 (freq: 0.3938, raw: 0.6483, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[29,142,792,939,616,965,861,848,927,42,320,40,728,486,150]


π”¬ Encoder Diversity (iter 12030):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 18/100] [Batch 667/669 (99.7%)] [Iter 12040] Loss: 0.7063 (freq: 0.2327, raw: 0.4729, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[431,614,198,786,407,639,729,560,569,274,65,750,838,264,1005]


π”¬ Encoder Diversity (iter 12040):
  Avg similarity: 0.0576 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9611 (0.0=collapsed)

================================================================================
[Epoch 18] Validation Results:
  Total Loss: 0.5719
  Freq Loss:  0.1753
  Raw Loss:   0.3958
  Quant Loss: 0.0008
  π“ Codebook Usage: 342/1024 (33.4%)
  π“ Codebook Entropy: 4.4711 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 28252 (21.7%)
  Top 10 most used codes:
    1. Code 477: 3523 times (2.71%)
    2. Code 879: 3423 times (2.63%)
    3. Code 64: 2942 times (2.26%)
    4. Code 522: 2710 times (2.08%)
    5. Code 631: 2662 times (2.04%)
    6. Code 6: 2644 times (2.03%)
    7. Code 614: 2636 times (2.02%)
    8. Code 946: 2635 times (2.02%)
    9. Code 1022: 2579 times (1.98%)
    10. Code 292: 2498 times (1.92%)
  Bottom 5 least used codes (among used):
    1. Code 269: 1 times (0.00%)
    2. Code 87: 1 times (0.00%)
    3. Code 287: 1 times (0.00%)
    4. Code 325: 1 times (0.00%)
    5. Code 309: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 4/10
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 19/100] [Batch 8/669 (1.2%)] [Iter 12050] Loss: 1.1780 (freq: 0.4072, raw: 0.7698, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 1022/1024 (99.8%) Top5:[472,631,634,585,560,244,65,714,947,198,614,936,734,366,946]


π”¬ Encoder Diversity (iter 12050):
  Avg similarity: 0.0418 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 19/100] [Batch 18/669 (2.7%)] [Iter 12060] Loss: 1.1548 (freq: 0.4594, raw: 0.6945, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[407,613,290,541,631,472,566,946,417,775,198,544,928,838,24]


π”¬ Encoder Diversity (iter 12060):
  Avg similarity: 0.0534 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9579 (0.0=collapsed)
[Epoch 19/100] [Batch 28/669 (4.2%)] [Iter 12070] Loss: 1.1781 (freq: 0.4303, raw: 0.7470, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[787,313,223,637,996,582,171,784,422,997,98,879,948,669,196]


π”¬ Encoder Diversity (iter 12070):
  Avg similarity: 0.0541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 19/100] [Batch 38/669 (5.7%)] [Iter 12080] Loss: 0.8592 (freq: 0.3123, raw: 0.5461, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 747/1024 (72.9%) Top5:[560,947,32,472,244,65,407,24,292,787,936,313,637,685,431]


π”¬ Encoder Diversity (iter 12080):
  Avg similarity: 0.0538 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 19/100] [Batch 48/669 (7.2%)] [Iter 12090] Loss: 1.4777 (freq: 0.5783, raw: 0.8983, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[65,796,560,750,634,244,936,601,614,26,84,32,714,198,854]


π”¬ Encoder Diversity (iter 12090):
  Avg similarity: 0.0568 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9625 (0.0=collapsed)
[Epoch 19/100] [Batch 58/669 (8.7%)] [Iter 12100] Loss: 1.3221 (freq: 0.5074, raw: 0.8137, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[24,997,787,223,755,26,996,196,171,422,263,175,425,313,98]


π”¬ Encoder Diversity (iter 12100):
  Avg similarity: 0.0559 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 19/100] [Batch 68/669 (10.2%)] [Iter 12110] Loss: 1.1754 (freq: 0.4359, raw: 0.7386, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[996,143,171,755,24,120,474,846,997,198,223,591,613,792,304]


π”¬ Encoder Diversity (iter 12110):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 19/100] [Batch 78/669 (11.7%)] [Iter 12120] Loss: 1.2953 (freq: 0.4439, raw: 0.8506, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 773/1024 (75.5%) Top5:[784,544,997,422,996,171,787,755,669,474,26,223,143,425,310]


π”¬ Encoder Diversity (iter 12120):
  Avg similarity: 0.0880 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9447 (0.0=collapsed)
[Epoch 19/100] [Batch 88/669 (13.2%)] [Iter 12130] Loss: 1.1017 (freq: 0.3996, raw: 0.7012, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 889/1024 (86.8%) Top5:[981,878,996,98,265,360,154,784,422,822,325,310,213,997,425]


π”¬ Encoder Diversity (iter 12130):
  Avg similarity: 0.0629 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9603 (0.0=collapsed)
[Epoch 19/100] [Batch 98/669 (14.6%)] [Iter 12140] Loss: 1.2185 (freq: 0.4692, raw: 0.7484, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 830/1024 (81.1%) Top5:[560,977,407,996,936,787,422,24,796,198,472,384,84,997,614]


π”¬ Encoder Diversity (iter 12140):
  Avg similarity: 0.0707 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9545 (0.0=collapsed)
[Epoch 19/100] [Batch 108/669 (16.1%)] [Iter 12150] Loss: 1.1846 (freq: 0.4377, raw: 0.7460, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 781/1024 (76.3%) Top5:[996,977,472,422,198,407,474,957,360,787,431,84,631,384,812]


π”¬ Encoder Diversity (iter 12150):
  Avg similarity: 0.0426 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 19/100] [Batch 118/669 (17.6%)] [Iter 12160] Loss: 1.0855 (freq: 0.4044, raw: 0.6802, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[619,996,198,366,639,822,170,775,729,310,384,422,723,947,786]


π”¬ Encoder Diversity (iter 12160):
  Avg similarity: 0.0668 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9566 (0.0=collapsed)
[Epoch 19/100] [Batch 128/669 (19.1%)] [Iter 12170] Loss: 1.1022 (freq: 0.3811, raw: 0.7202, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 762/1024 (74.4%) Top5:[434,792,996,213,417,143,755,422,310,170,784,186,669,367,304]


π”¬ Encoder Diversity (iter 12170):
  Avg similarity: 0.0686 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 19/100] [Batch 138/669 (20.6%)] [Iter 12180] Loss: 0.9955 (freq: 0.3314, raw: 0.6633, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 772/1024 (75.4%) Top5:[996,434,755,422,1022,947,639,170,223,569,198,171,687,978,313]


π”¬ Encoder Diversity (iter 12180):
  Avg similarity: 0.0374 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 19/100] [Batch 148/669 (22.1%)] [Iter 12190] Loss: 1.1671 (freq: 0.4208, raw: 0.7454, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 779/1024 (76.1%) Top5:[213,95,24,431,996,784,786,569,614,796,474,384,879,582,407]


π”¬ Encoder Diversity (iter 12190):
  Avg similarity: 0.0437 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9639 (0.0=collapsed)
[Epoch 19/100] [Batch 158/669 (23.6%)] [Iter 12200] Loss: 0.6211 (freq: 0.1984, raw: 0.4220, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 764/1024 (74.6%) Top5:[796,32,198,431,631,407,244,981,366,997,384,669,729,786,472]


π”¬ Encoder Diversity (iter 12200):
  Avg similarity: 0.0555 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 19/100] [Batch 168/669 (25.1%)] [Iter 12210] Loss: 1.1973 (freq: 0.4623, raw: 0.7340, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 867/1024 (84.7%) Top5:[977,213,470,24,422,325,95,784,594,997,126,582,923,835,860]


π”¬ Encoder Diversity (iter 12210):
  Avg similarity: 0.0511 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 19/100] [Batch 178/669 (26.6%)] [Iter 12220] Loss: 1.1904 (freq: 0.4199, raw: 0.7696, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[977,223,835,996,637,796,928,213,32,265,313,582,425,65,98]


π”¬ Encoder Diversity (iter 12220):
  Avg similarity: 0.0580 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 19/100] [Batch 188/669 (28.1%)] [Iter 12230] Loss: 1.0870 (freq: 0.4042, raw: 0.6819, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[977,24,544,997,533,95,474,714,170,213,431,957,417,407,223]


π”¬ Encoder Diversity (iter 12230):
  Avg similarity: 0.0778 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9459 (0.0=collapsed)
[Epoch 19/100] [Batch 198/669 (29.6%)] [Iter 12240] Loss: 1.0855 (freq: 0.3580, raw: 0.7267, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[32,425,213,434,784,223,26,812,755,0,95,890,996,170,417]


π”¬ Encoder Diversity (iter 12240):
  Avg similarity: 0.0461 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 19/100] [Batch 208/669 (31.1%)] [Iter 12250] Loss: 1.0101 (freq: 0.3729, raw: 0.6363, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[784,755,213,65,171,431,977,24,32,244,472,185,669,425,631]


π”¬ Encoder Diversity (iter 12250):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 19/100] [Batch 218/669 (32.6%)] [Iter 12260] Loss: 1.0983 (freq: 0.4151, raw: 0.6823, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[313,422,213,784,977,996,624,582,878,196,425,474,755,786,170]


π”¬ Encoder Diversity (iter 12260):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 19/100] [Batch 228/669 (34.1%)] [Iter 12270] Loss: 1.1170 (freq: 0.4086, raw: 0.7075, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 826/1024 (80.7%) Top5:[422,313,784,474,544,787,996,755,417,792,196,213,223,815,171]


π”¬ Encoder Diversity (iter 12270):
  Avg similarity: 0.0354 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 19/100] [Batch 238/669 (35.6%)] [Iter 12280] Loss: 0.9282 (freq: 0.3260, raw: 0.6013, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[422,786,313,196,993,582,977,244,790,360,957,796,681,366,544]


π”¬ Encoder Diversity (iter 12280):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 19/100] [Batch 248/669 (37.1%)] [Iter 12290] Loss: 1.1376 (freq: 0.3787, raw: 0.7580, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 757/1024 (73.9%) Top5:[812,223,996,422,313,407,755,790,24,360,775,65,796,548,95]


π”¬ Encoder Diversity (iter 12290):
  Avg similarity: 0.0464 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 19/100] [Batch 258/669 (38.6%)] [Iter 12300] Loss: 1.1944 (freq: 0.4126, raw: 0.7809, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[669,729,796,431,395,775,65,786,95,213,997,32,947,750,566]


π”¬ Encoder Diversity (iter 12300):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 19/100] [Batch 268/669 (40.1%)] [Iter 12310] Loss: 1.0318 (freq: 0.3197, raw: 0.7112, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[977,541,422,24,957,223,29,560,997,425,196,417,727,729,170]


π”¬ Encoder Diversity (iter 12310):
  Avg similarity: 0.0415 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 19/100] [Batch 278/669 (41.6%)] [Iter 12320] Loss: 0.9840 (freq: 0.3353, raw: 0.6478, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[544,263,803,185,126,313,213,796,681,95,472,747,422,463,65]


π”¬ Encoder Diversity (iter 12320):
  Avg similarity: 0.0822 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9475 (0.0=collapsed)
[Epoch 19/100] [Batch 288/669 (43.0%)] [Iter 12330] Loss: 1.2461 (freq: 0.4730, raw: 0.7720, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 750/1024 (73.2%) Top5:[803,796,472,681,784,560,422,32,223,747,139,170,614,185,263]


π”¬ Encoder Diversity (iter 12330):
  Avg similarity: 0.0623 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 19/100] [Batch 298/669 (44.5%)] [Iter 12340] Loss: 1.3115 (freq: 0.4856, raw: 0.8250, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 777/1024 (75.9%) Top5:[213,472,223,399,610,186,619,422,431,548,95,384,796,792,815]


π”¬ Encoder Diversity (iter 12340):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 19/100] [Batch 308/669 (46.0%)] [Iter 12350] Loss: 1.3474 (freq: 0.5052, raw: 0.8412, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[796,185,32,65,213,835,0,775,431,24,126,957,681,26,384]


π”¬ Encoder Diversity (iter 12350):
  Avg similarity: 0.0363 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 19/100] [Batch 318/669 (47.5%)] [Iter 12360] Loss: 1.1056 (freq: 0.3929, raw: 0.7117, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[812,637,422,815,417,878,434,787,755,360,223,185,474,65,170]


π”¬ Encoder Diversity (iter 12360):
  Avg similarity: 0.0360 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 19/100] [Batch 328/669 (49.0%)] [Iter 12370] Loss: 1.2140 (freq: 0.4224, raw: 0.7907, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 810/1024 (79.1%) Top5:[548,24,422,846,996,787,812,196,784,313,170,727,544,213,669]


π”¬ Encoder Diversity (iter 12370):
  Avg similarity: 0.0446 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9645 (0.0=collapsed)
[Epoch 19/100] [Batch 338/669 (50.5%)] [Iter 12380] Loss: 1.0890 (freq: 0.3738, raw: 0.7143, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[213,784,993,113,998,434,24,422,971,775,846,425,957,996,727]


π”¬ Encoder Diversity (iter 12380):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 19/100] [Batch 348/669 (52.0%)] [Iter 12390] Loss: 1.0052 (freq: 0.3637, raw: 0.6407, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 784/1024 (76.6%) Top5:[431,614,384,24,784,624,407,729,669,548,422,399,223,198,65]


π”¬ Encoder Diversity (iter 12390):
  Avg similarity: 0.0498 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 19/100] [Batch 358/669 (53.5%)] [Iter 12400] Loss: 1.0364 (freq: 0.2980, raw: 0.7375, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 775/1024 (75.7%) Top5:[747,957,358,803,681,185,472,463,960,32,560,729,566,714,198]


π”¬ Encoder Diversity (iter 12400):
  Avg similarity: 0.0603 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 19/100] [Batch 368/669 (55.0%)] [Iter 12410] Loss: 0.8248 (freq: 0.2592, raw: 0.5648, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[170,755,996,422,472,95,878,223,32,310,812,280,548,796,544]


π”¬ Encoder Diversity (iter 12410):
  Avg similarity: 0.0398 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9678 (0.0=collapsed)
[Epoch 19/100] [Batch 378/669 (56.5%)] [Iter 12420] Loss: 0.9184 (freq: 0.2991, raw: 0.6184, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[582,170,196,548,846,310,472,681,24,996,95,792,637,669,787]


π”¬ Encoder Diversity (iter 12420):
  Avg similarity: 0.0436 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 19/100] [Batch 388/669 (58.0%)] [Iter 12430] Loss: 1.0501 (freq: 0.3671, raw: 0.6820, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[422,996,792,434,417,582,170,669,681,355,653,960,566,755,0]


π”¬ Encoder Diversity (iter 12430):
  Avg similarity: 0.0643 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 19/100] [Batch 398/669 (59.5%)] [Iter 12440] Loss: 0.9826 (freq: 0.3686, raw: 0.6131, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 805/1024 (78.6%) Top5:[422,846,280,223,24,395,669,310,65,996,792,417,971,796,196]


π”¬ Encoder Diversity (iter 12440):
  Avg similarity: 0.0702 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9597 (0.0=collapsed)
[Epoch 19/100] [Batch 408/669 (61.0%)] [Iter 12450] Loss: 0.9667 (freq: 0.3689, raw: 0.5969, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[846,213,923,775,24,113,422,993,794,903,263,0,786,727,47]


π”¬ Encoder Diversity (iter 12450):
  Avg similarity: 0.0671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 19/100] [Batch 418/669 (62.5%)] [Iter 12460] Loss: 1.3740 (freq: 0.5298, raw: 0.8433, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[422,213,792,775,923,787,198,624,707,313,170,310,971,755,637]


π”¬ Encoder Diversity (iter 12460):
  Avg similarity: 0.0424 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 19/100] [Batch 428/669 (64.0%)] [Iter 12470] Loss: 1.4260 (freq: 0.5092, raw: 0.9158, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[198,422,755,669,223,358,244,407,434,492,567,399,996,812,0]


π”¬ Encoder Diversity (iter 12470):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9714 (0.0=collapsed)
[Epoch 19/100] [Batch 438/669 (65.5%)] [Iter 12480] Loss: 0.7558 (freq: 0.2390, raw: 0.5160, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[624,24,422,164,311,223,407,185,787,196,492,541,317,263,472]


π”¬ Encoder Diversity (iter 12480):
  Avg similarity: 0.0598 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9588 (0.0=collapsed)
[Epoch 19/100] [Batch 448/669 (67.0%)] [Iter 12490] Loss: 1.4741 (freq: 0.5572, raw: 0.9159, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 786/1024 (76.8%) Top5:[796,787,422,971,874,434,263,0,196,529,846,996,800,223,183]


π”¬ Encoder Diversity (iter 12490):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9642 (0.0=collapsed)
[Epoch 19/100] [Batch 458/669 (68.5%)] [Iter 12500] Loss: 0.9697 (freq: 0.3696, raw: 0.5991, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[422,796,310,784,77,32,417,923,998,196,846,878,126,548,996]


π”¬ Encoder Diversity (iter 12500):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9610 (0.0=collapsed)
[Epoch 19/100] [Batch 468/669 (70.0%)] [Iter 12510] Loss: 1.2242 (freq: 0.4530, raw: 0.7703, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[95,213,996,548,529,413,767,582,422,846,874,223,792,126,77]


π”¬ Encoder Diversity (iter 12510):
  Avg similarity: 0.0862 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9458 (0.0=collapsed)
[Epoch 19/100] [Batch 478/669 (71.4%)] [Iter 12520] Loss: 1.0864 (freq: 0.3920, raw: 0.6934, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[472,784,244,997,0,417,474,32,548,846,755,95,878,185,223]


π”¬ Encoder Diversity (iter 12520):
  Avg similarity: 0.0529 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 19/100] [Batch 488/669 (72.9%)] [Iter 12530] Loss: 0.4702 (freq: 0.1296, raw: 0.3399, quant: 0.0007, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[1,431,32,250,846,669,65,784,548,407,997,567,996,755,24]


π”¬ Encoder Diversity (iter 12530):
  Avg similarity: 0.0383 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 19/100] [Batch 498/669 (74.4%)] [Iter 12540] Loss: 1.1546 (freq: 0.4286, raw: 0.7250, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[17,185,32,472,311,604,213,164,796,971,186,422,727,431,244]


π”¬ Encoder Diversity (iter 12540):
  Avg similarity: 0.0695 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9586 (0.0=collapsed)
[Epoch 19/100] [Batch 508/669 (75.9%)] [Iter 12550] Loss: 1.3428 (freq: 0.4980, raw: 0.8438, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[548,878,422,186,996,755,792,196,839,213,859,407,26,529,544]


π”¬ Encoder Diversity (iter 12550):
  Avg similarity: 0.0816 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9496 (0.0=collapsed)
[Epoch 19/100] [Batch 518/669 (77.4%)] [Iter 12560] Loss: 0.9673 (freq: 0.3371, raw: 0.6293, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[65,198,767,407,997,755,32,213,17,784,637,971,846,413,223]


π”¬ Encoder Diversity (iter 12560):
  Avg similarity: 0.0501 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 19/100] [Batch 528/669 (78.9%)] [Iter 12570] Loss: 1.1658 (freq: 0.3868, raw: 0.7781, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[784,878,32,730,196,859,407,687,947,170,223,358,24,0,431]


π”¬ Encoder Diversity (iter 12570):
  Avg similarity: 0.0614 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9553 (0.0=collapsed)
[Epoch 19/100] [Batch 538/669 (80.4%)] [Iter 12580] Loss: 1.2051 (freq: 0.4582, raw: 0.7460, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[196,417,213,223,582,997,604,529,812,355,967,787,729,767,313]


π”¬ Encoder Diversity (iter 12580):
  Avg similarity: 0.0507 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 19/100] [Batch 548/669 (81.9%)] [Iter 12590] Loss: 0.9762 (freq: 0.3210, raw: 0.6543, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[0,407,80,787,65,223,455,196,24,997,529,947,900,796,413]


π”¬ Encoder Diversity (iter 12590):
  Avg similarity: 0.0763 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9558 (0.0=collapsed)
[Epoch 19/100] [Batch 558/669 (83.4%)] [Iter 12600] Loss: 0.8814 (freq: 0.2753, raw: 0.6053, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[787,784,196,422,529,223,0,755,26,792,417,767,846,544,355]


π”¬ Encoder Diversity (iter 12600):
  Avg similarity: 0.0612 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9656 (0.0=collapsed)
[Epoch 19/100] [Batch 568/669 (84.9%)] [Iter 12610] Loss: 1.2134 (freq: 0.4573, raw: 0.7552, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[422,223,417,996,571,874,529,878,846,24,0,792,669,755,26]


π”¬ Encoder Diversity (iter 12610):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 19/100] [Batch 578/669 (86.4%)] [Iter 12620] Loss: 1.1943 (freq: 0.4093, raw: 0.7841, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[681,878,213,971,417,548,815,774,223,395,422,675,529,784,846]


π”¬ Encoder Diversity (iter 12620):
  Avg similarity: 0.0726 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9565 (0.0=collapsed)
[Epoch 19/100] [Batch 588/669 (87.9%)] [Iter 12630] Loss: 0.8953 (freq: 0.2959, raw: 0.5986, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 795/1024 (77.6%) Top5:[784,529,669,422,996,839,859,93,582,846,431,223,774,263,874]


π”¬ Encoder Diversity (iter 12630):
  Avg similarity: 0.0541 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9600 (0.0=collapsed)
[Epoch 19/100] [Batch 598/669 (89.4%)] [Iter 12640] Loss: 1.3506 (freq: 0.5250, raw: 0.8247, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[996,422,263,170,24,455,997,213,784,223,185,529,417,93,582]


π”¬ Encoder Diversity (iter 12640):
  Avg similarity: 0.0345 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9655 (0.0=collapsed)
[Epoch 19/100] [Batch 608/669 (90.9%)] [Iter 12650] Loss: 0.8298 (freq: 0.2534, raw: 0.5755, quant: 0.0008, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[198,80,839,974,729,900,811,407,948,687,84,246,431,730,185]


π”¬ Encoder Diversity (iter 12650):
  Avg similarity: 0.0829 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9524 (0.0=collapsed)
[Epoch 19/100] [Batch 618/669 (92.4%)] [Iter 12660] Loss: 1.1877 (freq: 0.3749, raw: 0.8118, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[21,996,422,755,260,24,935,767,26,544,846,529,812,474,196]


π”¬ Encoder Diversity (iter 12660):
  Avg similarity: 0.0578 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9604 (0.0=collapsed)
[Epoch 19/100] [Batch 628/669 (93.9%)] [Iter 12670] Loss: 1.1714 (freq: 0.4225, raw: 0.7480, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 818/1024 (79.9%) Top5:[811,784,417,170,974,196,24,407,32,767,26,223,878,669,0]


π”¬ Encoder Diversity (iter 12670):
  Avg similarity: 0.0613 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9563 (0.0=collapsed)
[Epoch 19/100] [Batch 638/669 (95.4%)] [Iter 12680] Loss: 1.2343 (freq: 0.4396, raw: 0.7937, quant: 0.0011, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[784,529,716,93,755,878,422,996,223,544,455,669,24,492,407]


π”¬ Encoder Diversity (iter 12680):
  Avg similarity: 0.0611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 19/100] [Batch 648/669 (96.9%)] [Iter 12690] Loss: 1.1366 (freq: 0.3830, raw: 0.7527, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 772/1024 (75.4%) Top5:[24,455,784,198,246,384,914,80,196,422,806,32,755,996,554]


π”¬ Encoder Diversity (iter 12690):
  Avg similarity: 0.0708 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9487 (0.0=collapsed)
[Epoch 19/100] [Batch 658/669 (98.4%)] [Iter 12700] Loss: 0.9137 (freq: 0.3018, raw: 0.6111, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 773/1024 (75.5%) Top5:[198,24,32,246,185,681,796,669,956,914,903,80,384,705,544]


π”¬ Encoder Diversity (iter 12700):
  Avg similarity: 0.0441 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 19/100] [Batch 668/669 (99.9%)] [Iter 12710] Loss: 0.9065 (freq: 0.2914, raw: 0.6143, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 813/1024 (79.4%) Top5:[784,175,93,417,280,582,541,529,246,996,422,26,431,250,65]


π”¬ Encoder Diversity (iter 12710):
  Avg similarity: 0.0325 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)

================================================================================
[Epoch 19] Validation Results:
  Total Loss: 0.5548
  Freq Loss:  0.1704
  Raw Loss:   0.3836
  Quant Loss: 0.0008
  π“ Codebook Usage: 535/1024 (52.2%)
  π“ Codebook Entropy: 5.0691 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 25572 (19.6%)
  Top 10 most used codes:
    1. Code 250: 3200 times (2.46%)
    2. Code 780: 2969 times (2.28%)
    3. Code 65: 2740 times (2.10%)
    4. Code 788: 2697 times (2.07%)
    5. Code 342: 2525 times (1.94%)
    6. Code 900: 2445 times (1.88%)
    7. Code 80: 2350 times (1.80%)
    8. Code 705: 2264 times (1.74%)
    9. Code 17: 2192 times (1.68%)
    10. Code 270: 2190 times (1.68%)
  Bottom 5 least used codes (among used):
    1. Code 348: 1 times (0.00%)
    2. Code 212: 1 times (0.00%)
    3. Code 353: 1 times (0.00%)
    4. Code 590: 1 times (0.00%)
    5. Code 528: 1 times (0.00%)
================================================================================

[EarlyStopping] Best model saved at epoch 19
saving checkpoint to ./vq_output/checkpoints/VQ
[Epoch 20/100] [Batch 9/669 (1.3%)] [Iter 12720] Loss: 1.3651 (freq: 0.5366, raw: 0.8275, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 1024/1024 (100.0%) Top5:[34,681,832,198,947,687,447,193,65,948,246,173,900,384,87]


π”¬ Encoder Diversity (iter 12720):
  Avg similarity: 0.0459 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 20/100] [Batch 19/669 (2.8%)] [Iter 12730] Loss: 1.3202 (freq: 0.5021, raw: 0.8172, quant: 0.0010, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 816/1024 (79.7%) Top5:[681,995,898,87,1005,383,504,561,320,914,176,522,675,796,687]


π”¬ Encoder Diversity (iter 12730):
  Avg similarity: 0.0467 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 20/100] [Batch 29/669 (4.3%)] [Iter 12740] Loss: 1.1681 (freq: 0.4217, raw: 0.7454, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 772/1024 (75.4%) Top5:[956,447,198,80,705,244,84,729,687,250,32,675,914,248,246]


π”¬ Encoder Diversity (iter 12740):
  Avg similarity: 0.0704 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9522 (0.0=collapsed)
[Epoch 20/100] [Batch 39/669 (5.8%)] [Iter 12750] Loss: 1.3812 (freq: 0.5400, raw: 0.8403, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[518,995,32,898,383,467,36,974,117,90,956,64,719,712,84]


π”¬ Encoder Diversity (iter 12750):
  Avg similarity: 0.0940 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9407 (0.0=collapsed)
[Epoch 20/100] [Batch 49/669 (7.3%)] [Iter 12760] Loss: 1.1620 (freq: 0.4114, raw: 0.7496, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[383,87,117,759,995,983,712,64,317,363,1003,95,834,172,504]


π”¬ Encoder Diversity (iter 12760):
  Avg similarity: 0.0577 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9634 (0.0=collapsed)
[Epoch 20/100] [Batch 59/669 (8.8%)] [Iter 12770] Loss: 1.0078 (freq: 0.3443, raw: 0.6626, quant: 0.0009, domain: 0.0000) LR: 1.98e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[80,246,974,687,173,498,729,198,571,857,898,796,84,675,537]


π”¬ Encoder Diversity (iter 12770):
  Avg similarity: 0.0774 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9561 (0.0=collapsed)
[Epoch 20/100] [Batch 69/669 (10.3%)] [Iter 12780] Loss: 1.1039 (freq: 0.4108, raw: 0.6921, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 821/1024 (80.2%) Top5:[317,198,796,320,571,90,834,898,185,712,604,687,447,974,335]


π”¬ Encoder Diversity (iter 12780):
  Avg similarity: 0.0516 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9592 (0.0=collapsed)
[Epoch 20/100] [Batch 79/669 (11.8%)] [Iter 12790] Loss: 0.9854 (freq: 0.3468, raw: 0.6376, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[317,383,36,744,368,675,712,571,570,464,84,247,995,607,687]


π”¬ Encoder Diversity (iter 12790):
  Avg similarity: 0.0874 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9461 (0.0=collapsed)
[Epoch 20/100] [Batch 89/669 (13.3%)] [Iter 12800] Loss: 1.0912 (freq: 0.3988, raw: 0.6915, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[198,277,624,759,383,317,571,834,758,900,995,296,868,90,80]


π”¬ Encoder Diversity (iter 12800):
  Avg similarity: 0.0702 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9527 (0.0=collapsed)
[Epoch 20/100] [Batch 99/669 (14.8%)] [Iter 12810] Loss: 1.2602 (freq: 0.4445, raw: 0.8147, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[807,571,834,383,995,36,247,607,601,363,685,1011,108,50,117]


π”¬ Encoder Diversity (iter 12810):
  Avg similarity: 0.0508 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 20/100] [Batch 109/669 (16.3%)] [Iter 12820] Loss: 1.1596 (freq: 0.4102, raw: 0.7486, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[687,571,64,363,834,383,806,1005,198,807,117,995,34,681,317]


π”¬ Encoder Diversity (iter 12820):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 20/100] [Batch 119/669 (17.8%)] [Iter 12830] Loss: 1.0425 (freq: 0.3788, raw: 0.6628, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[32,796,277,729,383,246,198,974,80,571,126,185,431,504,65]


π”¬ Encoder Diversity (iter 12830):
  Avg similarity: 0.0519 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 20/100] [Batch 129/669 (19.3%)] [Iter 12840] Loss: 0.9400 (freq: 0.3381, raw: 0.6011, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[571,974,806,352,601,758,834,454,248,34,384,537,796,623,198]


π”¬ Encoder Diversity (iter 12840):
  Avg similarity: 0.0495 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9636 (0.0=collapsed)
[Epoch 20/100] [Batch 139/669 (20.8%)] [Iter 12850] Loss: 1.0169 (freq: 0.3685, raw: 0.6475, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 791/1024 (77.2%) Top5:[956,834,275,185,974,198,481,117,1005,806,142,811,126,807,447]


π”¬ Encoder Diversity (iter 12850):
  Avg similarity: 0.0819 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 20/100] [Batch 149/669 (22.3%)] [Iter 12860] Loss: 1.2489 (freq: 0.4797, raw: 0.7682, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[10,834,454,108,470,36,277,571,383,995,868,1011,247,296,65]


π”¬ Encoder Diversity (iter 12860):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9657 (0.0=collapsed)
[Epoch 20/100] [Batch 159/669 (23.8%)] [Iter 12870] Loss: 0.9916 (freq: 0.3222, raw: 0.6685, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[182,676,185,206,851,974,687,429,34,490,198,244,261,537,681]


π”¬ Encoder Diversity (iter 12870):
  Avg similarity: 0.0795 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9552 (0.0=collapsed)
[Epoch 20/100] [Batch 169/669 (25.3%)] [Iter 12880] Loss: 1.1075 (freq: 0.4090, raw: 0.6976, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[834,993,117,64,995,570,368,1005,277,160,155,383,806,913,1011]


π”¬ Encoder Diversity (iter 12880):
  Avg similarity: 0.0425 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 20/100] [Batch 179/669 (26.8%)] [Iter 12890] Loss: 1.3383 (freq: 0.5250, raw: 0.8123, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[65,908,758,683,80,108,995,851,10,447,185,261,198,685,117]


π”¬ Encoder Diversity (iter 12890):
  Avg similarity: 0.0513 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9659 (0.0=collapsed)
[Epoch 20/100] [Batch 189/669 (28.3%)] [Iter 12900] Loss: 1.0612 (freq: 0.3669, raw: 0.6934, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 835/1024 (81.5%) Top5:[744,683,713,1011,176,983,995,758,851,571,86,470,10,685,676]


π”¬ Encoder Diversity (iter 12900):
  Avg similarity: 0.1106 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9409 (0.0=collapsed)
[Epoch 20/100] [Batch 199/669 (29.7%)] [Iter 12910] Loss: 1.2577 (freq: 0.4457, raw: 0.8111, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[683,995,601,10,277,1011,36,713,204,898,86,383,758,591,406]


π”¬ Encoder Diversity (iter 12910):
  Avg similarity: 0.0435 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 20/100] [Batch 209/669 (31.2%)] [Iter 12920] Loss: 1.2345 (freq: 0.4138, raw: 0.8198, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[995,571,679,1005,464,64,683,454,36,624,696,10,744,1011,834]


π”¬ Encoder Diversity (iter 12920):
  Avg similarity: 0.0298 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 20/100] [Batch 219/669 (32.7%)] [Iter 12930] Loss: 1.2941 (freq: 0.4868, raw: 0.8063, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 785/1024 (76.7%) Top5:[683,1005,571,464,176,108,383,676,983,64,406,246,1003,834,368]


π”¬ Encoder Diversity (iter 12930):
  Avg similarity: 0.0362 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 20/100] [Batch 229/669 (34.2%)] [Iter 12940] Loss: 1.0379 (freq: 0.3514, raw: 0.6856, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 799/1024 (78.0%) Top5:[1005,683,464,834,244,185,676,246,571,851,729,814,687,384,64]


π”¬ Encoder Diversity (iter 12940):
  Avg similarity: 0.0607 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 20/100] [Batch 239/669 (35.7%)] [Iter 12950] Loss: 1.0508 (freq: 0.3477, raw: 0.7022, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[80,676,182,429,974,447,198,675,898,537,687,761,507,248,368]


π”¬ Encoder Diversity (iter 12950):
  Avg similarity: 0.0797 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9613 (0.0=collapsed)
[Epoch 20/100] [Batch 249/669 (37.2%)] [Iter 12960] Loss: 1.3326 (freq: 0.4858, raw: 0.8457, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 838/1024 (81.8%) Top5:[277,464,108,758,182,1011,10,834,683,644,675,204,470,915,64]


π”¬ Encoder Diversity (iter 12960):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9624 (0.0=collapsed)
[Epoch 20/100] [Batch 259/669 (38.7%)] [Iter 12970] Loss: 0.9286 (freq: 0.3260, raw: 0.6017, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[185,713,687,80,368,182,64,683,490,277,198,682,317,974,65]


π”¬ Encoder Diversity (iter 12970):
  Avg similarity: 0.0599 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 20/100] [Batch 269/669 (40.2%)] [Iter 12980] Loss: 1.2358 (freq: 0.4772, raw: 0.7577, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[1005,744,759,317,469,683,1011,707,591,995,571,277,965,685,117]


π”¬ Encoder Diversity (iter 12980):
  Avg similarity: 0.0386 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9689 (0.0=collapsed)
[Epoch 20/100] [Batch 279/669 (41.7%)] [Iter 12990] Loss: 1.0645 (freq: 0.3934, raw: 0.6703, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[10,683,834,652,1011,1003,974,317,571,383,601,246,713,464,447]


π”¬ Encoder Diversity (iter 12990):
  Avg similarity: 0.0564 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9626 (0.0=collapsed)
[Epoch 20/100] [Batch 289/669 (43.2%)] [Iter 13000] Loss: 1.3876 (freq: 0.4912, raw: 0.8954, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 882/1024 (86.1%) Top5:[247,683,10,395,86,1011,679,834,898,983,1005,995,759,681,173]


π”¬ Encoder Diversity (iter 13000):
  Avg similarity: 0.0322 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9694 (0.0=collapsed)
[Epoch 20/100] [Batch 299/669 (44.7%)] [Iter 13010] Loss: 0.9114 (freq: 0.3278, raw: 0.5827, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[570,834,524,454,1011,464,679,117,571,10,80,1001,683,730,182]


π”¬ Encoder Diversity (iter 13010):
  Avg similarity: 0.0672 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9593 (0.0=collapsed)
[Epoch 20/100] [Batch 309/669 (46.2%)] [Iter 13020] Loss: 1.0743 (freq: 0.3595, raw: 0.7140, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 796/1024 (77.7%) Top5:[246,317,683,1011,490,974,682,643,108,713,10,956,744,759,86]


π”¬ Encoder Diversity (iter 13020):
  Avg similarity: 0.0614 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 20/100] [Batch 319/669 (47.7%)] [Iter 13030] Loss: 1.1051 (freq: 0.3980, raw: 0.7061, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[713,368,834,995,10,1011,538,1005,80,578,744,464,518,176,64]


π”¬ Encoder Diversity (iter 13030):
  Avg similarity: 0.0307 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 20/100] [Batch 329/669 (49.2%)] [Iter 13040] Loss: 0.8358 (freq: 0.2875, raw: 0.5474, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 793/1024 (77.4%) Top5:[80,956,995,643,447,683,676,182,613,3,65,39,248,579,185]


π”¬ Encoder Diversity (iter 13040):
  Avg similarity: 0.0356 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9732 (0.0=collapsed)
[Epoch 20/100] [Batch 339/669 (50.7%)] [Iter 13050] Loss: 1.1262 (freq: 0.3974, raw: 0.7276, quant: 0.0011, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 815/1024 (79.6%) Top5:[683,834,185,983,317,368,518,108,1011,155,759,80,464,395,246]


π”¬ Encoder Diversity (iter 13050):
  Avg similarity: 0.0764 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9580 (0.0=collapsed)
[Epoch 20/100] [Batch 349/669 (52.2%)] [Iter 13060] Loss: 1.1315 (freq: 0.3836, raw: 0.7469, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 790/1024 (77.1%) Top5:[983,277,518,571,834,185,607,1003,995,570,679,683,660,613,623]


π”¬ Encoder Diversity (iter 13060):
  Avg similarity: 0.0465 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9680 (0.0=collapsed)
[Epoch 20/100] [Batch 359/669 (53.7%)] [Iter 13070] Loss: 0.9020 (freq: 0.3096, raw: 0.5915, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[983,607,248,995,185,613,524,310,432,843,956,371,644,814,117]


π”¬ Encoder Diversity (iter 13070):
  Avg similarity: 0.0662 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 20/100] [Batch 369/669 (55.2%)] [Iter 13080] Loss: 1.1040 (freq: 0.4024, raw: 0.7008, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 761/1024 (74.3%) Top5:[332,277,607,371,317,246,643,190,570,956,898,61,581,613,185]


π”¬ Encoder Diversity (iter 13080):
  Avg similarity: 0.0505 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 20/100] [Batch 379/669 (56.7%)] [Iter 13090] Loss: 1.0014 (freq: 0.3353, raw: 0.6652, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[524,758,713,176,395,913,1011,10,518,317,983,86,995,247,591]


π”¬ Encoder Diversity (iter 13090):
  Avg similarity: 0.0706 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9606 (0.0=collapsed)
[Epoch 20/100] [Batch 389/669 (58.1%)] [Iter 13100] Loss: 1.0964 (freq: 0.3999, raw: 0.6956, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 831/1024 (81.2%) Top5:[490,643,246,956,682,182,579,591,198,713,61,613,831,676,843]


π”¬ Encoder Diversity (iter 13100):
  Avg similarity: 0.0770 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9538 (0.0=collapsed)
[Epoch 20/100] [Batch 399/669 (59.6%)] [Iter 13110] Loss: 1.2754 (freq: 0.4107, raw: 0.8639, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 811/1024 (79.2%) Top5:[1011,317,806,591,64,834,10,995,176,155,368,277,713,744,524]


π”¬ Encoder Diversity (iter 13110):
  Avg similarity: 0.0609 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9622 (0.0=collapsed)
[Epoch 20/100] [Batch 409/669 (61.1%)] [Iter 13120] Loss: 1.0745 (freq: 0.3744, raw: 0.6991, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 832/1024 (81.2%) Top5:[507,185,682,643,571,1011,198,490,447,946,537,246,248,591,974]


π”¬ Encoder Diversity (iter 13120):
  Avg similarity: 0.0694 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 20/100] [Batch 419/669 (62.6%)] [Iter 13130] Loss: 1.2105 (freq: 0.4485, raw: 0.7610, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 876/1024 (85.5%) Top5:[834,353,464,758,469,1011,696,681,383,679,317,10,744,623,363]


π”¬ Encoder Diversity (iter 13130):
  Avg similarity: 0.0452 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 20/100] [Batch 429/669 (64.1%)] [Iter 13140] Loss: 1.1646 (freq: 0.4069, raw: 0.7567, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[591,995,368,317,834,537,10,1011,571,974,277,601,656,1003,176]


π”¬ Encoder Diversity (iter 13140):
  Avg similarity: 0.0521 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9654 (0.0=collapsed)
[Epoch 20/100] [Batch 439/669 (65.6%)] [Iter 13150] Loss: 1.2042 (freq: 0.4516, raw: 0.7516, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 803/1024 (78.4%) Top5:[537,185,524,946,224,317,579,204,571,502,974,660,1011,61,643]


π”¬ Encoder Diversity (iter 13150):
  Avg similarity: 0.0569 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 20/100] [Batch 449/669 (67.1%)] [Iter 13160] Loss: 1.1310 (freq: 0.4379, raw: 0.6921, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[395,176,317,834,204,956,277,591,995,182,682,173,571,80,10]


π”¬ Encoder Diversity (iter 13160):
  Avg similarity: 0.0471 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9648 (0.0=collapsed)
[Epoch 20/100] [Batch 459/669 (68.6%)] [Iter 13170] Loss: 1.3244 (freq: 0.5159, raw: 0.8075, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[683,995,696,502,10,277,204,591,834,806,656,571,117,554,317]


π”¬ Encoder Diversity (iter 13170):
  Avg similarity: 0.0751 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 20/100] [Batch 469/669 (70.1%)] [Iter 13180] Loss: 0.8355 (freq: 0.2946, raw: 0.5399, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[204,507,913,571,687,696,591,317,64,446,500,303,395,173,176]


π”¬ Encoder Diversity (iter 13180):
  Avg similarity: 0.0589 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 20/100] [Batch 479/669 (71.6%)] [Iter 13190] Loss: 1.1682 (freq: 0.3908, raw: 0.7764, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[571,10,395,806,277,368,591,1005,834,117,247,173,64,759,656]


π”¬ Encoder Diversity (iter 13190):
  Avg similarity: 0.0343 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 20/100] [Batch 489/669 (73.1%)] [Iter 13200] Loss: 0.8733 (freq: 0.2968, raw: 0.5756, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 797/1024 (77.8%) Top5:[571,682,80,806,956,490,568,805,418,277,182,379,687,388,371]


π”¬ Encoder Diversity (iter 13200):
  Avg similarity: 0.0406 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9646 (0.0=collapsed)
[Epoch 20/100] [Batch 499/669 (74.6%)] [Iter 13210] Loss: 1.0906 (freq: 0.3974, raw: 0.6923, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 802/1024 (78.3%) Top5:[579,644,246,613,317,58,682,571,185,743,379,61,591,490,676]


π”¬ Encoder Diversity (iter 13210):
  Avg similarity: 0.0771 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9473 (0.0=collapsed)
[Epoch 20/100] [Batch 509/669 (76.1%)] [Iter 13220] Loss: 1.0669 (freq: 0.3682, raw: 0.6978, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[682,1005,10,317,247,395,995,204,80,1011,744,248,713,418,108]


π”¬ Encoder Diversity (iter 13220):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9664 (0.0=collapsed)
[Epoch 20/100] [Batch 519/669 (77.6%)] [Iter 13230] Loss: 1.2102 (freq: 0.4532, raw: 0.7561, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[502,224,317,185,1011,61,995,682,571,58,579,478,447,117,10]


π”¬ Encoder Diversity (iter 13230):
  Avg similarity: 0.0421 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9677 (0.0=collapsed)
[Epoch 20/100] [Batch 529/669 (79.1%)] [Iter 13240] Loss: 1.0554 (freq: 0.3859, raw: 0.6685, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 834/1024 (81.4%) Top5:[994,247,80,758,613,524,789,956,182,454,571,104,246,204,682]


π”¬ Encoder Diversity (iter 13240):
  Avg similarity: 0.0380 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 20/100] [Batch 539/669 (80.6%)] [Iter 13250] Loss: 1.2151 (freq: 0.4447, raw: 0.7695, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[317,185,454,571,447,204,1005,834,643,371,248,418,676,660,601]


π”¬ Encoder Diversity (iter 13250):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 20/100] [Batch 549/669 (82.1%)] [Iter 13260] Loss: 0.9308 (freq: 0.3294, raw: 0.6005, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 731/1024 (71.4%) Top5:[185,277,900,317,204,994,601,447,87,490,958,395,806,670,371]


π”¬ Encoder Diversity (iter 13260):
  Avg similarity: 0.0549 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 20/100] [Batch 559/669 (83.6%)] [Iter 13270] Loss: 1.0263 (freq: 0.3449, raw: 0.6806, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 807/1024 (78.8%) Top5:[744,806,204,834,983,1005,317,994,247,454,571,173,995,585,591]


π”¬ Encoder Diversity (iter 13270):
  Avg similarity: 0.0634 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9576 (0.0=collapsed)
[Epoch 20/100] [Batch 569/669 (85.1%)] [Iter 13280] Loss: 0.9249 (freq: 0.3184, raw: 0.6057, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 809/1024 (79.0%) Top5:[204,834,995,806,585,983,247,395,332,578,490,789,913,277,10]


π”¬ Encoder Diversity (iter 13280):
  Avg similarity: 0.0686 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9516 (0.0=collapsed)
[Epoch 20/100] [Batch 579/669 (86.5%)] [Iter 13290] Loss: 1.3195 (freq: 0.4538, raw: 0.8647, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 877/1024 (85.6%) Top5:[834,805,591,1005,155,571,395,993,1011,10,446,983,176,416,86]


π”¬ Encoder Diversity (iter 13290):
  Avg similarity: 0.0545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9647 (0.0=collapsed)
[Epoch 20/100] [Batch 589/669 (88.0%)] [Iter 13300] Loss: 1.2140 (freq: 0.4287, raw: 0.7843, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[204,995,585,490,10,956,834,395,379,108,591,571,682,277,931]


π”¬ Encoder Diversity (iter 13300):
  Avg similarity: 0.0370 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9705 (0.0=collapsed)
[Epoch 20/100] [Batch 599/669 (89.5%)] [Iter 13310] Loss: 1.0035 (freq: 0.3643, raw: 0.6384, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[490,682,571,591,83,681,821,956,613,224,204,502,834,719,388]


π”¬ Encoder Diversity (iter 13310):
  Avg similarity: 0.0604 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9617 (0.0=collapsed)
[Epoch 20/100] [Batch 609/669 (91.0%)] [Iter 13320] Loss: 0.6898 (freq: 0.2178, raw: 0.4711, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[613,1005,821,379,806,956,204,10,247,62,317,585,469,418,86]


π”¬ Encoder Diversity (iter 13320):
  Avg similarity: 0.0873 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9567 (0.0=collapsed)
[Epoch 20/100] [Batch 619/669 (92.5%)] [Iter 13330] Loss: 1.0656 (freq: 0.3695, raw: 0.6952, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[10,518,277,247,1011,86,1005,204,117,683,108,454,872,806,571]


π”¬ Encoder Diversity (iter 13330):
  Avg similarity: 0.0475 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9633 (0.0=collapsed)
[Epoch 20/100] [Batch 629/669 (94.0%)] [Iter 13340] Loss: 1.0590 (freq: 0.3642, raw: 0.6939, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[683,86,61,276,185,198,806,682,1005,821,554,371,643,849,246]


π”¬ Encoder Diversity (iter 13340):
  Avg similarity: 0.0570 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 20/100] [Batch 639/669 (95.5%)] [Iter 13350] Loss: 1.1010 (freq: 0.4216, raw: 0.6785, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[429,834,913,611,568,303,204,10,155,805,789,332,1011,1005,849]


π”¬ Encoder Diversity (iter 13350):
  Avg similarity: 0.0522 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9662 (0.0=collapsed)
[Epoch 20/100] [Batch 649/669 (97.0%)] [Iter 13360] Loss: 1.0807 (freq: 0.3646, raw: 0.7151, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 879/1024 (85.8%) Top5:[571,682,591,619,759,913,416,719,173,993,1005,601,805,204,83]


π”¬ Encoder Diversity (iter 13360):
  Avg similarity: 0.0344 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 20/100] [Batch 659/669 (98.5%)] [Iter 13370] Loss: 1.2493 (freq: 0.4959, raw: 0.7525, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[681,447,613,682,643,57,418,198,379,994,246,569,94,831,759]


π”¬ Encoder Diversity (iter 13370):
  Avg similarity: 0.0503 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 20/100] [Batch 669/669 (100.0%)] [Iter 13380] Loss: 1.0642 (freq: 0.3658, raw: 0.6974, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 823/1024 (80.4%) Top5:[681,995,611,759,660,613,993,379,513,246,956,569,80,64,185]


================================================================================
[Epoch 20] Validation Results:
  Total Loss: 0.5600
  Freq Loss:  0.1712
  Raw Loss:   0.3880
  Quant Loss: 0.0008
  π“ Codebook Usage: 487/1024 (47.6%)
  π“ Codebook Entropy: 4.9874 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 26462 (20.3%)
  Top 10 most used codes:
    1. Code 417: 3116 times (2.39%)
    2. Code 80: 3064 times (2.35%)
    3. Code 670: 2751 times (2.11%)
    4. Code 999: 2684 times (2.06%)
    5. Code 375: 2565 times (1.97%)
    6. Code 994: 2559 times (1.97%)
    7. Code 607: 2547 times (1.96%)
    8. Code 8: 2451 times (1.88%)
    9. Code 83: 2375 times (1.82%)
    10. Code 379: 2350 times (1.80%)
  Bottom 5 least used codes (among used):
    1. Code 707: 1 times (0.00%)
    2. Code 410: 1 times (0.00%)
    3. Code 840: 1 times (0.00%)
    4. Code 969: 1 times (0.00%)
    5. Code 887: 1 times (0.00%)
================================================================================

[EarlyStopping] Patience 1/10
saving checkpoint to ./vq_output/checkpoints/VQ
saving checkpoint 19 to ./vq_output/checkpoints/VQ

π”¬ Encoder Diversity (iter 13380):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9651 (0.0=collapsed)
[Epoch 21/100] [Batch 10/669 (1.5%)] [Iter 13390] Loss: 1.1500 (freq: 0.4227, raw: 0.7263, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 1022/1024 (99.8%) Top5:[418,198,182,770,513,885,681,224,379,821,613,276,660,643,447]


π”¬ Encoder Diversity (iter 13390):
  Avg similarity: 0.0545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 21/100] [Batch 20/669 (3.0%)] [Iter 13400] Loss: 1.1929 (freq: 0.4412, raw: 0.7508, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[967,890,421,339,750,856,185,392,545,921,905,65,458,198,937]


π”¬ Encoder Diversity (iter 13400):
  Avg similarity: 0.0593 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9572 (0.0=collapsed)
[Epoch 21/100] [Batch 30/669 (4.5%)] [Iter 13410] Loss: 1.3050 (freq: 0.4701, raw: 0.8340, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 883/1024 (86.2%) Top5:[1010,45,974,392,207,664,284,1016,890,16,903,921,937,831,720]


π”¬ Encoder Diversity (iter 13410):
  Avg similarity: 0.0644 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9591 (0.0=collapsed)
[Epoch 21/100] [Batch 40/669 (6.0%)] [Iter 13420] Loss: 1.0763 (freq: 0.3826, raw: 0.6927, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[339,545,558,967,45,391,497,224,284,890,469,955,921,720,223]


π”¬ Encoder Diversity (iter 13420):
  Avg similarity: 0.0358 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9684 (0.0=collapsed)
[Epoch 21/100] [Batch 50/669 (7.5%)] [Iter 13430] Loss: 1.2502 (freq: 0.4799, raw: 0.7693, quant: 0.0011, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[1016,558,497,223,545,653,269,921,421,395,40,192,718,337,843]


π”¬ Encoder Diversity (iter 13430):
  Avg similarity: 0.0433 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9614 (0.0=collapsed)
[Epoch 21/100] [Batch 60/669 (9.0%)] [Iter 13440] Loss: 1.3295 (freq: 0.5007, raw: 0.8278, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 865/1024 (84.5%) Top5:[223,843,497,653,1016,558,89,831,905,856,771,40,373,956,371]


π”¬ Encoder Diversity (iter 13440):
  Avg similarity: 0.0361 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9717 (0.0=collapsed)
[Epoch 21/100] [Batch 70/669 (10.5%)] [Iter 13450] Loss: 1.3265 (freq: 0.4576, raw: 0.8679, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[558,40,653,771,224,613,192,223,469,667,579,921,885,352,236]


π”¬ Encoder Diversity (iter 13450):
  Avg similarity: 0.0382 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9715 (0.0=collapsed)
[Epoch 21/100] [Batch 80/669 (12.0%)] [Iter 13460] Loss: 0.9979 (freq: 0.3703, raw: 0.6267, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 782/1024 (76.4%) Top5:[885,421,223,83,185,392,61,956,184,513,40,545,651,56,207]


π”¬ Encoder Diversity (iter 13460):
  Avg similarity: 0.0545 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 21/100] [Batch 90/669 (13.5%)] [Iter 13470] Loss: 0.9454 (freq: 0.3535, raw: 0.5911, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[885,224,956,643,236,73,144,184,392,994,329,198,29,83,61]


π”¬ Encoder Diversity (iter 13470):
  Avg similarity: 0.0409 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9666 (0.0=collapsed)
[Epoch 21/100] [Batch 100/669 (14.9%)] [Iter 13480] Loss: 0.8353 (freq: 0.2933, raw: 0.5412, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 749/1024 (73.1%) Top5:[198,831,224,392,994,83,53,184,843,964,329,371,502,144,643]


π”¬ Encoder Diversity (iter 13480):
  Avg similarity: 0.0709 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9568 (0.0=collapsed)
[Epoch 21/100] [Batch 110/669 (16.4%)] [Iter 13490] Loss: 1.1813 (freq: 0.4238, raw: 0.7566, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 828/1024 (80.9%) Top5:[392,653,223,89,558,545,939,662,771,391,187,664,45,497,192]


π”¬ Encoder Diversity (iter 13490):
  Avg similarity: 0.0560 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9643 (0.0=collapsed)
[Epoch 21/100] [Batch 120/669 (17.9%)] [Iter 13500] Loss: 1.0500 (freq: 0.3687, raw: 0.6804, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[885,642,890,198,224,513,1016,666,329,370,352,73,425,388,209]


π”¬ Encoder Diversity (iter 13500):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9683 (0.0=collapsed)
[Epoch 21/100] [Batch 130/669 (19.4%)] [Iter 13510] Loss: 1.0333 (freq: 0.3796, raw: 0.6528, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[469,339,653,497,558,45,885,187,387,921,392,664,890,1012,967]


π”¬ Encoder Diversity (iter 13510):
  Avg similarity: 0.0306 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9698 (0.0=collapsed)
[Epoch 21/100] [Batch 140/669 (20.9%)] [Iter 13520] Loss: 1.0341 (freq: 0.3621, raw: 0.6711, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[392,805,653,388,497,224,773,115,223,89,905,613,759,831,209]


π”¬ Encoder Diversity (iter 13520):
  Avg similarity: 0.0633 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 21/100] [Batch 150/669 (22.4%)] [Iter 13530] Loss: 1.1917 (freq: 0.4252, raw: 0.7655, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 863/1024 (84.3%) Top5:[339,421,223,387,890,1016,653,49,545,568,45,905,664,89,83]


π”¬ Encoder Diversity (iter 13530):
  Avg similarity: 0.0512 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9602 (0.0=collapsed)
[Epoch 21/100] [Batch 160/669 (23.9%)] [Iter 13540] Loss: 0.8166 (freq: 0.2656, raw: 0.5501, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 881/1024 (86.0%) Top5:[921,1016,497,809,223,198,339,392,436,643,890,558,653,513,329]


π”¬ Encoder Diversity (iter 13540):
  Avg similarity: 0.0664 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9551 (0.0=collapsed)
[Epoch 21/100] [Batch 170/669 (25.4%)] [Iter 13550] Loss: 1.3176 (freq: 0.4887, raw: 0.8278, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 869/1024 (84.9%) Top5:[921,1016,89,545,40,653,890,339,223,664,56,392,458,905,184]


π”¬ Encoder Diversity (iter 13550):
  Avg similarity: 0.0432 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 21/100] [Batch 180/669 (26.9%)] [Iter 13560] Loss: 0.9713 (freq: 0.3496, raw: 0.6208, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[885,653,89,1012,773,664,329,370,613,905,890,803,513,392,371]


π”¬ Encoder Diversity (iter 13560):
  Avg similarity: 0.0880 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 21/100] [Batch 190/669 (28.4%)] [Iter 13570] Loss: 1.2318 (freq: 0.4760, raw: 0.7548, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 824/1024 (80.5%) Top5:[921,905,98,653,49,497,89,205,469,436,856,1016,935,339,421]


π”¬ Encoder Diversity (iter 13570):
  Avg similarity: 0.0463 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 21/100] [Batch 200/669 (29.9%)] [Iter 13580] Loss: 1.4017 (freq: 0.5269, raw: 0.8737, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 868/1024 (84.8%) Top5:[653,118,921,89,392,905,56,192,511,900,545,329,935,1012,223]


π”¬ Encoder Diversity (iter 13580):
  Avg similarity: 0.0556 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9560 (0.0=collapsed)
[Epoch 21/100] [Batch 210/669 (31.4%)] [Iter 13590] Loss: 0.5549 (freq: 0.1725, raw: 0.3816, quant: 0.0007, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[613,643,115,30,512,885,805,198,469,370,666,184,813,667,966]


π”¬ Encoder Diversity (iter 13590):
  Avg similarity: 0.0443 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9686 (0.0=collapsed)
[Epoch 21/100] [Batch 220/669 (32.9%)] [Iter 13600] Loss: 0.6889 (freq: 0.2411, raw: 0.4470, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 844/1024 (82.4%) Top5:[115,613,956,329,184,83,809,198,512,497,994,986,371,773,56]


π”¬ Encoder Diversity (iter 13600):
  Avg similarity: 0.0375 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9679 (0.0=collapsed)
[Epoch 21/100] [Batch 230/669 (34.4%)] [Iter 13610] Loss: 1.1767 (freq: 0.4083, raw: 0.7673, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[192,436,223,497,45,1016,89,939,935,98,759,40,905,856,205]


π”¬ Encoder Diversity (iter 13610):
  Avg similarity: 0.0555 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9637 (0.0=collapsed)
[Epoch 21/100] [Batch 240/669 (35.9%)] [Iter 13620] Loss: 1.4410 (freq: 0.5203, raw: 0.9197, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 846/1024 (82.6%) Top5:[89,421,653,545,387,337,1016,885,140,602,803,339,45,40,661]


π”¬ Encoder Diversity (iter 13620):
  Avg similarity: 0.0610 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9575 (0.0=collapsed)
[Epoch 21/100] [Batch 250/669 (37.4%)] [Iter 13630] Loss: 0.9135 (freq: 0.2933, raw: 0.6193, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 857/1024 (83.7%) Top5:[89,192,921,809,900,613,935,1016,45,337,223,118,392,339,40]


π”¬ Encoder Diversity (iter 13630):
  Avg similarity: 0.0601 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 21/100] [Batch 260/669 (38.9%)] [Iter 13640] Loss: 0.9492 (freq: 0.3444, raw: 0.6039, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[89,436,49,497,653,254,545,45,921,198,392,458,223,1016,935]


π”¬ Encoder Diversity (iter 13640):
  Avg similarity: 0.0402 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9667 (0.0=collapsed)
[Epoch 21/100] [Batch 270/669 (40.4%)] [Iter 13650] Loss: 0.7156 (freq: 0.2346, raw: 0.4801, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 861/1024 (84.1%) Top5:[669,643,1016,809,192,392,46,45,497,1009,771,954,49,813,653]


π”¬ Encoder Diversity (iter 13650):
  Avg similarity: 0.0484 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 21/100] [Batch 280/669 (41.9%)] [Iter 13660] Loss: 1.0236 (freq: 0.3389, raw: 0.6837, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 860/1024 (84.0%) Top5:[392,192,89,337,49,497,688,545,269,815,602,653,45,1009,56]


π”¬ Encoder Diversity (iter 13660):
  Avg similarity: 0.0574 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9608 (0.0=collapsed)
[Epoch 21/100] [Batch 290/669 (43.3%)] [Iter 13670] Loss: 1.0699 (freq: 0.4013, raw: 0.6677, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 827/1024 (80.8%) Top5:[392,223,339,545,89,1009,49,613,688,421,497,205,815,803,750]


π”¬ Encoder Diversity (iter 13670):
  Avg similarity: 0.0579 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9620 (0.0=collapsed)
[Epoch 21/100] [Batch 300/669 (44.8%)] [Iter 13680] Loss: 0.9839 (freq: 0.3669, raw: 0.6161, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 856/1024 (83.6%) Top5:[392,421,1009,339,497,387,192,546,49,46,80,45,815,337,561]


π”¬ Encoder Diversity (iter 13680):
  Avg similarity: 0.0431 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9650 (0.0=collapsed)
[Epoch 21/100] [Batch 310/669 (46.3%)] [Iter 13690] Loss: 1.3999 (freq: 0.5146, raw: 0.8842, quant: 0.0011, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[1016,337,1009,545,771,339,458,497,653,89,140,45,387,602,80]


π”¬ Encoder Diversity (iter 13690):
  Avg similarity: 0.0528 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 21/100] [Batch 320/669 (47.8%)] [Iter 13700] Loss: 0.9664 (freq: 0.3329, raw: 0.6326, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 848/1024 (82.8%) Top5:[192,392,223,921,89,337,1016,662,935,393,205,269,458,664,395]


π”¬ Encoder Diversity (iter 13700):
  Avg similarity: 0.0596 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9635 (0.0=collapsed)
[Epoch 21/100] [Batch 330/669 (49.3%)] [Iter 13710] Loss: 0.9586 (freq: 0.3207, raw: 0.6371, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 840/1024 (82.0%) Top5:[205,1016,1012,269,856,662,89,223,613,771,192,337,994,875,371]


π”¬ Encoder Diversity (iter 13710):
  Avg similarity: 0.0527 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9583 (0.0=collapsed)
[Epoch 21/100] [Batch 340/669 (50.8%)] [Iter 13720] Loss: 0.8461 (freq: 0.3074, raw: 0.5379, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 833/1024 (81.3%) Top5:[1016,339,885,463,469,921,561,497,395,45,613,511,392,223,115]


π”¬ Encoder Diversity (iter 13720):
  Avg similarity: 0.0653 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9594 (0.0=collapsed)
[Epoch 21/100] [Batch 350/669 (52.3%)] [Iter 13730] Loss: 1.1841 (freq: 0.4151, raw: 0.7681, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 798/1024 (77.9%) Top5:[223,921,511,469,89,395,259,1012,98,688,192,131,856,337,40]


π”¬ Encoder Diversity (iter 13730):
  Avg similarity: 0.0539 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9638 (0.0=collapsed)
[Epoch 21/100] [Batch 360/669 (53.8%)] [Iter 13740] Loss: 1.0220 (freq: 0.3720, raw: 0.6490, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 825/1024 (80.6%) Top5:[49,359,643,33,339,921,198,513,688,387,803,131,669,469,661]


π”¬ Encoder Diversity (iter 13740):
  Avg similarity: 0.0493 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9687 (0.0=collapsed)
[Epoch 21/100] [Batch 370/669 (55.3%)] [Iter 13750] Loss: 1.0799 (freq: 0.3944, raw: 0.6845, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 790/1024 (77.1%) Top5:[392,339,192,497,458,198,89,370,921,885,269,395,787,586,31]


π”¬ Encoder Diversity (iter 13750):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9669 (0.0=collapsed)
[Epoch 21/100] [Batch 380/669 (56.8%)] [Iter 13760] Loss: 0.7687 (freq: 0.2494, raw: 0.5184, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 817/1024 (79.8%) Top5:[329,198,688,370,184,517,46,803,115,977,813,371,890,613,131]


π”¬ Encoder Diversity (iter 13760):
  Avg similarity: 0.0875 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9529 (0.0=collapsed)
[Epoch 21/100] [Batch 390/669 (58.3%)] [Iter 13770] Loss: 1.4009 (freq: 0.4984, raw: 0.9015, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 812/1024 (79.3%) Top5:[89,921,890,33,223,192,709,198,1016,815,497,98,478,885,602]


π”¬ Encoder Diversity (iter 13770):
  Avg similarity: 0.0525 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9663 (0.0=collapsed)
[Epoch 21/100] [Batch 400/669 (59.8%)] [Iter 13780] Loss: 1.1439 (freq: 0.3987, raw: 0.7444, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 759/1024 (74.1%) Top5:[1016,497,803,890,921,192,198,813,939,613,395,40,89,643,49]


π”¬ Encoder Diversity (iter 13780):
  Avg similarity: 0.0845 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9500 (0.0=collapsed)
[Epoch 21/100] [Batch 410/669 (61.3%)] [Iter 13790] Loss: 0.9867 (freq: 0.3645, raw: 0.6213, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 753/1024 (73.5%) Top5:[458,497,1016,223,602,80,339,205,337,586,395,198,469,89,921]


π”¬ Encoder Diversity (iter 13790):
  Avg similarity: 0.0640 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9618 (0.0=collapsed)
[Epoch 21/100] [Batch 420/669 (62.8%)] [Iter 13800] Loss: 0.7751 (freq: 0.2462, raw: 0.5281, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 800/1024 (78.1%) Top5:[1016,497,205,653,395,905,192,834,45,803,89,371,994,176,561]


π”¬ Encoder Diversity (iter 13800):
  Avg similarity: 0.0537 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9631 (0.0=collapsed)
[Epoch 21/100] [Batch 430/669 (64.3%)] [Iter 13810] Loss: 1.1770 (freq: 0.3887, raw: 0.7873, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 788/1024 (77.0%) Top5:[339,497,586,1016,205,64,40,421,392,395,49,89,469,921,80]


π”¬ Encoder Diversity (iter 13810):
  Avg similarity: 0.0581 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9621 (0.0=collapsed)
[Epoch 21/100] [Batch 440/669 (65.8%)] [Iter 13820] Loss: 0.9436 (freq: 0.3227, raw: 0.6200, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 806/1024 (78.7%) Top5:[1016,591,49,198,497,546,1003,994,669,586,643,223,759,337,885]


π”¬ Encoder Diversity (iter 13820):
  Avg similarity: 0.0342 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9721 (0.0=collapsed)
[Epoch 21/100] [Batch 450/669 (67.3%)] [Iter 13830] Loss: 1.2864 (freq: 0.4483, raw: 0.8371, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 875/1024 (85.4%) Top5:[40,223,890,921,395,1016,269,387,391,935,89,1009,392,192,49]


π”¬ Encoder Diversity (iter 13830):
  Avg similarity: 0.0445 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9699 (0.0=collapsed)
[Epoch 21/100] [Batch 460/669 (68.8%)] [Iter 13840] Loss: 1.1744 (freq: 0.4415, raw: 0.7320, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 859/1024 (83.9%) Top5:[198,875,591,392,115,497,755,643,561,463,773,89,967,803,977]


π”¬ Encoder Diversity (iter 13840):
  Avg similarity: 0.0611 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9587 (0.0=collapsed)
[Epoch 21/100] [Batch 470/669 (70.3%)] [Iter 13850] Loss: 1.0898 (freq: 0.3604, raw: 0.7285, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 854/1024 (83.4%) Top5:[337,497,89,890,921,198,370,858,469,1016,269,421,643,192,395]


π”¬ Encoder Diversity (iter 13850):
  Avg similarity: 0.0606 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9619 (0.0=collapsed)
[Epoch 21/100] [Batch 480/669 (71.7%)] [Iter 13860] Loss: 0.8272 (freq: 0.2866, raw: 0.5397, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 847/1024 (82.7%) Top5:[198,1009,83,337,591,561,809,329,115,192,386,1016,404,977,89]


π”¬ Encoder Diversity (iter 13860):
  Avg similarity: 0.0381 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9695 (0.0=collapsed)
[Epoch 21/100] [Batch 490/669 (73.2%)] [Iter 13870] Loss: 0.9206 (freq: 0.3050, raw: 0.6147, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 837/1024 (81.7%) Top5:[890,89,921,395,223,205,329,497,586,404,198,49,337,386,45]


π”¬ Encoder Diversity (iter 13870):
  Avg similarity: 0.0348 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9706 (0.0=collapsed)
[Epoch 21/100] [Batch 500/669 (74.7%)] [Iter 13880] Loss: 1.0289 (freq: 0.3622, raw: 0.6658, quant: 0.0010, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 822/1024 (80.3%) Top5:[944,392,809,497,198,337,391,653,83,45,131,184,1016,591,395]


π”¬ Encoder Diversity (iter 13880):
  Avg similarity: 0.0403 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9649 (0.0=collapsed)
[Epoch 21/100] [Batch 510/669 (76.2%)] [Iter 13890] Loss: 1.1527 (freq: 0.4226, raw: 0.7293, quant: 0.0009, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 829/1024 (81.0%) Top5:[497,45,337,747,586,395,1016,269,944,223,465,192,329,921,184]


π”¬ Encoder Diversity (iter 13890):
  Avg similarity: 0.0843 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9510 (0.0=collapsed)
[Epoch 21/100] [Batch 520/669 (77.7%)] [Iter 13900] Loss: 0.8434 (freq: 0.2957, raw: 0.5469, quant: 0.0008, domain: 0.0000) LR: 1.97e-05 
π“ Codebook: 787/1024 (76.9%) Top5:[497,546,198,586,669,944,339,643,131,396,1016,404,387,370,184]


π”¬ Encoder Diversity (iter 13900):
  Avg similarity: 0.0502 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9589 (0.0=collapsed)
[Epoch 21/100] [Batch 530/669 (79.2%)] [Iter 13910] Loss: 1.1922 (freq: 0.4243, raw: 0.7669, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[497,1016,337,890,549,1003,773,395,205,416,897,380,269,40,387]


π”¬ Encoder Diversity (iter 13910):
  Avg similarity: 0.0938 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9488 (0.0=collapsed)
[Epoch 21/100] [Batch 540/669 (80.7%)] [Iter 13920] Loss: 0.6811 (freq: 0.2276, raw: 0.4528, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 808/1024 (78.9%) Top5:[89,497,184,1016,374,392,83,848,404,329,40,546,669,395,813]


π”¬ Encoder Diversity (iter 13920):
  Avg similarity: 0.0616 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9627 (0.0=collapsed)
[Epoch 21/100] [Batch 550/669 (82.2%)] [Iter 13930] Loss: 0.7070 (freq: 0.2322, raw: 0.4740, quant: 0.0008, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 789/1024 (77.1%) Top5:[337,1016,88,875,198,395,497,653,546,222,40,42,669,89,813]


π”¬ Encoder Diversity (iter 13930):
  Avg similarity: 0.0563 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9652 (0.0=collapsed)
[Epoch 21/100] [Batch 560/669 (83.7%)] [Iter 13940] Loss: 1.2143 (freq: 0.4245, raw: 0.7889, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 850/1024 (83.0%) Top5:[392,813,497,380,45,404,669,858,374,46,561,339,110,469,875]


π”¬ Encoder Diversity (iter 13940):
  Avg similarity: 0.1154 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9371 (0.0=collapsed)
[Epoch 21/100] [Batch 570/669 (85.2%)] [Iter 13950] Loss: 1.1648 (freq: 0.4299, raw: 0.7339, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[497,40,653,337,395,469,747,921,269,392,1016,339,205,49,386]


π”¬ Encoder Diversity (iter 13950):
  Avg similarity: 0.0567 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9661 (0.0=collapsed)
[Epoch 21/100] [Batch 580/669 (86.7%)] [Iter 13960] Loss: 1.1633 (freq: 0.4100, raw: 0.7524, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 858/1024 (83.8%) Top5:[944,404,374,921,45,198,967,49,46,813,803,602,115,31,329]


π”¬ Encoder Diversity (iter 13960):
  Avg similarity: 0.0408 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9673 (0.0=collapsed)
[Epoch 21/100] [Batch 590/669 (88.2%)] [Iter 13970] Loss: 1.2039 (freq: 0.4306, raw: 0.7724, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 841/1024 (82.1%) Top5:[198,337,222,813,45,643,392,944,329,688,1016,184,613,890,395]


π”¬ Encoder Diversity (iter 13970):
  Avg similarity: 0.0489 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9623 (0.0=collapsed)
[Epoch 21/100] [Batch 600/669 (89.7%)] [Iter 13980] Loss: 1.3049 (freq: 0.4868, raw: 0.8171, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 899/1024 (87.8%) Top5:[337,921,653,1016,395,905,89,421,469,497,222,269,586,478,40]


π”¬ Encoder Diversity (iter 13980):
  Avg similarity: 0.0582 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9536 (0.0=collapsed)
[Epoch 21/100] [Batch 610/669 (91.2%)] [Iter 13990] Loss: 1.3603 (freq: 0.5423, raw: 0.8170, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 888/1024 (86.7%) Top5:[497,921,905,586,395,1016,1003,913,386,643,354,387,662,669,89]


π”¬ Encoder Diversity (iter 13990):
  Avg similarity: 0.0372 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9675 (0.0=collapsed)
[Epoch 21/100] [Batch 620/669 (92.7%)] [Iter 14000] Loss: 1.1657 (freq: 0.4111, raw: 0.7535, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 870/1024 (85.0%) Top5:[497,1016,973,803,45,395,392,394,643,88,858,184,669,813,905]


π”¬ Encoder Diversity (iter 14000):
  Avg similarity: 0.0292 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9702 (0.0=collapsed)
[Epoch 21/100] [Batch 630/669 (94.2%)] [Iter 14010] Loss: 1.0330 (freq: 0.3467, raw: 0.6853, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 845/1024 (82.5%) Top5:[497,337,1016,107,45,875,184,295,825,944,803,83,404,1009,511]


π”¬ Encoder Diversity (iter 14010):
  Avg similarity: 0.0346 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9696 (0.0=collapsed)
[Epoch 21/100] [Batch 640/669 (95.7%)] [Iter 14020] Loss: 1.1730 (freq: 0.4174, raw: 0.7546, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 843/1024 (82.3%) Top5:[380,337,497,967,905,89,223,64,269,45,890,1016,474,392,586]


π”¬ Encoder Diversity (iter 14020):
  Avg similarity: 0.0387 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9697 (0.0=collapsed)
[Epoch 21/100] [Batch 650/669 (97.2%)] [Iter 14030] Loss: 1.1437 (freq: 0.3805, raw: 0.7624, quant: 0.0009, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 819/1024 (80.0%) Top5:[944,586,497,329,659,890,643,198,809,387,404,246,913,223,107]


π”¬ Encoder Diversity (iter 14030):
  Avg similarity: 0.0671 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9598 (0.0=collapsed)
[Epoch 21/100] [Batch 660/669 (98.7%)] [Iter 14040] Loss: 1.2667 (freq: 0.4338, raw: 0.8319, quant: 0.0010, domain: 0.0000) LR: 1.96e-05 
π“ Codebook: 852/1024 (83.2%) Top5:[586,469,890,198,1003,158,392,45,497,374,404,421,643,474,269]


π”¬ Encoder Diversity (iter 14040):
  Avg similarity: 0.0895 (1.0=identical, 0.0=orthogonal)
  Feature std: 0.9493 (0.0=collapsed)

================================================================================
[Epoch 21] Validation Results:
  Total Loss: 0.5827
  Freq Loss:  0.1793
  Raw Loss:   0.4025
  Quant Loss: 0.0009
  π“ Codebook Usage: 400/1024 (39.1%)
  π“ Codebook Entropy: 4.5855 (λ†’μ„μλ΅ κ· ν•μ΅ν, Low=νΈν–¥λ¨)
  π“ Total Tokens: 130200
  π“ Top 10 usage: 30256 (23.2%)
  Top 10 most used codes:
    1. Code 249: 3717 times (2.85%)
    2. Code 643: 3457 times (2.66%)
    3. Code 688: 3259 times (2.50%)
    4. Code 83: 2986 times (2.29%)
    5. Code 245: 2934 times (2.25%)
    6. Code 669: 2926 times (2.25%)
    7. Code 703: 2866 times (2.20%)
    8. Code 885: 2819 times (2.17%)
    9. Code 31: 2729 times (2.10%)
    10. Code 803: 2563 times (1.97%)
  Bottom 5 least used codes (among used):
    1. Code 143: 1 times (0.00%)
    2. Code 63: 1 times (0.00%)
    3. Code 154: 1 times (0.00%)
    4. Code 396: 1 times (0.00%)
    5. Code 285: 3 times (0.00%)
================================================================================

[EarlyStopping] Patience 2/10
saving checkpoint to ./vq_output/checkpoints/VQ
